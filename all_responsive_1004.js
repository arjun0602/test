/*! jQuery v2.1.1 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.1",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&a-parseFloat(a)>=0},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:g.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function(){return a.apply(b||this,e.concat(d.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+-new Date,v=a.document,w=0,x=0,y=gb(),z=gb(),A=gb(),B=function(a,b){return a===b&&(l=!0),0},C="undefined",D=1<<31,E={}.hasOwnProperty,F=[],G=F.pop,H=F.push,I=F.push,J=F.slice,K=F.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=N.replace("w","w#"),P="\\["+M+"*("+N+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+M+"*\\]",Q=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+P+")*)|.*)\\)|)",R=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),S=new RegExp("^"+M+"*,"+M+"*"),T=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),V=new RegExp(Q),W=new RegExp("^"+O+"$"),X={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+Q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{I.apply(F=J.call(v.childNodes),v.childNodes),F[v.childNodes.length].nodeType}catch(eb){I={apply:F.length?function(a,b){H.apply(a,J.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function fb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],!a||"string"!=typeof a)return d;if(1!==(k=b.nodeType)&&9!==k)return[];if(p&&!e){if(f=_.exec(a))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return I.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return I.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=9===k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+qb(o[l]);w=ab.test(a)&&ob(b.parentNode)||b,x=o.join(",")}if(x)try{return I.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function gb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function hb(a){return a[u]=!0,a}function ib(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function jb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function kb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||D)-(~a.sourceIndex||D);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function lb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function nb(a){return hb(function(b){return b=+b,hb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function ob(a){return a&&typeof a.getElementsByTagName!==C&&a}c=fb.support={},f=fb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=fb.setDocument=function(a){var b,e=a?a.ownerDocument||a:v,g=e.defaultView;return e!==n&&9===e.nodeType&&e.documentElement?(n=e,o=e.documentElement,p=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){m()},!1):g.attachEvent&&g.attachEvent("onunload",function(){m()})),c.attributes=ib(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ib(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(e.getElementsByClassName)&&ib(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),c.getById=ib(function(a){return o.appendChild(a).id=u,!e.getElementsByName||!e.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==C&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c=typeof a.getAttributeNode!==C&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==C?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==C&&p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(e.querySelectorAll))&&(ib(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>",a.querySelectorAll("[msallowclip^='']").length&&q.push("[*^$]="+M+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+M+"*(?:value|"+L+")"),a.querySelectorAll(":checked").length||q.push(":checked")}),ib(function(a){var b=e.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+M+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ib(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",Q)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===v&&t(v,a)?-1:b===e||b.ownerDocument===v&&t(v,b)?1:k?K.call(k,a)-K.call(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],i=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:k?K.call(k,a)-K.call(k,b):0;if(f===g)return kb(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?kb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},e):n},fb.matches=function(a,b){return fb(a,null,null,b)},fb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return fb(b,n,null,[a]).length>0},fb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},fb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&E.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},fb.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},fb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=fb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=fb.selectors={cacheLength:50,createPseudo:hb,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||fb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&fb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+M+")"+a+"("+M+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==C&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=fb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||fb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?hb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=K.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:hb(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?hb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:hb(function(a){return function(b){return fb(a,b).length>0}}),contains:hb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:hb(function(a){return W.test(a||"")||fb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:nb(function(){return[0]}),last:nb(function(a,b){return[b-1]}),eq:nb(function(a,b,c){return[0>c?c+b:c]}),even:nb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:nb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:nb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:nb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=lb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=mb(b);function pb(){}pb.prototype=d.filters=d.pseudos,d.setFilters=new pb,g=fb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?fb.error(a):z(a,i).slice(0)};function qb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function rb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function sb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function tb(a,b,c){for(var d=0,e=b.length;e>d;d++)fb(a,b[d],c);return c}function ub(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function vb(a,b,c,d,e,f){return d&&!d[u]&&(d=vb(d)),e&&!e[u]&&(e=vb(e,f)),hb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||tb(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:ub(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=ub(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?K.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=ub(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):I.apply(g,r)})}function wb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=rb(function(a){return a===b},h,!0),l=rb(function(a){return K.call(b,a)>-1},h,!0),m=[function(a,c,d){return!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>i;i++)if(c=d.relative[a[i].type])m=[rb(sb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return vb(i>1&&sb(m),i>1&&qb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&wb(a.slice(i,e)),f>e&&wb(a=a.slice(e)),f>e&&qb(a))}m.push(c)}return sb(m)}function xb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=G.call(i));s=ub(s)}I.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&fb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?hb(f):f}return h=fb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=wb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,xb(e,d)),f.selector=a}return f},i=fb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&ob(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&qb(j),!a)return I.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&ob(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ib(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ib(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||jb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ib(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||jb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ib(function(a){return null==a.getAttribute("disabled")})||jb(L,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),fb}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return g.call(b,a)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){while((a=a[b])&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++)if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable())},k={add:function(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=h.length:b&&(e=c,j(b))}return this},remove:function(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1)h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],f=0,this},disable:function(){return h=i=b=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,b||k.disable(),this},locked:function(){return!i},fireWith:function(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!c}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))))}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready()}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b)},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function K(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+Math.random()}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,n.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--)delete g[d[c]]}},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var L=new K,M=new K,N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}M.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return M.hasData(a)||L.hasData(a)},data:function(a,b,c){return M.access(a,b,c)},removeData:function(a,b){M.remove(a,b)
},_data:function(a,b,c){return L.access(a,b,c)},_removeData:function(a,b){L.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));L.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){M.set(this,a)}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){M.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0}function $(){return!1}function _(){try{return l.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return typeof n!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(E)||[""],j=b.length;while(j--)h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode)p.push(g),h=g;h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a)}f=0;while((g=p[f++])&&!b.isPropagationStopped())b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==_()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===_()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function(a){return n().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bb=/<([\w:]+)/,cb=/<|&#?\w+;/,db=/<(?:script|style|link)/i,eb=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/^$|\/(?:java|ecma)script/i,gb=/^true\/(.*)/,hb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ib={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ib.optgroup=ib.option,ib.tbody=ib.tfoot=ib.colgroup=ib.caption=ib.thead,ib.th=ib.td;function jb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function kb(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function lb(a){var b=gb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function mb(a,b){for(var c=0,d=a.length;d>c;c++)L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"))}function nb(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i))}}function ob(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function pb(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}n.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=ob(h),f=ob(a),d=0,e=f.length;e>d;d++)pb(f[d],g[d]);if(b)if(c)for(f=f||ob(a),g=g||ob(h),d=0,e=f.length;e>d;d++)nb(f[d],g[d]);else nb(a,h);return g=ob(h,"script"),g.length>0&&mb(g,!i&&ob(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++)if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(cb.test(e)){f=f||k.appendChild(b.createElement("div")),g=(bb.exec(e)||["",""])[1].toLowerCase(),h=ib[g]||ib._default,f.innerHTML=h[1]+e.replace(ab,"<$1></$2>")+h[2],j=h[0];while(j--)f=f.lastChild;n.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));k.textContent="",m=0;while(e=l[m++])if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=ob(k.appendChild(e),"script"),i&&mb(f),c)){j=0;while(e=f[j++])fb.test(e.type||"")&&c.push(e)}return k},cleanData:function(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events)f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);L.cache[e]&&delete L.cache[e]}delete M.cache[c[M.expando]]}}}),n.fn.extend({text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(ob(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&mb(ob(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(ob(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!db.test(a)&&!ib[(bb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(ab,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(ob(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(ob(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&eb.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(ob(c,"script"),kb),g=f.length;l>j;j++)h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,ob(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,n.map(f,lb),j=0;g>j;j++)h=f[j],fb.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(hb,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++)c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());return this.pushStack(d)}});var qb,rb={};function sb(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f}function tb(a){var b=l,c=rb[a];return c||(c=sb(a,b),"none"!==c&&c||(qb=(qb||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qb[0].contentDocument,b.write(),b.close(),c=sb(a,b),qb.detach()),rb[a]=c),c}var ub=/^margin/,vb=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};function xb(a,b,c){var d,e,f,g,h=a.style;return c=c||wb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),vb.test(g)&&ub.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function yb(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e)}a.getComputedStyle&&n.extend(k,{pixelPosition:function(){return g(),b},boxSizingReliable:function(){return null==c&&g(),c},reliableMarginRight:function(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),b}})}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var zb=/^(none|table(?!-c[ea]).+)/,Ab=new RegExp("^("+Q+")(.*)$","i"),Bb=new RegExp("^([+-])=("+Q+")","i"),Cb={position:"absolute",visibility:"hidden",display:"block"},Db={letterSpacing:"0",fontWeight:"400"},Eb=["Webkit","O","Moz","ms"];function Fb(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Eb.length;while(e--)if(b=Eb[e]+c,b in a)return b;return d}function Gb(a,b,c){var d=Ab.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Hb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));return g}function Ib(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wb(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xb(a,b,f),(0>e||null==e)&&(e=a.style[b]),vb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Hb(a,b,c||(g?"border":"content"),d,f)+"px"}function Jb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",tb(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=xb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Bb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xb(a,b,d)),"normal"===e&&b in Db&&(e=Db[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?zb.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Cb,function(){return Ib(a,b,d)}):Ib(a,b,d):void 0},set:function(a,c,d){var e=d&&wb(a);return Gb(a,c,d?Hb(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),n.cssHooks.marginRight=yb(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+R[d]+b]=f[d]||f[d-2]||f[0];return e}},ub.test(a)||(n.cssHooks[a+b].set=Gb)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Jb(this,!0)},hide:function(){return Jb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}});function Kb(a,b,c,d,e){return new Kb.prototype.init(a,b,c,d,e)}n.Tween=Kb,Kb.prototype={constructor:Kb,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Kb.propHooks[this.prop];return a&&a.get?a.get(this):Kb.propHooks._default.get(this)},run:function(a){var b,c=Kb.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Kb.propHooks._default.set(this),this}},Kb.prototype.init.prototype=Kb.prototype,Kb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Kb.propHooks.scrollTop=Kb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=Kb.prototype.init,n.fx.step={};var Lb,Mb,Nb=/^(?:toggle|show|hide)$/,Ob=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pb=/queueHooks$/,Qb=[Vb],Rb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Ob.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Ob.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function Sb(){return setTimeout(function(){Lb=void 0}),Lb=n.now()}function Tb(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=R[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ub(a,b,c){for(var d,e=(Rb[b]||[]).concat(Rb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Vb(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||tb(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Nb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?tb(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ub(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Wb(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Xb(a,b,c){var d,e,f=0,g=Qb.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Lb||Sb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Lb||Sb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Wb(k,j.opts.specialEasing);g>f;f++)if(d=Qb[f].call(j,a,k,j.opts))return d;return n.map(k,Ub,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(Xb,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Rb[c]=Rb[c]||[],Rb[c].unshift(b)},prefilter:function(a,b){b?Qb.unshift(a):Qb.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Xb(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Pb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Tb(b,!0),a,d,e)}}),n.each({slideDown:Tb("show"),slideUp:Tb("hide"),slideToggle:Tb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Lb=n.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Lb=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Mb||(Mb=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(Mb),Mb=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value}();var Yb,Zb,$b=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Zb:Yb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))
},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),Zb={set:function(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$b[b]||n.find.attr;$b[b]=function(a,b,d){var e,f;return d||(f=$b[b],$b[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$b[b]=f),e}});var _b=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||_b.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),k.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var ac=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ac," ").indexOf(b)>=0)return!0;return!1}});var bc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bc,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cc=n.now(),dc=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b};var ec,fc,gc=/#.*$/,hc=/([?&])_=[^&]*/,ic=/^(.*?):[ \t]*([^\r\n]*)$/gm,jc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,kc=/^(?:GET|HEAD)$/,lc=/^\/\//,mc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,nc={},oc={},pc="*/".concat("*");try{fc=location.href}catch(qc){fc=l.createElement("a"),fc.href="",fc=fc.href}ec=mc.exec(fc.toLowerCase())||[];function rc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function sc(a,b,c,d){var e={},f=a===oc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function tc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function uc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function vc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:fc,type:"GET",isLocal:jc.test(ec[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":pc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?tc(tc(a,n.ajaxSettings),b):tc(n.ajaxSettings,a)},ajaxPrefilter:rc(nc),ajaxTransport:rc(oc),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!f){f={};while(b=ic.exec(e))f[b[1].toLowerCase()]=b[2]}b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?e:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return c&&c.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||fc)+"").replace(gc,"").replace(lc,ec[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=mc.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===ec[1]&&h[2]===ec[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(ec[3]||("http:"===ec[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),sc(nc,k,b,v),2===t)return v;i=k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!kc.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(dc.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=hc.test(d)?d.replace(hc,"$1_="+cc++):d+(dc.test(d)?"&":"?")+"_="+cc++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+pc+"; q=0.01":""):k.accepts["*"]);for(j in k.headers)v.setRequestHeader(j,k.headers[j]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1})v[j](k[j]);if(c=sc(oc,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,c.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=uc(k,v,f)),u=vc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var wc=/%20/g,xc=/\[\]$/,yc=/\r?\n/g,zc=/^(?:submit|button|image|reset|file)$/i,Ac=/^(?:input|select|textarea|keygen)/i;function Bc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||xc.test(a)?d(a,e):Bc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Bc(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Bc(c,a[c],b,e);return d.join("&").replace(wc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Ac.test(this.nodeName)&&!zc.test(a)&&(this.checked||!T.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(yc,"\r\n")}}):{name:b.name,value:c.replace(yc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Cc=0,Dc={},Ec={0:200,1223:204},Fc=n.ajaxSettings.xhr();a.ActiveXObject&&n(a).on("unload",function(){for(var a in Dc)Dc[a]()}),k.cors=!!Fc&&"withCredentials"in Fc,k.ajax=Fc=!!Fc,n.ajaxTransport(function(a){var b;return k.cors||Fc&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Cc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Dc[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Ec[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Dc[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),l.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Gc=[],Hc=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Gc.pop()||n.expando+"_"+cc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Hc.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Hc.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Hc,"$1"+e):b.jsonp!==!1&&(b.url+=(dc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Gc.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var Ic=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Ic)return Ic.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var Jc=a.document.documentElement;function Kc(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(typeof d.getBoundingClientRect!==U&&(e=d.getBoundingClientRect()),c=Kc(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||Jc;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||Jc})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Kc(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=yb(k.pixelPosition,function(a,c){return c?(c=xb(a,b),vb.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Lc=a.jQuery,Mc=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Mc),b&&a.jQuery===n&&(a.jQuery=Lc),n},typeof b===U&&(a.jQuery=a.$=n),n});

/*!
 * Bootstrap v3.2.0 (http://getbootstrap.com)
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.2.0",d.prototype.close=function(b){function c(){f.detach().trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,""));var f=a(e);b&&b.preventDefault(),f.length||(f=d.hasClass("alert")?d:d.parent()),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",c).emulateTransitionEnd(150):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.2.0",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),d[e](null==f[b]?this.options[b]:f[b]),setTimeout(a.proxy(function(){"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")&&(c.prop("checked")&&this.$element.hasClass("active")?a=!1:b.find(".active").removeClass("active")),a&&c.prop("checked",!this.$element.hasClass("active")).trigger("change")}a&&this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target);d.hasClass("btn")||(d=d.closest(".btn")),b.call(d,"toggle"),c.preventDefault()})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b).on("keydown.bs.carousel",a.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.2.0",c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},c.prototype.keydown=function(a){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.to=function(b){var c=this,d=this.getItemIndex(this.$active=this.$element.find(".item.active"));return b>this.$items.length-1||0>b?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){c.to(b)}):d==b?this.pause().cycle():this.slide(b>d?"next":"prev",a(this.$items[b]))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){return this.sliding?void 0:this.slide("next")},c.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},c.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||d[b](),f=this.interval,g="next"==b?"left":"right",h="next"==b?"first":"last",i=this;if(!e.length){if(!this.options.wrap)return;e=this.$element.find(".item")[h]()}if(e.hasClass("active"))return this.sliding=!1;var j=e[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:g});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,f&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(e)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:g});return a.support.transition&&this.$element.hasClass("slide")?(e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one("bsTransitionEnd",function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(1e3*d.css("transition-duration").slice(0,-1))):(d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger(m)),f&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this},a(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}}),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.collapse"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b);!e&&f.toggle&&"show"==b&&(b=!b),e||d.data("bs.collapse",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.transitioning=null,this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};c.VERSION="3.2.0",c.DEFAULTS={toggle:!0},c.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},c.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var c=a.Event("show.bs.collapse");if(this.$element.trigger(c),!c.isDefaultPrevented()){var d=this.$parent&&this.$parent.find("> .panel > .in");if(d&&d.length){var e=d.data("bs.collapse");if(e&&e.transitioning)return;b.call(d,"hide"),e||d.data("bs.collapse",null)}var f=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[f](0),this.transitioning=1;var g=function(){this.$element.removeClass("collapsing").addClass("collapse in")[f](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return g.call(this);var h=a.camelCase(["scroll",f].join("-"));this.$element.one("bsTransitionEnd",a.proxy(g,this)).emulateTransitionEnd(350)[f](this.$element[0][h])}}},c.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(d,this)).emulateTransitionEnd(350):d.call(this)}}},c.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var d=a.fn.collapse;a.fn.collapse=b,a.fn.collapse.Constructor=c,a.fn.collapse.noConflict=function(){return a.fn.collapse=d,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(c){var d,e=a(this),f=e.attr("data-target")||c.preventDefault()||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),g=a(f),h=g.data("bs.collapse"),i=h?"toggle":e.data(),j=e.attr("data-parent"),k=j&&a(j);h&&h.transitioning||(k&&k.find('[data-toggle="collapse"][data-parent="'+j+'"]').not(e).addClass("collapsed"),e[g.hasClass("in")?"addClass":"removeClass"]("collapsed")),b.call(g,i)})}(jQuery),+function(a){"use strict";function b(b){b&&3===b.which||(a(e).remove(),a(f).each(function(){var d=c(a(this)),e={relatedTarget:this};d.hasClass("open")&&(d.trigger(b=a.Event("hide.bs.dropdown",e)),b.isDefaultPrevented()||d.removeClass("open").trigger("hidden.bs.dropdown",e))}))}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.2.0",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus"),f.toggleClass("open").trigger("shown.bs.dropdown",h)}return!1}},g.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var e=c(d),g=e.hasClass("open");if(!g||g&&27==b.keyCode)return 27==b.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.divider):visible a",i=e.find('[role="menu"]'+h+', [role="listbox"]'+h);if(i.length){var j=i.index(i.filter(":focus"));38==b.keyCode&&j>0&&j--,40==b.keyCode&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f+', [role="menu"], [role="listbox"]',g.prototype.keydown)}(jQuery),+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.2.0",c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(c.$body),c.$element.show().scrollTop(0),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$element.find(".modal-dialog").one("bsTransitionEnd",function(){c.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(300):c.$element.trigger("focus").trigger(e)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;if(this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;e?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(150):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var f=function(){c.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",f).emulateTransitionEnd(150):f()}else b&&b()},c.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;(e||"destroy"!=b)&&(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};c.VERSION="3.2.0",c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(this.options.viewport.selector||this.options.viewport);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show()},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var c=a.contains(document.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!c)return;var d=this,e=this.tip(),f=this.getUID(this.type);this.setContent(),e.attr("id",f),this.$element.attr("aria-describedby",f),this.options.animation&&e.addClass("fade");var g="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,i=h.test(g);i&&(g=g.replace(h,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(g).data("bs."+this.type,this),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element);var j=this.getPosition(),k=e[0].offsetWidth,l=e[0].offsetHeight;if(i){var m=g,n=this.$element.parent(),o=this.getPosition(n);g="bottom"==g&&j.top+j.height+l-o.scroll>o.height?"top":"top"==g&&j.top-o.scroll-l<0?"bottom":"right"==g&&j.right+k>o.width?"left":"left"==g&&j.left-k<o.left?"right":g,e.removeClass(m).addClass(g)}var p=this.getCalculatedOffset(g,j,k,l);this.applyPlacement(p,g);var q=function(){d.$element.trigger("shown.bs."+d.type),d.hoverState=null};a.support.transition&&this.$tip.hasClass("fade")?e.one("bsTransitionEnd",q).emulateTransitionEnd(150):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top=b.top+g,b.left=b.left+h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=k.left?2*k.left-e+i:2*k.top-f+j,m=k.left?"left":"top",n=k.left?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(l,d[0][n],m)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(){function b(){"in"!=c.hoverState&&d.detach(),c.$element.trigger("hidden.bs."+c.type)}var c=this,d=this.tip(),e=a.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(e),e.isDefaultPrevented()?void 0:(d.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d.one("bsTransitionEnd",b).emulateTransitionEnd(150):b(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName;return a.extend({},"function"==typeof c.getBoundingClientRect?c.getBoundingClientRect():null,{scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop(),width:d?a(window).width():b.outerWidth(),height:d?a(window).height():b.outerHeight()},d?{top:0,left:0}:b.offset())},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.width&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;(e||"destroy"!=b)&&(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.2.0",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").empty()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},c.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),+function(a){"use strict";function b(c,d){var e=a.proxy(this.process,this);this.$body=a("body"),this.$scrollElement=a(a(c).is("body")?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",e),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.2.0",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b="offset",c=0;a.isWindow(this.$scrollElement[0])||(b="position",c=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var d=this;this.$body.find(this.selector).map(function(){var d=a(this),e=d.data("target")||d.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[b]().top+c,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){d.offsets.push(this[0]),d.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<=e[0])return g!=(a=f[0])&&this.activate(a);for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(!e[a+1]||b<=e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,a(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.2.0",c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a")[0],f=a.Event("show.bs.tab",{relatedTarget:e});if(b.trigger(f),!f.isDefaultPrevented()){var g=a(d);this.activate(b.closest("li"),c),this.activate(g,g.parent(),function(){b.trigger({type:"shown.bs.tab",relatedTarget:e})})}}},c.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&f.hasClass("fade");g?f.one("bsTransitionEnd",e).emulateTransitionEnd(150):e(),f.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this},a(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(c){c.preventDefault(),b.call(a(this),"show")})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.2.0",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=a(document).height(),d=this.$target.scrollTop(),e=this.$element.offset(),f=this.options.offset,g=f.top,h=f.bottom;"object"!=typeof f&&(h=g=f),"function"==typeof g&&(g=f.top(this.$element)),"function"==typeof h&&(h=f.bottom(this.$element));var i=null!=this.unpin&&d+this.unpin<=e.top?!1:null!=h&&e.top+this.$element.height()>=b-h?"bottom":null!=g&&g>=d?"top":!1;if(this.affixed!==i){null!=this.unpin&&this.$element.css("top","");var j="affix"+(i?"-"+i:""),k=a.Event(j+".bs.affix");this.$element.trigger(k),k.isDefaultPrevented()||(this.affixed=i,this.unpin="bottom"==i?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(j).trigger(a.Event(j.replace("affix","affixed"))),"bottom"==i&&this.$element.offset({top:b-this.$element.height()-h}))}}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},d.offsetBottom&&(d.offset.bottom=d.offsetBottom),d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery);
/*!
 * enquire.js v2.1.2 - Awesome Media Queries in JavaScript
 * Copyright (c) 2014 Nick Williams - http://wicky.nillia.ms/enquire.js
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */

!function(a,b,c){var d=window.matchMedia;"undefined"!=typeof module&&module.exports?module.exports=c(d):"function"==typeof define&&define.amd?define(function(){return b[a]=c(d)}):b[a]=c(d)}("enquire",this,function(a){"use strict";function b(a,b){var c,d=0,e=a.length;for(d;e>d&&(c=b(a[d],d),c!==!1);d++);}function c(a){return"[object Array]"===Object.prototype.toString.apply(a)}function d(a){return"function"==typeof a}function e(a){this.options=a,!a.deferSetup&&this.setup()}function f(b,c){this.query=b,this.isUnconditional=c,this.handlers=[],this.mql=a(b);var d=this;this.listener=function(a){d.mql=a,d.assess()},this.mql.addListener(this.listener)}function g(){if(!a)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!a("only all").matches}return e.prototype={setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(a){return this.options===a||this.options.match===a}},f.prototype={addHandler:function(a){var b=new e(a);this.handlers.push(b),this.matches()&&b.on()},removeHandler:function(a){var c=this.handlers;b(c,function(b,d){return b.equals(a)?(b.destroy(),!c.splice(d,1)):void 0})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){b(this.handlers,function(a){a.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var a=this.matches()?"on":"off";b(this.handlers,function(b){b[a]()})}},g.prototype={register:function(a,e,g){var h=this.queries,i=g&&this.browserIsIncapable;return h[a]||(h[a]=new f(a,i)),d(e)&&(e={match:e}),c(e)||(e=[e]),b(e,function(b){d(b)&&(b={match:b}),h[a].addHandler(b)}),this},unregister:function(a,b){var c=this.queries[a];return c&&(b?c.removeHandler(b):(c.clear(),delete this.queries[a])),this}},new g});
/* MODIFIED */
;(function (window, document) {
	'use strict';

	var  nextTick, addEvent;
	nextTick = window.requestAnimationFrame ||
			   window.mozRequestAnimationFrame ||
			   window.webkitRequestAnimationFrame ||
			   function (callback) {
				   window.setTimeout(callback, 1000 / 60);
			   };

	addEvent = (function(){
		if (document.addEventListener){
			return function addStandardEventListener(el, eventName, fn){
				return el.addEventListener(eventName, fn, false);
			};
		}
		else {
			return function addIEEventListener(el, eventName, fn){
				return el.attachEvent('on'+eventName, fn);
			};
		}
	})();

	function Imager (elements, opts) {
		var self = this,doc  = document;
		opts = opts || {};

		this.elements         = elements || '.js-responsive-image';
		this.className        = opts.className || 'js-responsive-image-replaced';
		this.onResize         = opts.hasOwnProperty('onResize') ? opts.onResize : true;
		this.onImagesReplaced = opts.onImagesReplaced || function () {};

		this.eles = $(elements);
		nextTick(function(){self.init();});
	}

	Imager.prototype.init = function(){
		this.checkImagesNeedReplacing(this.eles);
		if(this.onResize){this.registerResizeEvent();}
	};

	Imager.prototype.checkImagesNeedReplacing = function (images) {
		var self = this;

		if (!this.isResizing) {
			this.isResizing = true;

			images.each(function(){self.replaceImagesBasedOnScreenDimensions(this);});
			
			this.isResizing = false;
			this.onImagesReplaced(images);
		}
	};

	Imager.prototype.replaceImagesBasedOnScreenDimensions = function (image) {
		var src,availableWidths = [],srcARRAY,cwidth;

		if( $(image).attr("data-media")!=undefined){
			var eMedia = $(image).attr("data-media")
			$(image).removeAttr("data-media")
			eMedia = $.parseJSON(eMedia)
			$.each(eMedia, function(key, value) {
				  availableWidths.push(parseInt(key));
			});
			$(image).data("width",availableWidths);
			$(image).data("media",eMedia);
		}

		srcARRAY = $(image).data("media");
		cwidth = Imager.getClosestValue($(image).parent().width(), $.extend([],$(image).data("width")));

		if(image.src == srcARRAY[cwidth]){return;}
		image.src = srcARRAY[cwidth];
	};
	//Removed = as on 768 screen it exclude 768 node from candidates image array
	Imager.getClosestValue = function getClosestValue(baseValue, candidates){
		if(baseValue > candidates[0] && candidates.length > 1){
			candidates.shift()
			getClosestValue(baseValue,candidates)
		}
		return candidates[0];
	}

	Imager.prototype.registerResizeEvent = function(){
		var self = this;
		addEvent(window, 'resize', function(){
			self.checkImagesNeedReplacing(self.eles);
		});
	};

	if (typeof module === 'object' && typeof module.exports === 'object') {
		module.exports = exports = Imager;
	} else if (typeof define === 'function' && define.amd) {
		define(function () { return Imager; });
	} else if (typeof window === 'object') {
		window.Imager = Imager;
	}

}(window, document));
/*!
 * jQuery blockUI plugin
 * Version 2.66.0-2013.10.09
 * Requires jQuery v1.7 or later
 *
 * Examples at: http://malsup.com/jquery/block/
 * Copyright (c) 2007-2013 M. Alsup
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
 */

;(function() {
/*jshint eqeqeq:false curly:false latedef:false */
"use strict";

	function setup($) {
		$.fn._fadeIn = $.fn.fadeIn;

		var noOp = $.noop || function() {};

		// this bit is to ensure we don't call setExpression when we shouldn't (with extra muscle to handle
		// confusing userAgent strings on Vista)
		var msie = /MSIE/.test(navigator.userAgent);
		var ie6  = /MSIE 6.0/.test(navigator.userAgent) && ! /MSIE 8.0/.test(navigator.userAgent);
		var mode = document.documentMode || 0;
		var setExpr = $.isFunction( document.createElement('div').style.setExpression );

		// global $ methods for blocking/unblocking the entire page
		$.blockUI   = function(opts) { install(window, opts); };
		$.unblockUI = function(opts) { remove(window, opts); };

		// convenience method for quick growl-like notifications  (http://www.google.com/search?q=growl)
		$.growlUI = function(title, message, timeout, onClose) {
			var $m = $('<div class="growlUI"></div>');
			if (title) $m.append('<h1>'+title+'</h1>');
			if (message) $m.append('<h2>'+message+'</h2>');
			if (timeout === undefined) timeout = 3000;

			// Added by konapun: Set timeout to 30 seconds if this growl is moused over, like normal toast notifications
			var callBlock = function(opts) {
				opts = opts || {};

				$.blockUI({
					message: $m,
					fadeIn : typeof opts.fadeIn  !== 'undefined' ? opts.fadeIn  : 700,
					fadeOut: typeof opts.fadeOut !== 'undefined' ? opts.fadeOut : 1000,
					timeout: typeof opts.timeout !== 'undefined' ? opts.timeout : timeout,
					centerY: false,
					showOverlay: false,
					onUnblock: onClose,
					css: $.blockUI.defaults.growlCSS
				});
			};

			callBlock();
			var nonmousedOpacity = $m.css('opacity');
			$m.mouseover(function() {
				callBlock({
					fadeIn: 0,
					timeout: 30000
				});

				var displayBlock = $('.blockMsg');
				displayBlock.stop(); // cancel fadeout if it has started
				displayBlock.fadeTo(300, 1); // make it easier to read the message by removing transparency
			}).mouseout(function() {
				$('.blockMsg').fadeOut(1000);
			});
			// End konapun additions
		};

		// plugin method for blocking element content
		$.fn.block = function(opts) {
			if ( this[0] === window ) {
				$.blockUI( opts );
				return this;
			}
			var fullOpts = $.extend({}, $.blockUI.defaults, opts || {});
			this.each(function() {
				var $el = $(this);
				if (fullOpts.ignoreIfBlocked && $el.data('blockUI.isBlocked'))
					return;
				$el.unblock({ fadeOut: 0 });
			});

			return this.each(function() {
				if ($.css(this,'position') == 'static') {
					this.style.position = 'relative';
					$(this).data('blockUI.static', true);
				}
				this.style.zoom = 1; // force 'hasLayout' in ie
				install(this, opts);
			});
		};

		// plugin method for unblocking element content
		$.fn.unblock = function(opts) {
			if ( this[0] === window ) {
				$.unblockUI( opts );
				return this;
			}
			return this.each(function() {
				remove(this, opts);
			});
		};

		$.blockUI.version = 2.66; // 2nd generation blocking at no extra cost!

		// override these in your code to change the default behavior and style
		$.blockUI.defaults = {
			// message displayed when blocking (use null for no message)
			message:  '<h1>Please wait...</h1>',

			title: null,		// title string; only used when theme == true
			draggable: true,	// only used when theme == true (requires jquery-ui.js to be loaded)

			theme: false, // set to true to use with jQuery UI themes

			// styles for the message when blocking; if you wish to disable
			// these and use an external stylesheet then do this in your code:
			// $.blockUI.defaults.css = {};
			css: {
				padding:	0,
				margin:		0,
				width:		'30%',
				top:		'40%',
				left:		'35%',
				textAlign:	'center',
				color:		'#000',
				border:		'3px solid #aaa',
				backgroundColor:'#fff',
				cursor:		'wait'
			},

			// minimal style set used when themes are used
			themedCSS: {
				width:	'30%',
				top:	'40%',
				left:	'35%'
			},

			// styles for the overlay
			overlayCSS:  {
				backgroundColor:	'#000',
				opacity:			0.6,
				cursor:				'wait'
			},

			// style to replace wait cursor before unblocking to correct issue
			// of lingering wait cursor
			cursorReset: 'default',

			// styles applied when using $.growlUI
			growlCSS: {
				width:		'350px',
				top:		'10px',
				left:		'',
				right:		'10px',
				border:		'none',
				padding:	'5px',
				opacity:	0.6,
				cursor:		'default',
				color:		'#fff',
				backgroundColor: '#000',
				'-webkit-border-radius':'10px',
				'-moz-border-radius':	'10px',
				'border-radius':		'10px'
			},

			// IE issues: 'about:blank' fails on HTTPS and javascript:false is s-l-o-w
			// (hat tip to Jorge H. N. de Vasconcelos)
			/*jshint scripturl:true */
			iframeSrc: /^https/i.test(window.location.href || '') ? 'javascript:false' : 'about:blank',

			// force usage of iframe in non-IE browsers (handy for blocking applets)
			forceIframe: false,

			// z-index for the blocking overlay
			baseZ: 1000,

			// set these to true to have the message automatically centered
			centerX: true, // <-- only effects element blocking (page block controlled via css above)
			centerY: true,

			// allow body element to be stetched in ie6; this makes blocking look better
			// on "short" pages.  disable if you wish to prevent changes to the body height
			allowBodyStretch: true,

			// enable if you want key and mouse events to be disabled for content that is blocked
			bindEvents: true,

			// be default blockUI will supress tab navigation from leaving blocking content
			// (if bindEvents is true)
			constrainTabKey: true,

			// fadeIn time in millis; set to 0 to disable fadeIn on block
			fadeIn:  200,

			// fadeOut time in millis; set to 0 to disable fadeOut on unblock
			fadeOut:  400,

			// time in millis to wait before auto-unblocking; set to 0 to disable auto-unblock
			timeout: 0,

			// disable if you don't want to show the overlay
			showOverlay: true,

			// if true, focus will be placed in the first available input field when
			// page blocking
			focusInput: true,

            // elements that can receive focus
            focusableElements: ':input:enabled:visible',

			// suppresses the use of overlay styles on FF/Linux (due to performance issues with opacity)
			// no longer needed in 2012
			// applyPlatformOpacityRules: true,

			// callback method invoked when fadeIn has completed and blocking message is visible
			onBlock: null,

			// callback method invoked when unblocking has completed; the callback is
			// passed the element that has been unblocked (which is the window object for page
			// blocks) and the options that were passed to the unblock call:
			//	onUnblock(element, options)
			onUnblock: null,

			// callback method invoked when the overlay area is clicked.
			// setting this will turn the cursor to a pointer, otherwise cursor defined in overlayCss will be used.
			onOverlayClick: null,

			// don't ask; if you really must know: http://groups.google.com/group/jquery-en/browse_thread/thread/36640a8730503595/2f6a79a77a78e493#2f6a79a77a78e493
			quirksmodeOffsetHack: 4,

			// class name of the message block
			blockMsgClass: 'blockMsg',

			// if it is already blocked, then ignore it (don't unblock and reblock)
			ignoreIfBlocked: false
		};

		// private data and functions follow...

		var pageBlock = null;
		var pageBlockEls = [];

		function install(el, opts) {
			var css, themedCSS;
			var full = (el == window);
			var msg = (opts && opts.message !== undefined ? opts.message : undefined);
			opts = $.extend({}, $.blockUI.defaults, opts || {});

			if (opts.ignoreIfBlocked && $(el).data('blockUI.isBlocked'))
				return;

			opts.overlayCSS = $.extend({}, $.blockUI.defaults.overlayCSS, opts.overlayCSS || {});
			css = $.extend({}, $.blockUI.defaults.css, opts.css || {});
			if (opts.onOverlayClick)
				opts.overlayCSS.cursor = 'pointer';

			themedCSS = $.extend({}, $.blockUI.defaults.themedCSS, opts.themedCSS || {});
			msg = msg === undefined ? opts.message : msg;

			// remove the current block (if there is one)
			if (full && pageBlock)
				remove(window, {fadeOut:0});

			// if an existing element is being used as the blocking content then we capture
			// its current place in the DOM (and current display style) so we can restore
			// it when we unblock
			if (msg && typeof msg != 'string' && (msg.parentNode || msg.jquery)) {
				var node = msg.jquery ? msg[0] : msg;
				var data = {};
				$(el).data('blockUI.history', data);
				data.el = node;
				data.parent = node.parentNode;
				data.display = node.style.display;
				data.position = node.style.position;
				if (data.parent)
					data.parent.removeChild(node);
			}

			$(el).data('blockUI.onUnblock', opts.onUnblock);
			var z = opts.baseZ;

			// blockUI uses 3 layers for blocking, for simplicity they are all used on every platform;
			// layer1 is the iframe layer which is used to supress bleed through of underlying content
			// layer2 is the overlay layer which has opacity and a wait cursor (by default)
			// layer3 is the message content that is displayed while blocking
			var lyr1, lyr2, lyr3, s;
			if (msie || opts.forceIframe)
				lyr1 = $('<iframe class="blockUI" style="z-index:'+ (z++) +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+opts.iframeSrc+'"></iframe>');
			else
				lyr1 = $('<div class="blockUI" style="display:none"></div>');

			if (opts.theme)
				lyr2 = $('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+ (z++) +';display:none"></div>');
			else
				lyr2 = $('<div class="blockUI blockOverlay" style="z-index:'+ (z++) +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');

			if (opts.theme && full) {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:fixed">';
				if ( opts.title ) {
					s += '<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title || '&nbsp;')+'</div>';
				}
				s += '<div class="ui-widget-content ui-dialog-content"></div>';
				s += '</div>';
			}
			else if (opts.theme) {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:absolute">';
				if ( opts.title ) {
					s += '<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title || '&nbsp;')+'</div>';
				}
				s += '<div class="ui-widget-content ui-dialog-content"></div>';
				s += '</div>';
			}
			else if (full) {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockPage" style="z-index:'+(z+10)+';display:none;position:fixed"></div>';
			}
			else {
				s = '<div class="blockUI ' + opts.blockMsgClass + ' blockElement" style="z-index:'+(z+10)+';display:none;position:absolute"></div>';
			}
			lyr3 = $(s);

			// if we have a message, style it
			if (msg) {
				if (opts.theme) {
					lyr3.css(themedCSS);
					lyr3.addClass('ui-widget-content');
				}
				else
					lyr3.css(css);
			}

			// style the overlay
			if (!opts.theme /*&& (!opts.applyPlatformOpacityRules)*/)
				lyr2.css(opts.overlayCSS);
			lyr2.css('position', full ? 'fixed' : 'absolute');

			// make iframe layer transparent in IE
			if (msie || opts.forceIframe)
				lyr1.css('opacity',0.0);

			//$([lyr1[0],lyr2[0],lyr3[0]]).appendTo(full ? 'body' : el);
			var layers = [lyr1,lyr2,lyr3], $par = full ? $('body') : $(el);
			$.each(layers, function() {
				this.appendTo($par);
			});

			if (opts.theme && opts.draggable && $.fn.draggable) {
				lyr3.draggable({
					handle: '.ui-dialog-titlebar',
					cancel: 'li'
				});
			}

			// ie7 must use absolute positioning in quirks mode and to account for activex issues (when scrolling)
			var expr = setExpr && (!$.support.boxModel || $('object,embed', full ? null : el).length > 0);
			if (ie6 || expr) {
				// give body 100% height
				if (full && opts.allowBodyStretch && $.support.boxModel)
					$('html,body').css('height','100%');

				// fix ie6 issue when blocked element has a border width
				if ((ie6 || !$.support.boxModel) && !full) {
					var t = sz(el,'borderTopWidth'), l = sz(el,'borderLeftWidth');
					var fixT = t ? '(0 - '+t+')' : 0;
					var fixL = l ? '(0 - '+l+')' : 0;
				}

				// simulate fixed position
				$.each(layers, function(i,o) {
					var s = o[0].style;
					s.position = 'absolute';
					if (i < 2) {
						if (full)
							s.setExpression('height','Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:'+opts.quirksmodeOffsetHack+') + "px"');
						else
							s.setExpression('height','this.parentNode.offsetHeight + "px"');
						if (full)
							s.setExpression('width','jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');
						else
							s.setExpression('width','this.parentNode.offsetWidth + "px"');
						if (fixL) s.setExpression('left', fixL);
						if (fixT) s.setExpression('top', fixT);
					}
					else if (opts.centerY) {
						if (full) s.setExpression('top','(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');
						s.marginTop = 0;
					}
					else if (!opts.centerY && full) {
						var top = (opts.css && opts.css.top) ? parseInt(opts.css.top, 10) : 0;
						var expression = '((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + '+top+') + "px"';
						s.setExpression('top',expression);
					}
				});
			}

			// show the message
			if (msg) {
				if (opts.theme)
					lyr3.find('.ui-widget-content').append(msg);
				else
					lyr3.append(msg);
				if (msg.jquery || msg.nodeType)
					$(msg).show();
			}

			if ((msie || opts.forceIframe) && opts.showOverlay)
				lyr1.show(); // opacity is zero
			if (opts.fadeIn) {
				var cb = opts.onBlock ? opts.onBlock : noOp;
				var cb1 = (opts.showOverlay && !msg) ? cb : noOp;
				var cb2 = msg ? cb : noOp;
				if (opts.showOverlay)
					lyr2._fadeIn(opts.fadeIn, cb1);
				if (msg)
					lyr3._fadeIn(opts.fadeIn, cb2);
			}
			else {
				if (opts.showOverlay)
					lyr2.show();
				if (msg)
					lyr3.show();
				if (opts.onBlock)
					opts.onBlock();
			}

			// bind key and mouse events
			bind(1, el, opts);

			if (full) {
				pageBlock = lyr3[0];
				pageBlockEls = $(opts.focusableElements,pageBlock);
				if (opts.focusInput)
					setTimeout(focus, 20);
			}
			else
				center(lyr3[0], opts.centerX, opts.centerY);

			if (opts.timeout) {
				// auto-unblock
				var to = setTimeout(function() {
					if (full)
						$.unblockUI(opts);
					else
						$(el).unblock(opts);
				}, opts.timeout);
				$(el).data('blockUI.timeout', to);
			}
		}

		// remove the block
		function remove(el, opts) {
			var count;
			var full = (el == window);
			var $el = $(el);
			var data = $el.data('blockUI.history');
			var to = $el.data('blockUI.timeout');
			if (to) {
				clearTimeout(to);
				$el.removeData('blockUI.timeout');
			}
			opts = $.extend({}, $.blockUI.defaults, opts || {});
			bind(0, el, opts); // unbind events

			if (opts.onUnblock === null) {
				opts.onUnblock = $el.data('blockUI.onUnblock');
				$el.removeData('blockUI.onUnblock');
			}

			var els;
			if (full) // crazy selector to handle odd field errors in ie6/7
				els = $('body').children().filter('.blockUI').add('body > .blockUI');
			else
				els = $el.find('>.blockUI');

			// fix cursor issue
			if ( opts.cursorReset ) {
				if ( els.length > 1 )
					els[1].style.cursor = opts.cursorReset;
				if ( els.length > 2 )
					els[2].style.cursor = opts.cursorReset;
			}

			if (full)
				pageBlock = pageBlockEls = null;

			if (opts.fadeOut) {
				count = els.length;
				els.stop().fadeOut(opts.fadeOut, function() {
					if ( --count === 0)
						reset(els,data,opts,el);
				});
			}
			else
				reset(els, data, opts, el);
		}

		// move blocking element back into the DOM where it started
		function reset(els,data,opts,el) {
			var $el = $(el);
			if ( $el.data('blockUI.isBlocked') )
				return;

			els.each(function(i,o) {
				// remove via DOM calls so we don't lose event handlers
				if (this.parentNode)
					this.parentNode.removeChild(this);
			});

			if (data && data.el) {
				data.el.style.display = data.display;
				data.el.style.position = data.position;
				if (data.parent)
					data.parent.appendChild(data.el);
				$el.removeData('blockUI.history');
			}

			if ($el.data('blockUI.static')) {
				$el.css('position', 'static'); // #22
			}

			if (typeof opts.onUnblock == 'function')
				opts.onUnblock(el,opts);

			// fix issue in Safari 6 where block artifacts remain until reflow
			var body = $(document.body), w = body.width(), cssW = body[0].style.width;
			body.width(w-1).width(w);
			body[0].style.width = cssW;
		}

		// bind/unbind the handler
		function bind(b, el, opts) {
			var full = el == window, $el = $(el);

			// don't bother unbinding if there is nothing to unbind
			if (!b && (full && !pageBlock || !full && !$el.data('blockUI.isBlocked')))
				return;

			$el.data('blockUI.isBlocked', b);

			// don't bind events when overlay is not in use or if bindEvents is false
			if (!full || !opts.bindEvents || (b && !opts.showOverlay))
				return;

			// bind anchors and inputs for mouse and key events
			var events = 'mousedown mouseup keydown keypress keyup touchstart touchend touchmove';
			if (b)
				$(document).bind(events, opts, handler);
			else
				$(document).unbind(events, handler);

		// former impl...
		//		var $e = $('a,:input');
		//		b ? $e.bind(events, opts, handler) : $e.unbind(events, handler);
		}

		// event handler to suppress keyboard/mouse events when blocking
		function handler(e) {
			// allow tab navigation (conditionally)
			if (e.type === 'keydown' && e.keyCode && e.keyCode == 9) {
				if (pageBlock && e.data.constrainTabKey) {
					var els = pageBlockEls;
					var fwd = !e.shiftKey && e.target === els[els.length-1];
					var back = e.shiftKey && e.target === els[0];
					if (fwd || back) {
						setTimeout(function(){focus(back);},10);
						return false;
					}
				}
			}
			var opts = e.data;
			var target = $(e.target);
			if (target.hasClass('blockOverlay') && opts.onOverlayClick)
				opts.onOverlayClick(e);

			// allow events within the message content
			if (target.parents('div.' + opts.blockMsgClass).length > 0)
				return true;

			// allow events for content that is not being blocked
			return target.parents().children().filter('div.blockUI').length === 0;
		}

		function focus(back) {
			if (!pageBlockEls)
				return;
			var e = pageBlockEls[back===true ? pageBlockEls.length-1 : 0];
			if (e)
				e.focus();
		}

		function center(el, x, y) {
			var p = el.parentNode, s = el.style;
			var l = ((p.offsetWidth - el.offsetWidth)/2) - sz(p,'borderLeftWidth');
			var t = ((p.offsetHeight - el.offsetHeight)/2) - sz(p,'borderTopWidth');
			if (x) s.left = l > 0 ? (l+'px') : '0';
			if (y) s.top  = t > 0 ? (t+'px') : '0';
		}

		function sz(el, p) {
			return parseInt($.css(el,p),10)||0;
		}

	}


	/*global define:true */
	if (typeof define === 'function' && define.amd && define.amd.jQuery) {
		define(['jquery'], setup);
	} else {
		setup(jQuery);
	}

})();

/*!
	Colorbox 1.5.14
	license: MIT
	http://www.jacklmoore.com/colorbox
*/
(function(t,e,i){function n(i,n,o){var r=e.createElement(i);return n&&(r.id=Z+n),o&&(r.style.cssText=o),t(r)}function o(){return i.innerHeight?i.innerHeight:t(i).height()}function r(e,i){i!==Object(i)&&(i={}),this.cache={},this.el=e,this.value=function(e){var n;return void 0===this.cache[e]&&(n=t(this.el).attr("data-cbox-"+e),void 0!==n?this.cache[e]=n:void 0!==i[e]?this.cache[e]=i[e]:void 0!==X[e]&&(this.cache[e]=X[e])),this.cache[e]},this.get=function(e){var i=this.value(e);return t.isFunction(i)?i.call(this.el,this):i}}function h(t){var e=W.length,i=(z+t)%e;return 0>i?e+i:i}function a(t,e){return Math.round((/%/.test(t)?("x"===e?E.width():o())/100:1)*parseInt(t,10))}function s(t,e){return t.get("photo")||t.get("photoRegex").test(e)}function l(t,e){return t.get("retinaUrl")&&i.devicePixelRatio>1?e.replace(t.get("photoRegex"),t.get("retinaSuffix")):e}function d(t){"contains"in y[0]&&!y[0].contains(t.target)&&t.target!==v[0]&&(t.stopPropagation(),y.focus())}function c(t){c.str!==t&&(y.add(v).removeClass(c.str).addClass(t),c.str=t)}function g(e){z=0,e&&e!==!1&&"nofollow"!==e?(W=t("."+te).filter(function(){var i=t.data(this,Y),n=new r(this,i);return n.get("rel")===e}),z=W.index(_.el),-1===z&&(W=W.add(_.el),z=W.length-1)):W=t(_.el)}function u(i){t(e).trigger(i),ae.triggerHandler(i)}function f(i){var o;if(!G){if(o=t(i).data(Y),_=new r(i,o),g(_.get("rel")),!$){$=q=!0,c(_.get("className")),y.css({visibility:"hidden",display:"block",opacity:""}),L=n(se,"LoadedContent","width:0; height:0; overflow:hidden; visibility:hidden"),b.css({width:"",height:""}).append(L),D=T.height()+k.height()+b.outerHeight(!0)-b.height(),j=C.width()+H.width()+b.outerWidth(!0)-b.width(),A=L.outerHeight(!0),N=L.outerWidth(!0);var h=a(_.get("initialWidth"),"x"),s=a(_.get("initialHeight"),"y"),l=_.get("maxWidth"),f=_.get("maxHeight");_.w=(l!==!1?Math.min(h,a(l,"x")):h)-N-j,_.h=(f!==!1?Math.min(s,a(f,"y")):s)-A-D,L.css({width:"",height:_.h}),J.position(),u(ee),_.get("onOpen"),O.add(F).hide(),y.focus(),_.get("trapFocus")&&e.addEventListener&&(e.addEventListener("focus",d,!0),ae.one(re,function(){e.removeEventListener("focus",d,!0)})),_.get("returnFocus")&&ae.one(re,function(){t(_.el).focus()})}var p=parseFloat(_.get("opacity"));v.css({opacity:p===p?p:"",cursor:_.get("overlayClose")?"pointer":"",visibility:"visible"}).show(),_.get("closeButton")?B.html(_.get("close")).appendTo(b):B.appendTo("<div/>"),w()}}function p(){y||(V=!1,E=t(i),y=n(se).attr({id:Y,"class":t.support.opacity===!1?Z+"IE":"",role:"dialog",tabindex:"-1"}).hide(),v=n(se,"Overlay").hide(),S=t([n(se,"LoadingOverlay")[0],n(se,"LoadingGraphic")[0]]),x=n(se,"Wrapper"),b=n(se,"Content").append(F=n(se,"Title"),I=n(se,"Current"),P=t('<button type="button"/>').attr({id:Z+"Previous"}),K=t('<button type="button"/>').attr({id:Z+"Next"}),R=n("button","Slideshow"),S),B=t('<button type="button"/>').attr({id:Z+"Close"}),x.append(n(se).append(n(se,"TopLeft"),T=n(se,"TopCenter"),n(se,"TopRight")),n(se,!1,"clear:left").append(C=n(se,"MiddleLeft"),b,H=n(se,"MiddleRight")),n(se,!1,"clear:left").append(n(se,"BottomLeft"),k=n(se,"BottomCenter"),n(se,"BottomRight"))).find("div div").css({"float":"left"}),M=n(se,!1,"position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;"),O=K.add(P).add(I).add(R)),e.body&&!y.parent().length&&t(e.body).append(v,y.append(x,M))}function m(){function i(t){t.which>1||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey||(t.preventDefault(),f(this))}return y?(V||(V=!0,K.click(function(){J.next()}),P.click(function(){J.prev()}),B.click(function(){J.close()}),v.click(function(){_.get("overlayClose")&&J.close()}),t(e).bind("keydown."+Z,function(t){var e=t.keyCode;$&&_.get("escKey")&&27===e&&(t.preventDefault(),J.close()),$&&_.get("arrowKey")&&W[1]&&!t.altKey&&(37===e?(t.preventDefault(),P.click()):39===e&&(t.preventDefault(),K.click()))}),t.isFunction(t.fn.on)?t(e).on("click."+Z,"."+te,i):t("."+te).live("click."+Z,i)),!0):!1}function w(){var e,o,r,h=J.prep,d=++le;if(q=!0,U=!1,u(he),u(ie),_.get("onLoad"),_.h=_.get("height")?a(_.get("height"),"y")-A-D:_.get("innerHeight")&&a(_.get("innerHeight"),"y"),_.w=_.get("width")?a(_.get("width"),"x")-N-j:_.get("innerWidth")&&a(_.get("innerWidth"),"x"),_.mw=_.w,_.mh=_.h,_.get("maxWidth")&&(_.mw=a(_.get("maxWidth"),"x")-N-j,_.mw=_.w&&_.w<_.mw?_.w:_.mw),_.get("maxHeight")&&(_.mh=a(_.get("maxHeight"),"y")-A-D,_.mh=_.h&&_.h<_.mh?_.h:_.mh),e=_.get("href"),Q=setTimeout(function(){S.show()},100),_.get("inline")){var c=t(e);r=t("<div>").hide().insertBefore(c),ae.one(he,function(){r.replaceWith(c)}),h(c)}else _.get("iframe")?h(" "):_.get("html")?h(_.get("html")):s(_,e)?(e=l(_,e),U=new Image,t(U).addClass(Z+"Photo").bind("error",function(){h(n(se,"Error").html(_.get("imgError")))}).one("load",function(){d===le&&setTimeout(function(){var e;t.each(["alt","longdesc","aria-describedby"],function(e,i){var n=t(_.el).attr(i)||t(_.el).attr("data-"+i);n&&U.setAttribute(i,n)}),_.get("retinaImage")&&i.devicePixelRatio>1&&(U.height=U.height/i.devicePixelRatio,U.width=U.width/i.devicePixelRatio),_.get("scalePhotos")&&(o=function(){U.height-=U.height*e,U.width-=U.width*e},_.mw&&U.width>_.mw&&(e=(U.width-_.mw)/U.width,o()),_.mh&&U.height>_.mh&&(e=(U.height-_.mh)/U.height,o())),_.h&&(U.style.marginTop=Math.max(_.mh-U.height,0)/2+"px"),W[1]&&(_.get("loop")||W[z+1])&&(U.style.cursor="pointer",U.onclick=function(){J.next()}),U.style.width=U.width+"px",U.style.height=U.height+"px",h(U)},1)}),U.src=e):e&&M.load(e,_.get("data"),function(e,i){d===le&&h("error"===i?n(se,"Error").html(_.get("xhrError")):t(this).contents())})}var v,y,x,b,T,C,H,k,W,E,L,M,S,F,I,R,K,P,B,O,_,D,j,A,N,z,U,$,q,G,Q,J,V,X={html:!1,photo:!1,iframe:!1,inline:!1,transition:"elastic",speed:300,fadeOut:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,opacity:.9,preloading:!0,className:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:void 0,closeButton:!0,fastIframe:!0,open:!1,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).*)?$/i,retinaImage:!1,retinaUrl:!1,retinaSuffix:"@2x.$1",current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",returnFocus:!0,trapFocus:!0,onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,rel:function(){return this.rel},href:function(){return t(this).attr("href")},title:function(){return this.title}},Y="colorbox",Z="cbox",te=Z+"Element",ee=Z+"_open",ie=Z+"_load",ne=Z+"_complete",oe=Z+"_cleanup",re=Z+"_closed",he=Z+"_purge",ae=t("<a/>"),se="div",le=0,de={},ce=function(){function t(){clearTimeout(h)}function e(){(_.get("loop")||W[z+1])&&(t(),h=setTimeout(J.next,_.get("slideshowSpeed")))}function i(){R.html(_.get("slideshowStop")).unbind(s).one(s,n),ae.bind(ne,e).bind(ie,t),y.removeClass(a+"off").addClass(a+"on")}function n(){t(),ae.unbind(ne,e).unbind(ie,t),R.html(_.get("slideshowStart")).unbind(s).one(s,function(){J.next(),i()}),y.removeClass(a+"on").addClass(a+"off")}function o(){r=!1,R.hide(),t(),ae.unbind(ne,e).unbind(ie,t),y.removeClass(a+"off "+a+"on")}var r,h,a=Z+"Slideshow_",s="click."+Z;return function(){r?_.get("slideshow")||(ae.unbind(oe,o),o()):_.get("slideshow")&&W[1]&&(r=!0,ae.one(oe,o),_.get("slideshowAuto")?i():n(),R.show())}}();t[Y]||(t(p),J=t.fn[Y]=t[Y]=function(e,i){var n,o=this;if(e=e||{},t.isFunction(o))o=t("<a/>"),e.open=!0;else if(!o[0])return o;return o[0]?(p(),m()&&(i&&(e.onComplete=i),o.each(function(){var i=t.data(this,Y)||{};t.data(this,Y,t.extend(i,e))}).addClass(te),n=new r(o[0],e),n.get("open")&&f(o[0])),o):o},J.position=function(e,i){function n(){T[0].style.width=k[0].style.width=b[0].style.width=parseInt(y[0].style.width,10)-j+"px",b[0].style.height=C[0].style.height=H[0].style.height=parseInt(y[0].style.height,10)-D+"px"}var r,h,s,l=0,d=0,c=y.offset();if(E.unbind("resize."+Z),y.css({top:-9e4,left:-9e4}),h=E.scrollTop(),s=E.scrollLeft(),_.get("fixed")?(c.top-=h,c.left-=s,y.css({position:"fixed"})):(l=h,d=s,y.css({position:"absolute"})),d+=_.get("right")!==!1?Math.max(E.width()-_.w-N-j-a(_.get("right"),"x"),0):_.get("left")!==!1?a(_.get("left"),"x"):Math.round(Math.max(E.width()-_.w-N-j,0)/2),l+=_.get("bottom")!==!1?Math.max(o()-_.h-A-D-a(_.get("bottom"),"y"),0):_.get("top")!==!1?a(_.get("top"),"y"):Math.round(Math.max(o()-_.h-A-D,0)/2),y.css({top:c.top,left:c.left,visibility:"visible"}),x[0].style.width=x[0].style.height="9999px",r={width:_.w+N+j,height:_.h+A+D,top:l,left:d},e){var g=0;t.each(r,function(t){return r[t]!==de[t]?(g=e,void 0):void 0}),e=g}de=r,e||y.css(r),y.dequeue().animate(r,{duration:e||0,complete:function(){n(),q=!1,x[0].style.width=_.w+N+j+"px",x[0].style.height=_.h+A+D+"px",_.get("reposition")&&setTimeout(function(){E.bind("resize."+Z,J.position)},1),t.isFunction(i)&&i()},step:n})},J.resize=function(t){var e;$&&(t=t||{},t.width&&(_.w=a(t.width,"x")-N-j),t.innerWidth&&(_.w=a(t.innerWidth,"x")),L.css({width:_.w}),t.height&&(_.h=a(t.height,"y")-A-D),t.innerHeight&&(_.h=a(t.innerHeight,"y")),t.innerHeight||t.height||(e=L.scrollTop(),L.css({height:"auto"}),_.h=L.height()),L.css({height:_.h}),e&&L.scrollTop(e),J.position("none"===_.get("transition")?0:_.get("speed")))},J.prep=function(i){function o(){return _.w=_.w||L.width(),_.w=_.mw&&_.mw<_.w?_.mw:_.w,_.w}function a(){return _.h=_.h||L.height(),_.h=_.mh&&_.mh<_.h?_.mh:_.h,_.h}if($){var d,g="none"===_.get("transition")?0:_.get("speed");L.remove(),L=n(se,"LoadedContent").append(i),L.hide().appendTo(M.show()).css({width:o(),overflow:_.get("scrolling")?"auto":"hidden"}).css({height:a()}).prependTo(b),M.hide(),t(U).css({"float":"none"}),c(_.get("className")),d=function(){function i(){t.support.opacity===!1&&y[0].style.removeAttribute("filter")}var n,o,a=W.length;$&&(o=function(){clearTimeout(Q),S.hide(),u(ne),_.get("onComplete")},F.html(_.get("title")).show(),L.show(),a>1?("string"==typeof _.get("current")&&I.html(_.get("current").replace("{current}",z+1).replace("{total}",a)).show(),K[_.get("loop")||a-1>z?"show":"hide"]().html(_.get("next")),P[_.get("loop")||z?"show":"hide"]().html(_.get("previous")),ce(),_.get("preloading")&&t.each([h(-1),h(1)],function(){var i,n=W[this],o=new r(n,t.data(n,Y)),h=o.get("href");h&&s(o,h)&&(h=l(o,h),i=e.createElement("img"),i.src=h)})):O.hide(),_.get("iframe")?(n=e.createElement("iframe"),"frameBorder"in n&&(n.frameBorder=0),"allowTransparency"in n&&(n.allowTransparency="true"),_.get("scrolling")||(n.scrolling="no"),t(n).attr({src:_.get("href"),name:(new Date).getTime(),"class":Z+"Iframe",allowFullScreen:!0}).one("load",o).appendTo(L),ae.one(he,function(){n.src="//about:blank"}),_.get("fastIframe")&&t(n).trigger("load")):o(),"fade"===_.get("transition")?y.fadeTo(g,1,i):i())},"fade"===_.get("transition")?y.fadeTo(g,0,function(){J.position(0,d)}):J.position(g,d)}},J.next=function(){!q&&W[1]&&(_.get("loop")||W[z+1])&&(z=h(1),f(W[z]))},J.prev=function(){!q&&W[1]&&(_.get("loop")||z)&&(z=h(-1),f(W[z]))},J.close=function(){$&&!G&&(G=!0,$=!1,u(oe),_.get("onCleanup"),E.unbind("."+Z),v.fadeTo(_.get("fadeOut")||0,0),y.stop().fadeTo(_.get("fadeOut")||0,0,function(){y.hide(),v.hide(),u(he),L.remove(),setTimeout(function(){G=!1,u(re),_.get("onClosed")},1)}))},J.remove=function(){y&&(y.stop(),t[Y].close(),y.stop(!1,!0).remove(),v.remove(),G=!1,y=null,t("."+te).removeData(Y).removeClass(te),t(e).unbind("click."+Z).unbind("keydown."+Z))},J.element=function(){return t(_.el)},J.settings=X)})(jQuery,document,window);
/*!
 * jQuery Form Plugin
 * version: 3.51.0-2014.06.20
 * Requires jQuery v1.5 or later
 * Copyright (c) 2014 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(e){"use strict";function t(t){var r=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(t.target).ajaxSubmit(r))}function r(t){var r=t.target,a=e(r);if(!a.is("[type=submit],[type=image]")){var n=a.closest("[type=submit]");if(0===n.length)return;r=n[0]}var i=this;if(i.clk=r,"image"==r.type)if(void 0!==t.offsetX)i.clk_x=t.offsetX,i.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var o=a.offset();i.clk_x=t.pageX-o.left,i.clk_y=t.pageY-o.top}else i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function a(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}var n={};n.fileapi=void 0!==e("<input type='file'/>").get(0).files,n.formdata=void 0!==window.FormData;var i=!!e.fn.prop;e.fn.attr2=function(){if(!i)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||"string"==typeof e?e:this.attr.apply(this,arguments)},e.fn.ajaxSubmit=function(t){function r(r){var a,n,i=e.param(r,t.traditional).split("&"),o=i.length,s=[];for(a=0;o>a;a++)i[a]=i[a].replace(/\+/g," "),n=i[a].split("="),s.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])]);return s}function o(a){for(var n=new FormData,i=0;i<a.length;i++)n.append(a[i].name,a[i].value);if(t.extraData){var o=r(t.extraData);for(i=0;i<o.length;i++)o[i]&&n.append(o[i][0],o[i][1])}t.data=null;var s=e.extend(!0,{},e.ajaxSettings,t,{contentType:!1,processData:!1,cache:!1,type:u||"POST"});t.uploadProgress&&(s.xhr=function(){var r=e.ajaxSettings.xhr();return r.upload&&r.upload.addEventListener("progress",function(e){var r=0,a=e.loaded||e.position,n=e.total;e.lengthComputable&&(r=Math.ceil(a/n*100)),t.uploadProgress(e,a,n,r)},!1),r}),s.data=null;var c=s.beforeSend;return s.beforeSend=function(e,r){r.data=t.formData?t.formData:n,c&&c.call(this,e,r)},e.ajax(s)}function s(r){function n(e){var t=null;try{e.contentWindow&&(t=e.contentWindow.document)}catch(r){a("cannot get iframe.contentWindow document: "+r)}if(t)return t;try{t=e.contentDocument?e.contentDocument:e.document}catch(r){a("cannot get iframe.contentDocument: "+r),t=e.document}return t}function o(){function t(){try{var e=n(g).readyState;a("state = "+e),e&&"uninitialized"==e.toLowerCase()&&setTimeout(t,50)}catch(r){a("Server abort: ",r," (",r.name,")"),s(k),j&&clearTimeout(j),j=void 0}}var r=f.attr2("target"),i=f.attr2("action"),o="multipart/form-data",c=f.attr("enctype")||f.attr("encoding")||o;w.setAttribute("target",p),(!u||/post/i.test(u))&&w.setAttribute("method","POST"),i!=m.url&&w.setAttribute("action",m.url),m.skipEncodingOverride||u&&!/post/i.test(u)||f.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),m.timeout&&(j=setTimeout(function(){T=!0,s(D)},m.timeout));var l=[];try{if(m.extraData)for(var d in m.extraData)m.extraData.hasOwnProperty(d)&&l.push(e.isPlainObject(m.extraData[d])&&m.extraData[d].hasOwnProperty("name")&&m.extraData[d].hasOwnProperty("value")?e('<input type="hidden" name="'+m.extraData[d].name+'">').val(m.extraData[d].value).appendTo(w)[0]:e('<input type="hidden" name="'+d+'">').val(m.extraData[d]).appendTo(w)[0]);m.iframeTarget||v.appendTo("body"),g.attachEvent?g.attachEvent("onload",s):g.addEventListener("load",s,!1),setTimeout(t,15);try{w.submit()}catch(h){var x=document.createElement("form").submit;x.apply(w)}}finally{w.setAttribute("action",i),w.setAttribute("enctype",c),r?w.setAttribute("target",r):f.removeAttr("target"),e(l).remove()}}function s(t){if(!x.aborted&&!F){if(M=n(g),M||(a("cannot access response document"),t=k),t===D&&x)return x.abort("timeout"),void S.reject(x,"timeout");if(t==k&&x)return x.abort("server abort"),void S.reject(x,"error","server abort");if(M&&M.location.href!=m.iframeSrc||T){g.detachEvent?g.detachEvent("onload",s):g.removeEventListener("load",s,!1);var r,i="success";try{if(T)throw"timeout";var o="xml"==m.dataType||M.XMLDocument||e.isXMLDoc(M);if(a("isXml="+o),!o&&window.opera&&(null===M.body||!M.body.innerHTML)&&--O)return a("requeing onLoad callback, DOM not available"),void setTimeout(s,250);var u=M.body?M.body:M.documentElement;x.responseText=u?u.innerHTML:null,x.responseXML=M.XMLDocument?M.XMLDocument:M,o&&(m.dataType="xml"),x.getResponseHeader=function(e){var t={"content-type":m.dataType};return t[e.toLowerCase()]},u&&(x.status=Number(u.getAttribute("status"))||x.status,x.statusText=u.getAttribute("statusText")||x.statusText);var c=(m.dataType||"").toLowerCase(),l=/(json|script|text)/.test(c);if(l||m.textarea){var f=M.getElementsByTagName("textarea")[0];if(f)x.responseText=f.value,x.status=Number(f.getAttribute("status"))||x.status,x.statusText=f.getAttribute("statusText")||x.statusText;else if(l){var p=M.getElementsByTagName("pre")[0],h=M.getElementsByTagName("body")[0];p?x.responseText=p.textContent?p.textContent:p.innerText:h&&(x.responseText=h.textContent?h.textContent:h.innerText)}}else"xml"==c&&!x.responseXML&&x.responseText&&(x.responseXML=X(x.responseText));try{E=_(x,c,m)}catch(y){i="parsererror",x.error=r=y||i}}catch(y){a("error caught: ",y),i="error",x.error=r=y||i}x.aborted&&(a("upload aborted"),i=null),x.status&&(i=x.status>=200&&x.status<300||304===x.status?"success":"error"),"success"===i?(m.success&&m.success.call(m.context,E,"success",x),S.resolve(x.responseText,"success",x),d&&e.event.trigger("ajaxSuccess",[x,m])):i&&(void 0===r&&(r=x.statusText),m.error&&m.error.call(m.context,x,i,r),S.reject(x,"error",r),d&&e.event.trigger("ajaxError",[x,m,r])),d&&e.event.trigger("ajaxComplete",[x,m]),d&&!--e.active&&e.event.trigger("ajaxStop"),m.complete&&m.complete.call(m.context,x,i),F=!0,m.timeout&&clearTimeout(j),setTimeout(function(){m.iframeTarget?v.attr("src",m.iframeSrc):v.remove(),x.responseXML=null},100)}}}var c,l,m,d,p,v,g,x,y,b,T,j,w=f[0],S=e.Deferred();if(S.abort=function(e){x.abort(e)},r)for(l=0;l<h.length;l++)c=e(h[l]),i?c.prop("disabled",!1):c.removeAttr("disabled");if(m=e.extend(!0,{},e.ajaxSettings,t),m.context=m.context||m,p="jqFormIO"+(new Date).getTime(),m.iframeTarget?(v=e(m.iframeTarget),b=v.attr2("name"),b?p=b:v.attr2("name",p)):(v=e('<iframe name="'+p+'" src="'+m.iframeSrc+'" />'),v.css({position:"absolute",top:"-1000px",left:"-1000px"})),g=v[0],x={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var r="timeout"===t?"timeout":"aborted";a("aborting upload... "+r),this.aborted=1;try{g.contentWindow.document.execCommand&&g.contentWindow.document.execCommand("Stop")}catch(n){}v.attr("src",m.iframeSrc),x.error=r,m.error&&m.error.call(m.context,x,r,t),d&&e.event.trigger("ajaxError",[x,m,r]),m.complete&&m.complete.call(m.context,x,r)}},d=m.global,d&&0===e.active++&&e.event.trigger("ajaxStart"),d&&e.event.trigger("ajaxSend",[x,m]),m.beforeSend&&m.beforeSend.call(m.context,x,m)===!1)return m.global&&e.active--,S.reject(),S;if(x.aborted)return S.reject(),S;y=w.clk,y&&(b=y.name,b&&!y.disabled&&(m.extraData=m.extraData||{},m.extraData[b]=y.value,"image"==y.type&&(m.extraData[b+".x"]=w.clk_x,m.extraData[b+".y"]=w.clk_y)));var D=1,k=2,A=e("meta[name=csrf-token]").attr("content"),L=e("meta[name=csrf-param]").attr("content");L&&A&&(m.extraData=m.extraData||{},m.extraData[L]=A),m.forceSync?o():setTimeout(o,10);var E,M,F,O=50,X=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},C=e.parseJSON||function(e){return window.eval("("+e+")")},_=function(t,r,a){var n=t.getResponseHeader("content-type")||"",i="xml"===r||!r&&n.indexOf("xml")>=0,o=i?t.responseXML:t.responseText;return i&&"parsererror"===o.documentElement.nodeName&&e.error&&e.error("parsererror"),a&&a.dataFilter&&(o=a.dataFilter(o,r)),"string"==typeof o&&("json"===r||!r&&n.indexOf("json")>=0?o=C(o):("script"===r||!r&&n.indexOf("javascript")>=0)&&e.globalEval(o)),o};return S}if(!this.length)return a("ajaxSubmit: skipping submit process - no element selected"),this;var u,c,l,f=this;"function"==typeof t?t={success:t}:void 0===t&&(t={}),u=t.type||this.attr2("method"),c=t.url||this.attr2("action"),l="string"==typeof c?e.trim(c):"",l=l||window.location.href||"",l&&(l=(l.match(/^([^#]+)/)||[])[1]),t=e.extend(!0,{url:l,success:e.ajaxSettings.success,type:u||e.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},t);var m={};if(this.trigger("form-pre-serialize",[this,t,m]),m.veto)return a("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(t.beforeSerialize&&t.beforeSerialize(this,t)===!1)return a("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var d=t.traditional;void 0===d&&(d=e.ajaxSettings.traditional);var p,h=[],v=this.formToArray(t.semantic,h);if(t.data&&(t.extraData=t.data,p=e.param(t.data,d)),t.beforeSubmit&&t.beforeSubmit(v,this,t)===!1)return a("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[v,this,t,m]),m.veto)return a("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var g=e.param(v,d);p&&(g=g?g+"&"+p:p),"GET"==t.type.toUpperCase()?(t.url+=(t.url.indexOf("?")>=0?"&":"?")+g,t.data=null):t.data=g;var x=[];if(t.resetForm&&x.push(function(){f.resetForm()}),t.clearForm&&x.push(function(){f.clearForm(t.includeHidden)}),!t.dataType&&t.target){var y=t.success||function(){};x.push(function(r){var a=t.replaceTarget?"replaceWith":"html";e(t.target)[a](r).each(y,arguments)})}else t.success&&x.push(t.success);if(t.success=function(e,r,a){for(var n=t.context||this,i=0,o=x.length;o>i;i++)x[i].apply(n,[e,r,a||f,f])},t.error){var b=t.error;t.error=function(e,r,a){var n=t.context||this;b.apply(n,[e,r,a,f])}}if(t.complete){var T=t.complete;t.complete=function(e,r){var a=t.context||this;T.apply(a,[e,r,f])}}var j=e("input[type=file]:enabled",this).filter(function(){return""!==e(this).val()}),w=j.length>0,S="multipart/form-data",D=f.attr("enctype")==S||f.attr("encoding")==S,k=n.fileapi&&n.formdata;a("fileAPI :"+k);var A,L=(w||D)&&!k;t.iframe!==!1&&(t.iframe||L)?t.closeKeepAlive?e.get(t.closeKeepAlive,function(){A=s(v)}):A=s(v):A=(w||D)&&k?o(v):e.ajax(t),f.removeData("jqxhr").data("jqxhr",A);for(var E=0;E<h.length;E++)h[E]=null;return this.trigger("form-submit-notify",[this,t]),this},e.fn.ajaxForm=function(n){if(n=n||{},n.delegation=n.delegation&&e.isFunction(e.fn.on),!n.delegation&&0===this.length){var i={s:this.selector,c:this.context};return!e.isReady&&i.s?(a("DOM not ready, queuing ajaxForm"),e(function(){e(i.s,i.c).ajaxForm(n)}),this):(a("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return n.delegation?(e(document).off("submit.form-plugin",this.selector,t).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,n,t).on("click.form-plugin",this.selector,n,r),this):this.ajaxFormUnbind().bind("submit.form-plugin",n,t).bind("click.form-plugin",n,r)},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t,r){var a=[];if(0===this.length)return a;var i,o=this[0],s=this.attr("id"),u=t?o.getElementsByTagName("*"):o.elements;if(u&&!/MSIE [678]/.test(navigator.userAgent)&&(u=e(u).get()),s&&(i=e(':input[form="'+s+'"]').get(),i.length&&(u=(u||[]).concat(i))),!u||!u.length)return a;var c,l,f,m,d,p,h;for(c=0,p=u.length;p>c;c++)if(d=u[c],f=d.name,f&&!d.disabled)if(t&&o.clk&&"image"==d.type)o.clk==d&&(a.push({name:f,value:e(d).val(),type:d.type}),a.push({name:f+".x",value:o.clk_x},{name:f+".y",value:o.clk_y}));else if(m=e.fieldValue(d,!0),m&&m.constructor==Array)for(r&&r.push(d),l=0,h=m.length;h>l;l++)a.push({name:f,value:m[l]});else if(n.fileapi&&"file"==d.type){r&&r.push(d);var v=d.files;if(v.length)for(l=0;l<v.length;l++)a.push({name:f,value:v[l],type:d.type});else a.push({name:f,value:"",type:d.type})}else null!==m&&"undefined"!=typeof m&&(r&&r.push(d),a.push({name:f,value:m,type:d.type,required:d.required}));if(!t&&o.clk){var g=e(o.clk),x=g[0];f=x.name,f&&!x.disabled&&"image"==x.type&&(a.push({name:f,value:g.val()}),a.push({name:f+".x",value:o.clk_x},{name:f+".y",value:o.clk_y}))}return a},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var r=[];return this.each(function(){var a=this.name;if(a){var n=e.fieldValue(this,t);if(n&&n.constructor==Array)for(var i=0,o=n.length;o>i;i++)r.push({name:a,value:n[i]});else null!==n&&"undefined"!=typeof n&&r.push({name:this.name,value:n})}}),e.param(r)},e.fn.fieldValue=function(t){for(var r=[],a=0,n=this.length;n>a;a++){var i=this[a],o=e.fieldValue(i,t);null===o||"undefined"==typeof o||o.constructor==Array&&!o.length||(o.constructor==Array?e.merge(r,o):r.push(o))}return r},e.fieldValue=function(t,r){var a=t.name,n=t.type,i=t.tagName.toLowerCase();if(void 0===r&&(r=!0),r&&(!a||t.disabled||"reset"==n||"button"==n||("checkbox"==n||"radio"==n)&&!t.checked||("submit"==n||"image"==n)&&t.form&&t.form.clk!=t||"select"==i&&-1==t.selectedIndex))return null;if("select"==i){var o=t.selectedIndex;if(0>o)return null;for(var s=[],u=t.options,c="select-one"==n,l=c?o+1:u.length,f=c?o:0;l>f;f++){var m=u[f];if(m.selected){var d=m.value;if(d||(d=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),c)return d;s.push(d)}}return s}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var r=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var a=this.type,n=this.tagName.toLowerCase();r.test(a)||"textarea"==n?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==n?this.selectedIndex=-1:"file"==a?/MSIE/.test(navigator.userAgent)?e(this).replaceWith(e(this).clone(!0)):e(this).val(""):t&&(t===!0&&/hidden/.test(a)||"string"==typeof t&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var r=this.type;if("checkbox"==r||"radio"==r)this.checked=t;else if("option"==this.tagName.toLowerCase()){var a=e(this).parent("select");t&&a[0]&&"select-one"==a[0].type&&a.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1});
/*!
 * hoverIntent v1.8.1 // 2014.08.11 // jQuery v1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
 
/* hoverIntent is similar to jQuery's built-in "hover" method except that
 * instead of firing the handlerIn function immediately, hoverIntent checks
 * to see if the user's mouse has slowed down (beneath the sensitivity
 * threshold) before firing the event. The handlerOut function is only
 * called after a matching handlerIn.
 *
 * // basic usage ... just like .hover()
 * .hoverIntent( handlerIn, handlerOut )
 * .hoverIntent( handlerInOut )
 *
 * // basic usage ... with event delegation!
 * .hoverIntent( handlerIn, handlerOut, selector )
 * .hoverIntent( handlerInOut, selector )
 *
 * // using a basic configuration object
 * .hoverIntent( config )
 *
 * @param  handlerIn   function OR configuration object
 * @param  handlerOut  function OR selector for delegation OR undefined
 * @param  selector    selector OR undefined
 * @author Brian Cherne <brian(at)cherne(dot)net>
 */
(function($) {
    $.fn.hoverIntent = function(handlerIn,handlerOut,selector) {

        // default configuration values
        var cfg = {
            interval: 100,
            sensitivity: 6,
            timeout: 0
        };

        if ( typeof handlerIn === "object" ) {
            cfg = $.extend(cfg, handlerIn );
        } else if ($.isFunction(handlerOut)) {
            cfg = $.extend(cfg, { over: handlerIn, out: handlerOut, selector: selector } );
        } else {
            cfg = $.extend(cfg, { over: handlerIn, out: handlerIn, selector: handlerOut } );
        }

        // instantiate variables
        // cX, cY = current X and Y position of mouse, updated by mousemove event
        // pX, pY = previous X and Y position of mouse, set by mouseover and polling interval
        var cX, cY, pX, pY;

        // A private function for getting mouse position
        var track = function(ev) {
            cX = ev.pageX;
            cY = ev.pageY;
        };

        // A private function for comparing current and previous mouse position
        var compare = function(ev,ob) {
            ob.hoverIntent_t = clearTimeout(ob.hoverIntent_t);
            // compare mouse positions to see if they've crossed the threshold
            if ( Math.sqrt( (pX-cX)*(pX-cX) + (pY-cY)*(pY-cY) ) < cfg.sensitivity ) {
                $(ob).off("mousemove.hoverIntent",track);
                // set hoverIntent state to true (so mouseOut can be called)
                ob.hoverIntent_s = true;
                return cfg.over.apply(ob,[ev]);
            } else {
                // set previous coordinates for next time
                pX = cX; pY = cY;
                // use self-calling timeout, guarantees intervals are spaced out properly (avoids JavaScript timer bugs)
                ob.hoverIntent_t = setTimeout( function(){compare(ev, ob);} , cfg.interval );
            }
        };

        // A private function for delaying the mouseOut function
        var delay = function(ev,ob) {
            ob.hoverIntent_t = clearTimeout(ob.hoverIntent_t);
            ob.hoverIntent_s = false;
            return cfg.out.apply(ob,[ev]);
        };

        // A private function for handling mouse 'hovering'
        var handleHover = function(e) {
            // copy objects to be passed into t (required for event object to be passed in IE)
            var ev = $.extend({},e);
            var ob = this;

            // cancel hoverIntent timer if it exists
            if (ob.hoverIntent_t) { ob.hoverIntent_t = clearTimeout(ob.hoverIntent_t); }

            // if e.type === "mouseenter"
            if (e.type === "mouseenter") {
                // set "previous" X and Y position based on initial entry point
                pX = ev.pageX; pY = ev.pageY;
                // update "current" X and Y position based on mousemove
                $(ob).on("mousemove.hoverIntent",track);
                // start polling interval (self-calling timeout) to compare mouse coordinates over time
                if (!ob.hoverIntent_s) { ob.hoverIntent_t = setTimeout( function(){compare(ev,ob);} , cfg.interval );}

                // else e.type == "mouseleave"
            } else {
                // unbind expensive mousemove event
                $(ob).off("mousemove.hoverIntent",track);
                // if hoverIntent state is true, then call the mouseOut function after the specified delay
                if (ob.hoverIntent_s) { ob.hoverIntent_t = setTimeout( function(){delay(ev,ob);} , cfg.timeout );}
            }
        };

        // listen for mouseenter and mouseleave
        return this.on({'mouseenter.hoverIntent':handleHover,'mouseleave.hoverIntent':handleHover}, cfg.selector);
    };
})(jQuery);
/* jQuery Password Strength Plugin (pstrength) - A jQuery plugin to provide accessibility functions
 * Author: Tane Piper (digitalspaghetti@gmail.com)
 * Website: http://digitalspaghetti.me.uk
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
 * This code uses a modified version of Steve Moitozo's algorithm (http://www.geekwisdom.com/dyn/passwdmeter)
 *
 * === Changelog ===
 * Version 1.2 (03/09/2007)
 * Added more options for colors and common words
 * Added common words checked to see if words like 'password' or 'qwerty' are being entered
 * Added minimum characters required for password
 * Re-worked scoring system to give better results
 *
 * Version 1.1 (20/08/2007)
 * Changed code to be more jQuery-like
 *
 * Version 1.0 (20/07/2007)
 * Initial version.
 */
(function($){
	$.extend($.fn, {
		pstrength : function(options) {
			var options = $.extend({
				verdicts:	["Too Short!","Very Weak","Weak","Medium","Strong","Very Strong"],
				colors: 	["#ccc","#f00","#c06","#f60","#3c0","#3f0"],
				values: 	[20,30,40,60,80,100],
				scores: 	[10,15,30,40],
				minchar:	6,
				minCharText: "Minimum length is %d characters"
			},options);
			return this.each(function(){
				var infoarea = $(this).attr('id');


				$(this).after('<div id="' + infoarea + '_bar" class="progress" style="display: none;"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"><span  id="' + infoarea + '_text">0%<span></div></div>');

				if(options.minchar>0){
					$(this).after('<div class="help-block" id="' + infoarea + '_minchar">' + options.minCharText.replace('%d', options.minchar) + '</div>');
				}


				options.$ctlBar = $("#" + infoarea + "_bar .progress-bar");
	    		options.$ctlText = $("#" + infoarea + "_text");

				$(this).keyup(function(){
					if(options.minchar <= $(this).val().length && $("#"+infoarea + '_bar:hidden')){
						$("#"+infoarea + '_bar').show()
					}

					$.fn.runPassword($(this).val(), infoarea, options);
				});
			});
		},
		runPassword : function (password, infoarea, options){

			nPerc = $.fn.checkPassword(password, options);
	    	var statusNum;

			if (nPerc < 0){
				statusNum=0
			}
			else if(nPerc <= options.scores[0]){
				statusNum=1
			}
			else if (nPerc > options.scores[0] && nPerc <= options.scores[1]){
				statusNum=2
			}
			else if (nPerc > options.scores[1] && nPerc <= options.scores[2]){
				statusNum=3
			}
			else if (nPerc > options.scores[2] && nPerc <= options.scores[3]){
				statusNum=4
			}
			else{
				statusNum=5
			}


			options.$ctlBar.css({width: options.values[statusNum]+"%"});
			options.$ctlBar.attr("aria-valuenow",options.values[statusNum]);
			options.$ctlBar.css({backgroundColor: options.colors[statusNum]});
			options.$ctlText.html(options.verdicts[statusNum]);

		},
		checkPassword : function(password, options)
		{
			var intScore = 0;
			var strVerdict = options.verdicts[0];
			
			if (password.length  < options.minchar){
				intScore = (intScore-100)
			}
			else if (password.length >options.minchar+1 && password.length <options.minchar+3){
				intScore = (intScore+6)
			}
			else if (password.length >options.minchar+2 && password.length <options.minchar+4){
				intScore = (intScore+12)
			}
			else if (password.length >options.minchar*2){
				intScore = (intScore+18)
			}

			if (password.match(/[a-z]/)){
				intScore = (intScore+1)
			}

			if (password.match(/[A-Z]/)){
				intScore = (intScore+5)
			}

			if (password.match(/\d+/)){
				intScore = (intScore+5)
			}

			if (password.match(/(.*[0-9].*[0-9].*[0-9])/)){
				intScore = (intScore+5)
			}

			if (password.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)){
				intScore = (intScore+5)
			}

			if (password.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){
				intScore = (intScore+5)
			}

			if (password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){
				intScore = (intScore+2)
			}

			if (password.match(/([a-zA-Z])/) && password.match(/([0-9])/)){
				intScore = (intScore+2)
			}

			if (password.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)){
				intScore = (intScore+2)
			}

			return intScore;

		}
	});
})(jQuery);
/**
 * syncHeight - jQuery plugin to automagically Sync the heights of columns
 * Made to seemlessly work with the CCS-Framework YAML (yaml.de)
 * @requires jQuery v1.0.3 or newer
 *
 * http://blog.ginader.de/dev/syncheight/
 *
 * Copyright (c) 2007-2013
 * Dirk Ginader (ginader.de)
 * Dirk Jesse (yaml.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * Version: 1.5
 *
 * Changelog
 * * v1.5 fixes issue with box-sizing: border-box
 * * v1.4: new Method unSyncHeight() that removes previously added syncs i.e. for responsive layouts
 * * v1.3: compatibility fix for jQuery 1.9.x (removed $.browser)
 *
 * Usage sync:
	$(window).load(function(){
		$('p').syncHeight();
	});
 * Usage unsync: 
	$(window).resize(function(){
		if($(window).width() < 500){
			$('p').unSyncHeight();
		}
	});
 */

(function($) {
	var getHeightProperty = function() {
		var browser_id = 0;
		var property = [
			// To avoid content overflow in synchronised boxes on font scaling, we
			// use 'min-height' property for modern browsers ...
			['min-height','0px'],
			// and 'height' property for Internet Explorer.
			['height','1%']
		];

		var bMatch = /(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase()) || [],
			browser = bMatch[1] || "",
			browserVersion = bMatch[2] || "0";

		// check for IE6 ...
		if(browser === 'msie' && browserVersion < 7){
			browser_id = 1;
		}

		return {
			'name': property[browser_id][0],
			'autoheightVal': property[browser_id][1]
		};
	};

	$.getSyncedHeight = function(selector) {
		var max = 0;
		var heightProperty = getHeightProperty();
		// get maximum element height ...
		$(selector).each(function() {
			// fallback to auto height before height check ...
			$(this).css(heightProperty.name, heightProperty.autoheightVal);
			var val = parseInt($(this).css('height'),10);
			if(val > max){
				max = val;
			}
		});
		return max;
	};

	$.fn.syncHeight = function(config) {
		var defaults = {
			updateOnResize: false,  // re-sync element heights after a browser resize event (useful in flexible layouts)
			height: false
		};

		var options = $.extend(defaults, config);
		var e = this;
		var max = 0;
		var heightPropertyName = getHeightProperty().name;


		if(options.parent==true){

			$(this).each(function() {
				$(this).css(heightPropertyName, 0+'px');
			});

			$(this).each(function() {
				$(this).css(heightPropertyName, $(this).parent().innerHeight()+'px');
			});
		}else{

			 if(typeof(options.height) === "number") {
				max = options.height;
			} else {
				max = $.getSyncedHeight(this);
			}


			 // set synchronized element height ...
			$(this).each(function() {
				$(this).css(heightPropertyName, max+'px');
			});
		}
	 

		// optional sync refresh on resize event ...
		if (options.updateOnResize === true) {
			$(window).bind('resize.syncHeight', function(){
				options["updateOnResize"]=false;
				$(e).syncHeight(options);
			});
		}
		return this;
	};

	$.fn.unSyncHeight = function() {
		// unbind optional resize event ...
		$(window).unbind('resize.syncHeight');

		var heightPropertyName = getHeightProperty().name;
		$(this).each(function() {
			$(this).css(heightPropertyName, '');
		});
	};
})(jQuery);

/**
 * Accessible Tabs - jQuery plugin for accessible, unobtrusive tabs
 * Build to seemlessly work with the CCS-Framework YAML (yaml.de) not depending on YAML though
 * @requires jQuery - tested with 1.9.1, 1.7 and 1.4.2 but might as well work with older versions
 *
 * english article: http://blog.ginader.de/archives/2009/02/07/jQuery-Accessible-Tabs-How-to-make-tabs-REALLY-accessible.php
 * german article: http://blog.ginader.de/archives/2009/02/07/jQuery-Accessible-Tabs-Wie-man-Tabs-WIRKLICH-zugaenglich-macht.php
 * 
 * code: http://github.com/ginader/Accessible-Tabs
 * please report issues at: http://github.com/ginader/Accessible-Tabs/issues
 *
 * Copyright (c) 2007 Dirk Ginader (ginader.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */

(function($) {
	var debugMode = false;
	$.fn.extend({
		// We assume there could be multiple sets of tabs on a page, so,
		// the unique id for each invididual tab's heading is identified with params q and r (e.g., id="accessibletabscontent0-2")
		getUniqueId: function(p, q, r){
			if (r===undefined) {r='';} else {r='-'+r;}
			return p + q + r;
		},
		accessibleTabs: function(config) {
			var defaults = {
				wrapperClass: 'content', // Classname to apply to the div that is wrapped around the original Markup
				currentClass: 'current', // Classname to apply to the LI of the selected Tab
				tabhead: 'h4', // Tag or valid Query Selector of the Elements to Transform the Tabs-Navigation from (originals are removed)
				tabheadClass: 'tabhead', // Classname to apply to the target heading element for each tab div
				tabbody: '.tabbody', // Tag or valid Query Selector of the Elements to be treated as the Tab Body
				fx:'show', // can be "fadeIn", "slideDown", "show"
				fxspeed: 'normal', // speed (String|Number): "slow", "normal", or "fast") or the number of milliseconds to run the animation
				currentInfoText: 'current tab: ', // text to indicate for screenreaders which tab is the current one
				currentInfoPosition: 'prepend', // Definition where to insert the Info Text. Can be either "prepend" or "append"
				currentInfoClass: 'current-info', // Class to apply to the span wrapping the CurrentInfoText
				tabsListClass:'tabs-list', // Class to apply to the generated list of tabs above the content
				syncheights:false, // syncs the heights of the tab contents when the SyncHeight plugin is available http://blog.ginader.de/dev/jquery/syncheight/index.php
				syncHeightMethodName:'syncHeight', // set the Method name of the plugin you want to use to sync the tab contents. Defaults to the SyncHeight plugin: http://github.com/ginader/syncHeight
				cssClassAvailable:false, // Enable individual css classes for tabs. Gets the appropriate class name of a tabhead element and apply it to the tab list element. Boolean value
				saveState:false, // save the selected tab into a cookie so it stays selected after a reload. This requires that the wrapping div needs to have an ID (so we know which tab we're saving)
				autoAnchor:false, // will move over any existing id of a headline in tabs markup so it can be linked to it
				pagination:false, // adds buttons to each tab to switch to the next/previous tab
				position:'top', // can be 'top' or 'bottom'. Defines where the tabs list is inserted.
				wrapInnerNavLinks: '', // inner wrap for a-tags in tab navigation. See http://api.jquery.com/wrapInner/ for further informations
				firstNavItemClass: 'first', // Classname of the first list item in the tab navigation
				lastNavItemClass: 'last', // Classname of the last list item in the tab navigation
				clearfixClass: 'clearfix' // Name of the Class that is used to clear/contain floats
			};
			var keyCodes = {
				37 : -1, //LEFT
				38 : -1, //UP
				39 : +1, //RIGHT 
				40 : +1 //DOWN
			};
			var positions = {
				top : 'prepend',
				bottom : 'append'
			};
			this.options = $.extend(defaults, config);

			var tabsCount = 0;
			if($("body").data('accessibleTabsCount') !== undefined){
				tabsCount = $("body").data('accessibleTabsCount');
			}
			$("body").data('accessibleTabsCount',this.size()+tabsCount);

			var o = this;
			return this.each(function(t) {
				var el = $(this);
				var list = '';
				var tabCount = 0;
				var ids = [];

				$(el).wrapInner('<div class="'+o.options.wrapperClass+'"></div>');
				debug($(el).find(o.options.tabhead).children("a"))

				$(el).find(o.options.tabhead).each(function(i){

					debug($(this))
					var id = '';
					var elId = $(this).attr('id');
					if(elId){
						// Skip this item if it already exists.
						if(elId.indexOf('accessibletabscontent') === 0) {
							return;
						}
						id =' id="'+elId+'"';
					}
					var tabId = o.getUniqueId('accessibletabscontent', tabsCount+t, i);//get a unique id to assign to this tab's heading
					var navItemId = o.getUniqueId('accessibletabsnavigation', tabsCount+t, i);//get a unique id for this navigation item
					ids.push(tabId);
					

					// SNK: support tab head with links
					var navItemText = ($(this).children("a").length>0)? $(this).children("a").html() :$(this).html() ;


					var ariaLabel="";

					if($(this).attr("aria-label")){
						ariaLabel='aria-label="'+$(this).attr("aria-label")+'"'
					}


					if(o.options.cssClassAvailable === true) {
						var cssClass = '';
						if($(this).attr('class')) {
							cssClass = $(this).attr('class');
							cssClass = ' class="'+cssClass+'"';
						}
						list += '<li id="'+navItemId+'"><a'+id+''+cssClass+' href="#'+tabId+'" '+ariaLabel+'>'+navItemText+'</a></li>';
					} else {
					  list += '<li id="'+navItemId+'"><a'+id+' href="#'+tabId+'" '+ariaLabel+'>'+navItemText+'</a></li>';
					}


					$(this).attr({"id": tabId, "class": o.options.tabheadClass, "tabindex": "-1"});//assign the unique id and the tabheadClass class name to this tab's heading
					tabCount++;
				});

				if (o.options.syncheights && $.fn[o.options.syncHeightMethodName]) {
					$(el).find(o.options.tabbody)[o.options.syncHeightMethodName]();
					$(window).resize(function(){
						$(el).find(o.options.tabbody)[o.options.syncHeightMethodName]();
					});
				}

				// Ensure that the call to setup tabs is re-runnable
				var tabs_selector = '.' + o.options.tabsListClass;
				if(!$(el).find(tabs_selector).length) {
					$(el)[positions[o.options.position]]('<ul class="'+o.options.clearfixClass+' '+o.options.tabsListClass+' tabamount'+tabCount+'"></ul>');
				}

				$(el).find(tabs_selector).append(list);

				// initial show first content block and hide the others
				var content = $(el).find(o.options.tabbody);
				if (content.length > 0) {
					$(content).hide();
					$(content[0]).show();
				}
				$(el).find("ul."+o.options.tabsListClass+">li:first").addClass(o.options.currentClass).addClass(o.options.firstNavItemClass)
				  .find('a')[o.options.currentInfoPosition]('<span class="'+o.options.currentInfoClass+'">'+o.options.currentInfoText+'</span>')
				  .parents("ul."+o.options.tabsListClass).children('li:last').addClass(o.options.lastNavItemClass);


				// SNK: add first and last class to tabhead

				var tabheads = $(el).find(o.options.tabhead);
				if (tabheads.length > 0) {
					$(tabheads[0]).addClass(o.options.currentClass).addClass(o.options.firstNavItemClass);
					$(tabheads).find('a').attr('aria-expanded', false);
					$(tabheads[0]).find('a').attr('aria-expanded', true);
					$(tabheads[tabheads.length-1]).addClass(o.options.lastNavItemClass);
					
				}





				if (o.options.wrapInnerNavLinks) {
				  $(el).find('ul.'+o.options.tabsListClass+'>li>a').wrapInner(o.options.wrapInnerNavLinks);
				}

				$(el).find('ul.'+o.options.tabsListClass+'>li>a').each(function(i){
					$(this).click(function(event){
						event.preventDefault();
						el.trigger("showTab.accessibleTabs", [$(event.target)]);
						if(o.options.saveState && $.cookie){
							$.cookie('accessibletab_'+el.attr('id')+'_active',i);
						}
						
						$(el).find('ul.'+o.options.tabsListClass+'>li.'+o.options.currentClass).removeClass(o.options.currentClass)
						.find("span."+o.options.currentInfoClass).remove();
						
						

						// SNK: remove current class from tabhead
						$(el).find(o.options.tabhead).removeClass(o.options.currentClass);
						$(el).find(o.options.tabhead).find('a').attr('aria-expanded', false);
						


						$(this).blur();
						$(el).find(o.options.tabbody+':visible').hide();
						$(el).find(o.options.tabbody).eq(i)[o.options.fx](o.options.fxspeed);
						$(this)[o.options.currentInfoPosition]('<span class="'+o.options.currentInfoClass+'">'+o.options.currentInfoText+'</span>')
						.parent().addClass(o.options.currentClass);


						// SNK: add active class to current tabhead
						$($(this).attr("href")).addClass(o.options.currentClass);
						$($(this).attr("href")).find('a').attr('aria-expanded', true);

						//Footer alignment on each tab change - registration
						ACC.global.footerAlignment();

						//now, only after writing the currentInfoText span to the tab list link, set focus to the tab's heading

						$($(this).attr("href")).focus().keyup(function(event){
							if(keyCodes[event.keyCode]){
								o.showAccessibleTab(i+keyCodes[event.keyCode]);
								$(this).unbind( "keyup" );
							}
						});

						// $(el).find('.accessibletabsanchor').keyup(function(event){
						//     if(keyCodes[event.keyCode]){
						//         o.showAccessibleTab(i+keyCodes[event.keyCode]);
						//     }
						// });
					});

					$(this).focus(function(){
						$(document).keyup(function(event){
							if(keyCodes[event.keyCode]){
								o.showAccessibleTab(i+keyCodes[event.keyCode]);
							}
						});
					});
					$(this).blur(function(){
						$(document).unbind( "keyup" );
					});

				});

				if(o.options.saveState && $.cookie){
					var savedState = $.cookie('accessibletab_'+el.attr('id')+'_active');
					debug($.cookie('accessibletab_'+el.attr('id')+'_active'));
					if(savedState !== null){
						o.showAccessibleTab(savedState,el.attr('id'));
					}
				}

				if(o.options.autoAnchor && window.location.hash){
					var anchorTab = $('.'+o.options.tabsListClass).find(window.location.hash);
					if(anchorTab.size()){
						anchorTab.click();
					}
				}

				if(o.options.pagination){
					var m = '<ul class="pagination">';
					m +='    <li class="previous"><a href="#{previousAnchor}"><span>{previousHeadline}</span></a></li>';
					m +='    <li class="next"><a href="#{nextAnchor}"><span>{nextHeadline}</span></a></li>';
					m +='</ul>';
					var tabs = $(el).find('.tabbody');
					var tabcount = tabs.size();
					tabs.each(function(idx){
						$(this).append(m);
						var next = idx+1;
						if(next>=tabcount){next = 0;}
						var previous = idx-1;
						if(previous<0){previous = tabcount-1;}
						var p = $(this).find('.pagination');
						var previousEl = p.find('.previous');
						previousEl.find('span').text($('#'+ids[previous]).text());
						previousEl.find('a').attr('href','#'+ids[previous])
						.click(function(event){
							event.preventDefault();
							$(el).find('.tabs-list a').eq(previous).click();
						});
						var nextEl = p.find('.next');
						nextEl.find('span').text($('#'+ids[next]).text());
						nextEl.find('a').attr('href','#'+ids[next])
						.click(function(event){
							event.preventDefault();
							$(el).find('.tabs-list a').eq(next).click();
						});
					});
				}
			});
		},
		showAccessibleTab: function(index,id){
			debug('showAccessibleTab');
			var o = this;
			if(id) {
				var el = $('#'+id);
				var links = el.find('ul.'+o.options.tabsListClass+'>li>a');
				el.trigger("showTab.accessibleTabs", [links.eq(index)]);
				links.eq(index).click();
			} else {
				return this.each(function() {
					var el = $(this);
					el.trigger("showTab.accessibleTabs");
					var links = el.find('ul.'+o.options.tabsListClass+'>li>a');
					el.trigger("showTab.accessibleTabs", [links.eq(index)]);
					links.eq(index).click();
				});
			}
		},
		showAccessibleTabSelector: function(selector){
			debug('showAccessibleTabSelector');
			var el = $(selector);
			if(el){
				if(el.get(0).nodeName.toLowerCase() === 'a'){
					el.click();
				}else{
					debug('the selector of a showAccessibleTabSelector() call needs to point to a tabs headline!');
				}
			}
		}
	});
	// private Methods
	function debug(msg,info){
		if(debugMode && window.console && window.console.log){
			if(info){
				window.console.log(info+': ',msg);
			}else{
				window.console.log(msg);
			}
		}
	}
})(jQuery);

/*! jQuery UI - v1.11.2 - 2015-01-04
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, resizable.js, selectable.js, sortable.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, menu.js, progressbar.js, selectmenu.js, slider.js, spinner.js, tabs.js, tooltip.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a="string"==typeof n,o=u.call(arguments,1),r=this;return n=!a&&o.length?e.widget.extend.apply(null,[n].concat(o)):n,a?this.each(function(){var i,a=e.data(this,s);return"instance"===n?(r=a,!1):a?e.isFunction(a[n])&&"_"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+n+"'")}):this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))}),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),t=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(n.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===n.at[0]?y.left+=m:"center"===n.at[0]&&(y.left+=m/2),"bottom"===n.at[1]?y.top+=g:"center"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,M=e.extend({},y),C=t(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?M.left-=d:"center"===n.my[0]&&(M.left-=d/2),"bottom"===n.my[1]?M.top-=c:"center"===n.my[1]&&(M.top-=c/2),M.left+=C[0],M.top+=C[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>m&&m>r(t+i)&&(h.horizontal="center"),c>g&&g>r(s+a)&&(h.vertical="middle"),h.important=o(r(t),r(i))>o(r(s),r(a))?"horizontal":"vertical",n.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,e.top+p+f+m>u&&(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,e.top+p+f+m>d&&(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}
},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return a>=l&&d>=r&&o>=u&&c>=h;case"intersect":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case"touch":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),a.length&&(s=e(a[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0?!0:(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,s+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,a=this.axis,o=t.pageX-n.left||0,r=t.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[t,o,r]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),a&&l&&(e.left=r-t.minWidth),s&&l&&(e.left=r-t.maxWidth),o&&u&&(e.top=h-t.minHeight),n&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(n[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,n,a,o,r,h=e(this).resizable("instance"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=h._num(t.css("padding"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(c,"left")?c.scrollWidth:a,r=h._hasScroll(c)?c.scrollHeight:n,h.parentData={element:c,left:s.left,top:s.top,width:o,height:r}))},resize:function(t){var i,s,n,a,o=e(this).resizable("instance"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,d={top:0,left:0},c=o.containerElement,p=!0;c[0]!==document&&/static/.test(c.css("position"))&&(d=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-d.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)})},resize:function(t,i){var s=e(this).resizable("instance"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0},h=function(t,s){e(t).each(function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),a={},o=s&&s.length?s:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var i=(n[t]||0)+(r[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):e.each(n.alsoResize,function(e,t){h(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((n.width-a.width)/l)*l,c=Math.round((n.height-a.height)/u)*u,p=a.width+d,f=a.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-c):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-c):(f=u-t.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-d):(p=u-t.height,i.size.width=p,i.position.left=o.left+a.width-p))}}),e.ui.resizable,e.widget("ui.selectable",e.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;
this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===s?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)}):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),s=t.next(),n=s.uniqueId().attr("id");
t.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(t=n.height(),this.element.siblings(":visible").each(function(){var i=e(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr("aria-selected","false"),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,i){var s,n,a,o=this,r=0,h=e.length&&(!t.length||e.index()<t.index()),l=this.options.animate||{},u=h&&l.down||l,d=function(){o._toggleComplete(i)};return"number"==typeof u&&(a=u),"string"==typeof u&&(n=u),n=n||u.easing||l.easing,a=a||u.duration||l.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:n,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:a,easing:n,complete:d,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?r+=i.now:"content"!==o.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-r),r=0)}}),void 0):t.animate(this.hideProps,a,n,d):e.animate(this.showProps,a,n,d)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var i,s,n,a,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,s=this.previousFilter||"",n=String.fromCharCode(t.keyCode),a=!1,clearTimeout(this.filterTimer),n===s?a=!0:n=s+n,i=this._filterMenuItems(n),i=a&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(t.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(t,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);s._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=a?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case a.UP:t=!0,this._keyEvent("previous",n);break;case a.DOWN:t=!0,this._keyEvent("next",n);break;case a.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?e(s).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,n=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var s=t.element[0];g(s).not(s).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):a.push("ui-button-text-only"),t.addClass(a.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.2"}});var v;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())
},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=RegExp("^\\d{"+n+","+s+"}"),o=i.substring(h).match(a);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;t.length>n;n++)if(b)"'"!==t.charAt(n)||_("'")?k():b=!1;else switch(t.charAt(n)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":r=new Date(x("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((x("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,C,N,A,P,I,z,H,F,E,O,j,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),J=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),K=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),U=this._get(e,"stepMonths"),Q=1!==K[0]||1!==K[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-K[0]*K[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?G:R,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;K[0]>w;w++){for(k="",this.maxRows=4,T=0;K[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",M="",Q){if(M+="<div class='ui-datepicker-group",K[1]>1)switch(T){case 0:M+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case K[1]-1:M+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",S=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?a:s:"")+(/all|right/.test(S)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",C=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+u)%7,C+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[N]+"'>"+p[N]+"</span></th>";for(M+=C+"</tr></thead><tbody>",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),P=(this._getFirstDayOfMonth(et,Z)-u+7)%7,I=Math.ceil((P+A)/7),z=Q?this.maxRows>I?this.maxRows:I:I,this.maxRows=z,H=this._daylightSavingAdjust(new Date(et,Z,1-P)),F=0;z>F;F++){for(M+="<tr>",E=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(H)+"</td>":"",x=0;7>x;x++)O=g?g.apply(e.input?e.input[0]:null,[H]):[!0,""],j=H.getMonth()!==Z,W=j&&!y||!O[0]||X&&X>H||$&&H>$,E+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(H.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===H.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!v?"":" "+O[1]+(H.getTime()===G.getTime()?" "+this._currentClass:"")+(H.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(j&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+H.getMonth()+"' data-year='"+H.getFullYear()+"'")+">"+(j&&!v?"&#xa0;":W?"<span class='ui-state-default'>"+H.getDate()+"</span>":"<a class='ui-state-default"+(H.getTime()===R.getTime()?" ui-state-highlight":"")+(H.getTime()===G.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+"' href='#'>"+H.getDate()+"</a>")+"</td>",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H);M+=E+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(Q?"</div>"+(K[0]>0&&T===K[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(a||!g)_+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");_+="</select>"}if(y||(b+=_+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!a&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.2",e.datepicker,e.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",a+1),s=!0),s&&!i&&this._trigger("focus",t),s},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;
e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(n))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(r>=0?"+":"")+r,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(n))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(a))}}).css("position",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(n[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var i,s,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=n.is(":data(ui-resizable)"),s&&!t&&n.resizable("destroy"),s&&"string"==typeof t&&n.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this,i=this.element.attr("tabindex");this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:i||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var s=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger("focus",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr("aria-activedescendant",t.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,n="";e.each(i,function(i,a){a.optgroup!==n&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(a.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:a.optgroup}).appendTo(t),n=a.optgroup),s._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var s=e("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),s="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](n).eq(-1):i[e+"All"](n).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var n=e(s),a=n.parent("optgroup");i.push({element:n,index:t,value:n.attr("value"),label:n.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||n.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,n,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var e=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-e},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,s,n,a,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(t,o,n)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,s){var n=i.attr(s);void 0!==n&&n.length&&(t[s]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"
},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,""),s=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var n,a,o,r=e(s).uniqueId().attr("id"),h=e(s).closest("li"),l=h.attr("aria-controls");t._isLocal(s)?(n=s.hash,o=n.substring(1),a=t.element.find(t._sanitizeSelector(n))):(o=h.attr("aria-controls")||e({}).uniqueId()[0].id,n="#"+o,a=t.element.find(n),a.length||(a=t._createPanel(o),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":o,"aria-labelledby":r}),a.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();"fill"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?e():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:r?e():a,newPanel:h};t.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",t,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?e():a,this.xhr&&this.xhr.abort(),l.length||h.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),t),this._toggle(t,u))},_toggle:function(t,i){function s(){a.running=!1,a._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,n=this.tabs.eq(t),a=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),r={tab:n,panel:o};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){o.html(e),s._trigger("load",i,r)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&s.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===s.xhr&&delete s.xhr},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr("href"),beforeSend:function(t,a){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:a},s))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr("aria-describedby")||"").split(/\s+/);s.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(s.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),s=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,s);-1!==n&&s.splice(n,1),t.removeData("ui-tooltip-id"),s=e.trim(s.join(" ")),s?t.attr("aria-describedby",s):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t.element)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur");n.target=n.currentTarget=s.element[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&s.parents().each(function(){var t,s=e(this);s.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,n=this,a=t?t.type:null;return"string"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){e.data("ui-tooltip-open")&&n._delay(function(){t&&(t.type=a),this._open(t,e,i)})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function n(e){u.of=e,o.is(":hidden")||o.position(u)}var a,o,r,h,l,u=e.extend({},this.options.position);if(s){if(a=this._find(i))return a.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),a=this._tooltip(i),o=a.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),s.clone?(l=s.clone(),l.removeAttr("id").find("[id]").removeAttr("id")):l=s,e("<div>").html(l).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):o.position(e.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(u.of),clearInterval(h))},e.fx.interval)),this._trigger("open",t,{tooltip:o}),r={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}},i[0]!==this.element[0]&&(r.remove=function(){this._removeTooltip(o)}),t&&"mouseover"!==t.type||(r.mouseleave="close"),t&&"focusin"!==t.type||(r.focusout="close"),this._on(!0,i,r)}},close:function(t){var i,s=this,n=e(t?t.currentTarget:this.element),a=this._find(n);a&&(i=a.tooltip,a.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),a.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete s.parents[t]}),a.closing=!0,this._trigger("close",t,{tooltip:i}),a.hiding||(a.closing=!1)))},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),s=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur"),a=s.element;n.target=n.currentTarget=a[0],t.close(n,!0),e("#"+i).remove(),a.data("ui-tooltip-title")&&(a.attr("title")||a.attr("title",a.data("ui-tooltip-title")),a.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var y="ui-effects-",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var d=this,c=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],c="array"),"string"===c?this.parse(s(n)||a._default):"array"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===c?(n instanceof l?f(u,function(e,t){n[t.cache]&&(d[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!d[a]&&s.to){if("alpha"===e||null==n[e])return;d[a]=s.to(d._rgba)}d[a][t.idx]=i(n[e],t,!0)}),d[a]&&0>e.inArray(null,d[a].slice(0,3))&&(d[a][3]=1,s.from&&(d._rgba=s.from(d[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=d[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),d="array"===r||"object"===r?s:arguments,c=this[o].slice();return f(a,function(e,t){var s=d["object"===r?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(n=l(u(c)),n[o]=c,n):l(c)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r="";if("transparent"!==n&&("string"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!c.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function t(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function i(t,i){var s,a,o={};for(s in i)a=i[s],t[s]!==a&&(n[s]||(e.fx.step[s]||!isNaN(parseFloat(a)))&&(o[s]=a));return o}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(s,function(e,t){n[t]&&o[t+"Class"](n[t])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,n,a,o){return"boolean"==typeof s||void 0===s?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,n,a)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function t(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.2",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=""),e.css(t[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,r=s.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),i()):o.call(n[0],s,i)}var s=t.apply(this,arguments),n=s.mode,a=s.queue,o=e.effects.effect[s.effect];return e.fx.off||!o?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):a===!1?this.each(i):this.queue(a||"fx",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);
var n=t.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||"boolean"==typeof s)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,n,a,o=e(this),r=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(o,t.mode||"hide"),d=t.direction||"up",c=r.test(d),p=c?"height":"width",f=c?"top":"left",m=h.test(d),g={},v="show"===u;o.parent().is(".ui-effects-wrapper")?e.effects.save(o.parent(),l):e.effects.save(o,l),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n=s[p](),a=parseFloat(s.css(f))||0,g[p]=v?n:0,m||(o.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?a:n+a),v&&(s.css(p,0),m||s.css(f,a+n)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&o.hide(),e.effects.restore(o,l),e.effects.removeWrapper(o),i()}})},e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"effect"),l="hide"===h,u="show"===h,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=o.queue(),_=b.length;for((u||l)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,y?2*-c:2*c).animate(a,m,g)),l&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g).animate(a,m,g),c=l?2*c:c/2;l&&(n={opacity:0},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()},e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[c](),l&&(n.css(c,0),n.css(p,a/2)),f[c]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})},e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===u?-s:s),d[l]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(h=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,l=o-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:r+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),h="show"===r,l="hide"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(c),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=n.queue(),p=c.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),d=1),s=1;l>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),n.dequeue()},e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()},e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})}});
/*
 *  jQuery OwlCarousel v1.3.3
 *
 *  Copyright (c) 2013 Bartosz Wojciechowski
 *  http://www.owlgraphic.com/owlcarousel/
 *
 *  Licensed under MIT
 *
 */

/*JS Lint helpers: */
/*global dragMove: false, dragEnd: false, $, jQuery, alert, window, document */
/*jslint nomen: true, continue:true */



/*
    MODIFIED to add additional functionality and accessibility 
*/

if (typeof Object.create !== "function") {
    Object.create = function (obj) {
        function F() {}
        F.prototype = obj;
        return new F();
    };
}
(function ($, window, document) {

    var Carousel = {
        init : function (options, el) {
            var base = this;

            base.$elem = $(el);
            base.options = $.extend({}, $.fn.owlCarousel.options, base.$elem.data(), options);

            base.userOptions = options;
            base.loadContent();
        },

        loadContent : function () {
            var base = this, url;

            function getData(data) {
                var i, content = "";
                if (typeof base.options.jsonSuccess === "function") {
                    base.options.jsonSuccess.apply(this, [data]);
                } else {
                    for (i in data.owl) {
                        if (data.owl.hasOwnProperty(i)) {
                            content += data.owl[i].item;
                        }
                    }
                    base.$elem.html(content);
                }
                base.logIn();
            }

            if (typeof base.options.beforeInit === "function") {
                base.options.beforeInit.apply(this, [base.$elem]);
            }

            if (typeof base.options.jsonPath === "string") {
                url = base.options.jsonPath;
                $.getJSON(url, getData);
            } else {
                base.logIn();
            }
        },

        logIn : function () {
            var base = this;

            base.$elem.data({
                "owl-originalStyles": base.$elem.attr("style"),
                "owl-originalClasses": base.$elem.attr("class")
            });

            base.$elem.css({opacity: 0});
            base.orignalItems = base.options.items;
            base.checkBrowser();
            base.wrapperWidth = 0;
            base.checkVisible = null;
            base.setVars();
        },

        setVars : function () {
            var base = this;
            if (base.$elem.children().length === 0) {return false; }
            base.baseClass();
            base.eventTypes();
            base.$userItems = base.$elem.children();
            base.itemsAmount = base.$userItems.length;
            base.wrapItems();
            base.$owlItems = base.$elem.find(".owl-item");
            base.$owlWrapper = base.$elem.find(".owl-wrapper");
            base.playDirection = "next";
            base.prevItem = 0;
            base.prevArr = [0];
            base.currentItem = 0;
            base.customEvents();
            base.onStartup();
        },

        onStartup : function () {
            var base = this;
            base.updateItems();
            base.calculateAll();
            base.buildControls();
            base.updateControls();
            base.response();
            base.moveEvents();
            base.stopOnHover();
            base.stopOnFocus();
            base.owlStatus();

            if (base.options.transitionStyle !== false) {
                base.transitionTypes(base.options.transitionStyle);
            }
            if (base.options.autoPlay === true) {
                base.options.autoPlay = 5000;
            }
            base.play();

            base.$elem.find(".owl-wrapper").css("display", "block");

            if (!base.$elem.is(":visible")) {
                base.watchVisibility();
            } else {
                base.$elem.css("opacity", 1);
            }
            base.onstartup = false;
            base.eachMoveUpdate();
            if (typeof base.options.afterInit === "function") {
                base.options.afterInit.apply(this, [base.$elem]);
            }
        },

        eachMoveUpdate : function () {
            var base = this;

            if (base.options.lazyLoad === true) {
                base.lazyLoad();
            }
            if (base.options.autoHeight === true) {
                base.autoHeight();
            }
            base.onVisibleItems();

            if (typeof base.options.afterAction === "function") {
                base.options.afterAction.apply(this, [base.$elem]);
            }
        },

        updateVars : function () {
            var base = this;
            if (typeof base.options.beforeUpdate === "function") {
                base.options.beforeUpdate.apply(this, [base.$elem]);
            }
            base.watchVisibility();
            base.updateItems();
            base.calculateAll();
            base.updatePosition();
            base.updateControls();
            base.eachMoveUpdate();
            if (typeof base.options.afterUpdate === "function") {
                base.options.afterUpdate.apply(this, [base.$elem]);
            }
        },

        reload : function () {
            var base = this;
            window.setTimeout(function () {
                base.updateVars();
            }, 0);
        },

        watchVisibility : function () {
            var base = this;

            if (base.$elem.is(":visible") === false) {
                base.$elem.css({opacity: 0});
                window.clearInterval(base.autoPlayInterval);
                window.clearInterval(base.checkVisible);
            } else {
                return false;
            }
            base.checkVisible = window.setInterval(function () {
                if (base.$elem.is(":visible")) {
                    base.reload();
                    base.$elem.animate({opacity: 1}, 200);
                    window.clearInterval(base.checkVisible);
                }
            }, 500);
        },

        wrapItems : function () {
            var base = this;
            base.$userItems.wrapAll("<div class=\"owl-wrapper\">").wrap("<div class=\"owl-item\"></div>");
            base.$elem.find(".owl-wrapper").wrap("<div class=\"owl-wrapper-outer\">");
            base.wrapperOuter = base.$elem.find(".owl-wrapper-outer");
            base.$elem.css("display", "block");
        },

        baseClass : function () {
            var base = this,
                hasBaseClass = base.$elem.hasClass(base.options.baseClass),
                hasThemeClass = base.$elem.hasClass(base.options.theme);

            if (!hasBaseClass) {
                base.$elem.addClass(base.options.baseClass);
            }

            if (!hasThemeClass) {
                base.$elem.addClass(base.options.theme);
            }
        },

        updateItems : function () {
            var base = this, width, i;

            if (base.options.responsive === false) {
                return false;
            }
            if (base.options.singleItem === true) {
                base.options.items = base.orignalItems = 1;
                base.options.itemsCustom = false;
                base.options.itemsDesktop = false;
                base.options.itemsDesktopSmall = false;
                base.options.itemsTablet = false;
                base.options.itemsTabletSmall = false;
                base.options.itemsMobile = false;
                return false;
            }

            width = $(base.options.responsiveBaseWidth).width();

            if (width > (base.options.itemsDesktop[0] || base.orignalItems)) {
                base.options.items = base.orignalItems;
            }
            if (base.options.itemsCustom !== false) {
                //Reorder array by screen size
                base.options.itemsCustom.sort(function (a, b) {return a[0] - b[0]; });

                for (i = 0; i < base.options.itemsCustom.length; i += 1) {
                    if (base.options.itemsCustom[i][0] <= width) {
                        base.options.items = base.options.itemsCustom[i][1];
                    }
                }

            } else {

                if (width <= base.options.itemsDesktop[0] && base.options.itemsDesktop !== false) {
                    base.options.items = base.options.itemsDesktop[1];
                }

                if (width <= base.options.itemsDesktopSmall[0] && base.options.itemsDesktopSmall !== false) {
                    base.options.items = base.options.itemsDesktopSmall[1];
                }

                if (width <= base.options.itemsTablet[0] && base.options.itemsTablet !== false) {
                    base.options.items = base.options.itemsTablet[1];
                }

                if (width <= base.options.itemsTabletSmall[0] && base.options.itemsTabletSmall !== false) {
                    base.options.items = base.options.itemsTabletSmall[1];
                }

                if (width <= base.options.itemsMobile[0] && base.options.itemsMobile !== false) {
                    base.options.items = base.options.itemsMobile[1];
                }
            }

            //if number of items is less than declared
            if (base.options.items > base.itemsAmount && base.options.itemsScaleUp === true) {
                base.options.items = base.itemsAmount;
            }
        },

        response : function () {
            var base = this,
                smallDelay,
                lastWindowWidth;

            if (base.options.responsive !== true) {
                return false;
            }
            lastWindowWidth = $(window).width();

            base.resizer = function () {
                if ($(window).width() !== lastWindowWidth) {
                    if (base.options.autoPlay !== false) {
                        window.clearInterval(base.autoPlayInterval);
                    }
                    window.clearTimeout(smallDelay);
                    smallDelay = window.setTimeout(function () {
                        lastWindowWidth = $(window).width();
                        base.updateVars();
                    }, base.options.responsiveRefreshRate);
                }
            };
            $(window).resize(base.resizer);
        },

        updatePosition : function () {
            var base = this;
            base.jumpTo(base.currentItem);
            if (base.options.autoPlay !== false) {
                base.checkAp();
            }
        },

        appendItemsSizes : function () {
            var base = this,
                roundPages = 0,
                lastItem = base.itemsAmount - base.options.items;

            base.$owlItems.each(function (index) {
                var $this = $(this);
                $this
                    .css({"width": base.itemWidth})
                    .data("owl-item", Number(index));

                if (index % base.options.items === 0 || index === lastItem) {
                    if (!(index > lastItem)) {
                        roundPages += 1;
                    }
                }
                $this.data("owl-roundPages", roundPages);
            });
        },

        appendWrapperSizes : function () {
            var base = this,
                width = base.$owlItems.length * base.itemWidth;

            base.$owlWrapper.css({
                "width": width * 2,
                "left": 0
            });
            base.appendItemsSizes();
        },

        calculateAll : function () {
            var base = this;
            base.calculateWidth();
            base.appendWrapperSizes();
            base.loops();
            base.max();
        },

        calculateWidth : function () {
            var base = this;
            base.itemWidth = Math.round(base.$elem.width() / base.options.items);
        },

        max : function () {
            var base = this,
                maximum = ((base.itemsAmount * base.itemWidth) - base.options.items * base.itemWidth) * -1;
            if (base.options.items > base.itemsAmount) {
                base.maximumItem = 0;
                maximum = 0;
                base.maximumPixels = 0;
            } else {
                base.maximumItem = base.itemsAmount - base.options.items;
                base.maximumPixels = maximum;
            }
            return maximum;
        },

        min : function () {
            return 0;
        },

        loops : function () {
            var base = this,
                prev = 0,
                elWidth = 0,
                i,
                item,
                roundPageNum;

            base.positionsInArray = [0];
            base.pagesInArray = [];

            for (i = 0; i < base.itemsAmount; i += 1) {
                elWidth += base.itemWidth;
                base.positionsInArray.push(-elWidth);

                if (base.options.scrollPerPage === true) {
                    item = $(base.$owlItems[i]);
                    roundPageNum = item.data("owl-roundPages");
                    if (roundPageNum !== prev) {
                        base.pagesInArray[prev] = base.positionsInArray[i];
                        prev = roundPageNum;
                    }
                }
            }
        },

        buildControls : function () {
            var base = this;
            if (base.options.navigation === true || base.options.pagination === true) {
                base.owlControls = $("<div class=\"owl-controls\"/>").toggleClass("clickable", !base.browser.isTouch).appendTo(base.$elem);
            }
            if (base.options.navigation === true) {
                base.buildButtons();
            }
            if (base.options.pagination === true) {
                base.buildPagination();
            }
            
        },

        buildButtons : function () {
        	var base = this,buttonPrevBg,buttonNextBg;
            buttonsWrapper = $("<div class=\"owl-buttons\"/>");
            base.owlControls.append(buttonsWrapper);

            base.buttonPrevBg = $("<div/>", {
                "class" : "btn-owl-prev-bg"
            });
            
            base.buttonNextBg = $("<div/>", {
                "class" : "btn-owl-next-bg"
            });
            
            base.buttonPrev = $("<div/>", {
                "class" : "owl-prev",
                "html" : base.options.navigationText[0] || "",
                "role" : "button",
                "tabindex" : "0"
            });
            
            base.buttonNext = $("<div/>", {
                "class" : "owl-next",
                "html" : base.options.navigationText[1] || "",
                "role" : "button",
                "tabindex" : "0"
            });
            
            base.buttonPrevBg.append(base.buttonPrev);
            base.buttonNextBg.append(base.buttonNext);

            buttonsWrapper
                .append(base.buttonPrevBg)
                .append(base.buttonNextBg);

            buttonsWrapper.on("touchstart.owlControls mousedown.owlControls", "div[class^=\"owl\"]", function (event) {
                event.preventDefault();
            });

            buttonsWrapper.on("touchend.owlControls mouseup.owlControls", "div[class^=\"owl\"]", function (event) {
                event.preventDefault();
                if ($(this).hasClass("owl-next")) {
                    base.next();
                } 
                else {
                	base.prev();
                }
            });
        },
        
        buildPagination : function () {
            var base = this;

            base.paginationWrapper = $( base.options.paginationWrapper );
            base.owlControls.append(base.paginationWrapper);
            
            base.paginationWrapper.on("touchstart.owlControls mousedown.owlControls", ".owl-page", function (event) {
                event.preventDefault();
            });
            
            base.paginationWrapper.on("touchend.owlControls mouseup.owlControls", ".owl-page", function (event) {
                event.preventDefault();
                if (Number($(this).data("owl-page")) !== base.currentItem) {
                    base.goTo(Number($(this).data("owl-page")), true);
                }
            });
            
            if (base.options.pause === true) {
            	base.buildPauseButton();
            	base.updatePauseButton();
            }
            
        },
        
        buildPauseButton : function () {
        	var base = this;
        			   
            base.paginationWrapper.on("touchstart.owlControls mousedown.owlControls", ".owl-pause", function (event) {
                event.preventDefault();
            });
            
            base.paginationWrapper.on("touchend.owlControls mouseup.owlControls", ".owl-pause", function (event) {
                event.preventDefault();
                if($(this).hasClass("paused")) {
                    base.play();
                    $(this).removeClass("paused");
                    $(this).attr("aria-label","pause button");
                }
                else if($(this).hasClass("owl-pause")) {
                    base.stop();
                    $(this).addClass("paused");
                    $(this).attr("aria-label","play button");
                }
            });
        },
        
        updatePauseButton : function () {
        	var base = this,
        			   pauseButton,
        			   pauseButtonInner;
        	
        	pauseButton = $("<div/>", {
                "class" : "owl-pause",
                "aria-label" : "pause",
                "aria-live" : "assertive",
                "aria-atomic" : "true",
                "role" : "button",
                "tabindex" : "0"
            });
        	pauseButtonInner = $("<span class='fa fa-pause'></span><span class='fa fa-play'></span>");
        	pauseButton.append(pauseButtonInner);
        	
            base.paginationWrapper.append(pauseButton);
        	
        	
        },
        
        updatePagination : function () {
            var base = this,
                counter,
                lastPage,
                lastItem,
                i,
                paginationButton,
                paginationButtonInner,
                numberofslides;

            if (base.options.pagination === false) {
                return false;
            }
            
            base.paginationWrapper.find('.owl-page').remove();

            counter = 0;
            lastPage = base.itemsAmount - base.itemsAmount % base.options.items;
            numberofslides = 0;
            for (i = 0; i < base.itemsAmount; i += 1) {
            	if (i % base.options.items === 0) {
            		numberofslides += 1;
            	}
            }
            
            for (i = 0; i < base.itemsAmount; i += 1) {
            	if (i % base.options.items === 0) {
            		counter += 1;
                    if (lastPage === i) {
                        lastItem = base.itemsAmount - base.options.items;
                        numberofslides = counter;
                    }
                    if (base.options.setpaginationtab === true) {
                    	paginationButton = $("<div/>", {
                            "class" : "owl-page",
                            "tabindex" : "0"
                        });
                    }
                    else {
                    	paginationButton = $("<div/>", {
                            "class" : "owl-page"
                        });
                    }
                    
                    paginationButtonInner = $("<span></span>", {
                        "text": base.options.paginationNumbers === true ? counter : "",
                        "class": base.options.paginationNumbers === true ? "owl-numbers" : ""
                    });
                    paginationButton.append(paginationButtonInner);
                    /* for accessibility */
                    var acc_text_for_slide = "Slide " + counter + " of " + Math.ceil(numberofslides);
                    paginationButtonInner = $("<span></span>", {
                        "text": acc_text_for_slide,
                        "class": "sr-only"
                    });
                    paginationButton.append(paginationButtonInner);
                    
                    
                    paginationButton.data("owl-page", lastPage === i ? lastItem : i);
                    paginationButton.data("owl-roundPages", counter);

                    base.paginationWrapper.append(paginationButton);
                }
            }
            base.checkPagination();
            
        },
        checkPagination : function () {
            var base = this;
            if (base.options.pagination === false) {
                return false;
            }
            base.paginationWrapper.find(".owl-page").each(function () {
                if ($(this).data("owl-roundPages") === $(base.$owlItems[base.currentItem]).data("owl-roundPages")) {
                    base.paginationWrapper
                        .find(".owl-page")
                        .removeClass("active")
                        .find(".current-slide")
                        .remove();
                    $(this).addClass("active").append("<span class='current-slide sr-only'>"+base.options.currentslideText+"</span>");
                }
            });
        },
        
        checkNavigation : function () {
            var base = this;

            if (base.options.navigation === false) {
                return false;
            }
            if (base.options.rewindNav === false) {
                if (base.currentItem === 0 && base.maximumItem === 0) {
                    base.buttonPrev.addClass("disabled");
                    base.buttonNext.addClass("disabled");
                } else if (base.currentItem === 0 && base.maximumItem !== 0) {
                    base.buttonPrev.addClass("disabled");
                    base.buttonNext.removeClass("disabled");
                } else if (base.currentItem === base.maximumItem) {
                    base.buttonPrev.removeClass("disabled");
                    base.buttonNext.addClass("disabled");
                } else if (base.currentItem !== 0 && base.currentItem !== base.maximumItem) {
                    base.buttonPrev.removeClass("disabled");
                    base.buttonNext.removeClass("disabled");
                }
            }
        },

        updateControls : function () {
            var base = this;
            base.updatePagination();
            base.checkNavigation();
            if (base.owlControls) {
                if (base.options.items >= base.itemsAmount) {
                    base.owlControls.hide();
                } else {
                    base.owlControls.show();
                }
            }
        },

        destroyControls : function () {
            var base = this;
            if (base.owlControls) {
                base.owlControls.remove();
            }
        },

        next : function (speed) {
            var base = this;

            if (base.isTransition) {
                return false;
            }

            base.currentItem += base.options.scrollPerPage === true ? base.options.items : 1;
            if (base.currentItem > base.maximumItem + (base.options.scrollPerPage === true ? (base.options.items - 1) : 0)) {
                if (base.options.rewindNav === true) {
                    base.currentItem = 0;
                    speed = "rewind";
                } else {
                    base.currentItem = base.maximumItem;
                    return false;
                }
            }
            base.goTo(base.currentItem, speed);
        },

        prev : function (speed) {
            var base = this;

            if (base.isTransition) {
                return false;
            }

            if (base.options.scrollPerPage === true && base.currentItem > 0 && base.currentItem < base.options.items) {
                base.currentItem = 0;
            } else {
                base.currentItem -= base.options.scrollPerPage === true ? base.options.items : 1;
            }
            if (base.currentItem < 0) {
                if (base.options.rewindNav === true) {
                    base.currentItem = base.maximumItem;
                    speed = "rewind";
                } else {
                    base.currentItem = 0;
                    return false;
                }
            }
            base.goTo(base.currentItem, speed);
        },

        goTo : function (position, speed, drag) {
            var base = this,
                goToPixel;

            if (base.isTransition) {
                return false;
            }
            if (typeof base.options.beforeMove === "function") {
                base.options.beforeMove.apply(this, [base.$elem]);
            }
            if (position >= base.maximumItem) {
                position = base.maximumItem;
            } else if (position <= 0) {
                position = 0;
            }

            base.currentItem = base.owl.currentItem = position;
            if (base.options.transitionStyle !== false && drag !== "drag" && base.options.items === 1 && base.browser.support3d === true) {
                base.swapSpeed(0);
                if (base.browser.support3d === true) {
                    base.transition3d(base.positionsInArray[position]);
                } else {
                    base.css2slide(base.positionsInArray[position], 1);
                }
                base.afterGo();
                base.singleItemTransition();
                return false;
            }
            goToPixel = base.positionsInArray[position];

            if (base.browser.support3d === true) {
                base.isCss3Finish = false;

                if (speed === true) {
                    base.swapSpeed("paginationSpeed");
                    window.setTimeout(function () {
                        base.isCss3Finish = true;
                    }, base.options.paginationSpeed);

                } else if (speed === "rewind") {
                    base.swapSpeed(base.options.rewindSpeed);
                    window.setTimeout(function () {
                        base.isCss3Finish = true;
                    }, base.options.rewindSpeed);

                } else {
                    base.swapSpeed("slideSpeed");
                    window.setTimeout(function () {
                        base.isCss3Finish = true;
                    }, base.options.slideSpeed);
                }
                base.transition3d(goToPixel);
            } else {
                if (speed === true) {
                    base.css2slide(goToPixel, base.options.paginationSpeed);
                } else if (speed === "rewind") {
                    base.css2slide(goToPixel, base.options.rewindSpeed);
                } else {
                    base.css2slide(goToPixel, base.options.slideSpeed);
                }
            }
            base.afterGo();
        },

        jumpTo : function (position) {
            var base = this;
            if (typeof base.options.beforeMove === "function") {
                base.options.beforeMove.apply(this, [base.$elem]);
            }
            if (position >= base.maximumItem || position === -1) {
                position = base.maximumItem;
            } else if (position <= 0) {
                position = 0;
            }
            base.swapSpeed(0);
            if (base.browser.support3d === true) {
                base.transition3d(base.positionsInArray[position]);
            } else {
                base.css2slide(base.positionsInArray[position], 1);
            }
            base.currentItem = base.owl.currentItem = position;
            base.afterGo();
        },

        afterGo : function () {
            var base = this;

            base.prevArr.push(base.currentItem);
            base.prevItem = base.owl.prevItem = base.prevArr[base.prevArr.length - 2];
            base.prevArr.shift(0);

            if (base.prevItem !== base.currentItem) {
                base.checkPagination();
                base.checkNavigation();
                base.eachMoveUpdate();

                if (base.options.autoPlay !== false) {
                    base.checkAp();
                }
            }
            if (typeof base.options.afterMove === "function" && base.prevItem !== base.currentItem) {
                base.options.afterMove.apply(this, [base.$elem]);
            }
        },

        stop : function () {
        	var base = this;
            base.apStatus = "stop";
            window.clearInterval(base.autoPlayInterval);
        },


        dragging : function (bool) {
            var base = this;
            base.options.dragging = bool;
            
        },


        checkAp : function () {
            var base = this;
            if (base.apStatus !== "stop") {
                base.play();
            }
        },

        play : function () {
        	var base = this;
            base.apStatus = "play";
            if (base.options.autoPlay === false) {
                return false;
            }
            window.clearInterval(base.autoPlayInterval);
            base.autoPlayInterval = window.setInterval(function () {
                base.next(true);
            }, base.options.autoPlay);
        },

        swapSpeed : function (action) {
            var base = this;
            if (action === "slideSpeed") {
                base.$owlWrapper.css(base.addCssSpeed(base.options.slideSpeed));
            } else if (action === "paginationSpeed") {
                base.$owlWrapper.css(base.addCssSpeed(base.options.paginationSpeed));
            } else if (typeof action !== "string") {
                base.$owlWrapper.css(base.addCssSpeed(action));
            }
        },

        addCssSpeed : function (speed) {
            return {
                "-webkit-transition": "all " + speed + "ms ease",
                "-moz-transition": "all " + speed + "ms ease",
                "-o-transition": "all " + speed + "ms ease",
                "transition": "all " + speed + "ms ease"
            };
        },

        removeTransition : function () {
            return {
                "-webkit-transition": "",
                "-moz-transition": "",
                "-o-transition": "",
                "transition": ""
            };
        },

        doTranslate : function (pixels) {
            return {
                "-webkit-transform": "translate3d(" + pixels + "px, 0px, 0px)",
                "-moz-transform": "translate3d(" + pixels + "px, 0px, 0px)",
                "-o-transform": "translate3d(" + pixels + "px, 0px, 0px)",
                "-ms-transform": "translate3d(" + pixels + "px, 0px, 0px)",
                "transform": "translate3d(" + pixels + "px, 0px,0px)"
            };
        },

        transition3d : function (value) {
            var base = this;
            base.$owlWrapper.css(base.doTranslate(value));
        },

        css2move : function (value) {
            var base = this;
            base.$owlWrapper.css({"left" : value});
        },

        css2slide : function (value, speed) {
            var base = this;

            base.isCssFinish = false;
            base.$owlWrapper.stop(true, true).animate({
                "left" : value
            }, {
                duration : speed || base.options.slideSpeed,
                complete : function () {
                    base.isCssFinish = true;
                }
            });
        },

        checkBrowser : function () {
            var base = this,
                translate3D = "translate3d(0px, 0px, 0px)",
                tempElem = document.createElement("div"),
                isTouch;

            tempElem.style.cssText = "  -moz-transform:" + translate3D +
                                  "; -ms-transform:"     + translate3D +
                                  "; -o-transform:"      + translate3D +
                                  "; -webkit-transform:" + translate3D +
                                  "; transform:"         + translate3D;
            

            isTouch = "ontouchstart" in window || window.navigator.msMaxTouchPoints;

            base.browser = {
                "isTouch" : isTouch
            };
        },
        
        checkBrowserOrg : function () {
            var base = this,
                translate3D = "translate3d(0px, 0px, 0px)",
                tempElem = document.createElement("div"),
                regex,
                asSupport,
                support3d,
                isTouch;

            tempElem.style.cssText = "  -moz-transform:" + translate3D +
                                  "; -ms-transform:"     + translate3D +
                                  "; -o-transform:"      + translate3D +
                                  "; -webkit-transform:" + translate3D +
                                  "; transform:"         + translate3D;
            regex = /translate3d\(0px, 0px, 0px\)/g;
            asSupport = tempElem.style.cssText.match(regex);
            support3d = (asSupport !== null && asSupport.length === 1);

            isTouch = "ontouchstart" in window || window.navigator.msMaxTouchPoints;

            base.browser = {
                "support3d" : support3d,
                "isTouch" : isTouch
            };
        },

        moveEvents : function () {
            var base = this;
            if (base.options.mouseDrag !== false || base.options.touchDrag !== false) {
                base.gestures();
                base.disabledEvents();
            }
        },

        eventTypes : function () {
            var base = this,
                types = ["s", "e", "x"];

            base.ev_types = {};

            if (base.options.mouseDrag === true && base.options.touchDrag === true) {
                types = [
                    "touchstart.owl mousedown.owl",
                    "touchmove.owl mousemove.owl",
                    "touchend.owl touchcancel.owl mouseup.owl"
                ];
            } else if (base.options.mouseDrag === false && base.options.touchDrag === true) {
                types = [
                    "touchstart.owl",
                    "touchmove.owl",
                    "touchend.owl touchcancel.owl"
                ];
            } else if (base.options.mouseDrag === true && base.options.touchDrag === false) {
                types = [
                    "mousedown.owl",
                    "mousemove.owl",
                    "mouseup.owl"
                ];
            }

            base.ev_types.start = types[0];
            base.ev_types.move = types[1];
            base.ev_types.end = types[2];
        },

        disabledEvents :  function () {
            var base = this;
            base.$elem.on("dragstart.owl", function (event) { event.preventDefault(); });
            base.$elem.on("mousedown.disableTextSelect", function (e) {
                return $(e.target).is('input, textarea, select, option');
            });
        },

        gestures : function () {
            /*jslint unparam: true*/
            var base = this,
                locals = {
                    offsetX : 0,
                    offsetY : 0,
                    baseElWidth : 0,
                    relativePos : 0,
                    position: null,
                    minSwipe : null,
                    maxSwipe: null,
                    sliding : null,
                    dargging: null,
                    targetElement : null
                };

            base.isCssFinish = true;

            function getTouches(event) {
                if (event.touches !== undefined) {
                    return {
                        x : event.touches[0].pageX,
                        y : event.touches[0].pageY
                    };
                }

                if (event.touches === undefined) {
                    if (event.pageX !== undefined) {
                        return {
                            x : event.pageX,
                            y : event.pageY
                        };
                    }
                    if (event.pageX === undefined) {
                        return {
                            x : event.clientX,
                            y : event.clientY
                        };
                    }
                }
            }

            function swapEvents(type) {
                if (type === "on") {
                    $(document).on(base.ev_types.move, dragMove);
                    $(document).on(base.ev_types.end, dragEnd);
                } else if (type === "off") {
                    $(document).off(base.ev_types.move);
                    $(document).off(base.ev_types.end);
                }
            }

            function dragStart(event) {
                var ev = event.originalEvent || event || window.event,
                    position;


                
                if(!base.options.dragging){
                	return;
                }

                if (ev.which === 3) {
                    return false;
                }
                if (base.itemsAmount <= base.options.items) {
                    return;
                }
                if (base.isCssFinish === false && !base.options.dragBeforeAnimFinish) {
                    return false;
                }
                if (base.isCss3Finish === false && !base.options.dragBeforeAnimFinish) {
                    return false;
                }

                if (base.options.autoPlay !== false) {
                    window.clearInterval(base.autoPlayInterval);
                }

                if (base.browser.isTouch !== true && !base.$owlWrapper.hasClass("grabbing")) {
                    base.$owlWrapper.addClass("grabbing");
                }

                base.newPosX = 0;
                base.newRelativeX = 0;

                $(this).css(base.removeTransition());

                position = $(this).position();
                locals.relativePos = position.left;

                locals.offsetX = getTouches(ev).x - position.left;
                locals.offsetY = getTouches(ev).y - position.top;

                swapEvents("on");

                locals.sliding = false;
                locals.targetElement = ev.target || ev.srcElement;
            }

            function dragMove(event) {

            	 if(!base.options.dragging){
                	return;
                }

                var ev = event.originalEvent || event || window.event,
                    minSwipe,
                    maxSwipe;

                base.newPosX = getTouches(ev).x - locals.offsetX;
                base.newPosY = getTouches(ev).y - locals.offsetY;
                base.newRelativeX = base.newPosX - locals.relativePos;

              

                if (typeof base.options.startDragging === "function" && locals.dragging !== true && base.newRelativeX !== 0) {
                    locals.dragging = true;
                  	base.options.startDragging.apply(base, [base.$elem]);
                  	
                }


                if ((base.newRelativeX > 8 || base.newRelativeX < -8) && (base.browser.isTouch === true)) {
                    if (ev.preventDefault !== undefined) {
                        ev.preventDefault();
                    } else {
                        ev.returnValue = false;
                    }
                    locals.sliding = true;
                }

                if ((base.newPosY > 10 || base.newPosY < -10) && locals.sliding === false) {
                    $(document).off("touchmove.owl");
                }

                minSwipe = function () {
                    return base.newRelativeX / 5;
                };

                maxSwipe = function () {
                    return base.maximumPixels + base.newRelativeX / 5;
                };

                base.newPosX = Math.max(Math.min(base.newPosX, minSwipe()), maxSwipe());
                if (base.browser.support3d === true) {
                    base.transition3d(base.newPosX);
                } else {
                    base.css2move(base.newPosX);
                }
            }

            function dragEnd(event) {
                var ev = event.originalEvent || event || window.event,
                    newPosition,
                    handlers,
                    owlStopEvent;

                ev.target = ev.target || ev.srcElement;

                locals.dragging = false;

                if (base.browser.isTouch !== true) {
                    base.$owlWrapper.removeClass("grabbing");
                }

                if (base.newRelativeX < 50) {
                    base.dragDirection = base.owl.dragDirection = "left";
                } else {
                    base.dragDirection = base.owl.dragDirection = "right";
                }

                if (base.newRelativeX !== 0) {
                    newPosition = base.getNewPosition();
                    base.goTo(newPosition, false, "drag");
                    if (locals.targetElement === ev.target && base.browser.isTouch !== true) {
                        $(ev.target).on("click.disable", function (ev) {
                            ev.stopImmediatePropagation();
                            ev.stopPropagation();
                            ev.preventDefault();
                            $(ev.target).off("click.disable");
                        });
                        handlers = $._data(ev.target, "events").click;
                        owlStopEvent = handlers.pop();
                        handlers.splice(0, 0, owlStopEvent);
                    }
                }
                swapEvents("off");
            }
            base.$elem.on(base.ev_types.start, ".owl-wrapper", dragStart);
        },

        getNewPosition : function () {
            var base = this,
                newPosition = base.closestItem();

            if (newPosition > base.maximumItem) {
                base.currentItem = base.maximumItem;
                newPosition  = base.maximumItem;
            } else if (base.newPosX >= 0) {
                newPosition = 0;
                base.currentItem = 0;
            }
            return newPosition;
        },
        closestItem : function () {
            var base = this,
                array = base.options.scrollPerPage === true ? base.pagesInArray : base.positionsInArray,
                goal = base.newPosX,
                closest = null;

            $.each(array, function (i, v) {
                if (goal - (base.itemWidth / 20) > array[i + 1] && goal - (base.itemWidth / 20) < v && base.moveDirection() === "left") {
                    closest = v;
                    if (base.options.scrollPerPage === true) {
                        base.currentItem = $.inArray(closest, base.positionsInArray);
                    } else {
                        base.currentItem = i;
                    }
                } else if (goal + (base.itemWidth / 20) < v && goal + (base.itemWidth / 20) > (array[i + 1] || array[i] - base.itemWidth) && base.moveDirection() === "right") {
                    if (base.options.scrollPerPage === true) {
                        closest = array[i + 1] || array[array.length - 1];
                        base.currentItem = $.inArray(closest, base.positionsInArray);
                    } else {
                        closest = array[i + 1];
                        base.currentItem = i + 1;
                    }
                }
            });
            return base.currentItem;
        },

        moveDirection : function () {
            var base = this,
                direction;
            if (base.newRelativeX < 0) {
                direction = "right";
                base.playDirection = "next";
            } else {
                direction = "left";
                base.playDirection = "prev";
            }
            return direction;
        },

        customEvents : function () {
            /*jslint unparam: true*/
            var base = this;
            base.$elem.on("owl.next", function () {
                base.next();
            });
            base.$elem.on("owl.prev", function () {
                base.prev();
            });
            base.$elem.on("owl.play", function (event, speed) {
                base.options.autoPlay = speed;
                base.play();
                base.hoverStatus = "play";
            });
            base.$elem.on("owl.stop", function () {
                base.stop();
                base.hoverStatus = "stop";
            });
            base.$elem.on("owl.goTo", function (event, item) {
                base.goTo(item);
            });
            base.$elem.on("owl.jumpTo", function (event, item) {
                base.jumpTo(item);
            });

             base.$elem.on("owl.dragging", function (event, item) {
                base.dragging(item);
            });
        },

        stopOnHover : function () {
        	var base = this;
            if (base.options.stopOnHover === true && base.browser.isTouch !== true && base.options.autoPlay !== false) {
                base.$elem.on("mouseover", function () {
                    base.stop();
                });
                base.$elem.on("mouseout", function () {
                    if (base.hoverStatus !== "stop") {
                        base.play();
                    }
                });
            }
        },
        
        stopOnFocus : function () {
        	var base = this;
            if (base.options.stopOnFocus === true && base.browser.isTouch !== true && base.options.autoPlay !== false) {
                base.$elem.on("focus", function () {
                    base.stop();
                });
                
                base.$elem.on("blur", function () {
                    if (base.hoverStatus !== "stop") {
                        base.play();
                    }
                });
            }
        },

        lazyLoad : function () {
            var base = this,
                i,
                $item,
                itemNumber,
                $lazyImg,
                follow;

            if (base.options.lazyLoad === false) {
                return false;
            }
            for (i = 0; i < base.itemsAmount; i += 1) {
                $item = $(base.$owlItems[i]);

                if ($item.data("owl-loaded") === "loaded") {
                    continue;
                }

                itemNumber = $item.data("owl-item");
                $lazyImg = $item.find(".lazyOwl");

                if (typeof $lazyImg.data("src") !== "string") {
                    $item.data("owl-loaded", "loaded");
                    continue;
                }
                if ($item.data("owl-loaded") === undefined) {
                    $lazyImg.hide();
                    $item.addClass("loading").data("owl-loaded", "checked");
                }
                if (base.options.lazyFollow === true) {
                    follow = itemNumber >= base.currentItem;
                } else {
                    follow = true;
                }
                if (follow && itemNumber < base.currentItem + base.options.items && $lazyImg.length) {
                    $lazyImg.each(function() {
                        base.lazyPreload($item, $(this));
                    });
                }
            }
        },

        lazyPreload : function ($item, $lazyImg) {
            var base = this,
                iterations = 0,
                isBackgroundImg;

            if ($lazyImg.prop("tagName") === "DIV") {
                $lazyImg.css("background-image", "url(" + $lazyImg.data("src") + ")");
                isBackgroundImg = true;
            } else {
                $lazyImg[0].src = $lazyImg.data("src");
            }

            function showImage() {
                $item.data("owl-loaded", "loaded").removeClass("loading");
                $lazyImg.removeAttr("data-src");
                if (base.options.lazyEffect === "fade") {
                    $lazyImg.fadeIn(400);
                } else {
                    $lazyImg.show();
                }
                if (typeof base.options.afterLazyLoad === "function") {
                    base.options.afterLazyLoad.apply(this, [base.$elem]);
                }
            }

            function checkLazyImage() {
                iterations += 1;
                if (base.completeImg($lazyImg.get(0)) || isBackgroundImg === true) {
                    showImage();
                } else if (iterations <= 100) {//if image loads in less than 10 seconds 
                    window.setTimeout(checkLazyImage, 100);
                } else {
                    showImage();
                }
            }

            checkLazyImage();
        },

        autoHeight : function () {
            var base = this,
                $currentimg = $(base.$owlItems[base.currentItem]).find("img"),
                iterations;

            function addHeight() {
                var $currentItem = $(base.$owlItems[base.currentItem]).height();
                base.wrapperOuter.css("height", $currentItem + "px");
                if (!base.wrapperOuter.hasClass("autoHeight")) {
                    window.setTimeout(function () {
                        base.wrapperOuter.addClass("autoHeight");
                    }, 0);
                }
            }

            function checkImage() {
                iterations += 1;
                if (base.completeImg($currentimg.get(0))) {
                    addHeight();
                } else if (iterations <= 100) { //if image loads in less than 10 seconds 
                    window.setTimeout(checkImage, 100);
                } else {
                    base.wrapperOuter.css("height", ""); //Else remove height attribute
                }
            }

            if ($currentimg.get(0) !== undefined) {
                iterations = 0;
                checkImage();
            } else {
                addHeight();
            }
        },

        completeImg : function (img) {
            var naturalWidthType;

            if (!img.complete) {
                return false;
            }
            naturalWidthType = typeof img.naturalWidth;
            if (naturalWidthType !== "undefined" && img.naturalWidth === 0) {
                return false;
            }
            return true;
        },

        onVisibleItems : function () {
            var base = this,
                i;
            if (base.options.addClassActive === true) {
                base.$owlItems.removeClass("active");
            }
            base.visibleItems = [];
            for (i = base.currentItem; i < base.currentItem + base.options.items; i += 1) {
                base.visibleItems.push(i);

                if (base.options.addClassActive === true) {
                    $(base.$owlItems[i]).addClass("active");
                }
            }
            base.owl.visibleItems = base.visibleItems;
            
        },

        transitionTypes : function (className) {
            var base = this;
            //Currently available: "fade", "backSlide", "goDown", "fadeUp"
            base.outClass = "owl-" + className + "-out";
            base.inClass = "owl-" + className + "-in";
        },

        singleItemTransition : function () {
            var base = this,
                outClass = base.outClass,
                inClass = base.inClass,
                $currentItem = base.$owlItems.eq(base.currentItem),
                $prevItem = base.$owlItems.eq(base.prevItem),
                prevPos = Math.abs(base.positionsInArray[base.currentItem]) + base.positionsInArray[base.prevItem],
                origin = Math.abs(base.positionsInArray[base.currentItem]) + base.itemWidth / 2,
                animEnd = 'webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend';

            base.isTransition = true;

            base.$owlWrapper
                .addClass('owl-origin')
                .css({
                    "-webkit-transform-origin" : origin + "px",
                    "-moz-perspective-origin" : origin + "px",
                    "perspective-origin" : origin + "px"
                });
            function transStyles(prevPos) {
                return {
                    "position" : "relative",
                    "left" : prevPos + "px"
                };
            }

            $prevItem
                .css(transStyles(prevPos, 10))
                .addClass(outClass)
                .on(animEnd, function () {
                    base.endPrev = true;
                    $prevItem.off(animEnd);
                    base.clearTransStyle($prevItem, outClass);
                });

            $currentItem
                .addClass(inClass)
                .on(animEnd, function () {
                    base.endCurrent = true;
                    $currentItem.off(animEnd);
                    base.clearTransStyle($currentItem, inClass);
                });
        },

        clearTransStyle : function (item, classToRemove) {
            var base = this;
            item.css({
                "position" : "",
                "left" : ""
            }).removeClass(classToRemove);

            if (base.endPrev && base.endCurrent) {
                base.$owlWrapper.removeClass('owl-origin');
                base.endPrev = false;
                base.endCurrent = false;
                base.isTransition = false;
            }
        },

        owlStatus : function () {
            var base = this;
            base.owl = {
                "userOptions"   : base.userOptions,
                "baseElement"   : base.$elem,
                "userItems"     : base.$userItems,
                "owlItems"      : base.$owlItems,
                "currentItem"   : base.currentItem,
                "prevItem"      : base.prevItem,
                "visibleItems"  : base.visibleItems,
                "isTouch"       : base.browser.isTouch,
                "browser"       : base.browser,
                "dragDirection" : base.dragDirection
            };
        },

        clearEvents : function () {
            var base = this;
            base.$elem.off(".owl owl mousedown.disableTextSelect");
            $(document).off(".owl owl");
            $(window).off("resize", base.resizer);
        },

        unWrap : function () {
            var base = this;
            if (base.$elem.children().length !== 0) {
                base.$owlWrapper.unwrap();
                base.$userItems.unwrap().unwrap();
                if (base.owlControls) {
                    base.owlControls.remove();
                }
            }
            base.clearEvents();
            base.$elem.attr({
                style: base.$elem.data("owl-originalStyles") || "",
                class: base.$elem.data("owl-originalClasses")
            });
        },

        destroy : function () {
            var base = this;
            base.stop();
            window.clearInterval(base.checkVisible);
            base.unWrap();
            base.$elem.removeData();
        },

        reinit : function (newOptions) {
            var base = this,
                options = $.extend({}, base.userOptions, newOptions);
            base.unWrap();
            base.init(options, base.$elem);
        },

        addItem : function (htmlString, targetPosition) {
            var base = this,
                position;

            if (!htmlString) {return false; }

            if (base.$elem.children().length === 0) {
                base.$elem.append(htmlString);
                base.setVars();
                return false;
            }
            base.unWrap();
            if (targetPosition === undefined || targetPosition === -1) {
                position = -1;
            } else {
                position = targetPosition;
            }
            if (position >= base.$userItems.length || position === -1) {
                base.$userItems.eq(-1).after(htmlString);
            } else {
                base.$userItems.eq(position).before(htmlString);
            }

            base.setVars();
        },

        removeItem : function (targetPosition) {
            var base = this,
                position;

            if (base.$elem.children().length === 0) {
                return false;
            }
            if (targetPosition === undefined || targetPosition === -1) {
                position = -1;
            } else {
                position = targetPosition;
            }

            base.unWrap();
            base.$userItems.eq(position).remove();
            base.setVars();
        }

    };

    $.fn.owlCarousel = function (options) {
        return this.each(function () {
            if ($(this).data("owl-init") === true) {
                return false;
            }
            $(this).data("owl-init", true);
            var carousel = Object.create(Carousel);
            carousel.init(options, this);
            $.data(this, "owlCarousel", carousel);
        });
    };

    $.fn.owlCarousel.options = {

        items : 5,
        itemsCustom : false,
        itemsDesktop : [1199, 4],
        itemsDesktopSmall : [979, 3],
        itemsTablet : [768, 2],
        itemsTabletSmall : false,
        itemsMobile : [479, 1],
        singleItem : false,
        itemsScaleUp : false,

        slideSpeed : 200,
        paginationSpeed : 800,
        rewindSpeed : 1000,

        autoPlay : false,
        stopOnHover : false,
        stopOnFocus : false,

        navigation : false,
        navigationText : ["prev","next"],
        rewindNav : true,
        scrollPerPage : false,
        
        pause : false,
        pauseText : ["pause"],
        
        pagination : true,
        paginationNumbers : false,
        currentslideText : "Current Slide",
        setpaginationtab: false,/* to set tabindex on pagination elems */

        responsive : true,
        responsiveRefreshRate : 200,
        responsiveBaseWidth : window,

        baseClass : "owl-carousel",
        theme : "owl-theme",

        lazyLoad : false,
        lazyFollow : true,
        lazyEffect : "fade",

        autoHeight : false,

        jsonPath : false,
        jsonSuccess : false,

        dragBeforeAnimFinish : true,
        mouseDrag : true,
        touchDrag : true,
        dragging: true,

        addClassActive : false,
        transitionStyle : false,

        beforeUpdate : false,
        afterUpdate : false,
        beforeInit : false,
        afterInit : false,
        beforeMove : false,
        afterMove : false,
        afterAction : false,
        startDragging : false,
        afterLazyLoad: false,
        
        paginationWrapper: "<div class=\"owl-pagination\"/>"
    };
}(jQuery, window, document));

/*
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(a){var r=a.fn.domManip,d="_tmplitem",q=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,b={},f={},e,p={key:0,data:{}},i=0,c=0,l=[];function g(g,d,h,e){var c={data:e||(e===0||e===false)?e:d?d.data:{},_wrap:d?d._wrap:null,tmpl:null,parent:d||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};g&&a.extend(c,g,{nodes:[],parent:d});if(h){c.tmpl=h;c._ctnt=c._ctnt||c.tmpl(a,c);c.key=++i;(l.length?f:b)[i]=c}return c}a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,d){a.fn[f]=function(n){var g=[],i=a(n),k,h,m,l,j=this.length===1&&this[0].parentNode;e=b||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&i.length===1){i[d](this[0]);g=this}else{for(h=0,m=i.length;h<m;h++){c=h;k=(h>0?this.clone(true):this).get();a(i[h])[d](k);g=g.concat(k)}c=0;g=this.pushStack(g,f,i.selector)}l=e;e=null;a.tmpl.complete(l);return g}});a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,m,k){if(d[0]&&a.isArray(d[0])){var g=a.makeArray(arguments),h=d[0],j=h.length,i=0,f;while(i<j&&!(f=a.data(h[i++],"tmplItem")));if(f&&c)g[2]=function(b){a.tmpl.afterManip(this,b,k)};r.apply(this,g)}else r.apply(this,arguments);c=0;!e&&a.tmpl.complete(b);return this}});a.extend({tmpl:function(d,h,e,c){var i,k=!c;if(k){c=p;d=a.template[d]||a.template(null,d);f={}}else if(!d){d=c.tmpl;b[c.key]=c;c.nodes=[];c.wrapped&&n(c,c.wrapped);return a(j(c,null,c.tmpl(a,c)))}if(!d)return[];if(typeof h==="function")h=h.call(c||{});e&&e.wrapped&&n(e,e.wrapped);i=a.isArray(h)?a.map(h,function(a){return a?g(e,c,d,a):null}):[g(e,c,d,h)];return k?a(j(c,null,i)):i},tmplItem:function(b){var c;if(b instanceof a)b=b[0];while(b&&b.nodeType===1&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode));return c||p},template:function(c,b){if(b){if(typeof b==="string")b=o(b);else if(b instanceof a)b=b[0]||{};if(b.nodeType)b=a.data(b,"tmpl")||a.data(b,"tmpl",o(b.innerHTML));return typeof c==="string"?(a.template[c]=b):b}return c?typeof c!=="string"?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){b={}},afterManip:function(f,b,d){var e=b.nodeType===11?a.makeArray(b.childNodes):b.nodeType===1?[b]:[];d.call(f,b);m(e);c++}});function j(e,g,f){var b,c=f?a.map(f,function(a){return typeof a==="string"?e.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+d+'="'+e.key+'" $2'):a:j(a,e,a._ctnt)}):e;if(g)return c;c=c.join("");c.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(f,c,e,d){b=a(e).get();m(b);if(c)b=k(c).concat(b);if(d)b=b.concat(k(d))});return b?b:k(c)}function k(c){var b=document.createElement("div");b.innerHTML=c;return a.makeArray(b.childNodes)}function o(b){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(m,l,k,g,b,c,d){var j=a.tmpl.tag[k],i,e,f;if(!j)throw"Unknown template tag: "+k;i=j._default||[];if(c&&!/\w$/.test(b)){b+=c;c=""}if(b){b=h(b);d=d?","+h(d)+")":c?")":"";e=c?b.indexOf(".")>-1?b+h(c):"("+b+").call($item"+d:b;f=c?e:"(typeof("+b+")==='function'?("+b+").call($item):("+b+"))"}else f=e=i.$1||"null";g=h(g);return"');"+j[l?"close":"open"].split("$notnull_1").join(b?"typeof("+b+")!=='undefined' && ("+b+")!=null":"true").split("$1a").join(f).split("$1").join(e).split("$2").join(g||i.$2||"")+"__.push('"})+"');}return __;")}function n(c,b){c._wrap=j(c,true,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join("")}function h(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(b){var a=document.createElement("div");a.appendChild(b.cloneNode(true));return a.innerHTML}function m(o){var n="_"+c,k,j,l={},e,p,h;for(e=0,p=o.length;e<p;e++){if((k=o[e]).nodeType!==1)continue;j=k.getElementsByTagName("*");for(h=j.length-1;h>=0;h--)m(j[h]);m(k)}function m(j){var p,h=j,k,e,m;if(m=j.getAttribute(d)){while(h.parentNode&&(h=h.parentNode).nodeType===1&&!(p=h.getAttribute(d)));if(p!==m){h=h.parentNode?h.nodeType===11?0:h.getAttribute(d)||0:0;if(!(e=b[m])){e=f[m];e=g(e,b[h]||f[h]);e.key=++i;b[i]=e}c&&o(m)}j.removeAttribute(d)}else if(c&&(e=a.data(j,"tmplItem"))){o(e.key);b[e.key]=e;h=a.data(j.parentNode,"tmplItem");h=h?h.key:0}if(e){k=e;while(k&&k.key!=h){k.nodes.push(j);k=k.parent}delete e._ctnt;delete e._wrap;a.data(j,"tmplItem",e)}function o(a){a=a+n;e=l[a]=l[a]||g(e,b[e.parent.key+n]||e.parent)}}}function u(a,d,c,b){if(!a)return l.pop();l.push({_:a,tmpl:d,item:this,data:c,options:b})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};c.wrapped=d;return a.tmpl(a.template(b.tmpl),b.data,c,b.item)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(""):b).filter(d||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}})(jQuery);
/*
 * Cookie plugin
 *
 * Copyright (c) 2006 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */

jQuery.cookie=function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};

/*
 * Currency tools
 *
 * Copyright (c) 2013 Caroline Schnapp (mllegeorgesand@gmail.com)
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 *
 */

if(typeof Currency==="undefined"){var Currency={}}Currency.cookie={configuration:{expires:365,path:"/",domain:window.location.hostname},name:"currency",write:function(a){jQuery.cookie(this.name,a,this.configuration)},read:function(){return jQuery.cookie(this.name)},destroy:function(){jQuery.cookie(this.name,null,this.configuration)}};Currency.money_with_currency_format={USD:"${{amount}} USD",EUR:"&euro;{{amount}} EUR",GBP:"&pound;{{amount}} GBP",CAD:"${{amount}} CAD",ARS:"${{amount_with_comma_separator}} ARS",AUD:"${{amount}} AUD",BBD:"${{amount}} Bds",BDT:"Tk {{amount}} BDT",BSD:"BS${{amount}} BSD",BHD:"{{amount}}0 BHD",BRL:"R$ {{amount_with_comma_separator}} BRL",BOB:"Bs{{amount_with_comma_separator}} BOB",BND:"${{amount}} BND",BGN:"{{amount}}  BGN",MMK:"K{{amount}} MMK",KYD:"${{amount}} KYD",CLP:"${{amount_no_decimals}} CLP",CNY:"&#165;{{amount}} CNY",COP:"${{amount_with_comma_separator}} COP",CRC:"&#8353; {{amount_with_comma_separator}} CRC",HRK:"{{amount_with_comma_separator}} kn HRK",CZK:"{{amount_with_comma_separator}} K&#269;",DKK:"kr.{{amount_with_comma_separator}}",DOP:"RD$ {{amount_with_comma_separator}}",XCD:"EC${{amount}}",EGP:"LE {{amount}} EGP",XPF:"{{amount_no_decimals_with_space_separator}}} XPF",FJD:"FJ${{amount}}",GHS:"GH&#8373;{{amount}}",GTQ:"{{amount}} GTQ",GYD:"${{amount}} GYD",GEL:"{{amount}} GEL",HKD:"HK${{amount}}",HUF:"{{amount_no_decimals_with_comma_separator}} Ft",ISK:"{{amount_no_decimals}} kr ISK",INR:"Rs.{{amount}}",IDR:"Rp {{amount_with_comma_separator}}",NIS:"{{amount}} NIS",JMD:"${{amount}} JMD",JPY:"&#165;{{amount_no_decimals}} JPY",JOD:"{{amount}}0 JOD",KZT:"{{amount}} KZT",KES:"KSh{{amount}}",KWD:"{{amount}}0 KWD",LVL:"Ls {{amount}} LVL",LTL:"{{amount}} Lt",MXN:"$ {{amount}} MXN",MYR:"RM{{amount}} MYR",MUR:"Rs {{amount}} MUR",MDL:"{{amount}} MDL",MAD:"Dh {{amount}} MAD",MNT:"{{amount_no_decimals}} MNT",MZN:"Mt {{amount}} MZN",ANG:"{{amount}} NA&fnof;",NZD:"${{amount}} NZD",NGN:"&#8358;{{amount}} NGN",NOK:"kr {{amount_with_comma_separator}} NOK",OMR:"{{amount_with_comma_separator}} OMR",PKR:"Rs.{{amount}} PKR",PYG:"Gs. {{amount_no_decimals_with_comma_separator}} PYG",PEN:"S/. {{amount}} PEN",PHP:"&#8369;{{amount}} PHP",PLN:"{{amount_with_comma_separator}} zl PLN",QAR:"QAR {{amount_with_comma_separator}}",RON:"{{amount_with_comma_separator}} lei RON",RUB:"&#1088;&#1091;&#1073;{{amount_with_comma_separator}} RUB",SAR:"{{amount}} SAR",RSD:"{{amount}} RSD",SCR:"Rs {{amount}} SCR",SGD:"${{amount}} SGD",SYP:"S&pound;{{amount}} SYP",ZAR:"R {{amount}} ZAR",KRW:"&#8361;{{amount_no_decimals}} KRW",LKR:"Rs {{amount}} LKR",SEK:"{{amount_no_decimals}} kr SEK",CHF:"SFr. {{amount}} CHF",TWD:"${{amount}} TWD",THB:"{{amount}} &#xe3f; THB",TZS:"{{amount}} TZS",TTD:"${{amount}} TTD",TRY:"{{amount}}TL",UAH:"{{amount}} UAH",AED:"Dhs. {{amount}} AED",UYU:"${{amount_with_comma_separator}} UYU",VEB:"Bs. {{amount_with_comma_separator}} VEB",VND:"{{amount_no_decimals_with_comma_separator}} VND",ZMK:"ZMK{{amount_no_decimals_with_comma_separator}}"};Currency.money_format={USD:"${{amount}}",EUR:"&euro;{{amount}}",GBP:"&pound;{{amount}}",CAD:"${{amount}}",ARS:"${{amount_with_comma_separator}}",AUD:"${{amount}}",BBD:"${{amount}}",BDT:"Tk {{amount}}",BSD:"BS${{amount}}",BHD:"{{amount}}0 BHD",BRL:"R$ {{amount_with_comma_separator}}",BOB:"Bs{{amount_with_comma_separator}}",BND:"${{amount}}",BGN:"{{amount}} ",MMK:"K{{amount}}",KYD:"${{amount}}",CLP:"${{amount_no_decimals}}",CNY:"&#165;{{amount}}",COP:"${{amount_with_comma_separator}}",CRC:"&#8353; {{amount_with_comma_separator}}",HRK:"{{amount_with_comma_separator}} kn",CZK:"{{amount_with_comma_separator}} K&#269;",DKK:"{{amount_with_comma_separator}}",DOP:"RD$ {{amount_with_comma_separator}}",XCD:"${{amount}}",EGP:"LE {{amount}}",XPF:"{{amount_no_decimals_with_space_separator}}} XPF",FJD:"${{amount}}",GHS:"GH&#8373;{{amount}}",GTQ:"{{amount}}",GYD:"${{amount}}",GEL:"{{amount}} GEL",HKD:"${{amount}}",HUF:"{{amount_no_decimals_with_comma_separator}}",ISK:"{{amount_no_decimals}} kr",INR:"{{amount}}",IDR:"{{amount_with_comma_separator}}",NIS:"{{amount}} NIS",JMD:"${{amount}}",JPY:"&#165;{{amount_no_decimals}}",JOD:"{{amount}}0 JD",KZT:"{{amount}} KZT",KES:"KSh{{amount}}",KWD:"{{amount}}0 KD",LVL:"Ls {{amount}}",LTL:"{{amount}} Lt",MXN:"$ {{amount}}",MYR:"RM{{amount}} MYR",MUR:"Rs {{amount}}",MDL:"{{amount}} MDL",MAD:"{{amount}} dh",MNT:"{{amount_no_decimals}} &#8366",MZN:"{{amount}} Mt",ANG:"&fnof;{{amount}}",NZD:"${{amount}}",NGN:"&#8358;{{amount}}",NOK:"kr {{amount_with_comma_separator}}",OMR:"{{amount_with_comma_separator}} OMR",PKR:"Rs.{{amount}}",PYG:"Gs. {{amount_no_decimals_with_comma_separator}}",PEN:"S/. {{amount}}",PHP:"&#8369;{{amount}}",PLN:"{{amount_with_comma_separator}} zl",QAR:"QAR {{amount_with_comma_separator}}",RON:"{{amount_with_comma_separator}} lei",RUB:"&#1088;&#1091;&#1073;{{amount_with_comma_separator}}",SAR:"{{amount}} SR",RSD:"{{amount}} RSD",SCR:"Rs {{amount}}",SGD:"${{amount}}",SYP:"S&pound;{{amount}}",ZAR:"R {{amount}}",KRW:"&#8361;{{amount_no_decimals}}",LKR:"Rs {{amount}}",SEK:"{{amount_no_decimals}} kr",CHF:"SFr. {{amount}}",TWD:"${{amount}}",THB:"{{amount}} &#xe3f;",TZS:"{{amount}} TZS",TTD:"${{amount}}",TRY:"{{amount}}TL",UAH:"{{amount}}",AED:"Dhs. {{amount}}",UYU:"${{amount_with_comma_separator}}",VEB:"Bs. {{amount_with_comma_separator}}",VND:"{{amount_no_decimals_with_comma_separator}}",ZMK:"K{{amount_no_decimals_with_comma_separator}}"};Currency.formatMoney=function(b,f){if(typeof b=="string"){b=b.replace(".","")}var e="";var d=/\{\{\s*(\w+)\s*\}\}/;var a=(f||this.money_format);function c(g){return g.replace(/(\d+)(\d{3}[\.,]?)/,"$1,$2")}switch(a.match(d)[1]){case"amount":e=c(floatToString(b/100,2));break;case"amount_no_decimals":e=c(floatToString(b/100,0));break;case"amount_with_comma_separator":e=floatToString(b/100,2).replace(/\./,",");break;case"amount_no_decimals_with_comma_separator":e=c(floatToString(b/100,0)).replace(/\./,",");break}return a.replace(d,e)};function floatToString(c,a){var b=c.toFixed(a).toString();if(b.match(/^\.\d+/)){return"0"+b}else{return b}}Currency.currentCurrency="";Currency.format="money_with_currency_format";Currency.convertAll=function(c,b,a,d){jQuery(a||"span.money").each(function(){if(jQuery(this).attr("data-currency")===b){return}if(jQuery(this).attr("data-currency-"+b)){jQuery(this).html(jQuery(this).attr("data-currency-"+b))}else{var e=0;var f=Currency[d||Currency.format][c]||"{{amount}}";var g=Currency[d||Currency.format][b]||"{{amount}}";if(f.indexOf("amount_no_decimals")!==-1){e=Currency.convert(parseInt(jQuery(this).html().replace(/[^0-9]/g,""),10)*100,c,b)}else{e=Currency.convert(parseInt(jQuery(this).html().replace(/[^0-9]/g,""),10),c,b)}var h=Currency.formatMoney(e,g);jQuery(this).html(h);jQuery(this).attr("data-currency-"+b,h)}jQuery(this).attr("data-currency",b)});this.currentCurrency=b;this.cookie.write(b)};
/*!
 * jquery-timepicker v1.11.11 - A jQuery timepicker plugin inspired by Google Calendar. It supports both mouse and keyboard navigation.
 * Copyright (c) 2015 Jon Thornton - http://jonthornton.github.com/jquery-timepicker/
 * License: MIT
 */


(function (factory) {
    if (typeof exports === "object" && exports &&
        typeof module === "object" && module && module.exports === exports) {
        // Browserify. Attach to jQuery module.
        factory(require("jquery"));
    } else if (typeof define === 'function' && define.amd) {
		// AMD. Register as an anonymous module.
		define(['jquery'], factory);
	} else {
		// Browser globals
		factory(jQuery);
	}
}(function ($) {
	var _ONE_DAY = 86400;
	var _lang = {
		am: 'am',
		pm: 'pm',
		AM: 'AM',
		PM: 'PM',
		decimal: '.',
		mins: 'mins',
		hr: 'hr',
		hrs: 'hrs'
	};

	var _DEFAULTS = {
		appendTo: 'body',
		className: null,
		closeOnWindowScroll: false,
		disableTextInput: false,
		disableTimeRanges: [],
		disableTouchKeyboard: false,
		durationTime: null,
		forceRoundTime: false,
		maxTime: null,
		minTime: null,
		noneOption: false,
		orientation: 'l',
		roundingFunction: function(seconds, settings) {
			if (seconds === null) {
				return null;
			} else if (typeof settings.step !== "number") {
				// TODO: nearest fit irregular steps
				return seconds;
			} else {
				var offset = seconds % (settings.step*60); // step is in minutes

				var start = settings.minTime || 0;

                // adjust offset by start mod step so that the offset is aligned not to 00:00 but to the start
                offset -= start % (settings.step * 60);

				if (offset >= settings.step*30) {
					// if offset is larger than a half step, round up
					seconds += (settings.step*60) - offset;
				} else {
					// round down
					seconds -= offset;
				}

				return _moduloSeconds(seconds, settings);
			}
		},
		scrollDefault: null,
		selectOnBlur: false,
		show2400: false,
		showDuration: false,
		showOn: ['click', 'focus'],
		showOnFocus: true,
		step: 30,
		stopScrollPropagation: false,
		timeFormat: 'g:ia',
		typeaheadHighlight: true,
		useSelect: false,
		wrapHours: true
	};

	var methods = {
		init: function(options)
		{
			return this.each(function()
			{
				var self = $(this);

				// pick up settings from data attributes
				var attributeOptions = [];
				for (var key in _DEFAULTS) {
					if (self.data(key))  {
						attributeOptions[key] = self.data(key);
					}
				}

				var settings = $.extend({}, _DEFAULTS, options, attributeOptions);

				if (settings.lang) {
					_lang = $.extend(_lang, settings.lang);
				}

				settings = _parseSettings(settings);
				self.data('timepicker-settings', settings);
				self.addClass('ui-timepicker-input');

				if (settings.useSelect) {
					_render(self);
				} else {
					self.prop('autocomplete', 'off');
					if (settings.showOn) {
						for (var i in settings.showOn) {
							self.on(settings.showOn[i]+'.timepicker', methods.show);
						}
					}
					self.on('change.timepicker', _formatValue);
					self.on('keydown.timepicker', _keydownhandler);
					self.on('keyup.timepicker', _keyuphandler);
					if (settings.disableTextInput) {
						self.on('keydown.timepicker', _disableTextInputHandler);
					}
                    			self.on('cut.timepicker', _keyuphandler);
                    			self.on('paste.timepicker', _keyuphandler);

					_formatValue.call(self.get(0), null, 'initial');
				}
			});
		},

		show: function(e)
		{
			var self = $(this);
			var settings = self.data('timepicker-settings');

			if (e) {
				e.preventDefault();
			}

			if (settings.useSelect) {
				self.data('timepicker-list').focus();
				return;
			}

			if (_hideKeyboard(self)) {
				// block the keyboard on mobile devices
				self.blur();
			}

			var list = self.data('timepicker-list');

			// check if input is readonly
			if (self.prop('readonly')) {
				return;
			}

			// check if list needs to be rendered
			if (!list || list.length === 0 || typeof settings.durationTime === 'function') {
				_render(self);
				list = self.data('timepicker-list');
			}

			if (_isVisible(list)) {
				return;
			}

			self.data('ui-timepicker-value', self.val());
			_setSelected(self, list);

			// make sure other pickers are hidden
			methods.hide();

			// position the dropdown relative to the input
			list.show();
			var listOffset = {};

			if (settings.orientation.match(/r/)) {
				// right-align the dropdown
				listOffset.left = self.offset().left + self.outerWidth() - list.outerWidth() + parseInt(list.css('marginLeft').replace('px', ''), 10);
			} else {
				// left-align the dropdown
				listOffset.left = self.offset().left + parseInt(list.css('marginLeft').replace('px', ''), 10);
			}

			var verticalOrientation;
			if (settings.orientation.match(/t/)) {
				verticalOrientation = 't';
			} else if (settings.orientation.match(/b/)) {
				verticalOrientation = 'b';
			} else if ((self.offset().top + self.outerHeight(true) + list.outerHeight()) > $(window).height() + $(window).scrollTop()) {
				verticalOrientation = 't';
			} else {
				verticalOrientation = 'b';
			}

			if (verticalOrientation == 't') {
				// position the dropdown on top
				list.addClass('ui-timepicker-positioned-top');
				listOffset.top = self.offset().top - list.outerHeight() + parseInt(list.css('marginTop').replace('px', ''), 10);
			} else {
				// put it under the input
				list.removeClass('ui-timepicker-positioned-top');
				listOffset.top = self.offset().top + self.outerHeight() + parseInt(list.css('marginTop').replace('px', ''), 10);
			}

			list.offset(listOffset);

			// position scrolling
			var selected = list.find('.ui-timepicker-selected');

			if (!selected.length) {
				var timeInt = _time2int(_getTimeValue(self));
				if (timeInt !== null) {
					selected = _findRow(self, list, timeInt);
				} else if (settings.scrollDefault) {
					selected = _findRow(self, list, settings.scrollDefault());
				}
			}

			// if not found or disabled, intelligently find first selectable element
			if (!selected.length || selected.hasClass('ui-timepicker-disabled')) {
				selected = list.find('li:not(.ui-timepicker-disabled):first');
			}

			if (selected && selected.length) {
				var topOffset = list.scrollTop() + selected.position().top - selected.outerHeight();
				list.scrollTop(topOffset);
			} else {
				list.scrollTop(0);
			}

			// prevent scroll propagation
			if(settings.stopScrollPropagation) {
				$(document).on('wheel.ui-timepicker', '.ui-timepicker-wrapper', function(e){
					e.preventDefault();
					var currentScroll = $(this).scrollTop();
					$(this).scrollTop(currentScroll + e.originalEvent.deltaY);
				});
			}

			// attach close handlers
			$(document).on('touchstart.ui-timepicker mousedown.ui-timepicker', _closeHandler);
			$(window).on('resize.ui-timepicker', _closeHandler);
			if (settings.closeOnWindowScroll) {
				$(document).on('scroll.ui-timepicker', _closeHandler);
			}

			self.trigger('showTimepicker');

			return this;
		},

		hide: function(e)
		{
			var self = $(this);
			var settings = self.data('timepicker-settings');

			if (settings && settings.useSelect) {
				self.blur();
			}

			$('.ui-timepicker-wrapper').each(function() {
				var list = $(this);
				if (!_isVisible(list)) {
					return;
				}

				var self = list.data('timepicker-input');
				var settings = self.data('timepicker-settings');

				if (settings && settings.selectOnBlur) {
					_selectValue(self);
				}

				list.hide();
				self.trigger('hideTimepicker');
			});

			return this;
		},

		option: function(key, value)
		{
			if (typeof key == 'string' && typeof value == 'undefined') {
				return $(this).data('timepicker-settings')[key];
			}

			return this.each(function(){
				var self = $(this);
				var settings = self.data('timepicker-settings');
				var list = self.data('timepicker-list');

				if (typeof key == 'object') {
					settings = $.extend(settings, key);
				} else if (typeof key == 'string') {
					settings[key] = value;
				}

				settings = _parseSettings(settings);

				self.data('timepicker-settings', settings);

				_formatValue.call(self.get(0), {'type':'change'}, 'initial');

				if (list) {
					list.remove();
					self.data('timepicker-list', false);
				}

				if (settings.useSelect) {
					_render(self);
				}
			});
		},

		getSecondsFromMidnight: function()
		{
			return _time2int(_getTimeValue(this));
		},

		getTime: function(relative_date)
		{
			var self = this;

			var time_string = _getTimeValue(self);
			if (!time_string) {
				return null;
			}

			var offset = _time2int(time_string);
			if (offset === null) {
				return null;
			}

			if (!relative_date) {
				relative_date = new Date();
			}

			// construct a Date from relative date, and offset's time
			var time = new Date(relative_date);
			time.setHours(offset / 3600);
			time.setMinutes(offset % 3600 / 60);
			time.setSeconds(offset % 60);
			time.setMilliseconds(0);

			return time;
		},

		isVisible: function() {
			var self = this;
			var list = self.data('timepicker-list');
			return !!(list && _isVisible(list));
		},

		setTime: function(value)
		{
			var self = this;
			var settings = self.data('timepicker-settings');

			if (settings.forceRoundTime) {
				var prettyTime = _roundAndFormatTime(_time2int(value), settings)
			} else {
				var prettyTime = _int2time(_time2int(value), settings);
			}

			if (value && prettyTime === null && settings.noneOption) {
				prettyTime = value;
			}

			self.val(prettyTime);
			_formatValue.call(self.get(0), {'type':'change'}, 'initial');

			if (self.data('timepicker-list')) {
				_setSelected(self, self.data('timepicker-list'));
			}

			return this;
		},

		remove: function()
		{
			var self = this;

			// check if this element is a timepicker
			if (!self.hasClass('ui-timepicker-input')) {
				return;
			}

			var settings = self.data('timepicker-settings');
			self.removeAttr('autocomplete', 'off');
			self.removeClass('ui-timepicker-input');
			self.removeData('timepicker-settings');
			self.off('.timepicker');

			// timepicker-list won't be present unless the user has interacted with this timepicker
			if (self.data('timepicker-list')) {
				self.data('timepicker-list').remove();
			}

			if (settings.useSelect) {
				self.show();
			}

			self.removeData('timepicker-list');

			return this;
		}
	};

	// private methods

	function _isVisible(elem)
	{
		var el = elem[0];
		return el.offsetWidth > 0 && el.offsetHeight > 0;
	}

	function _parseSettings(settings)
	{
		if (settings.minTime) {
			settings.minTime = _time2int(settings.minTime);
		}

		if (settings.maxTime) {
			settings.maxTime = _time2int(settings.maxTime);
		}

		if (settings.durationTime && typeof settings.durationTime !== 'function') {
			settings.durationTime = _time2int(settings.durationTime);
		}

		if (settings.scrollDefault == 'now') {
			settings.scrollDefault = function() {
				return settings.roundingFunction(_time2int(new Date()), settings);
			}
		} else if (settings.scrollDefault && typeof settings.scrollDefault != 'function') {
			var val = settings.scrollDefault;
			settings.scrollDefault = function() {
				return settings.roundingFunction(_time2int(val), settings);
			}
		} else if (settings.minTime) {
			settings.scrollDefault = function() {
				return settings.roundingFunction(settings.minTime, settings);
			}
		}

		if ($.type(settings.timeFormat) === "string" && settings.timeFormat.match(/[gh]/)) {
			settings._twelveHourTime = true;
		}

		if (settings.showOnFocus === false && settings.showOn.indexOf('focus') != -1) {
			settings.showOn.splice(settings.showOn.indexOf('focus'), 1);
		}

		if (settings.disableTimeRanges.length > 0) {
			// convert string times to integers
			for (var i in settings.disableTimeRanges) {
				settings.disableTimeRanges[i] = [
					_time2int(settings.disableTimeRanges[i][0]),
					_time2int(settings.disableTimeRanges[i][1])
				];
			}

			// sort by starting time
			settings.disableTimeRanges = settings.disableTimeRanges.sort(function(a, b){
				return a[0] - b[0];
			});

			// merge any overlapping ranges
			for (var i = settings.disableTimeRanges.length-1; i > 0; i--) {
				if (settings.disableTimeRanges[i][0] <= settings.disableTimeRanges[i-1][1]) {
					settings.disableTimeRanges[i-1] = [
						Math.min(settings.disableTimeRanges[i][0], settings.disableTimeRanges[i-1][0]),
						Math.max(settings.disableTimeRanges[i][1], settings.disableTimeRanges[i-1][1])
					];
					settings.disableTimeRanges.splice(i, 1);
				}
			}
		}

		return settings;
	}

	function _render(self)
	{
		var settings = self.data('timepicker-settings');
		var list = self.data('timepicker-list');

		if (list && list.length) {
			list.remove();
			self.data('timepicker-list', false);
		}

		if (settings.useSelect) {
			list = $('<select />', { 'class': 'ui-timepicker-select' });
			var wrapped_list = list;
		} else {
			list = $('<ul />', { 'class': 'ui-timepicker-list' });

			var wrapped_list = $('<div />', { 'class': 'ui-timepicker-wrapper', 'tabindex': -1 });
			wrapped_list.css({'display':'none', 'position': 'absolute' }).append(list);
		}

		if (settings.noneOption) {
			if (settings.noneOption === true) {
				settings.noneOption = (settings.useSelect) ? 'Time...' : 'None';
			}

			if ($.isArray(settings.noneOption)) {
				for (var i in settings.noneOption) {
					if (parseInt(i, 10) == i){
						var noneElement = _generateNoneElement(settings.noneOption[i], settings.useSelect);
						list.append(noneElement);
					}
				}
			} else {
				var noneElement = _generateNoneElement(settings.noneOption, settings.useSelect);
				list.append(noneElement);
			}
		}

		if (settings.className) {
			wrapped_list.addClass(settings.className);
		}

		if ((settings.minTime !== null || settings.durationTime !== null) && settings.showDuration) {
			var stepval = typeof settings.step == 'function' ? 'function' : settings.step;
			wrapped_list.addClass('ui-timepicker-with-duration');
			wrapped_list.addClass('ui-timepicker-step-'+settings.step);
		}

		var durStart = settings.minTime;
		if (typeof settings.durationTime === 'function') {
			durStart = _time2int(settings.durationTime());
		} else if (settings.durationTime !== null) {
			durStart = settings.durationTime;
		}
		var start = (settings.minTime !== null) ? settings.minTime : 0;
		var end = (settings.maxTime !== null) ? settings.maxTime : (start + _ONE_DAY - 1);

		if (end < start) {
			// make sure the end time is greater than start time, otherwise there will be no list to show
			end += _ONE_DAY;
		}

		if (end === _ONE_DAY-1 && $.type(settings.timeFormat) === "string" && settings.show2400) {
			// show a 24:00 option when using military time
			end = _ONE_DAY;
		}

		var dr = settings.disableTimeRanges;
		var drCur = 0;
		var drLen = dr.length;

		var stepFunc = settings.step;
		if (typeof stepFunc != 'function') {
			stepFunc = function() {
				return settings.step;
			}
		}

		for (var i=start, j=0; i <= end; j++, i += stepFunc(j)*60) {
			var timeInt = i;
			var timeString = _int2time(timeInt, settings);

			if (settings.useSelect) {
				var row = $('<option />', { 'value': timeString });
				row.text(timeString);
			} else {
				var row = $('<li />');
				row.addClass((timeInt % _ONE_DAY) < (_ONE_DAY / 2) ? 'ui-timepicker-am' : 'ui-timepicker-pm');
				row.data('time', _moduloSeconds(timeInt, settings));
				row.text(timeString);
			}

			if ((settings.minTime !== null || settings.durationTime !== null) && settings.showDuration) {
				var durationString = _int2duration(i - durStart, settings.step);
				if (settings.useSelect) {
					row.text(row.text()+' ('+durationString+')');
				} else {
					var duration = $('<span />', { 'class': 'ui-timepicker-duration' });
					duration.text(' ('+durationString+')');
					row.append(duration);
				}
			}

			if (drCur < drLen) {
				if (timeInt >= dr[drCur][1]) {
					drCur += 1;
				}

				if (dr[drCur] && timeInt >= dr[drCur][0] && timeInt < dr[drCur][1]) {
					if (settings.useSelect) {
						row.prop('disabled', true);
					} else {
						row.addClass('ui-timepicker-disabled');
					}
				}
			}

			list.append(row);
		}

		wrapped_list.data('timepicker-input', self);
		self.data('timepicker-list', wrapped_list);

		if (settings.useSelect) {
			if (self.val()) {
				list.val(_roundAndFormatTime(_time2int(self.val()), settings));
			}

			list.on('focus', function(){
				$(this).data('timepicker-input').trigger('showTimepicker');
			});
			list.on('blur', function(){
				$(this).data('timepicker-input').trigger('hideTimepicker');
			});
			list.on('change', function(){
				_setTimeValue(self, $(this).val(), 'select');
			});

			_setTimeValue(self, list.val(), 'initial');
			self.hide().after(list);
		} else {
			var appendTo = settings.appendTo;
			if (typeof appendTo === 'string') {
				appendTo = $(appendTo);
			} else if (typeof appendTo === 'function') {
				appendTo = appendTo(self);
			}
			appendTo.append(wrapped_list);
			_setSelected(self, list);

			list.on('mousedown click', 'li', function(e) {

				// hack: temporarily disable the focus handler
				// to deal with the fact that IE fires 'focus'
				// events asynchronously
				self.off('focus.timepicker');
				self.on('focus.timepicker-ie-hack', function(){
					self.off('focus.timepicker-ie-hack');
					self.on('focus.timepicker', methods.show);
				});

				if (!_hideKeyboard(self)) {
					self[0].focus();
				}

				// make sure only the clicked row is selected
				list.find('li').removeClass('ui-timepicker-selected');
				$(this).addClass('ui-timepicker-selected');

				if (_selectValue(self)) {
					self.trigger('hideTimepicker');

					list.on('mouseup.timepicker click.timepicker', 'li', function(e) {
						list.off('mouseup.timepicker click.timepicker');
						wrapped_list.hide();
					});
				}
			});
		}
	}

	function _generateNoneElement(optionValue, useSelect)
	{
		var label, className, value;

		if (typeof optionValue == 'object') {
			label = optionValue.label;
			className = optionValue.className;
			value = optionValue.value;
		} else if (typeof optionValue == 'string') {
			label = optionValue;
		} else {
			$.error('Invalid noneOption value');
		}

		if (useSelect) {
			return $('<option />', {
					'value': value,
					'class': className,
					'text': label
				});
		} else {
			return $('<li />', {
					'class': className,
					'text': label
				}).data('time', String(value));
		}
	}

	function _roundAndFormatTime(seconds, settings)
	{
		seconds = settings.roundingFunction(seconds, settings);
		if (seconds !== null) {
			return _int2time(seconds, settings);
		}
	}

	// event handler to decide whether to close timepicker
	function _closeHandler(e)
	{
		if (e.target == window) {
			// mobile Chrome fires focus events against window for some reason
			return;
		}

		var target = $(e.target);

		if (target.closest('.ui-timepicker-input').length || target.closest('.ui-timepicker-wrapper').length) {
			// active timepicker was focused. ignore
			return;
		}

		methods.hide();
		$(document).unbind('.ui-timepicker');
		$(window).unbind('.ui-timepicker');
	}

	function _hideKeyboard(self)
	{
		var settings = self.data('timepicker-settings');
		return ((window.navigator.msMaxTouchPoints || 'ontouchstart' in document) && settings.disableTouchKeyboard);
	}

	function _findRow(self, list, value)
	{
		if (!value && value !== 0) {
			return false;
		}

		var settings = self.data('timepicker-settings');
		var out = false;
		var value = settings.roundingFunction(value, settings);

		// loop through the menu items
		list.find('li').each(function(i, obj) {
			var jObj = $(obj);
			if (typeof jObj.data('time') != 'number') {
				return;
			}

			if (jObj.data('time') == value) {
				out = jObj;
				return false;
			}
		});

		return out;
	}

	function _setSelected(self, list)
	{
		list.find('li').removeClass('ui-timepicker-selected');

		var settings = self.data('timepicker-settings');
		var timeValue = _time2int(_getTimeValue(self), settings);
		if (timeValue === null) {
			return;
		}

		var selected = _findRow(self, list, timeValue);
		if (selected) {

			var topDelta = selected.offset().top - list.offset().top;

			if (topDelta + selected.outerHeight() > list.outerHeight() || topDelta < 0) {
				list.scrollTop(list.scrollTop() + selected.position().top - selected.outerHeight());
			}

			if (settings.forceRoundTime || selected.data('time') === timeValue) {
				selected.addClass('ui-timepicker-selected');
			}
		}
	}


	function _formatValue(e, origin)
	{
		if (origin == 'timepicker') {
			return;
		}

		var self = $(this);

		if (this.value === '') {
			_setTimeValue(self, null, origin);
			return;
		}

		if (self.is(':focus') && (!e || e.type != 'change')) {
			return;
		}

		var settings = self.data('timepicker-settings');
		var seconds = _time2int(this.value, settings);

		if (seconds === null) {
			self.trigger('timeFormatError');
			return;
		}

		var rangeError = false;
		// check that the time in within bounds
		if ((settings.minTime !== null && settings.maxTime !== null)
			&& (seconds < settings.minTime || seconds > settings.maxTime)) {
			rangeError = true;
		}

		// check that time isn't within disabled time ranges
		$.each(settings.disableTimeRanges, function(){
			if (seconds >= this[0] && seconds < this[1]) {
				rangeError = true;
				return false;
			}
		});

		if (settings.forceRoundTime) {
			var roundSeconds = settings.roundingFunction(seconds, settings);
			if (roundSeconds != seconds) {
				seconds = roundSeconds;
				origin = null;
			}
		}

		var prettyTime = _int2time(seconds, settings);

		if (rangeError) {
			if (_setTimeValue(self, prettyTime, 'error') || e && e.type == 'change') {
				self.trigger('timeRangeError');
			}
		} else {
			_setTimeValue(self, prettyTime, origin);
		}
	}

	function _getTimeValue(self)
	{
		if (self.is('input')) {
			return self.val();
		} else {
			// use the element's data attributes to store values
			return self.data('ui-timepicker-value');
		}
	}

	function _setTimeValue(self, value, source)
	{
		if (self.is('input')) {
			self.val(value);

			var settings = self.data('timepicker-settings');
			if (settings.useSelect && source != 'select' && source != 'initial') {
				self.data('timepicker-list').val(_roundAndFormatTime(_time2int(value), settings));
			}
		}

		if (self.data('ui-timepicker-value') != value) {
			self.data('ui-timepicker-value', value);
			if (source == 'select') {
				self.trigger('selectTime').trigger('changeTime').trigger('change', 'timepicker');
			} else if (['error', 'initial'].indexOf(source) == -1) {
				self.trigger('changeTime');
			}

			return true;
		} else {
			self.trigger('selectTime');
			return false;
		}
	}

	/*
	*  Filter freeform input
	*/
	function _disableTextInputHandler(e)
	{
		switch (e.keyCode) {
			case 13: // return
			case 9: //tab
				return;

			default:
				e.preventDefault();
		}
	}

	/*
	*  Keyboard navigation via arrow keys
	*/
	function _keydownhandler(e)
	{
		var self = $(this);
		var list = self.data('timepicker-list');

		if (!list || !_isVisible(list)) {
			if (e.keyCode == 40) {
				// show the list!
				methods.show.call(self.get(0));
				list = self.data('timepicker-list');
				if (!_hideKeyboard(self)) {
					self.focus();
				}
			} else {
				return true;
			}
		}

		switch (e.keyCode) {

			case 13: // return
				if (_selectValue(self)) {
					_formatValue.call(self.get(0), {'type':'change'});
					methods.hide.apply(this);
				}

				e.preventDefault();
				return false;

			case 38: // up
				var selected = list.find('.ui-timepicker-selected');

				if (!selected.length) {
					list.find('li').each(function(i, obj) {
						if ($(obj).position().top > 0) {
							selected = $(obj);
							return false;
						}
					});
					selected.addClass('ui-timepicker-selected');

				} else if (!selected.is(':first-child')) {
					selected.removeClass('ui-timepicker-selected');
					selected.prev().addClass('ui-timepicker-selected');

					if (selected.prev().position().top < selected.outerHeight()) {
						list.scrollTop(list.scrollTop() - selected.outerHeight());
					}
				}

				return false;

			case 40: // down
				selected = list.find('.ui-timepicker-selected');

				if (selected.length === 0) {
					list.find('li').each(function(i, obj) {
						if ($(obj).position().top > 0) {
							selected = $(obj);
							return false;
						}
					});

					selected.addClass('ui-timepicker-selected');
				} else if (!selected.is(':last-child')) {
					selected.removeClass('ui-timepicker-selected');
					selected.next().addClass('ui-timepicker-selected');

					if (selected.next().position().top + 2*selected.outerHeight() > list.outerHeight()) {
						list.scrollTop(list.scrollTop() + selected.outerHeight());
					}
				}

				return false;

			case 27: // escape
				list.find('li').removeClass('ui-timepicker-selected');
				methods.hide();
				break;

			case 9: //tab
				methods.hide();
				break;

			default:
				return true;
		}
	}

	/*
	*	Time typeahead
	*/
	function _keyuphandler(e)
	{
		var self = $(this);
		var list = self.data('timepicker-list');
		var settings = self.data('timepicker-settings');

		if (!list || !_isVisible(list) || settings.disableTextInput) {
			return true;
		}

		if (e.type === 'paste' || e.type === 'cut') {
		    	setTimeout(function () {
				if (settings.typeaheadHighlight) {
			    		_setSelected(self, list);
				} else {
			    		list.hide();
				}
		    	}, 0);
		    	return;
		}

		switch (e.keyCode) {

			case 96: // numpad numerals
			case 97:
			case 98:
			case 99:
			case 100:
			case 101:
			case 102:
			case 103:
			case 104:
			case 105:
			case 48: // numerals
			case 49:
			case 50:
			case 51:
			case 52:
			case 53:
			case 54:
			case 55:
			case 56:
			case 57:
			case 65: // a
			case 77: // m
			case 80: // p
			case 186: // colon
			case 8: // backspace
			case 46: // delete
				if (settings.typeaheadHighlight) {
					_setSelected(self, list);
				} else {
					list.hide();
				}
				break;
		}
	}

	function _selectValue(self)
	{
		var settings = self.data('timepicker-settings');
		var list = self.data('timepicker-list');
		var timeValue = null;

		var cursor = list.find('.ui-timepicker-selected');

		if (cursor.hasClass('ui-timepicker-disabled')) {
			return false;
		}

		if (cursor.length) {
			// selected value found
			timeValue = cursor.data('time');
		}

		if (timeValue !== null) {
			if (typeof timeValue != 'string') {
				timeValue = _int2time(timeValue, settings);
			}

			_setTimeValue(self, timeValue, 'select');
		}

		return true;
	}

	function _int2duration(seconds, step)
	{
		seconds = Math.abs(seconds);
		var minutes = Math.round(seconds/60),
			duration = [],
			hours, mins;

		if (minutes < 60) {
			// Only show (x mins) under 1 hour
			duration = [minutes, _lang.mins];
		} else {
			hours = Math.floor(minutes/60);
			mins = minutes%60;

			// Show decimal notation (eg: 1.5 hrs) for 30 minute steps
			if (step == 30 && mins == 30) {
				hours += _lang.decimal + 5;
			}

			duration.push(hours);
			duration.push(hours == 1 ? _lang.hr : _lang.hrs);

			// Show remainder minutes notation (eg: 1 hr 15 mins) for non-30 minute steps
			// and only if there are remainder minutes to show
			if (step != 30 && mins) {
				duration.push(mins);
				duration.push(_lang.mins);
			}
		}

		return duration.join(' ');
	}

	function _int2time(timeInt, settings)
	{
		if (typeof timeInt != 'number') {
			return null;
		}

		var seconds = parseInt(timeInt%60)
			, minutes = parseInt((timeInt/60)%60)
			, hours = parseInt((timeInt/(60*60))%24);

		var time = new Date(1970, 0, 2, hours, minutes, seconds, 0);

		if (isNaN(time.getTime())) {
			return null;
		}

		if ($.type(settings.timeFormat) === "function") {
			return settings.timeFormat(time);
		}

		var output = '';
		var hour, code;
		for (var i=0; i<settings.timeFormat.length; i++) {

			code = settings.timeFormat.charAt(i);
			switch (code) {

				case 'a':
					output += (time.getHours() > 11) ? _lang.pm : _lang.am;
					break;

				case 'A':
					output += (time.getHours() > 11) ? _lang.PM : _lang.AM;
					break;

				case 'g':
					hour = time.getHours() % 12;
					output += (hour === 0) ? '12' : hour;
					break;

				case 'G':
					hour = time.getHours();
					if (timeInt === _ONE_DAY) hour = settings.show2400 ? 24 : 0;
					output += hour;
					break;

				case 'h':
					hour = time.getHours() % 12;

					if (hour !== 0 && hour < 10) {
						hour = '0'+hour;
					}

					output += (hour === 0) ? '12' : hour;
					break;

				case 'H':
					hour = time.getHours();
					if (timeInt === _ONE_DAY) hour = settings.show2400 ? 24 : 0;
					output += (hour > 9) ? hour : '0'+hour;
					break;

				case 'i':
					var minutes = time.getMinutes();
					output += (minutes > 9) ? minutes : '0'+minutes;
					break;

				case 's':
					seconds = time.getSeconds();
					output += (seconds > 9) ? seconds : '0'+seconds;
					break;

				case '\\':
					// escape character; add the next character and skip ahead
					i++;
					output += settings.timeFormat.charAt(i);
					break;

				default:
					output += code;
			}
		}

		return output;
	}

	function _time2int(timeString, settings)
	{
		if (timeString === '' || timeString === null) return null;
		if (typeof timeString == 'object') {
			return timeString.getHours()*3600 + timeString.getMinutes()*60 + timeString.getSeconds();
		}
		if (typeof timeString != 'string') {
			return timeString;
		}

		timeString = timeString.toLowerCase().replace(/[\s\.]/g, '');

		// if the last character is an "a" or "p", add the "m"
		if (timeString.slice(-1) == 'a' || timeString.slice(-1) == 'p') {
			timeString += 'm';
		}

		var ampmRegex = '(' +
			_lang.am.replace('.', '')+'|' +
			_lang.pm.replace('.', '')+'|' +
			_lang.AM.replace('.', '')+'|' +
			_lang.PM.replace('.', '')+')?';

		// try to parse time input
		var pattern = new RegExp('^'+ampmRegex+'([0-9]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?'+ampmRegex+'$');

		var time = timeString.match(pattern);
		if (!time) {
			return null;
		}

		var hour = parseInt(time[2]*1, 10);
		var ampm = time[1] || time[5];
		var hours = hour;
		var minutes = ( time[3]*1 || 0 );
		var seconds = ( time[4]*1 || 0 );

		if (hour <= 12 && ampm) {
			var isPm = (ampm == _lang.pm || ampm == _lang.PM);

			if (hour == 12) {
				hours = isPm ? 12 : 0;
			} else {
				hours = (hour + (isPm ? 12 : 0));
			}
		} else if (settings) {
			var t = hour * 3600 + minutes * 60 + seconds;
			if (t >= _ONE_DAY + (settings.show2400 ? 1 : 0)) {
				if (settings.wrapHours === false) {
					return null;
				}

				hours = hour % 24;
			}
		}

		var timeInt = hours*3600 + minutes*60 + seconds;

		// if no am/pm provided, intelligently guess based on the scrollDefault
		if (hour < 12 && !ampm && settings && settings._twelveHourTime && settings.scrollDefault) {
			var delta = timeInt - settings.scrollDefault();
			if (delta < 0 && delta >= _ONE_DAY / -2) {
				timeInt = (timeInt + (_ONE_DAY / 2)) % _ONE_DAY;
			}
		}

		return timeInt;
	}

	function _pad2(n) {
		return ("0" + n).slice(-2);
	}

	function _moduloSeconds(seconds, settings) {
		if (seconds == _ONE_DAY && settings.show2400) {
			return seconds;
		}

		return seconds%_ONE_DAY;
	}

	// Plugin entry
	$.fn.timepicker = function(method)
	{
		if (!this.length) return this;
		if (methods[method]) {
			// check if this element is a timepicker
			if (!this.hasClass('ui-timepicker-input')) {
				return this;
			}
			return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
		}
		else if(typeof method === "object" || !method) { return methods.init.apply(this, arguments); }
		else { $.error("Method "+ method + " does not exist on jQuery.timepicker"); }
	};
}));

//! moment.js
//! version : 2.9.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

(function (undefined) {
    /************************************
        Constants
    ************************************/

    var moment,
        VERSION = '2.9.0',
        // the global-scope this is NOT the global object in Node.js
        globalScope = (typeof global !== 'undefined' && (typeof window === 'undefined' || window === global.window)) ? global : this,
        oldGlobalMoment,
        round = Math.round,
        hasOwnProperty = Object.prototype.hasOwnProperty,
        i,

        YEAR = 0,
        MONTH = 1,
        DATE = 2,
        HOUR = 3,
        MINUTE = 4,
        SECOND = 5,
        MILLISECOND = 6,

        // internal storage for locale config files
        locales = {},

        // extra moment internal properties (plugins register props here)
        momentProperties = [],

        // check for nodeJS
        hasModule = (typeof module !== 'undefined' && module && module.exports),

        // ASP.NET json date format regex
        aspNetJsonRegex = /^\/?Date\((\-?\d+)/i,
        aspNetTimeSpanJsonRegex = /(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,

        // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html
        // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere
        isoDurationRegex = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,

        // format tokens
        formattingTokens = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,
        localFormattingTokens = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,

        // parsing token regexes
        parseTokenOneOrTwoDigits = /\d\d?/, // 0 - 99
        parseTokenOneToThreeDigits = /\d{1,3}/, // 0 - 999
        parseTokenOneToFourDigits = /\d{1,4}/, // 0 - 9999
        parseTokenOneToSixDigits = /[+\-]?\d{1,6}/, // -999,999 - 999,999
        parseTokenDigits = /\d+/, // nonzero number of digits
        parseTokenWord = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, // any word (or two) characters or numbers including two/three word month in arabic.
        parseTokenTimezone = /Z|[\+\-]\d\d:?\d\d/gi, // +00:00 -00:00 +0000 -0000 or Z
        parseTokenT = /T/i, // T (ISO separator)
        parseTokenOffsetMs = /[\+\-]?\d+/, // 1234567890123
        parseTokenTimestampMs = /[\+\-]?\d+(\.\d{1,3})?/, // 123456789 123456789.123

        //strict parsing regexes
        parseTokenOneDigit = /\d/, // 0 - 9
        parseTokenTwoDigits = /\d\d/, // 00 - 99
        parseTokenThreeDigits = /\d{3}/, // 000 - 999
        parseTokenFourDigits = /\d{4}/, // 0000 - 9999
        parseTokenSixDigits = /[+-]?\d{6}/, // -999,999 - 999,999
        parseTokenSignedNumber = /[+-]?\d+/, // -inf - inf

        // iso 8601 regex
        // 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)
        isoRegex = /^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,

        isoFormat = 'YYYY-MM-DDTHH:mm:ssZ',

        isoDates = [
            ['YYYYYY-MM-DD', /[+-]\d{6}-\d{2}-\d{2}/],
            ['YYYY-MM-DD', /\d{4}-\d{2}-\d{2}/],
            ['GGGG-[W]WW-E', /\d{4}-W\d{2}-\d/],
            ['GGGG-[W]WW', /\d{4}-W\d{2}/],
            ['YYYY-DDD', /\d{4}-\d{3}/]
        ],

        // iso time formats and regexes
        isoTimes = [
            ['HH:mm:ss.SSSS', /(T| )\d\d:\d\d:\d\d\.\d+/],
            ['HH:mm:ss', /(T| )\d\d:\d\d:\d\d/],
            ['HH:mm', /(T| )\d\d:\d\d/],
            ['HH', /(T| )\d\d/]
        ],

        // timezone chunker '+10:00' > ['10', '00'] or '-1530' > ['-', '15', '30']
        parseTimezoneChunker = /([\+\-]|\d\d)/gi,

        // getter and setter names
        proxyGettersAndSetters = 'Date|Hours|Minutes|Seconds|Milliseconds'.split('|'),
        unitMillisecondFactors = {
            'Milliseconds' : 1,
            'Seconds' : 1e3,
            'Minutes' : 6e4,
            'Hours' : 36e5,
            'Days' : 864e5,
            'Months' : 2592e6,
            'Years' : 31536e6
        },

        unitAliases = {
            ms : 'millisecond',
            s : 'second',
            m : 'minute',
            h : 'hour',
            d : 'day',
            D : 'date',
            w : 'week',
            W : 'isoWeek',
            M : 'month',
            Q : 'quarter',
            y : 'year',
            DDD : 'dayOfYear',
            e : 'weekday',
            E : 'isoWeekday',
            gg: 'weekYear',
            GG: 'isoWeekYear'
        },

        camelFunctions = {
            dayofyear : 'dayOfYear',
            isoweekday : 'isoWeekday',
            isoweek : 'isoWeek',
            weekyear : 'weekYear',
            isoweekyear : 'isoWeekYear'
        },

        // format function strings
        formatFunctions = {},

        // default relative time thresholds
        relativeTimeThresholds = {
            s: 45,  // seconds to minute
            m: 45,  // minutes to hour
            h: 22,  // hours to day
            d: 26,  // days to month
            M: 11   // months to year
        },

        // tokens to ordinalize and pad
        ordinalizeTokens = 'DDD w W M D d'.split(' '),
        paddedTokens = 'M D H h m s w W'.split(' '),

        formatTokenFunctions = {
            M    : function () {
                return this.month() + 1;
            },
            MMM  : function (format) {
                return this.localeData().monthsShort(this, format);
            },
            MMMM : function (format) {
                return this.localeData().months(this, format);
            },
            D    : function () {
                return this.date();
            },
            DDD  : function () {
                return this.dayOfYear();
            },
            d    : function () {
                return this.day();
            },
            dd   : function (format) {
                return this.localeData().weekdaysMin(this, format);
            },
            ddd  : function (format) {
                return this.localeData().weekdaysShort(this, format);
            },
            dddd : function (format) {
                return this.localeData().weekdays(this, format);
            },
            w    : function () {
                return this.week();
            },
            W    : function () {
                return this.isoWeek();
            },
            YY   : function () {
                return leftZeroFill(this.year() % 100, 2);
            },
            YYYY : function () {
                return leftZeroFill(this.year(), 4);
            },
            YYYYY : function () {
                return leftZeroFill(this.year(), 5);
            },
            YYYYYY : function () {
                var y = this.year(), sign = y >= 0 ? '+' : '-';
                return sign + leftZeroFill(Math.abs(y), 6);
            },
            gg   : function () {
                return leftZeroFill(this.weekYear() % 100, 2);
            },
            gggg : function () {
                return leftZeroFill(this.weekYear(), 4);
            },
            ggggg : function () {
                return leftZeroFill(this.weekYear(), 5);
            },
            GG   : function () {
                return leftZeroFill(this.isoWeekYear() % 100, 2);
            },
            GGGG : function () {
                return leftZeroFill(this.isoWeekYear(), 4);
            },
            GGGGG : function () {
                return leftZeroFill(this.isoWeekYear(), 5);
            },
            e : function () {
                return this.weekday();
            },
            E : function () {
                return this.isoWeekday();
            },
            a    : function () {
                return this.localeData().meridiem(this.hours(), this.minutes(), true);
            },
            A    : function () {
                return this.localeData().meridiem(this.hours(), this.minutes(), false);
            },
            H    : function () {
                return this.hours();
            },
            h    : function () {
                return this.hours() % 12 || 12;
            },
            m    : function () {
                return this.minutes();
            },
            s    : function () {
                return this.seconds();
            },
            S    : function () {
                return toInt(this.milliseconds() / 100);
            },
            SS   : function () {
                return leftZeroFill(toInt(this.milliseconds() / 10), 2);
            },
            SSS  : function () {
                return leftZeroFill(this.milliseconds(), 3);
            },
            SSSS : function () {
                return leftZeroFill(this.milliseconds(), 3);
            },
            Z    : function () {
                var a = this.utcOffset(),
                    b = '+';
                if (a < 0) {
                    a = -a;
                    b = '-';
                }
                return b + leftZeroFill(toInt(a / 60), 2) + ':' + leftZeroFill(toInt(a) % 60, 2);
            },
            ZZ   : function () {
                var a = this.utcOffset(),
                    b = '+';
                if (a < 0) {
                    a = -a;
                    b = '-';
                }
                return b + leftZeroFill(toInt(a / 60), 2) + leftZeroFill(toInt(a) % 60, 2);
            },
            z : function () {
                return this.zoneAbbr();
            },
            zz : function () {
                return this.zoneName();
            },
            x    : function () {
                return this.valueOf();
            },
            X    : function () {
                return this.unix();
            },
            Q : function () {
                return this.quarter();
            }
        },

        deprecations = {},

        lists = ['months', 'monthsShort', 'weekdays', 'weekdaysShort', 'weekdaysMin'],

        updateInProgress = false;

    // Pick the first defined of two or three arguments. dfl comes from
    // default.
    function dfl(a, b, c) {
        switch (arguments.length) {
            case 2: return a != null ? a : b;
            case 3: return a != null ? a : b != null ? b : c;
            default: throw new Error('Implement me');
        }
    }

    function hasOwnProp(a, b) {
        return hasOwnProperty.call(a, b);
    }

    function defaultParsingFlags() {
        // We need to deep clone this object, and es5 standard is not very
        // helpful.
        return {
            empty : false,
            unusedTokens : [],
            unusedInput : [],
            overflow : -2,
            charsLeftOver : 0,
            nullInput : false,
            invalidMonth : null,
            invalidFormat : false,
            userInvalidated : false,
            iso: false
        };
    }

    function printMsg(msg) {
        if (moment.suppressDeprecationWarnings === false &&
                typeof console !== 'undefined' && console.warn) {
            console.warn('Deprecation warning: ' + msg);
        }
    }

    function deprecate(msg, fn) {
        var firstTime = true;
        return extend(function () {
            if (firstTime) {
                printMsg(msg);
                firstTime = false;
            }
            return fn.apply(this, arguments);
        }, fn);
    }

    function deprecateSimple(name, msg) {
        if (!deprecations[name]) {
            printMsg(msg);
            deprecations[name] = true;
        }
    }

    function padToken(func, count) {
        return function (a) {
            return leftZeroFill(func.call(this, a), count);
        };
    }
    function ordinalizeToken(func, period) {
        return function (a) {
            return this.localeData().ordinal(func.call(this, a), period);
        };
    }

    function monthDiff(a, b) {
        // difference in months
        var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),
            // b is in (anchor - 1 month, anchor + 1 month)
            anchor = a.clone().add(wholeMonthDiff, 'months'),
            anchor2, adjust;

        if (b - anchor < 0) {
            anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');
            // linear across the month
            adjust = (b - anchor) / (anchor - anchor2);
        } else {
            anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');
            // linear across the month
            adjust = (b - anchor) / (anchor2 - anchor);
        }

        return -(wholeMonthDiff + adjust);
    }

    while (ordinalizeTokens.length) {
        i = ordinalizeTokens.pop();
        formatTokenFunctions[i + 'o'] = ordinalizeToken(formatTokenFunctions[i], i);
    }
    while (paddedTokens.length) {
        i = paddedTokens.pop();
        formatTokenFunctions[i + i] = padToken(formatTokenFunctions[i], 2);
    }
    formatTokenFunctions.DDDD = padToken(formatTokenFunctions.DDD, 3);


    function meridiemFixWrap(locale, hour, meridiem) {
        var isPm;

        if (meridiem == null) {
            // nothing to do
            return hour;
        }
        if (locale.meridiemHour != null) {
            return locale.meridiemHour(hour, meridiem);
        } else if (locale.isPM != null) {
            // Fallback
            isPm = locale.isPM(meridiem);
            if (isPm && hour < 12) {
                hour += 12;
            }
            if (!isPm && hour === 12) {
                hour = 0;
            }
            return hour;
        } else {
            // thie is not supposed to happen
            return hour;
        }
    }

    /************************************
        Constructors
    ************************************/

    function Locale() {
    }

    // Moment prototype object
    function Moment(config, skipOverflow) {
        if (skipOverflow !== false) {
            checkOverflow(config);
        }
        copyConfig(this, config);
        this._d = new Date(+config._d);
        // Prevent infinite loop in case updateOffset creates new moment
        // objects.
        if (updateInProgress === false) {
            updateInProgress = true;
            moment.updateOffset(this);
            updateInProgress = false;
        }
    }

    // Duration Constructor
    function Duration(duration) {
        var normalizedInput = normalizeObjectUnits(duration),
            years = normalizedInput.year || 0,
            quarters = normalizedInput.quarter || 0,
            months = normalizedInput.month || 0,
            weeks = normalizedInput.week || 0,
            days = normalizedInput.day || 0,
            hours = normalizedInput.hour || 0,
            minutes = normalizedInput.minute || 0,
            seconds = normalizedInput.second || 0,
            milliseconds = normalizedInput.millisecond || 0;

        // representation for dateAddRemove
        this._milliseconds = +milliseconds +
            seconds * 1e3 + // 1000
            minutes * 6e4 + // 1000 * 60
            hours * 36e5; // 1000 * 60 * 60
        // Because of dateAddRemove treats 24 hours as different from a
        // day when working around DST, we need to store them separately
        this._days = +days +
            weeks * 7;
        // It is impossible translate months into days without knowing
        // which months you are are talking about, so we have to store
        // it separately.
        this._months = +months +
            quarters * 3 +
            years * 12;

        this._data = {};

        this._locale = moment.localeData();

        this._bubble();
    }

    /************************************
        Helpers
    ************************************/


    function extend(a, b) {
        for (var i in b) {
            if (hasOwnProp(b, i)) {
                a[i] = b[i];
            }
        }

        if (hasOwnProp(b, 'toString')) {
            a.toString = b.toString;
        }

        if (hasOwnProp(b, 'valueOf')) {
            a.valueOf = b.valueOf;
        }

        return a;
    }

    function copyConfig(to, from) {
        var i, prop, val;

        if (typeof from._isAMomentObject !== 'undefined') {
            to._isAMomentObject = from._isAMomentObject;
        }
        if (typeof from._i !== 'undefined') {
            to._i = from._i;
        }
        if (typeof from._f !== 'undefined') {
            to._f = from._f;
        }
        if (typeof from._l !== 'undefined') {
            to._l = from._l;
        }
        if (typeof from._strict !== 'undefined') {
            to._strict = from._strict;
        }
        if (typeof from._tzm !== 'undefined') {
            to._tzm = from._tzm;
        }
        if (typeof from._isUTC !== 'undefined') {
            to._isUTC = from._isUTC;
        }
        if (typeof from._offset !== 'undefined') {
            to._offset = from._offset;
        }
        if (typeof from._pf !== 'undefined') {
            to._pf = from._pf;
        }
        if (typeof from._locale !== 'undefined') {
            to._locale = from._locale;
        }

        if (momentProperties.length > 0) {
            for (i in momentProperties) {
                prop = momentProperties[i];
                val = from[prop];
                if (typeof val !== 'undefined') {
                    to[prop] = val;
                }
            }
        }

        return to;
    }

    function absRound(number) {
        if (number < 0) {
            return Math.ceil(number);
        } else {
            return Math.floor(number);
        }
    }

    // left zero fill a number
    // see http://jsperf.com/left-zero-filling for performance comparison
    function leftZeroFill(number, targetLength, forceSign) {
        var output = '' + Math.abs(number),
            sign = number >= 0;

        while (output.length < targetLength) {
            output = '0' + output;
        }
        return (sign ? (forceSign ? '+' : '') : '-') + output;
    }

    function positiveMomentsDifference(base, other) {
        var res = {milliseconds: 0, months: 0};

        res.months = other.month() - base.month() +
            (other.year() - base.year()) * 12;
        if (base.clone().add(res.months, 'M').isAfter(other)) {
            --res.months;
        }

        res.milliseconds = +other - +(base.clone().add(res.months, 'M'));

        return res;
    }

    function momentsDifference(base, other) {
        var res;
        other = makeAs(other, base);
        if (base.isBefore(other)) {
            res = positiveMomentsDifference(base, other);
        } else {
            res = positiveMomentsDifference(other, base);
            res.milliseconds = -res.milliseconds;
            res.months = -res.months;
        }

        return res;
    }

    // TODO: remove 'name' arg after deprecation is removed
    function createAdder(direction, name) {
        return function (val, period) {
            var dur, tmp;
            //invert the arguments, but complain about it
            if (period !== null && !isNaN(+period)) {
                deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period).');
                tmp = val; val = period; period = tmp;
            }

            val = typeof val === 'string' ? +val : val;
            dur = moment.duration(val, period);
            addOrSubtractDurationFromMoment(this, dur, direction);
            return this;
        };
    }

    function addOrSubtractDurationFromMoment(mom, duration, isAdding, updateOffset) {
        var milliseconds = duration._milliseconds,
            days = duration._days,
            months = duration._months;
        updateOffset = updateOffset == null ? true : updateOffset;

        if (milliseconds) {
            mom._d.setTime(+mom._d + milliseconds * isAdding);
        }
        if (days) {
            rawSetter(mom, 'Date', rawGetter(mom, 'Date') + days * isAdding);
        }
        if (months) {
            rawMonthSetter(mom, rawGetter(mom, 'Month') + months * isAdding);
        }
        if (updateOffset) {
            moment.updateOffset(mom, days || months);
        }
    }

    // check if is an array
    function isArray(input) {
        return Object.prototype.toString.call(input) === '[object Array]';
    }

    function isDate(input) {
        return Object.prototype.toString.call(input) === '[object Date]' ||
            input instanceof Date;
    }

    // compare two arrays, return the number of differences
    function compareArrays(array1, array2, dontConvert) {
        var len = Math.min(array1.length, array2.length),
            lengthDiff = Math.abs(array1.length - array2.length),
            diffs = 0,
            i;
        for (i = 0; i < len; i++) {
            if ((dontConvert && array1[i] !== array2[i]) ||
                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {
                diffs++;
            }
        }
        return diffs + lengthDiff;
    }

    function normalizeUnits(units) {
        if (units) {
            var lowered = units.toLowerCase().replace(/(.)s$/, '$1');
            units = unitAliases[units] || camelFunctions[lowered] || lowered;
        }
        return units;
    }

    function normalizeObjectUnits(inputObject) {
        var normalizedInput = {},
            normalizedProp,
            prop;

        for (prop in inputObject) {
            if (hasOwnProp(inputObject, prop)) {
                normalizedProp = normalizeUnits(prop);
                if (normalizedProp) {
                    normalizedInput[normalizedProp] = inputObject[prop];
                }
            }
        }

        return normalizedInput;
    }

    function makeList(field) {
        var count, setter;

        if (field.indexOf('week') === 0) {
            count = 7;
            setter = 'day';
        }
        else if (field.indexOf('month') === 0) {
            count = 12;
            setter = 'month';
        }
        else {
            return;
        }

        moment[field] = function (format, index) {
            var i, getter,
                method = moment._locale[field],
                results = [];

            if (typeof format === 'number') {
                index = format;
                format = undefined;
            }

            getter = function (i) {
                var m = moment().utc().set(setter, i);
                return method.call(moment._locale, m, format || '');
            };

            if (index != null) {
                return getter(index);
            }
            else {
                for (i = 0; i < count; i++) {
                    results.push(getter(i));
                }
                return results;
            }
        };
    }

    function toInt(argumentForCoercion) {
        var coercedNumber = +argumentForCoercion,
            value = 0;

        if (coercedNumber !== 0 && isFinite(coercedNumber)) {
            if (coercedNumber >= 0) {
                value = Math.floor(coercedNumber);
            } else {
                value = Math.ceil(coercedNumber);
            }
        }

        return value;
    }

    function daysInMonth(year, month) {
        return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();
    }

    function weeksInYear(year, dow, doy) {
        return weekOfYear(moment([year, 11, 31 + dow - doy]), dow, doy).week;
    }

    function daysInYear(year) {
        return isLeapYear(year) ? 366 : 365;
    }

    function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;
    }

    function checkOverflow(m) {
        var overflow;
        if (m._a && m._pf.overflow === -2) {
            overflow =
                m._a[MONTH] < 0 || m._a[MONTH] > 11 ? MONTH :
                m._a[DATE] < 1 || m._a[DATE] > daysInMonth(m._a[YEAR], m._a[MONTH]) ? DATE :
                m._a[HOUR] < 0 || m._a[HOUR] > 24 ||
                    (m._a[HOUR] === 24 && (m._a[MINUTE] !== 0 ||
                                           m._a[SECOND] !== 0 ||
                                           m._a[MILLISECOND] !== 0)) ? HOUR :
                m._a[MINUTE] < 0 || m._a[MINUTE] > 59 ? MINUTE :
                m._a[SECOND] < 0 || m._a[SECOND] > 59 ? SECOND :
                m._a[MILLISECOND] < 0 || m._a[MILLISECOND] > 999 ? MILLISECOND :
                -1;

            if (m._pf._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {
                overflow = DATE;
            }

            m._pf.overflow = overflow;
        }
    }

    function isValid(m) {
        if (m._isValid == null) {
            m._isValid = !isNaN(m._d.getTime()) &&
                m._pf.overflow < 0 &&
                !m._pf.empty &&
                !m._pf.invalidMonth &&
                !m._pf.nullInput &&
                !m._pf.invalidFormat &&
                !m._pf.userInvalidated;

            if (m._strict) {
                m._isValid = m._isValid &&
                    m._pf.charsLeftOver === 0 &&
                    m._pf.unusedTokens.length === 0 &&
                    m._pf.bigHour === undefined;
            }
        }
        return m._isValid;
    }

    function normalizeLocale(key) {
        return key ? key.toLowerCase().replace('_', '-') : key;
    }

    // pick the locale from the array
    // try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each
    // substring from most specific to least, but move to the next array item if it's a more specific variant than the current root
    function chooseLocale(names) {
        var i = 0, j, next, locale, split;

        while (i < names.length) {
            split = normalizeLocale(names[i]).split('-');
            j = split.length;
            next = normalizeLocale(names[i + 1]);
            next = next ? next.split('-') : null;
            while (j > 0) {
                locale = loadLocale(split.slice(0, j).join('-'));
                if (locale) {
                    return locale;
                }
                if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {
                    //the next array item is better than a shallower substring of this one
                    break;
                }
                j--;
            }
            i++;
        }
        return null;
    }

    function loadLocale(name) {
        var oldLocale = null;
        if (!locales[name] && hasModule) {
            try {
                oldLocale = moment.locale();
                require('./locale/' + name);
                // because defineLocale currently also sets the global locale, we want to undo that for lazy loaded locales
                moment.locale(oldLocale);
            } catch (e) { }
        }
        return locales[name];
    }

    // Return a moment from input, that is local/utc/utcOffset equivalent to
    // model.
    function makeAs(input, model) {
        var res, diff;
        if (model._isUTC) {
            res = model.clone();
            diff = (moment.isMoment(input) || isDate(input) ?
                    +input : +moment(input)) - (+res);
            // Use low-level api, because this fn is low-level api.
            res._d.setTime(+res._d + diff);
            moment.updateOffset(res, false);
            return res;
        } else {
            return moment(input).local();
        }
    }

    /************************************
        Locale
    ************************************/


    extend(Locale.prototype, {

        set : function (config) {
            var prop, i;
            for (i in config) {
                prop = config[i];
                if (typeof prop === 'function') {
                    this[i] = prop;
                } else {
                    this['_' + i] = prop;
                }
            }
            // Lenient ordinal parsing accepts just a number in addition to
            // number + (possibly) stuff coming from _ordinalParseLenient.
            this._ordinalParseLenient = new RegExp(this._ordinalParse.source + '|' + /\d{1,2}/.source);
        },

        _months : 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_'),
        months : function (m) {
            return this._months[m.month()];
        },

        _monthsShort : 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_'),
        monthsShort : function (m) {
            return this._monthsShort[m.month()];
        },

        monthsParse : function (monthName, format, strict) {
            var i, mom, regex;

            if (!this._monthsParse) {
                this._monthsParse = [];
                this._longMonthsParse = [];
                this._shortMonthsParse = [];
            }

            for (i = 0; i < 12; i++) {
                // make the regex if we don't have it already
                mom = moment.utc([2000, i]);
                if (strict && !this._longMonthsParse[i]) {
                    this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');
                    this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');
                }
                if (!strict && !this._monthsParse[i]) {
                    regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');
                    this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');
                }
                // test the regex
                if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {
                    return i;
                } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {
                    return i;
                } else if (!strict && this._monthsParse[i].test(monthName)) {
                    return i;
                }
            }
        },

        _weekdays : 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_'),
        weekdays : function (m) {
            return this._weekdays[m.day()];
        },

        _weekdaysShort : 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_'),
        weekdaysShort : function (m) {
            return this._weekdaysShort[m.day()];
        },

        _weekdaysMin : 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_'),
        weekdaysMin : function (m) {
            return this._weekdaysMin[m.day()];
        },

        weekdaysParse : function (weekdayName) {
            var i, mom, regex;

            if (!this._weekdaysParse) {
                this._weekdaysParse = [];
            }

            for (i = 0; i < 7; i++) {
                // make the regex if we don't have it already
                if (!this._weekdaysParse[i]) {
                    mom = moment([2000, 1]).day(i);
                    regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');
                    this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');
                }
                // test the regex
                if (this._weekdaysParse[i].test(weekdayName)) {
                    return i;
                }
            }
        },

        _longDateFormat : {
            LTS : 'h:mm:ss A',
            LT : 'h:mm A',
            L : 'MM/DD/YYYY',
            LL : 'MMMM D, YYYY',
            LLL : 'MMMM D, YYYY LT',
            LLLL : 'dddd, MMMM D, YYYY LT'
        },
        longDateFormat : function (key) {
            var output = this._longDateFormat[key];
            if (!output && this._longDateFormat[key.toUpperCase()]) {
                output = this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (val) {
                    return val.slice(1);
                });
                this._longDateFormat[key] = output;
            }
            return output;
        },

        isPM : function (input) {
            // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays
            // Using charAt should be more compatible.
            return ((input + '').toLowerCase().charAt(0) === 'p');
        },

        _meridiemParse : /[ap]\.?m?\.?/i,
        meridiem : function (hours, minutes, isLower) {
            if (hours > 11) {
                return isLower ? 'pm' : 'PM';
            } else {
                return isLower ? 'am' : 'AM';
            }
        },


        _calendar : {
            sameDay : '[Today at] LT',
            nextDay : '[Tomorrow at] LT',
            nextWeek : 'dddd [at] LT',
            lastDay : '[Yesterday at] LT',
            lastWeek : '[Last] dddd [at] LT',
            sameElse : 'L'
        },
        calendar : function (key, mom, now) {
            var output = this._calendar[key];
            return typeof output === 'function' ? output.apply(mom, [now]) : output;
        },

        _relativeTime : {
            future : 'in %s',
            past : '%s ago',
            s : 'a few seconds',
            m : 'a minute',
            mm : '%d minutes',
            h : 'an hour',
            hh : '%d hours',
            d : 'a day',
            dd : '%d days',
            M : 'a month',
            MM : '%d months',
            y : 'a year',
            yy : '%d years'
        },

        relativeTime : function (number, withoutSuffix, string, isFuture) {
            var output = this._relativeTime[string];
            return (typeof output === 'function') ?
                output(number, withoutSuffix, string, isFuture) :
                output.replace(/%d/i, number);
        },

        pastFuture : function (diff, output) {
            var format = this._relativeTime[diff > 0 ? 'future' : 'past'];
            return typeof format === 'function' ? format(output) : format.replace(/%s/i, output);
        },

        ordinal : function (number) {
            return this._ordinal.replace('%d', number);
        },
        _ordinal : '%d',
        _ordinalParse : /\d{1,2}/,

        preparse : function (string) {
            return string;
        },

        postformat : function (string) {
            return string;
        },

        week : function (mom) {
            return weekOfYear(mom, this._week.dow, this._week.doy).week;
        },

        _week : {
            dow : 0, // Sunday is the first day of the week.
            doy : 6  // The week that contains Jan 1st is the first week of the year.
        },

        firstDayOfWeek : function () {
            return this._week.dow;
        },

        firstDayOfYear : function () {
            return this._week.doy;
        },

        _invalidDate: 'Invalid date',
        invalidDate: function () {
            return this._invalidDate;
        }
    });

    /************************************
        Formatting
    ************************************/


    function removeFormattingTokens(input) {
        if (input.match(/\[[\s\S]/)) {
            return input.replace(/^\[|\]$/g, '');
        }
        return input.replace(/\\/g, '');
    }

    function makeFormatFunction(format) {
        var array = format.match(formattingTokens), i, length;

        for (i = 0, length = array.length; i < length; i++) {
            if (formatTokenFunctions[array[i]]) {
                array[i] = formatTokenFunctions[array[i]];
            } else {
                array[i] = removeFormattingTokens(array[i]);
            }
        }

        return function (mom) {
            var output = '';
            for (i = 0; i < length; i++) {
                output += array[i] instanceof Function ? array[i].call(mom, format) : array[i];
            }
            return output;
        };
    }

    // format date using native date object
    function formatMoment(m, format) {
        if (!m.isValid()) {
            return m.localeData().invalidDate();
        }

        format = expandFormat(format, m.localeData());

        if (!formatFunctions[format]) {
            formatFunctions[format] = makeFormatFunction(format);
        }

        return formatFunctions[format](m);
    }

    function expandFormat(format, locale) {
        var i = 5;

        function replaceLongDateFormatTokens(input) {
            return locale.longDateFormat(input) || input;
        }

        localFormattingTokens.lastIndex = 0;
        while (i >= 0 && localFormattingTokens.test(format)) {
            format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);
            localFormattingTokens.lastIndex = 0;
            i -= 1;
        }

        return format;
    }


    /************************************
        Parsing
    ************************************/


    // get the regex to find the next token
    function getParseRegexForToken(token, config) {
        var a, strict = config._strict;
        switch (token) {
        case 'Q':
            return parseTokenOneDigit;
        case 'DDDD':
            return parseTokenThreeDigits;
        case 'YYYY':
        case 'GGGG':
        case 'gggg':
            return strict ? parseTokenFourDigits : parseTokenOneToFourDigits;
        case 'Y':
        case 'G':
        case 'g':
            return parseTokenSignedNumber;
        case 'YYYYYY':
        case 'YYYYY':
        case 'GGGGG':
        case 'ggggg':
            return strict ? parseTokenSixDigits : parseTokenOneToSixDigits;
        case 'S':
            if (strict) {
                return parseTokenOneDigit;
            }
            /* falls through */
        case 'SS':
            if (strict) {
                return parseTokenTwoDigits;
            }
            /* falls through */
        case 'SSS':
            if (strict) {
                return parseTokenThreeDigits;
            }
            /* falls through */
        case 'DDD':
            return parseTokenOneToThreeDigits;
        case 'MMM':
        case 'MMMM':
        case 'dd':
        case 'ddd':
        case 'dddd':
            return parseTokenWord;
        case 'a':
        case 'A':
            return config._locale._meridiemParse;
        case 'x':
            return parseTokenOffsetMs;
        case 'X':
            return parseTokenTimestampMs;
        case 'Z':
        case 'ZZ':
            return parseTokenTimezone;
        case 'T':
            return parseTokenT;
        case 'SSSS':
            return parseTokenDigits;
        case 'MM':
        case 'DD':
        case 'YY':
        case 'GG':
        case 'gg':
        case 'HH':
        case 'hh':
        case 'mm':
        case 'ss':
        case 'ww':
        case 'WW':
            return strict ? parseTokenTwoDigits : parseTokenOneOrTwoDigits;
        case 'M':
        case 'D':
        case 'd':
        case 'H':
        case 'h':
        case 'm':
        case 's':
        case 'w':
        case 'W':
        case 'e':
        case 'E':
            return parseTokenOneOrTwoDigits;
        case 'Do':
            return strict ? config._locale._ordinalParse : config._locale._ordinalParseLenient;
        default :
            a = new RegExp(regexpEscape(unescapeFormat(token.replace('\\', '')), 'i'));
            return a;
        }
    }

    function utcOffsetFromString(string) {
        string = string || '';
        var possibleTzMatches = (string.match(parseTokenTimezone) || []),
            tzChunk = possibleTzMatches[possibleTzMatches.length - 1] || [],
            parts = (tzChunk + '').match(parseTimezoneChunker) || ['-', 0, 0],
            minutes = +(parts[1] * 60) + toInt(parts[2]);

        return parts[0] === '+' ? minutes : -minutes;
    }

    // function to convert string input to date
    function addTimeToArrayFromToken(token, input, config) {
        var a, datePartArray = config._a;

        switch (token) {
        // QUARTER
        case 'Q':
            if (input != null) {
                datePartArray[MONTH] = (toInt(input) - 1) * 3;
            }
            break;
        // MONTH
        case 'M' : // fall through to MM
        case 'MM' :
            if (input != null) {
                datePartArray[MONTH] = toInt(input) - 1;
            }
            break;
        case 'MMM' : // fall through to MMMM
        case 'MMMM' :
            a = config._locale.monthsParse(input, token, config._strict);
            // if we didn't find a month name, mark the date as invalid.
            if (a != null) {
                datePartArray[MONTH] = a;
            } else {
                config._pf.invalidMonth = input;
            }
            break;
        // DAY OF MONTH
        case 'D' : // fall through to DD
        case 'DD' :
            if (input != null) {
                datePartArray[DATE] = toInt(input);
            }
            break;
        case 'Do' :
            if (input != null) {
                datePartArray[DATE] = toInt(parseInt(
                            input.match(/\d{1,2}/)[0], 10));
            }
            break;
        // DAY OF YEAR
        case 'DDD' : // fall through to DDDD
        case 'DDDD' :
            if (input != null) {
                config._dayOfYear = toInt(input);
            }

            break;
        // YEAR
        case 'YY' :
            datePartArray[YEAR] = moment.parseTwoDigitYear(input);
            break;
        case 'YYYY' :
        case 'YYYYY' :
        case 'YYYYYY' :
            datePartArray[YEAR] = toInt(input);
            break;
        // AM / PM
        case 'a' : // fall through to A
        case 'A' :
            config._meridiem = input;
            // config._isPm = config._locale.isPM(input);
            break;
        // HOUR
        case 'h' : // fall through to hh
        case 'hh' :
            config._pf.bigHour = true;
            /* falls through */
        case 'H' : // fall through to HH
        case 'HH' :
            datePartArray[HOUR] = toInt(input);
            break;
        // MINUTE
        case 'm' : // fall through to mm
        case 'mm' :
            datePartArray[MINUTE] = toInt(input);
            break;
        // SECOND
        case 's' : // fall through to ss
        case 'ss' :
            datePartArray[SECOND] = toInt(input);
            break;
        // MILLISECOND
        case 'S' :
        case 'SS' :
        case 'SSS' :
        case 'SSSS' :
            datePartArray[MILLISECOND] = toInt(('0.' + input) * 1000);
            break;
        // UNIX OFFSET (MILLISECONDS)
        case 'x':
            config._d = new Date(toInt(input));
            break;
        // UNIX TIMESTAMP WITH MS
        case 'X':
            config._d = new Date(parseFloat(input) * 1000);
            break;
        // TIMEZONE
        case 'Z' : // fall through to ZZ
        case 'ZZ' :
            config._useUTC = true;
            config._tzm = utcOffsetFromString(input);
            break;
        // WEEKDAY - human
        case 'dd':
        case 'ddd':
        case 'dddd':
            a = config._locale.weekdaysParse(input);
            // if we didn't get a weekday name, mark the date as invalid
            if (a != null) {
                config._w = config._w || {};
                config._w['d'] = a;
            } else {
                config._pf.invalidWeekday = input;
            }
            break;
        // WEEK, WEEK DAY - numeric
        case 'w':
        case 'ww':
        case 'W':
        case 'WW':
        case 'd':
        case 'e':
        case 'E':
            token = token.substr(0, 1);
            /* falls through */
        case 'gggg':
        case 'GGGG':
        case 'GGGGG':
            token = token.substr(0, 2);
            if (input) {
                config._w = config._w || {};
                config._w[token] = toInt(input);
            }
            break;
        case 'gg':
        case 'GG':
            config._w = config._w || {};
            config._w[token] = moment.parseTwoDigitYear(input);
        }
    }

    function dayOfYearFromWeekInfo(config) {
        var w, weekYear, week, weekday, dow, doy, temp;

        w = config._w;
        if (w.GG != null || w.W != null || w.E != null) {
            dow = 1;
            doy = 4;

            // TODO: We need to take the current isoWeekYear, but that depends on
            // how we interpret now (local, utc, fixed offset). So create
            // a now version of current config (take local/utc/offset flags, and
            // create now).
            weekYear = dfl(w.GG, config._a[YEAR], weekOfYear(moment(), 1, 4).year);
            week = dfl(w.W, 1);
            weekday = dfl(w.E, 1);
        } else {
            dow = config._locale._week.dow;
            doy = config._locale._week.doy;

            weekYear = dfl(w.gg, config._a[YEAR], weekOfYear(moment(), dow, doy).year);
            week = dfl(w.w, 1);

            if (w.d != null) {
                // weekday -- low day numbers are considered next week
                weekday = w.d;
                if (weekday < dow) {
                    ++week;
                }
            } else if (w.e != null) {
                // local weekday -- counting starts from begining of week
                weekday = w.e + dow;
            } else {
                // default to begining of week
                weekday = dow;
            }
        }
        temp = dayOfYearFromWeeks(weekYear, week, weekday, doy, dow);

        config._a[YEAR] = temp.year;
        config._dayOfYear = temp.dayOfYear;
    }

    // convert an array to a date.
    // the array should mirror the parameters below
    // note: all values past the year are optional and will default to the lowest possible value.
    // [year, month, day , hour, minute, second, millisecond]
    function dateFromConfig(config) {
        var i, date, input = [], currentDate, yearToUse;

        if (config._d) {
            return;
        }

        currentDate = currentDateArray(config);

        //compute day of the year from weeks and weekdays
        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {
            dayOfYearFromWeekInfo(config);
        }

        //if the day of the year is set, figure out what it is
        if (config._dayOfYear) {
            yearToUse = dfl(config._a[YEAR], currentDate[YEAR]);

            if (config._dayOfYear > daysInYear(yearToUse)) {
                config._pf._overflowDayOfYear = true;
            }

            date = makeUTCDate(yearToUse, 0, config._dayOfYear);
            config._a[MONTH] = date.getUTCMonth();
            config._a[DATE] = date.getUTCDate();
        }

        // Default to current date.
        // * if no year, month, day of month are given, default to today
        // * if day of month is given, default month and year
        // * if month is given, default only year
        // * if year is given, don't default anything
        for (i = 0; i < 3 && config._a[i] == null; ++i) {
            config._a[i] = input[i] = currentDate[i];
        }

        // Zero out whatever was not defaulted, including time
        for (; i < 7; i++) {
            config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];
        }

        // Check for 24:00:00.000
        if (config._a[HOUR] === 24 &&
                config._a[MINUTE] === 0 &&
                config._a[SECOND] === 0 &&
                config._a[MILLISECOND] === 0) {
            config._nextDay = true;
            config._a[HOUR] = 0;
        }

        config._d = (config._useUTC ? makeUTCDate : makeDate).apply(null, input);
        // Apply timezone offset from input. The actual utcOffset can be changed
        // with parseZone.
        if (config._tzm != null) {
            config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
        }

        if (config._nextDay) {
            config._a[HOUR] = 24;
        }
    }

    function dateFromObject(config) {
        var normalizedInput;

        if (config._d) {
            return;
        }

        normalizedInput = normalizeObjectUnits(config._i);
        config._a = [
            normalizedInput.year,
            normalizedInput.month,
            normalizedInput.day || normalizedInput.date,
            normalizedInput.hour,
            normalizedInput.minute,
            normalizedInput.second,
            normalizedInput.millisecond
        ];

        dateFromConfig(config);
    }

    function currentDateArray(config) {
        var now = new Date();
        if (config._useUTC) {
            return [
                now.getUTCFullYear(),
                now.getUTCMonth(),
                now.getUTCDate()
            ];
        } else {
            return [now.getFullYear(), now.getMonth(), now.getDate()];
        }
    }

    // date from string and format string
    function makeDateFromStringAndFormat(config) {
        if (config._f === moment.ISO_8601) {
            parseISO(config);
            return;
        }

        config._a = [];
        config._pf.empty = true;

        // This array is used to make a Date, either with `new Date` or `Date.UTC`
        var string = '' + config._i,
            i, parsedInput, tokens, token, skipped,
            stringLength = string.length,
            totalParsedInputLength = 0;

        tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];

        for (i = 0; i < tokens.length; i++) {
            token = tokens[i];
            parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];
            if (parsedInput) {
                skipped = string.substr(0, string.indexOf(parsedInput));
                if (skipped.length > 0) {
                    config._pf.unusedInput.push(skipped);
                }
                string = string.slice(string.indexOf(parsedInput) + parsedInput.length);
                totalParsedInputLength += parsedInput.length;
            }
            // don't parse if it's not a known token
            if (formatTokenFunctions[token]) {
                if (parsedInput) {
                    config._pf.empty = false;
                }
                else {
                    config._pf.unusedTokens.push(token);
                }
                addTimeToArrayFromToken(token, parsedInput, config);
            }
            else if (config._strict && !parsedInput) {
                config._pf.unusedTokens.push(token);
            }
        }

        // add remaining unparsed input length to the string
        config._pf.charsLeftOver = stringLength - totalParsedInputLength;
        if (string.length > 0) {
            config._pf.unusedInput.push(string);
        }

        // clear _12h flag if hour is <= 12
        if (config._pf.bigHour === true && config._a[HOUR] <= 12) {
            config._pf.bigHour = undefined;
        }
        // handle meridiem
        config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR],
                config._meridiem);
        dateFromConfig(config);
        checkOverflow(config);
    }

    function unescapeFormat(s) {
        return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (matched, p1, p2, p3, p4) {
            return p1 || p2 || p3 || p4;
        });
    }

    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript
    function regexpEscape(s) {
        return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
    }

    // date from string and array of format strings
    function makeDateFromStringAndArray(config) {
        var tempConfig,
            bestMoment,

            scoreToBeat,
            i,
            currentScore;

        if (config._f.length === 0) {
            config._pf.invalidFormat = true;
            config._d = new Date(NaN);
            return;
        }

        for (i = 0; i < config._f.length; i++) {
            currentScore = 0;
            tempConfig = copyConfig({}, config);
            if (config._useUTC != null) {
                tempConfig._useUTC = config._useUTC;
            }
            tempConfig._pf = defaultParsingFlags();
            tempConfig._f = config._f[i];
            makeDateFromStringAndFormat(tempConfig);

            if (!isValid(tempConfig)) {
                continue;
            }

            // if there is any input that was not parsed add a penalty for that format
            currentScore += tempConfig._pf.charsLeftOver;

            //or tokens
            currentScore += tempConfig._pf.unusedTokens.length * 10;

            tempConfig._pf.score = currentScore;

            if (scoreToBeat == null || currentScore < scoreToBeat) {
                scoreToBeat = currentScore;
                bestMoment = tempConfig;
            }
        }

        extend(config, bestMoment || tempConfig);
    }

    // date from iso format
    function parseISO(config) {
        var i, l,
            string = config._i,
            match = isoRegex.exec(string);

        if (match) {
            config._pf.iso = true;
            for (i = 0, l = isoDates.length; i < l; i++) {
                if (isoDates[i][1].exec(string)) {
                    // match[5] should be 'T' or undefined
                    config._f = isoDates[i][0] + (match[6] || ' ');
                    break;
                }
            }
            for (i = 0, l = isoTimes.length; i < l; i++) {
                if (isoTimes[i][1].exec(string)) {
                    config._f += isoTimes[i][0];
                    break;
                }
            }
            if (string.match(parseTokenTimezone)) {
                config._f += 'Z';
            }
            makeDateFromStringAndFormat(config);
        } else {
            config._isValid = false;
        }
    }

    // date from iso format or fallback
    function makeDateFromString(config) {
        parseISO(config);
        if (config._isValid === false) {
            delete config._isValid;
            moment.createFromInputFallback(config);
        }
    }

    function map(arr, fn) {
        var res = [], i;
        for (i = 0; i < arr.length; ++i) {
            res.push(fn(arr[i], i));
        }
        return res;
    }

    function makeDateFromInput(config) {
        var input = config._i, matched;
        if (input === undefined) {
            config._d = new Date();
        } else if (isDate(input)) {
            config._d = new Date(+input);
        } else if ((matched = aspNetJsonRegex.exec(input)) !== null) {
            config._d = new Date(+matched[1]);
        } else if (typeof input === 'string') {
            makeDateFromString(config);
        } else if (isArray(input)) {
            config._a = map(input.slice(0), function (obj) {
                return parseInt(obj, 10);
            });
            dateFromConfig(config);
        } else if (typeof(input) === 'object') {
            dateFromObject(config);
        } else if (typeof(input) === 'number') {
            // from milliseconds
            config._d = new Date(input);
        } else {
            moment.createFromInputFallback(config);
        }
    }

    function makeDate(y, m, d, h, M, s, ms) {
        //can't just apply() to create a date:
        //http://stackoverflow.com/questions/181348/instantiating-a-javascript-object-by-calling-prototype-constructor-apply
        var date = new Date(y, m, d, h, M, s, ms);

        //the date constructor doesn't accept years < 1970
        if (y < 1970) {
            date.setFullYear(y);
        }
        return date;
    }

    function makeUTCDate(y) {
        var date = new Date(Date.UTC.apply(null, arguments));
        if (y < 1970) {
            date.setUTCFullYear(y);
        }
        return date;
    }

    function parseWeekday(input, locale) {
        if (typeof input === 'string') {
            if (!isNaN(input)) {
                input = parseInt(input, 10);
            }
            else {
                input = locale.weekdaysParse(input);
                if (typeof input !== 'number') {
                    return null;
                }
            }
        }
        return input;
    }

    /************************************
        Relative Time
    ************************************/


    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize
    function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {
        return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
    }

    function relativeTime(posNegDuration, withoutSuffix, locale) {
        var duration = moment.duration(posNegDuration).abs(),
            seconds = round(duration.as('s')),
            minutes = round(duration.as('m')),
            hours = round(duration.as('h')),
            days = round(duration.as('d')),
            months = round(duration.as('M')),
            years = round(duration.as('y')),

            args = seconds < relativeTimeThresholds.s && ['s', seconds] ||
                minutes === 1 && ['m'] ||
                minutes < relativeTimeThresholds.m && ['mm', minutes] ||
                hours === 1 && ['h'] ||
                hours < relativeTimeThresholds.h && ['hh', hours] ||
                days === 1 && ['d'] ||
                days < relativeTimeThresholds.d && ['dd', days] ||
                months === 1 && ['M'] ||
                months < relativeTimeThresholds.M && ['MM', months] ||
                years === 1 && ['y'] || ['yy', years];

        args[2] = withoutSuffix;
        args[3] = +posNegDuration > 0;
        args[4] = locale;
        return substituteTimeAgo.apply({}, args);
    }


    /************************************
        Week of Year
    ************************************/


    // firstDayOfWeek       0 = sun, 6 = sat
    //                      the day of the week that starts the week
    //                      (usually sunday or monday)
    // firstDayOfWeekOfYear 0 = sun, 6 = sat
    //                      the first week is the week that contains the first
    //                      of this day of the week
    //                      (eg. ISO weeks use thursday (4))
    function weekOfYear(mom, firstDayOfWeek, firstDayOfWeekOfYear) {
        var end = firstDayOfWeekOfYear - firstDayOfWeek,
            daysToDayOfWeek = firstDayOfWeekOfYear - mom.day(),
            adjustedMoment;


        if (daysToDayOfWeek > end) {
            daysToDayOfWeek -= 7;
        }

        if (daysToDayOfWeek < end - 7) {
            daysToDayOfWeek += 7;
        }

        adjustedMoment = moment(mom).add(daysToDayOfWeek, 'd');
        return {
            week: Math.ceil(adjustedMoment.dayOfYear() / 7),
            year: adjustedMoment.year()
        };
    }

    //http://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday
    function dayOfYearFromWeeks(year, week, weekday, firstDayOfWeekOfYear, firstDayOfWeek) {
        var d = makeUTCDate(year, 0, 1).getUTCDay(), daysToAdd, dayOfYear;

        d = d === 0 ? 7 : d;
        weekday = weekday != null ? weekday : firstDayOfWeek;
        daysToAdd = firstDayOfWeek - d + (d > firstDayOfWeekOfYear ? 7 : 0) - (d < firstDayOfWeek ? 7 : 0);
        dayOfYear = 7 * (week - 1) + (weekday - firstDayOfWeek) + daysToAdd + 1;

        return {
            year: dayOfYear > 0 ? year : year - 1,
            dayOfYear: dayOfYear > 0 ?  dayOfYear : daysInYear(year - 1) + dayOfYear
        };
    }

    /************************************
        Top Level Functions
    ************************************/

    function makeMoment(config) {
        var input = config._i,
            format = config._f,
            res;

        config._locale = config._locale || moment.localeData(config._l);

        if (input === null || (format === undefined && input === '')) {
            return moment.invalid({nullInput: true});
        }

        if (typeof input === 'string') {
            config._i = input = config._locale.preparse(input);
        }

        if (moment.isMoment(input)) {
            return new Moment(input, true);
        } else if (format) {
            if (isArray(format)) {
                makeDateFromStringAndArray(config);
            } else {
                makeDateFromStringAndFormat(config);
            }
        } else {
            makeDateFromInput(config);
        }

        res = new Moment(config);
        if (res._nextDay) {
            // Adding is smart enough around DST
            res.add(1, 'd');
            res._nextDay = undefined;
        }

        return res;
    }

    moment = function (input, format, locale, strict) {
        var c;

        if (typeof(locale) === 'boolean') {
            strict = locale;
            locale = undefined;
        }
        // object construction must be done this way.
        // https://github.com/moment/moment/issues/1423
        c = {};
        c._isAMomentObject = true;
        c._i = input;
        c._f = format;
        c._l = locale;
        c._strict = strict;
        c._isUTC = false;
        c._pf = defaultParsingFlags();

        return makeMoment(c);
    };

    moment.suppressDeprecationWarnings = false;

    moment.createFromInputFallback = deprecate(
        'moment construction falls back to js Date. This is ' +
        'discouraged and will be removed in upcoming major ' +
        'release. Please refer to ' +
        'https://github.com/moment/moment/issues/1407 for more info.',
        function (config) {
            config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));
        }
    );

    // Pick a moment m from moments so that m[fn](other) is true for all
    // other. This relies on the function fn to be transitive.
    //
    // moments should either be an array of moment objects or an array, whose
    // first element is an array of moment objects.
    function pickBy(fn, moments) {
        var res, i;
        if (moments.length === 1 && isArray(moments[0])) {
            moments = moments[0];
        }
        if (!moments.length) {
            return moment();
        }
        res = moments[0];
        for (i = 1; i < moments.length; ++i) {
            if (moments[i][fn](res)) {
                res = moments[i];
            }
        }
        return res;
    }

    moment.min = function () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isBefore', args);
    };

    moment.max = function () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isAfter', args);
    };

    // creating with utc
    moment.utc = function (input, format, locale, strict) {
        var c;

        if (typeof(locale) === 'boolean') {
            strict = locale;
            locale = undefined;
        }
        // object construction must be done this way.
        // https://github.com/moment/moment/issues/1423
        c = {};
        c._isAMomentObject = true;
        c._useUTC = true;
        c._isUTC = true;
        c._l = locale;
        c._i = input;
        c._f = format;
        c._strict = strict;
        c._pf = defaultParsingFlags();

        return makeMoment(c).utc();
    };

    // creating with unix timestamp (in seconds)
    moment.unix = function (input) {
        return moment(input * 1000);
    };

    // duration
    moment.duration = function (input, key) {
        var duration = input,
            // matching against regexp is expensive, do it on demand
            match = null,
            sign,
            ret,
            parseIso,
            diffRes;

        if (moment.isDuration(input)) {
            duration = {
                ms: input._milliseconds,
                d: input._days,
                M: input._months
            };
        } else if (typeof input === 'number') {
            duration = {};
            if (key) {
                duration[key] = input;
            } else {
                duration.milliseconds = input;
            }
        } else if (!!(match = aspNetTimeSpanJsonRegex.exec(input))) {
            sign = (match[1] === '-') ? -1 : 1;
            duration = {
                y: 0,
                d: toInt(match[DATE]) * sign,
                h: toInt(match[HOUR]) * sign,
                m: toInt(match[MINUTE]) * sign,
                s: toInt(match[SECOND]) * sign,
                ms: toInt(match[MILLISECOND]) * sign
            };
        } else if (!!(match = isoDurationRegex.exec(input))) {
            sign = (match[1] === '-') ? -1 : 1;
            parseIso = function (inp) {
                // We'd normally use ~~inp for this, but unfortunately it also
                // converts floats to ints.
                // inp may be undefined, so careful calling replace on it.
                var res = inp && parseFloat(inp.replace(',', '.'));
                // apply sign while we're at it
                return (isNaN(res) ? 0 : res) * sign;
            };
            duration = {
                y: parseIso(match[2]),
                M: parseIso(match[3]),
                d: parseIso(match[4]),
                h: parseIso(match[5]),
                m: parseIso(match[6]),
                s: parseIso(match[7]),
                w: parseIso(match[8])
            };
        } else if (duration == null) {// checks for null or undefined
            duration = {};
        } else if (typeof duration === 'object' &&
                ('from' in duration || 'to' in duration)) {
            diffRes = momentsDifference(moment(duration.from), moment(duration.to));

            duration = {};
            duration.ms = diffRes.milliseconds;
            duration.M = diffRes.months;
        }

        ret = new Duration(duration);

        if (moment.isDuration(input) && hasOwnProp(input, '_locale')) {
            ret._locale = input._locale;
        }

        return ret;
    };

    // version number
    moment.version = VERSION;

    // default format
    moment.defaultFormat = isoFormat;

    // constant that refers to the ISO standard
    moment.ISO_8601 = function () {};

    // Plugins that add properties should also add the key here (null value),
    // so we can properly clone ourselves.
    moment.momentProperties = momentProperties;

    // This function will be called whenever a moment is mutated.
    // It is intended to keep the offset in sync with the timezone.
    moment.updateOffset = function () {};

    // This function allows you to set a threshold for relative time strings
    moment.relativeTimeThreshold = function (threshold, limit) {
        if (relativeTimeThresholds[threshold] === undefined) {
            return false;
        }
        if (limit === undefined) {
            return relativeTimeThresholds[threshold];
        }
        relativeTimeThresholds[threshold] = limit;
        return true;
    };

    moment.lang = deprecate(
        'moment.lang is deprecated. Use moment.locale instead.',
        function (key, value) {
            return moment.locale(key, value);
        }
    );

    // This function will load locale and then set the global locale.  If
    // no arguments are passed in, it will simply return the current global
    // locale key.
    moment.locale = function (key, values) {
        var data;
        if (key) {
            if (typeof(values) !== 'undefined') {
                data = moment.defineLocale(key, values);
            }
            else {
                data = moment.localeData(key);
            }

            if (data) {
                moment.duration._locale = moment._locale = data;
            }
        }

        return moment._locale._abbr;
    };

    moment.defineLocale = function (name, values) {
        if (values !== null) {
            values.abbr = name;
            if (!locales[name]) {
                locales[name] = new Locale();
            }
            locales[name].set(values);

            // backwards compat for now: also set the locale
            moment.locale(name);

            return locales[name];
        } else {
            // useful for testing
            delete locales[name];
            return null;
        }
    };

    moment.langData = deprecate(
        'moment.langData is deprecated. Use moment.localeData instead.',
        function (key) {
            return moment.localeData(key);
        }
    );

    // returns locale data
    moment.localeData = function (key) {
        var locale;

        if (key && key._locale && key._locale._abbr) {
            key = key._locale._abbr;
        }

        if (!key) {
            return moment._locale;
        }

        if (!isArray(key)) {
            //short-circuit everything else
            locale = loadLocale(key);
            if (locale) {
                return locale;
            }
            key = [key];
        }

        return chooseLocale(key);
    };

    // compare moment object
    moment.isMoment = function (obj) {
        return obj instanceof Moment ||
            (obj != null && hasOwnProp(obj, '_isAMomentObject'));
    };

    // for typechecking Duration objects
    moment.isDuration = function (obj) {
        return obj instanceof Duration;
    };

    for (i = lists.length - 1; i >= 0; --i) {
        makeList(lists[i]);
    }

    moment.normalizeUnits = function (units) {
        return normalizeUnits(units);
    };

    moment.invalid = function (flags) {
        var m = moment.utc(NaN);
        if (flags != null) {
            extend(m._pf, flags);
        }
        else {
            m._pf.userInvalidated = true;
        }

        return m;
    };

    moment.parseZone = function () {
        return moment.apply(null, arguments).parseZone();
    };

    moment.parseTwoDigitYear = function (input) {
        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);
    };

    moment.isDate = isDate;

    /************************************
        Moment Prototype
    ************************************/


    extend(moment.fn = Moment.prototype, {

        clone : function () {
            return moment(this);
        },

        valueOf : function () {
            return +this._d - ((this._offset || 0) * 60000);
        },

        unix : function () {
            return Math.floor(+this / 1000);
        },

        toString : function () {
            return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');
        },

        toDate : function () {
            return this._offset ? new Date(+this) : this._d;
        },

        toISOString : function () {
            var m = moment(this).utc();
            if (0 < m.year() && m.year() <= 9999) {
                if ('function' === typeof Date.prototype.toISOString) {
                    // native implementation is ~50x faster, use it when we can
                    return this.toDate().toISOString();
                } else {
                    return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
                }
            } else {
                return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
            }
        },

        toArray : function () {
            var m = this;
            return [
                m.year(),
                m.month(),
                m.date(),
                m.hours(),
                m.minutes(),
                m.seconds(),
                m.milliseconds()
            ];
        },

        isValid : function () {
            return isValid(this);
        },

        isDSTShifted : function () {
            if (this._a) {
                return this.isValid() && compareArrays(this._a, (this._isUTC ? moment.utc(this._a) : moment(this._a)).toArray()) > 0;
            }

            return false;
        },

        parsingFlags : function () {
            return extend({}, this._pf);
        },

        invalidAt: function () {
            return this._pf.overflow;
        },

        utc : function (keepLocalTime) {
            return this.utcOffset(0, keepLocalTime);
        },

        local : function (keepLocalTime) {
            if (this._isUTC) {
                this.utcOffset(0, keepLocalTime);
                this._isUTC = false;

                if (keepLocalTime) {
                    this.subtract(this._dateUtcOffset(), 'm');
                }
            }
            return this;
        },

        format : function (inputString) {
            var output = formatMoment(this, inputString || moment.defaultFormat);
            return this.localeData().postformat(output);
        },

        add : createAdder(1, 'add'),

        subtract : createAdder(-1, 'subtract'),

        diff : function (input, units, asFloat) {
            var that = makeAs(input, this),
                zoneDiff = (that.utcOffset() - this.utcOffset()) * 6e4,
                anchor, diff, output, daysAdjust;

            units = normalizeUnits(units);

            if (units === 'year' || units === 'month' || units === 'quarter') {
                output = monthDiff(this, that);
                if (units === 'quarter') {
                    output = output / 3;
                } else if (units === 'year') {
                    output = output / 12;
                }
            } else {
                diff = this - that;
                output = units === 'second' ? diff / 1e3 : // 1000
                    units === 'minute' ? diff / 6e4 : // 1000 * 60
                    units === 'hour' ? diff / 36e5 : // 1000 * 60 * 60
                    units === 'day' ? (diff - zoneDiff) / 864e5 : // 1000 * 60 * 60 * 24, negate dst
                    units === 'week' ? (diff - zoneDiff) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst
                    diff;
            }
            return asFloat ? output : absRound(output);
        },

        from : function (time, withoutSuffix) {
            return moment.duration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);
        },

        fromNow : function (withoutSuffix) {
            return this.from(moment(), withoutSuffix);
        },

        calendar : function (time) {
            // We want to compare the start of today, vs this.
            // Getting start-of-today depends on whether we're locat/utc/offset
            // or not.
            var now = time || moment(),
                sod = makeAs(now, this).startOf('day'),
                diff = this.diff(sod, 'days', true),
                format = diff < -6 ? 'sameElse' :
                    diff < -1 ? 'lastWeek' :
                    diff < 0 ? 'lastDay' :
                    diff < 1 ? 'sameDay' :
                    diff < 2 ? 'nextDay' :
                    diff < 7 ? 'nextWeek' : 'sameElse';
            return this.format(this.localeData().calendar(format, this, moment(now)));
        },

        isLeapYear : function () {
            return isLeapYear(this.year());
        },

        isDST : function () {
            return (this.utcOffset() > this.clone().month(0).utcOffset() ||
                this.utcOffset() > this.clone().month(5).utcOffset());
        },

        day : function (input) {
            var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
            if (input != null) {
                input = parseWeekday(input, this.localeData());
                return this.add(input - day, 'd');
            } else {
                return day;
            }
        },

        month : makeAccessor('Month', true),

        startOf : function (units) {
            units = normalizeUnits(units);
            // the following switch intentionally omits break keywords
            // to utilize falling through the cases.
            switch (units) {
            case 'year':
                this.month(0);
                /* falls through */
            case 'quarter':
            case 'month':
                this.date(1);
                /* falls through */
            case 'week':
            case 'isoWeek':
            case 'day':
                this.hours(0);
                /* falls through */
            case 'hour':
                this.minutes(0);
                /* falls through */
            case 'minute':
                this.seconds(0);
                /* falls through */
            case 'second':
                this.milliseconds(0);
                /* falls through */
            }

            // weeks are a special case
            if (units === 'week') {
                this.weekday(0);
            } else if (units === 'isoWeek') {
                this.isoWeekday(1);
            }

            // quarters are also special
            if (units === 'quarter') {
                this.month(Math.floor(this.month() / 3) * 3);
            }

            return this;
        },

        endOf: function (units) {
            units = normalizeUnits(units);
            if (units === undefined || units === 'millisecond') {
                return this;
            }
            return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');
        },

        isAfter: function (input, units) {
            var inputMs;
            units = normalizeUnits(typeof units !== 'undefined' ? units : 'millisecond');
            if (units === 'millisecond') {
                input = moment.isMoment(input) ? input : moment(input);
                return +this > +input;
            } else {
                inputMs = moment.isMoment(input) ? +input : +moment(input);
                return inputMs < +this.clone().startOf(units);
            }
        },

        isBefore: function (input, units) {
            var inputMs;
            units = normalizeUnits(typeof units !== 'undefined' ? units : 'millisecond');
            if (units === 'millisecond') {
                input = moment.isMoment(input) ? input : moment(input);
                return +this < +input;
            } else {
                inputMs = moment.isMoment(input) ? +input : +moment(input);
                return +this.clone().endOf(units) < inputMs;
            }
        },

        isBetween: function (from, to, units) {
            return this.isAfter(from, units) && this.isBefore(to, units);
        },

        isSame: function (input, units) {
            var inputMs;
            units = normalizeUnits(units || 'millisecond');
            if (units === 'millisecond') {
                input = moment.isMoment(input) ? input : moment(input);
                return +this === +input;
            } else {
                inputMs = +moment(input);
                return +(this.clone().startOf(units)) <= inputMs && inputMs <= +(this.clone().endOf(units));
            }
        },

        min: deprecate(
                 'moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548',
                 function (other) {
                     other = moment.apply(null, arguments);
                     return other < this ? this : other;
                 }
         ),

        max: deprecate(
                'moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548',
                function (other) {
                    other = moment.apply(null, arguments);
                    return other > this ? this : other;
                }
        ),

        zone : deprecate(
                'moment().zone is deprecated, use moment().utcOffset instead. ' +
                'https://github.com/moment/moment/issues/1779',
                function (input, keepLocalTime) {
                    if (input != null) {
                        if (typeof input !== 'string') {
                            input = -input;
                        }

                        this.utcOffset(input, keepLocalTime);

                        return this;
                    } else {
                        return -this.utcOffset();
                    }
                }
        ),

        // keepLocalTime = true means only change the timezone, without
        // affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->
        // 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset
        // +0200, so we adjust the time as needed, to be valid.
        //
        // Keeping the time actually adds/subtracts (one hour)
        // from the actual represented time. That is why we call updateOffset
        // a second time. In case it wants us to change the offset again
        // _changeInProgress == true case, then we have to adjust, because
        // there is no such time in the given timezone.
        utcOffset : function (input, keepLocalTime) {
            var offset = this._offset || 0,
                localAdjust;
            if (input != null) {
                if (typeof input === 'string') {
                    input = utcOffsetFromString(input);
                }
                if (Math.abs(input) < 16) {
                    input = input * 60;
                }
                if (!this._isUTC && keepLocalTime) {
                    localAdjust = this._dateUtcOffset();
                }
                this._offset = input;
                this._isUTC = true;
                if (localAdjust != null) {
                    this.add(localAdjust, 'm');
                }
                if (offset !== input) {
                    if (!keepLocalTime || this._changeInProgress) {
                        addOrSubtractDurationFromMoment(this,
                                moment.duration(input - offset, 'm'), 1, false);
                    } else if (!this._changeInProgress) {
                        this._changeInProgress = true;
                        moment.updateOffset(this, true);
                        this._changeInProgress = null;
                    }
                }

                return this;
            } else {
                return this._isUTC ? offset : this._dateUtcOffset();
            }
        },

        isLocal : function () {
            return !this._isUTC;
        },

        isUtcOffset : function () {
            return this._isUTC;
        },

        isUtc : function () {
            return this._isUTC && this._offset === 0;
        },

        zoneAbbr : function () {
            return this._isUTC ? 'UTC' : '';
        },

        zoneName : function () {
            return this._isUTC ? 'Coordinated Universal Time' : '';
        },

        parseZone : function () {
            if (this._tzm) {
                this.utcOffset(this._tzm);
            } else if (typeof this._i === 'string') {
                this.utcOffset(utcOffsetFromString(this._i));
            }
            return this;
        },

        hasAlignedHourOffset : function (input) {
            if (!input) {
                input = 0;
            }
            else {
                input = moment(input).utcOffset();
            }

            return (this.utcOffset() - input) % 60 === 0;
        },

        daysInMonth : function () {
            return daysInMonth(this.year(), this.month());
        },

        dayOfYear : function (input) {
            var dayOfYear = round((moment(this).startOf('day') - moment(this).startOf('year')) / 864e5) + 1;
            return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');
        },

        quarter : function (input) {
            return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
        },

        weekYear : function (input) {
            var year = weekOfYear(this, this.localeData()._week.dow, this.localeData()._week.doy).year;
            return input == null ? year : this.add((input - year), 'y');
        },

        isoWeekYear : function (input) {
            var year = weekOfYear(this, 1, 4).year;
            return input == null ? year : this.add((input - year), 'y');
        },

        week : function (input) {
            var week = this.localeData().week(this);
            return input == null ? week : this.add((input - week) * 7, 'd');
        },

        isoWeek : function (input) {
            var week = weekOfYear(this, 1, 4).week;
            return input == null ? week : this.add((input - week) * 7, 'd');
        },

        weekday : function (input) {
            var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;
            return input == null ? weekday : this.add(input - weekday, 'd');
        },

        isoWeekday : function (input) {
            // behaves the same as moment#day except
            // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)
            // as a setter, sunday should belong to the previous week.
            return input == null ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7);
        },

        isoWeeksInYear : function () {
            return weeksInYear(this.year(), 1, 4);
        },

        weeksInYear : function () {
            var weekInfo = this.localeData()._week;
            return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);
        },

        get : function (units) {
            units = normalizeUnits(units);
            return this[units]();
        },

        set : function (units, value) {
            var unit;
            if (typeof units === 'object') {
                for (unit in units) {
                    this.set(unit, units[unit]);
                }
            }
            else {
                units = normalizeUnits(units);
                if (typeof this[units] === 'function') {
                    this[units](value);
                }
            }
            return this;
        },

        // If passed a locale key, it will set the locale for this
        // instance.  Otherwise, it will return the locale configuration
        // variables for this instance.
        locale : function (key) {
            var newLocaleData;

            if (key === undefined) {
                return this._locale._abbr;
            } else {
                newLocaleData = moment.localeData(key);
                if (newLocaleData != null) {
                    this._locale = newLocaleData;
                }
                return this;
            }
        },

        lang : deprecate(
            'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',
            function (key) {
                if (key === undefined) {
                    return this.localeData();
                } else {
                    return this.locale(key);
                }
            }
        ),

        localeData : function () {
            return this._locale;
        },

        _dateUtcOffset : function () {
            // On Firefox.24 Date#getTimezoneOffset returns a floating point.
            // https://github.com/moment/moment/pull/1871
            return -Math.round(this._d.getTimezoneOffset() / 15) * 15;
        }

    });

    function rawMonthSetter(mom, value) {
        var dayOfMonth;

        // TODO: Move this out of here!
        if (typeof value === 'string') {
            value = mom.localeData().monthsParse(value);
            // TODO: Another silent failure?
            if (typeof value !== 'number') {
                return mom;
            }
        }

        dayOfMonth = Math.min(mom.date(),
                daysInMonth(mom.year(), value));
        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);
        return mom;
    }

    function rawGetter(mom, unit) {
        return mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]();
    }

    function rawSetter(mom, unit, value) {
        if (unit === 'Month') {
            return rawMonthSetter(mom, value);
        } else {
            return mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);
        }
    }

    function makeAccessor(unit, keepTime) {
        return function (value) {
            if (value != null) {
                rawSetter(this, unit, value);
                moment.updateOffset(this, keepTime);
                return this;
            } else {
                return rawGetter(this, unit);
            }
        };
    }

    moment.fn.millisecond = moment.fn.milliseconds = makeAccessor('Milliseconds', false);
    moment.fn.second = moment.fn.seconds = makeAccessor('Seconds', false);
    moment.fn.minute = moment.fn.minutes = makeAccessor('Minutes', false);
    // Setting the hour should keep the time, because the user explicitly
    // specified which hour he wants. So trying to maintain the same hour (in
    // a new timezone) makes sense. Adding/subtracting hours does not follow
    // this rule.
    moment.fn.hour = moment.fn.hours = makeAccessor('Hours', true);
    // moment.fn.month is defined separately
    moment.fn.date = makeAccessor('Date', true);
    moment.fn.dates = deprecate('dates accessor is deprecated. Use date instead.', makeAccessor('Date', true));
    moment.fn.year = makeAccessor('FullYear', true);
    moment.fn.years = deprecate('years accessor is deprecated. Use year instead.', makeAccessor('FullYear', true));

    // add plural methods
    moment.fn.days = moment.fn.day;
    moment.fn.months = moment.fn.month;
    moment.fn.weeks = moment.fn.week;
    moment.fn.isoWeeks = moment.fn.isoWeek;
    moment.fn.quarters = moment.fn.quarter;

    // add aliased format methods
    moment.fn.toJSON = moment.fn.toISOString;

    // alias isUtc for dev-friendliness
    moment.fn.isUTC = moment.fn.isUtc;

    /************************************
        Duration Prototype
    ************************************/


    function daysToYears (days) {
        // 400 years have 146097 days (taking into account leap year rules)
        return days * 400 / 146097;
    }

    function yearsToDays (years) {
        // years * 365 + absRound(years / 4) -
        //     absRound(years / 100) + absRound(years / 400);
        return years * 146097 / 400;
    }

    extend(moment.duration.fn = Duration.prototype, {

        _bubble : function () {
            var milliseconds = this._milliseconds,
                days = this._days,
                months = this._months,
                data = this._data,
                seconds, minutes, hours, years = 0;

            // The following code bubbles up values, see the tests for
            // examples of what that means.
            data.milliseconds = milliseconds % 1000;

            seconds = absRound(milliseconds / 1000);
            data.seconds = seconds % 60;

            minutes = absRound(seconds / 60);
            data.minutes = minutes % 60;

            hours = absRound(minutes / 60);
            data.hours = hours % 24;

            days += absRound(hours / 24);

            // Accurately convert days to years, assume start from year 0.
            years = absRound(daysToYears(days));
            days -= absRound(yearsToDays(years));

            // 30 days to a month
            // TODO (iskren): Use anchor date (like 1st Jan) to compute this.
            months += absRound(days / 30);
            days %= 30;

            // 12 months -> 1 year
            years += absRound(months / 12);
            months %= 12;

            data.days = days;
            data.months = months;
            data.years = years;
        },

        abs : function () {
            this._milliseconds = Math.abs(this._milliseconds);
            this._days = Math.abs(this._days);
            this._months = Math.abs(this._months);

            this._data.milliseconds = Math.abs(this._data.milliseconds);
            this._data.seconds = Math.abs(this._data.seconds);
            this._data.minutes = Math.abs(this._data.minutes);
            this._data.hours = Math.abs(this._data.hours);
            this._data.months = Math.abs(this._data.months);
            this._data.years = Math.abs(this._data.years);

            return this;
        },

        weeks : function () {
            return absRound(this.days() / 7);
        },

        valueOf : function () {
            return this._milliseconds +
              this._days * 864e5 +
              (this._months % 12) * 2592e6 +
              toInt(this._months / 12) * 31536e6;
        },

        humanize : function (withSuffix) {
            var output = relativeTime(this, !withSuffix, this.localeData());

            if (withSuffix) {
                output = this.localeData().pastFuture(+this, output);
            }

            return this.localeData().postformat(output);
        },

        add : function (input, val) {
            // supports only 2.0-style add(1, 's') or add(moment)
            var dur = moment.duration(input, val);

            this._milliseconds += dur._milliseconds;
            this._days += dur._days;
            this._months += dur._months;

            this._bubble();

            return this;
        },

        subtract : function (input, val) {
            var dur = moment.duration(input, val);

            this._milliseconds -= dur._milliseconds;
            this._days -= dur._days;
            this._months -= dur._months;

            this._bubble();

            return this;
        },

        get : function (units) {
            units = normalizeUnits(units);
            return this[units.toLowerCase() + 's']();
        },

        as : function (units) {
            var days, months;
            units = normalizeUnits(units);

            if (units === 'month' || units === 'year') {
                days = this._days + this._milliseconds / 864e5;
                months = this._months + daysToYears(days) * 12;
                return units === 'month' ? months : months / 12;
            } else {
                // handle milliseconds separately because of floating point math errors (issue #1867)
                days = this._days + Math.round(yearsToDays(this._months / 12));
                switch (units) {
                    case 'week': return days / 7 + this._milliseconds / 6048e5;
                    case 'day': return days + this._milliseconds / 864e5;
                    case 'hour': return days * 24 + this._milliseconds / 36e5;
                    case 'minute': return days * 24 * 60 + this._milliseconds / 6e4;
                    case 'second': return days * 24 * 60 * 60 + this._milliseconds / 1000;
                    // Math.floor prevents floating point math errors here
                    case 'millisecond': return Math.floor(days * 24 * 60 * 60 * 1000) + this._milliseconds;
                    default: throw new Error('Unknown unit ' + units);
                }
            }
        },

        lang : moment.fn.lang,
        locale : moment.fn.locale,

        toIsoString : deprecate(
            'toIsoString() is deprecated. Please use toISOString() instead ' +
            '(notice the capitals)',
            function () {
                return this.toISOString();
            }
        ),

        toISOString : function () {
            // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js
            var years = Math.abs(this.years()),
                months = Math.abs(this.months()),
                days = Math.abs(this.days()),
                hours = Math.abs(this.hours()),
                minutes = Math.abs(this.minutes()),
                seconds = Math.abs(this.seconds() + this.milliseconds() / 1000);

            if (!this.asSeconds()) {
                // this is the same as C#'s (Noda) and python (isodate)...
                // but not other JS (goog.date)
                return 'P0D';
            }

            return (this.asSeconds() < 0 ? '-' : '') +
                'P' +
                (years ? years + 'Y' : '') +
                (months ? months + 'M' : '') +
                (days ? days + 'D' : '') +
                ((hours || minutes || seconds) ? 'T' : '') +
                (hours ? hours + 'H' : '') +
                (minutes ? minutes + 'M' : '') +
                (seconds ? seconds + 'S' : '');
        },

        localeData : function () {
            return this._locale;
        },

        toJSON : function () {
            return this.toISOString();
        }
    });

    moment.duration.fn.toString = moment.duration.fn.toISOString;

    function makeDurationGetter(name) {
        moment.duration.fn[name] = function () {
            return this._data[name];
        };
    }

    for (i in unitMillisecondFactors) {
        if (hasOwnProp(unitMillisecondFactors, i)) {
            makeDurationGetter(i.toLowerCase());
        }
    }

    moment.duration.fn.asMilliseconds = function () {
        return this.as('ms');
    };
    moment.duration.fn.asSeconds = function () {
        return this.as('s');
    };
    moment.duration.fn.asMinutes = function () {
        return this.as('m');
    };
    moment.duration.fn.asHours = function () {
        return this.as('h');
    };
    moment.duration.fn.asDays = function () {
        return this.as('d');
    };
    moment.duration.fn.asWeeks = function () {
        return this.as('weeks');
    };
    moment.duration.fn.asMonths = function () {
        return this.as('M');
    };
    moment.duration.fn.asYears = function () {
        return this.as('y');
    };

    /************************************
        Default Locale
    ************************************/


    // Set default locale, other locale will inherit from English.
    moment.locale('en', {
        ordinalParse: /\d{1,2}(th|st|nd|rd)/,
        ordinal : function (number) {
            var b = number % 10,
                output = (toInt(number % 100 / 10) === 1) ? 'th' :
                (b === 1) ? 'st' :
                (b === 2) ? 'nd' :
                (b === 3) ? 'rd' : 'th';
            return number + output;
        }
    });

    /* EMBED_LOCALES */

    /************************************
        Exposing Moment
    ************************************/

    function makeGlobal(shouldDeprecate) {
        /*global ender:false */
        if (typeof ender !== 'undefined') {
            return;
        }
        oldGlobalMoment = globalScope.moment;
        if (shouldDeprecate) {
            globalScope.moment = deprecate(
                    'Accessing Moment through the global scope is ' +
                    'deprecated, and will be removed in an upcoming ' +
                    'release.',
                    moment);
        } else {
            globalScope.moment = moment;
        }
    }

    // CommonJS module is defined
    if (hasModule) {
        module.exports = moment;
    } else if (typeof define === 'function' && define.amd) {
        define(function (require, exports, module) {
            if (module.config && module.config() && module.config().noGlobal === true) {
                // release the global variable
                globalScope.moment = oldGlobalMoment;
            }

            return moment;
        });
        makeGlobal(true);
    } else {
        makeGlobal();
    }
}).call(this);

//! moment-timezone.js
//! version : 0.5.0
//! author : Tim Wood
//! license : MIT
//! github.com/moment/moment-timezone

(function (root, factory) {
	"use strict";

	/*global define*/
	if (typeof define === 'function' && define.amd) {
		define(['moment'], factory);                 // AMD
	} else if (typeof module === 'object' && module.exports) {
		module.exports = factory(require('moment')); // Node
	} else {
		factory(root.moment);                        // Browser
	}
}(this, function (moment) {
	"use strict";

	// Do not load moment-timezone a second time.
	if (moment.tz !== undefined) {
		logError('Moment Timezone ' + moment.tz.version + ' was already loaded ' + (moment.tz.dataVersion ? 'with data from ' : 'without any data') + moment.tz.dataVersion);
		return moment;
	}

	var VERSION = "0.5.0",
		zones = {},
		links = {},
		names = {},
		guesses = {},
		cachedGuess,

		momentVersion = moment.version.split('.'),
		major = +momentVersion[0],
		minor = +momentVersion[1];

	// Moment.js version check
	if (major < 2 || (major === 2 && minor < 6)) {
		logError('Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js ' + moment.version + '. See momentjs.com');
	}

	/************************************
		Unpacking
	************************************/

	function charCodeToInt(charCode) {
		if (charCode > 96) {
			return charCode - 87;
		} else if (charCode > 64) {
			return charCode - 29;
		}
		return charCode - 48;
	}

	function unpackBase60(string) {
		var i = 0,
			parts = string.split('.'),
			whole = parts[0],
			fractional = parts[1] || '',
			multiplier = 1,
			num,
			out = 0,
			sign = 1;

		// handle negative numbers
		if (string.charCodeAt(0) === 45) {
			i = 1;
			sign = -1;
		}

		// handle digits before the decimal
		for (i; i < whole.length; i++) {
			num = charCodeToInt(whole.charCodeAt(i));
			out = 60 * out + num;
		}

		// handle digits after the decimal
		for (i = 0; i < fractional.length; i++) {
			multiplier = multiplier / 60;
			num = charCodeToInt(fractional.charCodeAt(i));
			out += num * multiplier;
		}

		return out * sign;
	}

	function arrayToInt (array) {
		for (var i = 0; i < array.length; i++) {
			array[i] = unpackBase60(array[i]);
		}
	}

	function intToUntil (array, length) {
		for (var i = 0; i < length; i++) {
			array[i] = Math.round((array[i - 1] || 0) + (array[i] * 60000)); // minutes to milliseconds
		}

		array[length - 1] = Infinity;
	}

	function mapIndices (source, indices) {
		var out = [], i;

		for (i = 0; i < indices.length; i++) {
			out[i] = source[indices[i]];
		}

		return out;
	}

	function unpack (string) {
		var data = string.split('|'),
			offsets = data[2].split(' '),
			indices = data[3].split(''),
			untils  = data[4].split(' ');

		arrayToInt(offsets);
		arrayToInt(indices);
		arrayToInt(untils);

		intToUntil(untils, indices.length);

		return {
			name       : data[0],
			abbrs      : mapIndices(data[1].split(' '), indices),
			offsets    : mapIndices(offsets, indices),
			untils     : untils,
			population : data[5] | 0
		};
	}

	/************************************
		Zone object
	************************************/

	function Zone (packedString) {
		if (packedString) {
			this._set(unpack(packedString));
		}
	}

	Zone.prototype = {
		_set : function (unpacked) {
			this.name       = unpacked.name;
			this.abbrs      = unpacked.abbrs;
			this.untils     = unpacked.untils;
			this.offsets    = unpacked.offsets;
			this.population = unpacked.population;
		},

		_index : function (timestamp) {
			var target = +timestamp,
				untils = this.untils,
				i;

			for (i = 0; i < untils.length; i++) {
				if (target < untils[i]) {
					return i;
				}
			}
		},

		parse : function (timestamp) {
			var target  = +timestamp,
				offsets = this.offsets,
				untils  = this.untils,
				max     = untils.length - 1,
				offset, offsetNext, offsetPrev, i;

			for (i = 0; i < max; i++) {
				offset     = offsets[i];
				offsetNext = offsets[i + 1];
				offsetPrev = offsets[i ? i - 1 : i];

				if (offset < offsetNext && tz.moveAmbiguousForward) {
					offset = offsetNext;
				} else if (offset > offsetPrev && tz.moveInvalidForward) {
					offset = offsetPrev;
				}

				if (target < untils[i] - (offset * 60000)) {
					return offsets[i];
				}
			}

			return offsets[max];
		},

		abbr : function (mom) {
			return this.abbrs[this._index(mom)];
		},

		offset : function (mom) {
			return this.offsets[this._index(mom)];
		}
	};

	/************************************
		Current Timezone
	************************************/

	function OffsetAt(at) {
		var timeString = at.toTimeString();
		var abbr = timeString.match(/\(.+\)/);
		if (abbr && abbr[0]) {
			// 17:56:31 GMT-0600 (CST)
			// 17:56:31 GMT-0600 (Central Standard Time)
			abbr = abbr[0].match(/[A-Z]/g).join('');
		} else {
			// 17:56:31 CST
			abbr = timeString.match(/[A-Z]{3,5}/g)[0];
		}

		if (abbr === 'GMT') {
			abbr = undefined;
		}

		this.at = +at;
		this.abbr = abbr;
		this.offset = at.getTimezoneOffset();
	}

	function ZoneScore(zone) {
		this.zone = zone;
		this.offsetScore = 0;
		this.abbrScore = 0;
	}

	ZoneScore.prototype.scoreOffsetAt = function (offsetAt) {
		this.offsetScore += Math.abs(this.zone.offset(offsetAt.at) - offsetAt.offset);
		if (this.zone.abbr(offsetAt.at).match(/[A-Z]/g).join('') !== offsetAt.abbr) {
			this.abbrScore++;
		}
	};

	function findChange(low, high) {
		var mid, diff;

		while ((diff = ((high.at - low.at) / 12e4 | 0) * 6e4)) {
			mid = new OffsetAt(new Date(low.at + diff));
			if (mid.offset === low.offset) {
				low = mid;
			} else {
				high = mid;
			}
		}

		return low;
	}

	function userOffsets() {
		var startYear = new Date().getFullYear() - 2,
			last = new OffsetAt(new Date(startYear, 0, 1)),
			offsets = [last],
			change, next, i;

		for (i = 1; i < 48; i++) {
			next = new OffsetAt(new Date(startYear, i, 1));
			if (next.offset !== last.offset) {
				change = findChange(last, next);
				offsets.push(change);
				offsets.push(new OffsetAt(new Date(change.at + 6e4)));
			}
			last = next;
		}

		for (i = 0; i < 4; i++) {
			offsets.push(new OffsetAt(new Date(startYear + i, 0, 1)));
			offsets.push(new OffsetAt(new Date(startYear + i, 6, 1)));
		}

		return offsets;
	}

	function sortZoneScores (a, b) {
		if (a.offsetScore !== b.offsetScore) {
			return a.offsetScore - b.offsetScore;
		}
		if (a.abbrScore !== b.abbrScore) {
			return a.abbrScore - b.abbrScore;
		}
		return b.zone.population - a.zone.population;
	}

	function addToGuesses (name, offsets) {
		var i, offset;
		arrayToInt(offsets);
		for (i = 0; i < offsets.length; i++) {
			offset = offsets[i];
			guesses[offset] = guesses[offset] || {};
			guesses[offset][name] = true;
		}
	}

	function guessesForUserOffsets (offsets) {
		var offsetsLength = offsets.length,
			filteredGuesses = {},
			out = [],
			i, j, guessesOffset;

		for (i = 0; i < offsetsLength; i++) {
			guessesOffset = guesses[offsets[i].offset] || {};
			for (j in guessesOffset) {
				if (guessesOffset.hasOwnProperty(j)) {
					filteredGuesses[j] = true;
				}
			}
		}

		for (i in filteredGuesses) {
			if (filteredGuesses.hasOwnProperty(i)) {
				out.push(names[i]);
			}
		}

		return out;
	}

	function rebuildGuess () {
		var offsets = userOffsets(),
			offsetsLength = offsets.length,
			guesses = guessesForUserOffsets(offsets),
			zoneScores = [],
			zoneScore, i, j;

		for (i = 0; i < guesses.length; i++) {
			zoneScore = new ZoneScore(getZone(guesses[i]), offsetsLength);
			for (j = 0; j < offsetsLength; j++) {
				zoneScore.scoreOffsetAt(offsets[j]);
			}
			zoneScores.push(zoneScore);
		}

		zoneScores.sort(sortZoneScores);

		return zoneScores.length > 0 ? zoneScores[0].zone.name : undefined;
	}

	function guess (ignoreCache) {
		if (!cachedGuess || ignoreCache) {
			cachedGuess = rebuildGuess();
		}
		return cachedGuess;
	}

	/************************************
		Global Methods
	************************************/

	function normalizeName (name) {
		return (name || '').toLowerCase().replace(/\//g, '_');
	}

	function addZone (packed) {
		var i, name, split, normalized;

		if (typeof packed === "string") {
			packed = [packed];
		}

		for (i = 0; i < packed.length; i++) {
			split = packed[i].split('|');
			name = split[0];
			normalized = normalizeName(name);
			zones[normalized] = packed[i];
			names[normalized] = name;
			if (split[5]) {
				addToGuesses(normalized, split[2].split(' '));
			}
		}
	}

	function getZone (name, caller) {
		name = normalizeName(name);

		var zone = zones[name];
		var link;

		if (zone instanceof Zone) {
			return zone;
		}

		if (typeof zone === 'string') {
			zone = new Zone(zone);
			zones[name] = zone;
			return zone;
		}

		// Pass getZone to prevent recursion more than 1 level deep
		if (links[name] && caller !== getZone && (link = getZone(links[name], getZone))) {
			zone = zones[name] = new Zone();
			zone._set(link);
			zone.name = names[name];
			return zone;
		}

		return null;
	}

	function getNames () {
		var i, out = [];

		for (i in names) {
			if (names.hasOwnProperty(i) && (zones[i] || zones[links[i]]) && names[i]) {
				out.push(names[i]);
			}
		}

		return out.sort();
	}

	function addLink (aliases) {
		var i, alias, normal0, normal1;

		if (typeof aliases === "string") {
			aliases = [aliases];
		}

		for (i = 0; i < aliases.length; i++) {
			alias = aliases[i].split('|');

			normal0 = normalizeName(alias[0]);
			normal1 = normalizeName(alias[1]);

			links[normal0] = normal1;
			names[normal0] = alias[0];

			links[normal1] = normal0;
			names[normal1] = alias[1];
		}
	}

	function loadData (data) {
		addZone(data.zones);
		addLink(data.links);
		tz.dataVersion = data.version;
	}

	function zoneExists (name) {
		if (!zoneExists.didShowError) {
			zoneExists.didShowError = true;
				logError("moment.tz.zoneExists('" + name + "') has been deprecated in favor of !moment.tz.zone('" + name + "')");
		}
		return !!getZone(name);
	}

	function needsOffset (m) {
		return !!(m._a && (m._tzm === undefined));
	}

	function logError (message) {
		if (typeof console !== 'undefined' && typeof console.error === 'function') {
			console.error(message);
		}
	}

	/************************************
		moment.tz namespace
	************************************/

	function tz (input) {
		var args = Array.prototype.slice.call(arguments, 0, -1),
			name = arguments[arguments.length - 1],
			zone = getZone(name),
			out  = moment.utc.apply(null, args);

		if (zone && !moment.isMoment(input) && needsOffset(out)) {
			out.add(zone.parse(out), 'minutes');
		}

		out.tz(name);

		return out;
	}

	tz.version      = VERSION;
	tz.dataVersion  = '';
	tz._zones       = zones;
	tz._links       = links;
	tz._names       = names;
	tz.add          = addZone;
	tz.link         = addLink;
	tz.load         = loadData;
	tz.zone         = getZone;
	tz.zoneExists   = zoneExists; // deprecated in 0.1.0
	tz.guess        = guess;
	tz.names        = getNames;
	tz.Zone         = Zone;
	tz.unpack       = unpack;
	tz.unpackBase60 = unpackBase60;
	tz.needsOffset  = needsOffset;
	tz.moveInvalidForward   = true;
	tz.moveAmbiguousForward = false;

	/************************************
		Interface with Moment.js
	************************************/

	var fn = moment.fn;

	moment.tz = tz;

	moment.defaultZone = null;

	moment.updateOffset = function (mom, keepTime) {
		var zone = moment.defaultZone,
			offset;

		if (mom._z === undefined) {
			if (zone && needsOffset(mom) && !mom._isUTC) {
				mom._d = moment.utc(mom._a)._d;
				mom.utc().add(zone.parse(mom), 'minutes');
			}
			mom._z = zone;
		}
		if (mom._z) {
			offset = mom._z.offset(mom);
			if (Math.abs(offset) < 16) {
				offset = offset / 60;
			}
			if (mom.utcOffset !== undefined) {
				mom.utcOffset(-offset, keepTime);
			} else {
				mom.zone(offset, keepTime);
			}
		}
	};

	fn.tz = function (name) {
		if (name) {
			this._z = getZone(name);
			if (this._z) {
				moment.updateOffset(this);
			} else {
				logError("Moment Timezone has no data for " + name + ". See http://momentjs.com/timezone/docs/#/data-loading/.");
			}
			return this;
		}
		if (this._z) { return this._z.name; }
	};

	function abbrWrap (old) {
		return function () {
			if (this._z) { return this._z.abbr(this); }
			return old.call(this);
		};
	}

	function resetZoneWrap (old) {
		return function () {
			this._z = null;
			return old.apply(this, arguments);
		};
	}

	fn.zoneName = abbrWrap(fn.zoneName);
	fn.zoneAbbr = abbrWrap(fn.zoneAbbr);
	fn.utc      = resetZoneWrap(fn.utc);

	moment.tz.setDefault = function(name) {
		if (major < 2 || (major === 2 && minor < 9)) {
			logError('Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js ' + moment.version + '.');
		}
		moment.defaultZone = name ? getZone(name) : null;
		return moment;
	};

	// Cloning a moment should include the _z property.
	var momentProperties = moment.momentProperties;
	if (Object.prototype.toString.call(momentProperties) === '[object Array]') {
		// moment 2.8.1+
		momentProperties.push('_z');
		momentProperties.push('_a');
	} else if (momentProperties) {
		// moment 2.7.0
		momentProperties._z = null;
	}

	loadData({
		"version": "2015g",
		"zones": [
			"Africa/Abidjan|GMT|0|0||48e5",
			"Africa/Khartoum|EAT|-30|0||51e5",
			"Africa/Algiers|CET|-10|0||26e5",
			"Africa/Lagos|WAT|-10|0||17e6",
			"Africa/Maputo|CAT|-20|0||26e5",
			"Africa/Cairo|EET EEST|-20 -30|010101010|1Cby0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0|15e6",
			"Africa/Casablanca|WET WEST|0 -10|01010101010101010101010101010101010101010|1Cco0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0|32e5",
			"Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e6",
			"Africa/Johannesburg|SAST|-20|0||84e5",
			"Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00|11e5",
			"Africa/Windhoek|WAST WAT|-20 -10|01010101010101010101010|1C1c0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0|32e4",
			"America/Adak|HST HDT|a0 90|01010101010101010101010|1BR00 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326",
			"America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1BQX0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4",
			"America/Santo_Domingo|AST|40|0||29e5",
			"America/Araguaina|BRT BRST|30 20|010|1IdD0 Lz0|14e4",
			"America/Argentina/Buenos_Aires|ART|30|0|",
			"America/Asuncion|PYST PYT|30 40|01010101010101010101010|1C430 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5",
			"America/Panama|EST|50|0||15e5",
			"America/Bahia|BRT BRST|30 20|010|1FJf0 Rb0|27e5",
			"America/Bahia_Banderas|MST CDT CST|70 50 60|01212121212121212121212|1C1l0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|84e3",
			"America/Fortaleza|BRT|30|0||34e5",
			"America/Managua|CST|60|0||22e5",
			"America/Manaus|AMT|40|0||19e5",
			"America/Bogota|COT|50|0||90e5",
			"America/Denver|MST MDT|70 60|01010101010101010101010|1BQV0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5",
			"America/Campo_Grande|AMST AMT|30 40|01010101010101010101010|1BIr0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10|77e4",
			"America/Cancun|CST CDT EST|60 50 50|010101010102|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4",
			"America/Caracas|VET|4u|0||29e5",
			"America/Cayenne|GFT|30|0||58e3",
			"America/Cayman|EST EDT|50 40|01010101010|1Qtj0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|58e3",
			"America/Chicago|CST CDT|60 50|01010101010101010101010|1BQU0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5",
			"America/Chihuahua|MST MDT|70 60|01010101010101010101010|1C1l0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|81e4",
			"America/Phoenix|MST|70|0||42e5",
			"America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6",
			"America/New_York|EST EDT|50 40|01010101010101010101010|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6",
			"America/Rio_Branco|AMT ACT|40 50|01|1KLE0|31e4",
			"America/Fort_Nelson|PST PDT MST|80 70 70|010101010102|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2",
			"America/Halifax|AST ADT|40 30|01010101010101010101010|1BQS0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4",
			"America/Godthab|WGT WGST|30 20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e3",
			"America/Goose_Bay|AST ADT|40 30|01010101010101010101010|1BQQ1 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|76e2",
			"America/Grand_Turk|EST EDT AST|50 40 40|0101010101012|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2",
			"America/Guayaquil|ECT|50|0||27e5",
			"America/Guyana|GYT|40|0||80e4",
			"America/Havana|CST CDT|50 40|01010101010101010101010|1BQR0 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5",
			"America/La_Paz|BOT|40|0||19e5",
			"America/Lima|PET|50|0||11e6",
			"America/Mexico_City|CST CDT|60 50|01010101010101010101010|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|20e6",
			"America/Metlakatla|PST|80|0||14e2",
			"America/Miquelon|PMST PMDT|30 20|01010101010101010101010|1BQR0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2",
			"America/Montevideo|UYST UYT|20 30|010101010101|1BQQ0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0|17e5",
			"America/Noronha|FNT|20|0||30e2",
			"America/North_Dakota/Beulah|MST MDT CST CDT|70 60 60 50|01232323232323232323232|1BQV0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0",
			"America/Paramaribo|SRT|30|0||24e4",
			"America/Port-au-Prince|EST EDT|50 40|0101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5",
			"America/Santa_Isabel|PST PDT|80 70|01010101010101010101010|1C1m0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|23e3",
			"America/Santiago|CLST CLT CLT|30 40 30|010101010102|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0|62e5",
			"America/Sao_Paulo|BRST BRT|20 30|01010101010101010101010|1BIq0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10|20e6",
			"America/Scoresbysund|EGT EGST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|452",
			"America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1BQPv 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4",
			"Antarctica/Casey|CAST AWST|-b0 -80|0101|1BN30 40P0 KL0|10",
			"Antarctica/Davis|DAVT DAVT|-50 -70|0101|1BPw0 3Wn0 KN0|70",
			"Antarctica/DumontDUrville|DDUT|-a0|0||80",
			"Antarctica/Macquarie|AEDT MIST|-b0 -b0|01|1C140|1",
			"Antarctica/Mawson|MAWT|-50|0||60",
			"Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|14e5",
			"Antarctica/Rothera|ROTT|30|0||130",
			"Antarctica/Syowa|SYOT|-30|0||20",
			"Antarctica/Troll|UTC CEST|0 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|40",
			"Antarctica/Vostok|VOST|-60|0||25",
			"Asia/Baghdad|AST|-30|0||66e5",
			"Asia/Almaty|ALMT|-60|0||15e5",
			"Asia/Amman|EET EEST|-20 -30|010101010101010101010|1BVy0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0|25e5",
			"Asia/Anadyr|ANAT ANAST ANAT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0|13e3",
			"Asia/Aqtobe|AQTT|-50|0||27e4",
			"Asia/Ashgabat|TMT|-50|0||41e4",
			"Asia/Baku|AZT AZST|-40 -50|01010101010101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5",
			"Asia/Bangkok|ICT|-70|0||15e6",
			"Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1BWm0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|22e5",
			"Asia/Bishkek|KGT|-60|0||87e4",
			"Asia/Brunei|BNT|-80|0||42e4",
			"Asia/Kolkata|IST|-5u|0||15e6",
			"Asia/Chita|YAKT YAKST YAKT IRKT|-90 -a0 -a0 -80|01023|1BWh0 1qM0 WM0 8Hz0|33e4",
			"Asia/Choibalsan|CHOT CHOST|-80 -90|0101010101010|1O8G0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|38e3",
			"Asia/Shanghai|CST|-80|0||23e6",
			"Asia/Dhaka|BDT|-60|0||16e6",
			"Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1C0m0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0|26e5",
			"Asia/Dili|TLT|-90|0||19e4",
			"Asia/Dubai|GST|-40|0||39e5",
			"Asia/Dushanbe|TJT|-50|0||76e4",
			"Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1BVW1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1210 1nz0 14N0 1nz0 1210 1nz0 1210 1nz0 1210 1nz0|18e5",
			"Asia/Hebron|EET EEST|-20 -30|0101010101010101010101010|1BVy0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1210 1nz0 14N0 1nz0 1210 1nz0 1210 1nz0 1210 1nz0|25e4",
			"Asia/Hong_Kong|HKT|-80|0||73e5",
			"Asia/Hovd|HOVT HOVST|-70 -80|0101010101010|1O8H0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|81e3",
			"Asia/Irkutsk|IRKT IRKST IRKT|-80 -90 -90|01020|1BWi0 1qM0 WM0 8Hz0|60e4",
			"Europe/Istanbul|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e6",
			"Asia/Jakarta|WIB|-70|0||31e6",
			"Asia/Jayapura|WIT|-90|0||26e4",
			"Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1BVA0 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0|81e4",
			"Asia/Kabul|AFT|-4u|0||46e5",
			"Asia/Kamchatka|PETT PETST PETT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0|18e4",
			"Asia/Karachi|PKT|-50|0||24e6",
			"Asia/Urumqi|XJT|-60|0||32e5",
			"Asia/Kathmandu|NPT|-5J|0||12e5",
			"Asia/Khandyga|VLAT VLAST VLAT YAKT YAKT|-a0 -b0 -b0 -a0 -90|010234|1BWg0 1qM0 WM0 17V0 7zD0|66e2",
			"Asia/Krasnoyarsk|KRAT KRAST KRAT|-70 -80 -80|01020|1BWj0 1qM0 WM0 8Hz0|10e5",
			"Asia/Kuala_Lumpur|MYT|-80|0||71e5",
			"Asia/Magadan|MAGT MAGST MAGT MAGT|-b0 -c0 -c0 -a0|01023|1BWf0 1qM0 WM0 8Hz0|95e3",
			"Asia/Makassar|WITA|-80|0||15e5",
			"Asia/Manila|PHT|-80|0||24e6",
			"Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|35e5",
			"Asia/Novokuznetsk|KRAT NOVST NOVT NOVT|-70 -70 -60 -70|01230|1BWj0 1qN0 WM0 8Hz0|55e4",
			"Asia/Novosibirsk|NOVT NOVST NOVT|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0|15e5",
			"Asia/Omsk|OMST OMSST OMST|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0|12e5",
			"Asia/Oral|ORAT|-50|0||27e4",
			"Asia/Pyongyang|KST KST|-90 -8u|01|1P4D0|29e5",
			"Asia/Qyzylorda|QYZT|-60|0||73e4",
			"Asia/Rangoon|MMT|-6u|0||48e5",
			"Asia/Sakhalin|SAKT SAKST SAKT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0|58e4",
			"Asia/Tashkent|UZT|-50|0||23e5",
			"Asia/Seoul|KST|-90|0||23e6",
			"Asia/Singapore|SGT|-80|0||56e5",
			"Asia/Srednekolymsk|MAGT MAGST MAGT SRET|-b0 -c0 -c0 -b0|01023|1BWf0 1qM0 WM0 8Hz0|35e2",
			"Asia/Tbilisi|GET|-40|0||11e5",
			"Asia/Tehran|IRST IRDT|-3u -4u|01010101010101010101010|1BTUu 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6",
			"Asia/Thimphu|BTT|-60|0||79e3",
			"Asia/Tokyo|JST|-90|0||38e6",
			"Asia/Ulaanbaatar|ULAT ULAST|-80 -90|0101010101010|1O8G0 1cJ0 1cP0 1cJ0 1cP0 1fx0 1cP0 1cJ0 1cP0 1cJ0 1cP0 1cJ0|12e5",
			"Asia/Ust-Nera|MAGT MAGST MAGT VLAT VLAT|-b0 -c0 -c0 -b0 -a0|010234|1BWf0 1qM0 WM0 17V0 7zD0|65e2",
			"Asia/Vladivostok|VLAT VLAST VLAT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0|60e4",
			"Asia/Yakutsk|YAKT YAKST YAKT|-90 -a0 -a0|01020|1BWh0 1qM0 WM0 8Hz0|28e4",
			"Asia/Yekaterinburg|YEKT YEKST YEKT|-50 -60 -60|01020|1BWl0 1qM0 WM0 8Hz0|14e5",
			"Asia/Yerevan|AMT AMST|-40 -50|01010|1BWm0 1qM0 WM0 1qM0|13e5",
			"Atlantic/Azores|AZOT AZOST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|25e4",
			"Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5",
			"Atlantic/Cape_Verde|CVT|10|0||50e4",
			"Atlantic/South_Georgia|GST|20|0||30",
			"Atlantic/Stanley|FKST FKT|30 40|010|1C6R0 U10|21e2",
			"Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1C140 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5",
			"Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1C14u 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|11e5",
			"Australia/Brisbane|AEST|-a0|0||20e5",
			"Australia/Darwin|ACST|-9u|0||12e4",
			"Australia/Eucla|ACWST|-8J|0||368",
			"Australia/Lord_Howe|LHDT LHST|-b0 -au|01010101010101010101010|1C130 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu|347",
			"Australia/Perth|AWST|-80|0||18e5",
			"Pacific/Easter|EASST EAST EAST|50 60 50|010101010102|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0|30e2",
			"Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5",
			"Etc/GMT+1|GMT+1|10|0|",
			"Etc/GMT+10|GMT+10|a0|0|",
			"Etc/GMT+11|GMT+11|b0|0|",
			"Etc/GMT+12|GMT+12|c0|0|",
			"Etc/GMT+2|GMT+2|20|0|",
			"Etc/GMT+3|GMT+3|30|0|",
			"Etc/GMT+4|GMT+4|40|0|",
			"Etc/GMT+5|GMT+5|50|0|",
			"Etc/GMT+6|GMT+6|60|0|",
			"Etc/GMT+7|GMT+7|70|0|",
			"Etc/GMT+8|GMT+8|80|0|",
			"Etc/GMT+9|GMT+9|90|0|",
			"Etc/GMT-1|GMT-1|-10|0|",
			"Etc/GMT-10|GMT-10|-a0|0|",
			"Etc/GMT-11|GMT-11|-b0|0|",
			"Etc/GMT-12|GMT-12|-c0|0|",
			"Etc/GMT-13|GMT-13|-d0|0|",
			"Etc/GMT-14|GMT-14|-e0|0|",
			"Etc/GMT-2|GMT-2|-20|0|",
			"Etc/GMT-3|GMT-3|-30|0|",
			"Etc/GMT-4|GMT-4|-40|0|",
			"Etc/GMT-5|GMT-5|-50|0|",
			"Etc/GMT-6|GMT-6|-60|0|",
			"Etc/GMT-7|GMT-7|-70|0|",
			"Etc/GMT-8|GMT-8|-80|0|",
			"Etc/GMT-9|GMT-9|-90|0|",
			"Etc/UCT|UCT|0|0|",
			"Etc/UTC|UTC|0|0|",
			"Europe/London|GMT BST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|10e6",
			"Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|67e4",
			"Europe/Kaliningrad|EET EEST FET|-20 -30 -30|01020|1BWo0 1qM0 WM0 8Hz0|44e4",
			"Europe/Minsk|EET EEST FET MSK|-20 -30 -30 -30|01023|1BWo0 1qM0 WM0 8Hy0|19e5",
			"Europe/Moscow|MSK MSD MSK|-30 -40 -40|01020|1BWn0 1qM0 WM0 8Hz0|16e6",
			"Europe/Samara|SAMT SAMST SAMT|-40 -40 -30|0120|1BWm0 1qN0 WM0|12e5",
			"Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|01010101023|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0|33e4",
			"Pacific/Honolulu|HST|a0|0||37e4",
			"Indian/Chagos|IOT|-60|0||30e2",
			"Indian/Christmas|CXT|-70|0||21e2",
			"Indian/Cocos|CCT|-6u|0||596",
			"Indian/Kerguelen|TFT|-50|0||130",
			"Indian/Mahe|SCT|-40|0||79e3",
			"Indian/Maldives|MVT|-50|0||35e4",
			"Indian/Mauritius|MUT|-40|0||15e4",
			"Indian/Reunion|RET|-40|0||84e4",
			"Pacific/Majuro|MHT|-c0|0||28e3",
			"MET|MET MEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00",
			"Pacific/Chatham|CHADT CHAST|-dJ -cJ|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|600",
			"Pacific/Apia|SST SDT WSDT WSST|b0 a0 -e0 -d0|01012323232323232323232|1Dbn0 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|37e3",
			"Pacific/Bougainville|PGT BST|-a0 -b0|01|1NwE0|18e4",
			"Pacific/Chuuk|CHUT|-a0|0||49e3",
			"Pacific/Efate|VUT|-b0|0||66e3",
			"Pacific/Enderbury|PHOT|-d0|0||1",
			"Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0|483",
			"Pacific/Fiji|FJST FJT|-d0 -c0|01010101010101010101010|1BWe0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0|88e4",
			"Pacific/Funafuti|TVT|-c0|0||45e2",
			"Pacific/Galapagos|GALT|60|0||25e3",
			"Pacific/Gambier|GAMT|90|0||125",
			"Pacific/Guadalcanal|SBT|-b0|0||11e4",
			"Pacific/Guam|ChST|-a0|0||17e4",
			"Pacific/Kiritimati|LINT|-e0|0||51e2",
			"Pacific/Kosrae|KOST|-b0|0||66e2",
			"Pacific/Marquesas|MART|9u|0||86e2",
			"Pacific/Pago_Pago|SST|b0|0||37e2",
			"Pacific/Nauru|NRT|-c0|0||10e3",
			"Pacific/Niue|NUT|b0|0||12e2",
			"Pacific/Norfolk|NFT NFT|-bu -b0|01|1PoCu|25e4",
			"Pacific/Noumea|NCT|-b0|0||98e3",
			"Pacific/Palau|PWT|-90|0||21e3",
			"Pacific/Pohnpei|PONT|-b0|0||34e3",
			"Pacific/Port_Moresby|PGT|-a0|0||25e4",
			"Pacific/Rarotonga|CKT|a0|0||13e3",
			"Pacific/Tahiti|TAHT|a0|0||18e4",
			"Pacific/Tarawa|GILT|-c0|0||29e3",
			"Pacific/Tongatapu|TOT|-d0|0||75e3",
			"Pacific/Wake|WAKT|-c0|0||16e3",
			"Pacific/Wallis|WFT|-c0|0||94"
		],
		"links": [
			"Africa/Abidjan|Africa/Accra",
			"Africa/Abidjan|Africa/Bamako",
			"Africa/Abidjan|Africa/Banjul",
			"Africa/Abidjan|Africa/Bissau",
			"Africa/Abidjan|Africa/Conakry",
			"Africa/Abidjan|Africa/Dakar",
			"Africa/Abidjan|Africa/Freetown",
			"Africa/Abidjan|Africa/Lome",
			"Africa/Abidjan|Africa/Monrovia",
			"Africa/Abidjan|Africa/Nouakchott",
			"Africa/Abidjan|Africa/Ouagadougou",
			"Africa/Abidjan|Africa/Sao_Tome",
			"Africa/Abidjan|Africa/Timbuktu",
			"Africa/Abidjan|America/Danmarkshavn",
			"Africa/Abidjan|Atlantic/Reykjavik",
			"Africa/Abidjan|Atlantic/St_Helena",
			"Africa/Abidjan|Etc/GMT",
			"Africa/Abidjan|Etc/GMT+0",
			"Africa/Abidjan|Etc/GMT-0",
			"Africa/Abidjan|Etc/GMT0",
			"Africa/Abidjan|Etc/Greenwich",
			"Africa/Abidjan|GMT",
			"Africa/Abidjan|GMT+0",
			"Africa/Abidjan|GMT-0",
			"Africa/Abidjan|GMT0",
			"Africa/Abidjan|Greenwich",
			"Africa/Abidjan|Iceland",
			"Africa/Algiers|Africa/Tunis",
			"Africa/Cairo|Egypt",
			"Africa/Casablanca|Africa/El_Aaiun",
			"Africa/Johannesburg|Africa/Maseru",
			"Africa/Johannesburg|Africa/Mbabane",
			"Africa/Khartoum|Africa/Addis_Ababa",
			"Africa/Khartoum|Africa/Asmara",
			"Africa/Khartoum|Africa/Asmera",
			"Africa/Khartoum|Africa/Dar_es_Salaam",
			"Africa/Khartoum|Africa/Djibouti",
			"Africa/Khartoum|Africa/Juba",
			"Africa/Khartoum|Africa/Kampala",
			"Africa/Khartoum|Africa/Mogadishu",
			"Africa/Khartoum|Africa/Nairobi",
			"Africa/Khartoum|Indian/Antananarivo",
			"Africa/Khartoum|Indian/Comoro",
			"Africa/Khartoum|Indian/Mayotte",
			"Africa/Lagos|Africa/Bangui",
			"Africa/Lagos|Africa/Brazzaville",
			"Africa/Lagos|Africa/Douala",
			"Africa/Lagos|Africa/Kinshasa",
			"Africa/Lagos|Africa/Libreville",
			"Africa/Lagos|Africa/Luanda",
			"Africa/Lagos|Africa/Malabo",
			"Africa/Lagos|Africa/Ndjamena",
			"Africa/Lagos|Africa/Niamey",
			"Africa/Lagos|Africa/Porto-Novo",
			"Africa/Maputo|Africa/Blantyre",
			"Africa/Maputo|Africa/Bujumbura",
			"Africa/Maputo|Africa/Gaborone",
			"Africa/Maputo|Africa/Harare",
			"Africa/Maputo|Africa/Kigali",
			"Africa/Maputo|Africa/Lubumbashi",
			"Africa/Maputo|Africa/Lusaka",
			"Africa/Tripoli|Libya",
			"America/Adak|America/Atka",
			"America/Adak|US/Aleutian",
			"America/Anchorage|America/Juneau",
			"America/Anchorage|America/Nome",
			"America/Anchorage|America/Sitka",
			"America/Anchorage|America/Yakutat",
			"America/Anchorage|US/Alaska",
			"America/Argentina/Buenos_Aires|America/Argentina/Catamarca",
			"America/Argentina/Buenos_Aires|America/Argentina/ComodRivadavia",
			"America/Argentina/Buenos_Aires|America/Argentina/Cordoba",
			"America/Argentina/Buenos_Aires|America/Argentina/Jujuy",
			"America/Argentina/Buenos_Aires|America/Argentina/La_Rioja",
			"America/Argentina/Buenos_Aires|America/Argentina/Mendoza",
			"America/Argentina/Buenos_Aires|America/Argentina/Rio_Gallegos",
			"America/Argentina/Buenos_Aires|America/Argentina/Salta",
			"America/Argentina/Buenos_Aires|America/Argentina/San_Juan",
			"America/Argentina/Buenos_Aires|America/Argentina/San_Luis",
			"America/Argentina/Buenos_Aires|America/Argentina/Tucuman",
			"America/Argentina/Buenos_Aires|America/Argentina/Ushuaia",
			"America/Argentina/Buenos_Aires|America/Buenos_Aires",
			"America/Argentina/Buenos_Aires|America/Catamarca",
			"America/Argentina/Buenos_Aires|America/Cordoba",
			"America/Argentina/Buenos_Aires|America/Jujuy",
			"America/Argentina/Buenos_Aires|America/Mendoza",
			"America/Argentina/Buenos_Aires|America/Rosario",
			"America/Campo_Grande|America/Cuiaba",
			"America/Chicago|America/Indiana/Knox",
			"America/Chicago|America/Indiana/Tell_City",
			"America/Chicago|America/Knox_IN",
			"America/Chicago|America/Matamoros",
			"America/Chicago|America/Menominee",
			"America/Chicago|America/North_Dakota/Center",
			"America/Chicago|America/North_Dakota/New_Salem",
			"America/Chicago|America/Rainy_River",
			"America/Chicago|America/Rankin_Inlet",
			"America/Chicago|America/Resolute",
			"America/Chicago|America/Winnipeg",
			"America/Chicago|CST6CDT",
			"America/Chicago|Canada/Central",
			"America/Chicago|US/Central",
			"America/Chicago|US/Indiana-Starke",
			"America/Chihuahua|America/Mazatlan",
			"America/Chihuahua|Mexico/BajaSur",
			"America/Denver|America/Boise",
			"America/Denver|America/Cambridge_Bay",
			"America/Denver|America/Edmonton",
			"America/Denver|America/Inuvik",
			"America/Denver|America/Ojinaga",
			"America/Denver|America/Shiprock",
			"America/Denver|America/Yellowknife",
			"America/Denver|Canada/Mountain",
			"America/Denver|MST7MDT",
			"America/Denver|Navajo",
			"America/Denver|US/Mountain",
			"America/Fortaleza|America/Belem",
			"America/Fortaleza|America/Maceio",
			"America/Fortaleza|America/Recife",
			"America/Fortaleza|America/Santarem",
			"America/Halifax|America/Glace_Bay",
			"America/Halifax|America/Moncton",
			"America/Halifax|America/Thule",
			"America/Halifax|Atlantic/Bermuda",
			"America/Halifax|Canada/Atlantic",
			"America/Havana|Cuba",
			"America/Los_Angeles|America/Dawson",
			"America/Los_Angeles|America/Ensenada",
			"America/Los_Angeles|America/Tijuana",
			"America/Los_Angeles|America/Vancouver",
			"America/Los_Angeles|America/Whitehorse",
			"America/Los_Angeles|Canada/Pacific",
			"America/Los_Angeles|Canada/Yukon",
			"America/Los_Angeles|Mexico/BajaNorte",
			"America/Los_Angeles|PST8PDT",
			"America/Los_Angeles|US/Pacific",
			"America/Los_Angeles|US/Pacific-New",
			"America/Managua|America/Belize",
			"America/Managua|America/Costa_Rica",
			"America/Managua|America/El_Salvador",
			"America/Managua|America/Guatemala",
			"America/Managua|America/Regina",
			"America/Managua|America/Swift_Current",
			"America/Managua|America/Tegucigalpa",
			"America/Managua|Canada/East-Saskatchewan",
			"America/Managua|Canada/Saskatchewan",
			"America/Manaus|America/Boa_Vista",
			"America/Manaus|America/Porto_Velho",
			"America/Manaus|Brazil/West",
			"America/Metlakatla|Pacific/Pitcairn",
			"America/Mexico_City|America/Merida",
			"America/Mexico_City|America/Monterrey",
			"America/Mexico_City|Mexico/General",
			"America/New_York|America/Detroit",
			"America/New_York|America/Fort_Wayne",
			"America/New_York|America/Indiana/Indianapolis",
			"America/New_York|America/Indiana/Marengo",
			"America/New_York|America/Indiana/Petersburg",
			"America/New_York|America/Indiana/Vevay",
			"America/New_York|America/Indiana/Vincennes",
			"America/New_York|America/Indiana/Winamac",
			"America/New_York|America/Indianapolis",
			"America/New_York|America/Iqaluit",
			"America/New_York|America/Kentucky/Louisville",
			"America/New_York|America/Kentucky/Monticello",
			"America/New_York|America/Louisville",
			"America/New_York|America/Montreal",
			"America/New_York|America/Nassau",
			"America/New_York|America/Nipigon",
			"America/New_York|America/Pangnirtung",
			"America/New_York|America/Thunder_Bay",
			"America/New_York|America/Toronto",
			"America/New_York|Canada/Eastern",
			"America/New_York|EST5EDT",
			"America/New_York|US/East-Indiana",
			"America/New_York|US/Eastern",
			"America/New_York|US/Michigan",
			"America/Noronha|Brazil/DeNoronha",
			"America/Panama|America/Atikokan",
			"America/Panama|America/Coral_Harbour",
			"America/Panama|America/Jamaica",
			"America/Panama|EST",
			"America/Panama|Jamaica",
			"America/Phoenix|America/Creston",
			"America/Phoenix|America/Dawson_Creek",
			"America/Phoenix|America/Hermosillo",
			"America/Phoenix|MST",
			"America/Phoenix|US/Arizona",
			"America/Rio_Branco|America/Eirunepe",
			"America/Rio_Branco|America/Porto_Acre",
			"America/Rio_Branco|Brazil/Acre",
			"America/Santiago|Antarctica/Palmer",
			"America/Santiago|Chile/Continental",
			"America/Santo_Domingo|America/Anguilla",
			"America/Santo_Domingo|America/Antigua",
			"America/Santo_Domingo|America/Aruba",
			"America/Santo_Domingo|America/Barbados",
			"America/Santo_Domingo|America/Blanc-Sablon",
			"America/Santo_Domingo|America/Curacao",
			"America/Santo_Domingo|America/Dominica",
			"America/Santo_Domingo|America/Grenada",
			"America/Santo_Domingo|America/Guadeloupe",
			"America/Santo_Domingo|America/Kralendijk",
			"America/Santo_Domingo|America/Lower_Princes",
			"America/Santo_Domingo|America/Marigot",
			"America/Santo_Domingo|America/Martinique",
			"America/Santo_Domingo|America/Montserrat",
			"America/Santo_Domingo|America/Port_of_Spain",
			"America/Santo_Domingo|America/Puerto_Rico",
			"America/Santo_Domingo|America/St_Barthelemy",
			"America/Santo_Domingo|America/St_Kitts",
			"America/Santo_Domingo|America/St_Lucia",
			"America/Santo_Domingo|America/St_Thomas",
			"America/Santo_Domingo|America/St_Vincent",
			"America/Santo_Domingo|America/Tortola",
			"America/Santo_Domingo|America/Virgin",
			"America/Sao_Paulo|Brazil/East",
			"America/St_Johns|Canada/Newfoundland",
			"Asia/Aqtobe|Asia/Aqtau",
			"Asia/Ashgabat|Asia/Ashkhabad",
			"Asia/Baghdad|Asia/Aden",
			"Asia/Baghdad|Asia/Bahrain",
			"Asia/Baghdad|Asia/Kuwait",
			"Asia/Baghdad|Asia/Qatar",
			"Asia/Baghdad|Asia/Riyadh",
			"Asia/Bangkok|Asia/Ho_Chi_Minh",
			"Asia/Bangkok|Asia/Phnom_Penh",
			"Asia/Bangkok|Asia/Saigon",
			"Asia/Bangkok|Asia/Vientiane",
			"Asia/Dhaka|Asia/Dacca",
			"Asia/Dubai|Asia/Muscat",
			"Asia/Hong_Kong|Hongkong",
			"Asia/Jakarta|Asia/Pontianak",
			"Asia/Jerusalem|Asia/Tel_Aviv",
			"Asia/Jerusalem|Israel",
			"Asia/Kathmandu|Asia/Katmandu",
			"Asia/Kolkata|Asia/Calcutta",
			"Asia/Kolkata|Asia/Colombo",
			"Asia/Kuala_Lumpur|Asia/Kuching",
			"Asia/Makassar|Asia/Ujung_Pandang",
			"Asia/Seoul|ROK",
			"Asia/Shanghai|Asia/Chongqing",
			"Asia/Shanghai|Asia/Chungking",
			"Asia/Shanghai|Asia/Harbin",
			"Asia/Shanghai|Asia/Macao",
			"Asia/Shanghai|Asia/Macau",
			"Asia/Shanghai|Asia/Taipei",
			"Asia/Shanghai|PRC",
			"Asia/Shanghai|ROC",
			"Asia/Singapore|Singapore",
			"Asia/Tashkent|Asia/Samarkand",
			"Asia/Tehran|Iran",
			"Asia/Thimphu|Asia/Thimbu",
			"Asia/Tokyo|Japan",
			"Asia/Ulaanbaatar|Asia/Ulan_Bator",
			"Asia/Urumqi|Asia/Kashgar",
			"Australia/Adelaide|Australia/Broken_Hill",
			"Australia/Adelaide|Australia/South",
			"Australia/Adelaide|Australia/Yancowinna",
			"Australia/Brisbane|Australia/Lindeman",
			"Australia/Brisbane|Australia/Queensland",
			"Australia/Darwin|Australia/North",
			"Australia/Lord_Howe|Australia/LHI",
			"Australia/Perth|Australia/West",
			"Australia/Sydney|Australia/ACT",
			"Australia/Sydney|Australia/Canberra",
			"Australia/Sydney|Australia/Currie",
			"Australia/Sydney|Australia/Hobart",
			"Australia/Sydney|Australia/Melbourne",
			"Australia/Sydney|Australia/NSW",
			"Australia/Sydney|Australia/Tasmania",
			"Australia/Sydney|Australia/Victoria",
			"Etc/UCT|UCT",
			"Etc/UTC|Etc/Universal",
			"Etc/UTC|Etc/Zulu",
			"Etc/UTC|UTC",
			"Etc/UTC|Universal",
			"Etc/UTC|Zulu",
			"Europe/Athens|Asia/Nicosia",
			"Europe/Athens|EET",
			"Europe/Athens|Europe/Bucharest",
			"Europe/Athens|Europe/Helsinki",
			"Europe/Athens|Europe/Kiev",
			"Europe/Athens|Europe/Mariehamn",
			"Europe/Athens|Europe/Nicosia",
			"Europe/Athens|Europe/Riga",
			"Europe/Athens|Europe/Sofia",
			"Europe/Athens|Europe/Tallinn",
			"Europe/Athens|Europe/Uzhgorod",
			"Europe/Athens|Europe/Vilnius",
			"Europe/Athens|Europe/Zaporozhye",
			"Europe/Chisinau|Europe/Tiraspol",
			"Europe/Dublin|Eire",
			"Europe/Istanbul|Asia/Istanbul",
			"Europe/Istanbul|Turkey",
			"Europe/Lisbon|Atlantic/Canary",
			"Europe/Lisbon|Atlantic/Faeroe",
			"Europe/Lisbon|Atlantic/Faroe",
			"Europe/Lisbon|Atlantic/Madeira",
			"Europe/Lisbon|Portugal",
			"Europe/Lisbon|WET",
			"Europe/London|Europe/Belfast",
			"Europe/London|Europe/Guernsey",
			"Europe/London|Europe/Isle_of_Man",
			"Europe/London|Europe/Jersey",
			"Europe/London|GB",
			"Europe/London|GB-Eire",
			"Europe/Moscow|Europe/Volgograd",
			"Europe/Moscow|W-SU",
			"Europe/Paris|Africa/Ceuta",
			"Europe/Paris|Arctic/Longyearbyen",
			"Europe/Paris|Atlantic/Jan_Mayen",
			"Europe/Paris|CET",
			"Europe/Paris|Europe/Amsterdam",
			"Europe/Paris|Europe/Andorra",
			"Europe/Paris|Europe/Belgrade",
			"Europe/Paris|Europe/Berlin",
			"Europe/Paris|Europe/Bratislava",
			"Europe/Paris|Europe/Brussels",
			"Europe/Paris|Europe/Budapest",
			"Europe/Paris|Europe/Busingen",
			"Europe/Paris|Europe/Copenhagen",
			"Europe/Paris|Europe/Gibraltar",
			"Europe/Paris|Europe/Ljubljana",
			"Europe/Paris|Europe/Luxembourg",
			"Europe/Paris|Europe/Madrid",
			"Europe/Paris|Europe/Malta",
			"Europe/Paris|Europe/Monaco",
			"Europe/Paris|Europe/Oslo",
			"Europe/Paris|Europe/Podgorica",
			"Europe/Paris|Europe/Prague",
			"Europe/Paris|Europe/Rome",
			"Europe/Paris|Europe/San_Marino",
			"Europe/Paris|Europe/Sarajevo",
			"Europe/Paris|Europe/Skopje",
			"Europe/Paris|Europe/Stockholm",
			"Europe/Paris|Europe/Tirane",
			"Europe/Paris|Europe/Vaduz",
			"Europe/Paris|Europe/Vatican",
			"Europe/Paris|Europe/Vienna",
			"Europe/Paris|Europe/Warsaw",
			"Europe/Paris|Europe/Zagreb",
			"Europe/Paris|Europe/Zurich",
			"Europe/Paris|Poland",
			"Pacific/Auckland|Antarctica/McMurdo",
			"Pacific/Auckland|Antarctica/South_Pole",
			"Pacific/Auckland|NZ",
			"Pacific/Chatham|NZ-CHAT",
			"Pacific/Chuuk|Pacific/Truk",
			"Pacific/Chuuk|Pacific/Yap",
			"Pacific/Easter|Chile/EasterIsland",
			"Pacific/Guam|Pacific/Saipan",
			"Pacific/Honolulu|HST",
			"Pacific/Honolulu|Pacific/Johnston",
			"Pacific/Honolulu|US/Hawaii",
			"Pacific/Majuro|Kwajalein",
			"Pacific/Majuro|Pacific/Kwajalein",
			"Pacific/Pago_Pago|Pacific/Midway",
			"Pacific/Pago_Pago|Pacific/Samoa",
			"Pacific/Pago_Pago|US/Samoa",
			"Pacific/Pohnpei|Pacific/Ponape"
		]
	});


	return moment;
}));

/*! jstz - v1.0.4 - 2012-12-18 */
(function(e){var t=function(){"use strict";var e="s",n=function(e){var t=-e.getTimezoneOffset();return t!==null?t:0},r=function(e,t,n){var r=new Date;return e!==undefined&&r.setFullYear(e),r.setDate(n),r.setMonth(t),r},i=function(e){return n(r(e,0,2))},s=function(e){return n(r(e,5,2))},o=function(e){var t=e.getMonth()>7?s(e.getFullYear()):i(e.getFullYear()),r=n(e);return t-r!==0},u=function(){var t=i(),n=s(),r=i()-s();return r<0?t+",1":r>0?n+",1,"+e:t+",0"},a=function(){var e=u();return new t.TimeZone(t.olson.timezones[e])},f=function(e){var t=new Date(2010,6,15,1,0,0,0),n={"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,11,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":t,"Asia/Yekaterinburg":t,"Asia/Omsk":t,"Asia/Krasnoyarsk":t,"Asia/Irkutsk":t,"Asia/Yakutsk":t,"Asia/Vladivostok":t,"Asia/Kamchatka":t,"Europe/Minsk":t,"Australia/Perth":new Date(2008,10,1,1,0,0,0)};return n[e]};return{determine:a,date_is_dst:o,dst_start_for:f}}();t.TimeZone=function(e){"use strict";var n={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},r=e,i=function(){var e=n[r],i=e.length,s=0,o=e[0];for(;s<i;s+=1){o=e[s];if(t.date_is_dst(t.dst_start_for(o))){r=o;return}}},s=function(){return typeof n[r]!="undefined"};return s()&&i(),{name:function(){return r}}},t.olson={},t.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"Etc/GMT+2","-120,1":"Etc/GMT+2","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"Etc/UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},typeof exports!="undefined"?exports.jstz=t:e.jstz=t})(this);
!function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define(b):this[a]=b()}("$script",function(){function a(a,b){for(var c=0,d=a.length;d>c;++c)if(!b(a[c]))return i;return 1}function b(b,c){a(b,function(a){return!c(a)})}function c(f,g,h){function i(a){return a.call?a():m[a]}function k(){if(!--s){m[r]=1,q&&q();for(var c in o)a(c.split("|"),i)&&!b(o[c],i)&&(o[c]=[])}}f=f[j]?f:[f];var l=g&&g.call,q=l?g:h,r=l?f.join(""):g,s=f.length;return setTimeout(function(){b(f,function a(b,c){return null===b?k():(b=c||-1!==b.indexOf(".js")||/^https?:\/\//.test(b)||!e?b:e+b+".js",p[b]?(r&&(n[r]=1),2==p[b]?k():setTimeout(function(){a(b,!0)},0)):(p[b]=1,r&&(n[r]=1),void d(b,k)))})},0),c}function d(a,b){var c,d=g.createElement("script");d.onload=d.onerror=d[l]=function(){d[k]&&!/^c|loade/.test(d[k])||c||(d.onload=d[l]=null,c=1,p[a]=2,b())},d.async=1,d.src=f?a+(-1===a.indexOf("?")?"?":"&")+f:a,h.insertBefore(d,h.lastChild)}var e,f,g=document,h=g.getElementsByTagName("head")[0],i=!1,j="push",k="readyState",l="onreadystatechange",m={},n={},o={},p={};return c.get=d,c.order=function(a,b,d){!function e(f){f=a.shift(),a.length?c(f,e):c(f,b,d)}()},c.path=function(a){e=a},c.urlArgs=function(a){f=a},c.ready=function(d,e,f){d=d[j]?d:[d];var g=[];return!b(d,function(a){m[a]||g[j](a)})&&a(d,function(a){return m[a]})?e():!function(a){o[a]=o[a]||[],o[a][j](e),f&&f(g)}(d.join("|")),c},c.done=function(a){c([null],a)},c}),parent.postMessage({pk:Math.random(),gatewayId:"smartEditBootstrap",eventId:"loading",data:{location:document.location.href}},"*"),function a(){var b=500,c="heartBeatGateway",d="heartBeat";parent.postMessage({pk:Math.random(),gatewayId:c,eventId:d,data:{location:document.location.href}},"*"),setTimeout(a,b)}(),$(document).ready(function(){parent.postMessage({pk:Math.random(),gatewayId:"smartEditBootstrap",eventId:"bootstrapSmartEdit",data:{location:document.location.href}},"*")});var injectJS=function(a,b,c){c<b.length&&$script(b[c],function(){injectJS(a,b,c+1)})},injectCSS=function(a,b,c){var d=document.createElement("link");d.rel="stylesheet",d.href=b[c],a.appendChild(d),c+1<b.length&&injectCSS(a,b,c+1)},eventMethod=window.addEventListener?"addEventListener":"attachEvent",eventer=window[eventMethod],messageEvent="attachEvent"==eventMethod?"onmessage":"message";eventer(messageEvent,function(a){var b=a.data;if("smarteditBootstrap"==b.eventName){if(window.smartedit=window.smartedit||{},b.resources&&b.resources.properties)for(var c in b.resources.properties)window.smartedit[c]=b.resources.properties[c];var d=document.getElementsByTagName("head")[0];b.resources&&b.resources.js&&b.resources.js.length>0&&injectJS(d,b.resources.js,0),b.resources&&b.resources.css&&b.resources.css.length>0&&injectCSS(d,b.resources.css,0)}},!1);
(function($) {
	$.extend({
		tablesorterPager: new function() {

			function updatePageDisplay(c) {
				var s = $(c.cssPageDisplay,c.container).val((c.page+1) + c.seperator + c.totalPages);
			}

			function moveToPage(table) {
				var c = table.config;
				if(c.page < 0 || c.page > (c.totalPages-1)) {
					c.page = 0;
				}

				renderTable(table,c.rowsCopy);
			}

			function renderTable(table,rows) {

				var c = table.config;
				var l = rows.length;
				var s = (c.page * c.size);
				var e = (s + c.size);
				if(e > rows.length ) {
					e = rows.length;
				}


				var tableBody = $(table.tBodies[0]);

				// clear the table body

				$.tablesorter.clearTableBody(table);

				for(var i = s; i < e; i++) {

					//tableBody.append(rows[i]);

					var o = rows[i];
					var l = o.length;
					for(var j=0; j < l; j++) {

						tableBody[0].appendChild(o[j]);

					}
				}

				$(table).trigger("applyWidgets");

				if( c.page >= c.totalPages ) {
        			moveToLastPage(table);
				}

				updatePageDisplay(c);
			}

			this.appender = function(table,rows) {

				var c = table.config;

				c.rowsCopy = rows;
				c.totalRows = rows.length;
				c.totalPages = Math.ceil(c.totalRows / c.size);

				renderTable(table,rows);
			};

			this.defaults = {
				size: 5,
				offset: 0,
				page: 0,
				totalRows: 0,
				totalPages: 0,
				container: null,
				seperator: "/",
				appender: this.appender
			};

			this.construct = function(settings) {

				return this.each(function() {

                    config = $.extend(this.config, $.tablesorterPager.defaults, settings);

					var table = this, pager = config.container;

                    var curr = 0;
                    var numPages = Math.ceil($(table).find("tbody tr").length/config.size);
                    if (numPages > 1) {
                        while(numPages > curr){
                            $('<li><a href="#" class="page_link">'+(curr+1)+'</a></li>').appendTo(pager);
                            curr++;
                        }

                        $(this).trigger("appendCache");
                        $(pager).find('.page_link:first').addClass('active');
                        $(pager).find(".page_link").click(function() {
                            var clickedPage = $(this).html().valueOf()-1;
                            table.config.page = clickedPage;
                            moveToPage(table);
                            pager.find(".page_link").removeClass("active");
                            pager.find(".page_link").eq(clickedPage).addClass("active");
                            return false;
                        });
					}
				});
			};

		}
	});
	// extend plugin scope
	$.fn.extend({
        tablesorterPager: $.tablesorterPager.construct
	});

})(jQuery);
/*
 *
 * TableSorter 2.0 - Client-side table sorting with ease!
 * Version 2.0.5b
 * @requires jQuery v1.2.3
 *
 * Copyright (c) 2007 Christian Bach
 * Examples and docs at: http://tablesorter.com
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
(function($){$.extend({tablesorter:new
function(){var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:true,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:false,cancelSelection:true,sortList:[],headerList:[],dateFormat:"us",decimal:'/\.|\,/g',onRenderHeader:null,selectorHeaders:'thead th',debug:false};function benchmark(s,d){log(s+","+(new Date().getTime()-d.getTime())+"ms");}this.benchmark=benchmark;function log(s){if(typeof console!="undefined"&&typeof console.debug!="undefined"){console.log(s);}else{alert(s);}}function buildParserCache(table,$headers){if(table.config.debug){var parsersDebug="";}if(table.tBodies.length==0)return;var rows=table.tBodies[0].rows;if(rows[0]){var list=[],cells=rows[0].cells,l=cells.length;for(var i=0;i<l;i++){var p=false;if($.metadata&&($($headers[i]).metadata()&&$($headers[i]).metadata().sorter)){p=getParserById($($headers[i]).metadata().sorter);}else if((table.config.headers[i]&&table.config.headers[i].sorter)){p=getParserById(table.config.headers[i].sorter);}if(!p){p=detectParserForColumn(table,rows,-1,i);}if(table.config.debug){parsersDebug+="column:"+i+" parser:"+p.id+"\n";}list.push(p);}}if(table.config.debug){log(parsersDebug);}return list;};function detectParserForColumn(table,rows,rowIndex,cellIndex){var l=parsers.length,node=false,nodeValue=false,keepLooking=true;while(nodeValue==''&&keepLooking){rowIndex++;if(rows[rowIndex]){node=getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex);nodeValue=trimAndGetNodeText(table.config,node);if(table.config.debug){log('Checking if value was empty on row:'+rowIndex);}}else{keepLooking=false;}}for(var i=1;i<l;i++){if(parsers[i].is(nodeValue,table,node)){return parsers[i];}}return parsers[0];}function getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex){return rows[rowIndex].cells[cellIndex];}function trimAndGetNodeText(config,node){return $.trim(getElementText(config,node));}function getParserById(name){var l=parsers.length;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==name.toLowerCase()){return parsers[i];}}return false;}function buildCache(table){if(table.config.debug){var cacheTime=new Date();}var totalRows=(table.tBodies[0]&&table.tBodies[0].rows.length)||0,totalCells=(table.tBodies[0].rows[0]&&table.tBodies[0].rows[0].cells.length)||0,parsers=table.config.parsers,cache={row:[],normalized:[]};for(var i=0;i<totalRows;++i){var c=$(table.tBodies[0].rows[i]),cols=[];if(c.hasClass(table.config.cssChildRow)){cache.row[cache.row.length-1]=cache.row[cache.row.length-1].add(c);continue;}cache.row.push(c);for(var j=0;j<totalCells;++j){cols.push(parsers[j].format(getElementText(table.config,c[0].cells[j]),table,c[0].cells[j]));}cols.push(cache.normalized.length);cache.normalized.push(cols);cols=null;};if(table.config.debug){benchmark("Building cache for "+totalRows+" rows:",cacheTime);}return cache;};function getElementText(config,node){var text="";if(!node)return"";if(!config.supportsTextContent)config.supportsTextContent=node.textContent||false;if(config.textExtraction=="simple"){if(config.supportsTextContent){text=node.textContent;}else{if(node.childNodes[0]&&node.childNodes[0].hasChildNodes()){text=node.childNodes[0].innerHTML;}else{text=node.innerHTML;}}}else{if(typeof(config.textExtraction)=="function"){text=config.textExtraction(node);}else{text=$(node).text();}}return text;}function appendToTable(table,cache){if(table.config.debug){var appendTime=new Date()}var c=cache,r=c.row,n=c.normalized,totalRows=n.length,checkCell=(n[0].length-1),tableBody=$(table.tBodies[0]),rows=[];for(var i=0;i<totalRows;i++){var pos=n[i][checkCell];rows.push(r[pos]);if(!table.config.appender){var l=r[pos].length;for(var j=0;j<l;j++){tableBody[0].appendChild(r[pos][j]);}}}if(table.config.appender){table.config.appender(table,rows);}rows=null;if(table.config.debug){benchmark("Rebuilt table:",appendTime);}applyWidget(table);setTimeout(function(){$(table).trigger("sortEnd");},0);};function buildHeaders(table){if(table.config.debug){var time=new Date();}var meta=($.metadata)?true:false;var header_index=computeTableHeaderCellIndexes(table);$tableHeaders=$(table.config.selectorHeaders,table).each(function(index){this.column=header_index[this.parentNode.rowIndex+"-"+this.cellIndex];this.order=formatSortingOrder(table.config.sortInitialOrder);this.count=this.order;if(checkHeaderMetadata(this)||checkHeaderOptions(table,index))this.sortDisabled=true;if(checkHeaderOptionsSortingLocked(table,index))this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(table,index);if(!this.sortDisabled){var $th=$(this).addClass(table.config.cssHeader);if(table.config.onRenderHeader)table.config.onRenderHeader.apply($th);}table.config.headerList[index]=this;});if(table.config.debug){benchmark("Built headers:",time);log($tableHeaders);}return $tableHeaders;};function computeTableHeaderCellIndexes(t){var matrix=[];var lookup={};var thead=t.getElementsByTagName('THEAD')[0];var trs=thead.getElementsByTagName('TR');for(var i=0;i<trs.length;i++){var cells=trs[i].cells;for(var j=0;j<cells.length;j++){var c=cells[j];var rowIndex=c.parentNode.rowIndex;var cellId=rowIndex+"-"+c.cellIndex;var rowSpan=c.rowSpan||1;var colSpan=c.colSpan||1
var firstAvailCol;if(typeof(matrix[rowIndex])=="undefined"){matrix[rowIndex]=[];}for(var k=0;k<matrix[rowIndex].length+1;k++){if(typeof(matrix[rowIndex][k])=="undefined"){firstAvailCol=k;break;}}lookup[cellId]=firstAvailCol;for(var k=rowIndex;k<rowIndex+rowSpan;k++){if(typeof(matrix[k])=="undefined"){matrix[k]=[];}var matrixrow=matrix[k];for(var l=firstAvailCol;l<firstAvailCol+colSpan;l++){matrixrow[l]="x";}}}}return lookup;}function checkCellColSpan(table,rows,row){var arr=[],r=table.tHead.rows,c=r[row].cells;for(var i=0;i<c.length;i++){var cell=c[i];if(cell.colSpan>1){arr=arr.concat(checkCellColSpan(table,headerArr,row++));}else{if(table.tHead.length==1||(cell.rowSpan>1||!r[row+1])){arr.push(cell);}}}return arr;};function checkHeaderMetadata(cell){if(($.metadata)&&($(cell).metadata().sorter===false)){return true;};return false;}function checkHeaderOptions(table,i){if((table.config.headers[i])&&(table.config.headers[i].sorter===false)){return true;};return false;}function checkHeaderOptionsSortingLocked(table,i){if((table.config.headers[i])&&(table.config.headers[i].lockedOrder))return table.config.headers[i].lockedOrder;return false;}function applyWidget(table){var c=table.config.widgets;var l=c.length;for(var i=0;i<l;i++){getWidgetById(c[i]).format(table);}}function getWidgetById(name){var l=widgets.length;for(var i=0;i<l;i++){if(widgets[i].id.toLowerCase()==name.toLowerCase()){return widgets[i];}}};function formatSortingOrder(v){if(typeof(v)!="Number"){return(v.toLowerCase()=="desc")?1:0;}else{return(v==1)?1:0;}}function isValueInArray(v,a){var l=a.length;for(var i=0;i<l;i++){if(a[i][0]==v){return true;}}return false;}function setHeadersCss(table,$headers,list,css){$headers.removeClass(css[0]).removeClass(css[1]);var h=[];$headers.each(function(offset){if(!this.sortDisabled){h[this.column]=$(this);}});var l=list.length;for(var i=0;i<l;i++){h[list[i][0]].addClass(css[list[i][1]]);}}function fixColumnWidth(table,$headers){var c=table.config;if(c.widthFixed){var colgroup=$('<colgroup>');$("tr:first td",table.tBodies[0]).each(function(){colgroup.append($('<col>').css('width',$(this).width()));});$(table).prepend(colgroup);};}function updateHeaderSortCount(table,sortList){var c=table.config,l=sortList.length;for(var i=0;i<l;i++){var s=sortList[i],o=c.headerList[s[0]];o.count=s[1];o.count++;}}function multisort(table,sortList,cache){if(table.config.debug){var sortTime=new Date();}var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length;for(var i=0;i<l;i++){var c=sortList[i][0];var order=sortList[i][1];var s=(table.config.parsers[c].type=="text")?((order==0)?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c)):((order==0)?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c));var e="e"+i;dynamicExp+="var "+e+" = "+s;dynamicExp+="if("+e+") { return "+e+"; } ";dynamicExp+="else { ";}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;i<l;i++){dynamicExp+="}; ";}dynamicExp+="return 0; ";dynamicExp+="}; ";if(table.config.debug){benchmark("Evaling expression:"+dynamicExp,new Date());}eval(dynamicExp);cache.normalized.sort(sortWrapper);if(table.config.debug){benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime);}return cache;};function makeSortFunction(type,direction,index){var a="a["+index+"]",b="b["+index+"]";if(type=='text'&&direction=='asc'){return"("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+a+" < "+b+") ? -1 : 1 )));";}else if(type=='text'&&direction=='desc'){return"("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+b+" < "+a+") ? -1 : 1 )));";}else if(type=='numeric'&&direction=='asc'){return"("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+a+" - "+b+"));";}else if(type=='numeric'&&direction=='desc'){return"("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+b+" - "+a+"));";}};function makeSortText(i){return"((a["+i+"] < b["+i+"]) ? -1 : ((a["+i+"] > b["+i+"]) ? 1 : 0));";};function makeSortTextDesc(i){return"((b["+i+"] < a["+i+"]) ? -1 : ((b["+i+"] > a["+i+"]) ? 1 : 0));";};function makeSortNumeric(i){return"a["+i+"]-b["+i+"];";};function makeSortNumericDesc(i){return"b["+i+"]-a["+i+"];";};function sortText(a,b){if(table.config.sortLocaleCompare)return a.localeCompare(b);return((a<b)?-1:((a>b)?1:0));};function sortTextDesc(a,b){if(table.config.sortLocaleCompare)return b.localeCompare(a);return((b<a)?-1:((b>a)?1:0));};function sortNumeric(a,b){return a-b;};function sortNumericDesc(a,b){return b-a;};function getCachedSortType(parsers,i){return parsers[i].type;};this.construct=function(settings){return this.each(function(){if(!this.tHead||!this.tBodies)return;var $this,$document,$headers,cache,config,shiftDown=0,sortOrder;this.config={};config=$.extend(this.config,$.tablesorter.defaults,settings);$this=$(this);$.data(this,"tablesorter",config);$headers=buildHeaders(this);this.config.parsers=buildParserCache(this,$headers);cache=buildCache(this);var sortCSS=[config.cssDesc,config.cssAsc];fixColumnWidth(this);$headers.click(function(e){var totalRows=($this[0].tBodies[0]&&$this[0].tBodies[0].rows.length)||0;if(!this.sortDisabled&&totalRows>0){$this.trigger("sortStart");var $cell=$(this);var i=this.column;this.order=this.count++%2;if(this.lockedOrder)this.order=this.lockedOrder;if(!e[config.sortMultiSortKey]){config.sortList=[];if(config.sortForce!=null){var a=config.sortForce;for(var j=0;j<a.length;j++){if(a[j][0]!=i){config.sortList.push(a[j]);}}}config.sortList.push([i,this.order]);}else{if(isValueInArray(i,config.sortList)){for(var j=0;j<config.sortList.length;j++){var s=config.sortList[j],o=config.headerList[s[0]];if(s[0]==i){o.count=s[1];o.count++;s[1]=o.count%2;}}}else{config.sortList.push([i,this.order]);}};setTimeout(function(){setHeadersCss($this[0],$headers,config.sortList,sortCSS);appendToTable($this[0],multisort($this[0],config.sortList,cache));},1);return false;}}).mousedown(function(){if(config.cancelSelection){this.onselectstart=function(){return false};return false;}});$this.bind("update",function(){var me=this;setTimeout(function(){me.config.parsers=buildParserCache(me,$headers);cache=buildCache(me);},1);}).bind("updateCell",function(e,cell){var config=this.config;var pos=[(cell.parentNode.rowIndex-1),cell.cellIndex];cache.normalized[pos[0]][pos[1]]=config.parsers[pos[1]].format(getElementText(config,cell),cell);}).bind("sorton",function(e,list){$(this).trigger("sortStart");config.sortList=list;var sortList=config.sortList;updateHeaderSortCount(this,sortList);setHeadersCss(this,$headers,sortList,sortCSS);appendToTable(this,multisort(this,sortList,cache));}).bind("appendCache",function(){appendToTable(this,cache);}).bind("applyWidgetId",function(e,id){getWidgetById(id).format(this);}).bind("applyWidgets",function(){applyWidget(this);});if($.metadata&&($(this).metadata()&&$(this).metadata().sortlist)){config.sortList=$(this).metadata().sortlist;}if(config.sortList.length>0){$this.trigger("sorton",[config.sortList]);}applyWidget(this);});};this.addParser=function(parser){var l=parsers.length,a=true;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==parser.id.toLowerCase()){a=false;}}if(a){parsers.push(parser);};};this.addWidget=function(widget){widgets.push(widget);};this.formatFloat=function(s){var i=parseFloat(s);return(isNaN(i))?0:i;};this.formatInt=function(s){var i=parseInt(s);return(isNaN(i))?0:i;};this.isDigit=function(s,config){return/^[-+]?\d*$/.test($.trim(s.replace(/[,.']/g,'')));};this.clearTableBody=function(table){if (navigator.userAgent.match("MSIE")) {function empty(){while(this.firstChild)this.removeChild(this.firstChild);}empty.apply(table.tBodies[0]);}else{table.tBodies[0].innerHTML="";}};}});$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(s){return true;},format:function(s){return $.trim(s.toLocaleLowerCase());},type:"text"});ts.addParser({id:"digit",is:function(s,table){var c=table.config;return $.tablesorter.isDigit(s,c);},format:function(s){return $.tablesorter.formatFloat(s);},type:"numeric"});ts.addParser({id:"currency",is:function(s){return/^[$?.]/.test(s);},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/[$]/g),""));},type:"numeric"});ts.addParser({id:"ipAddress",is:function(s){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(s);},format:function(s){var a=s.split("."),r="",l=a.length;for(var i=0;i<l;i++){var item=a[i];if(item.length==2){r+="0"+item;}else{r+=item;}}return $.tablesorter.formatFloat(r);},type:"numeric"});ts.addParser({id:"url",is:function(s){return/^(https?|ftp|file):\/\/$/.test(s);},format:function(s){return jQuery.trim(s.replace(new RegExp(/(https?|ftp|file):\/\//),''));},type:"text"});ts.addParser({id:"isoDate",is:function(s){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(s);},format:function(s){return $.tablesorter.formatFloat((s!="")?new Date(s.replace(new RegExp(/-/g),"/")).getTime():"0");},type:"numeric"});ts.addParser({id:"percent",is:function(s){return/\%$/.test($.trim(s));},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/%/g),""));},type:"numeric"});ts.addParser({id:"usLongDate",is:function(s){return s.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/));},format:function(s){return $.tablesorter.formatFloat(new Date(s).getTime());},type:"numeric"});ts.addParser({id:"shortDate",is:function(s){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(s);},format:function(s,table){var c=table.config;s=s.replace(/\-/g,"/");if(c.dateFormat=="us"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");}else if(c.dateFormat=="uk"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");}else if(c.dateFormat=="dd/mm/yy"||c.dateFormat=="dd-mm-yy"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");}return $.tablesorter.formatFloat(new Date(s).getTime());},type:"numeric"});ts.addParser({id:"time",is:function(s){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(s);},format:function(s){return $.tablesorter.formatFloat(new Date("2000/01/01 "+s).getTime());},type:"numeric"});ts.addParser({id:"metadata",is:function(s){return false;},format:function(s,table,cell){var c=table.config,p=(!c.parserMetadataName)?'sortValue':c.parserMetadataName;return $(cell).metadata()[p];},type:"numeric"});ts.addWidget({id:"zebra",format:function(table){if(table.config.debug){var time=new Date();}var $tr,row=-1,odd;$("tr:visible",table.tBodies[0]).each(function(i){$tr=$(this);if(!$tr.hasClass(table.config.cssChildRow))row++;odd=(row%2==0);$tr.removeClass(table.config.widgetZebra.css[odd?0:1]).addClass(table.config.widgetZebra.css[odd?1:0])});if(table.config.debug){$.tablesorter.benchmark("Applying Zebra widget",time);}}});})(jQuery);
/*!
 * Chart.js
 * http://chartjs.org/
 * Version: 2.2.1
 *
 * Copyright 2016 Nick Downie
 * Released under the MIT license
 * https://github.com/chartjs/Chart.js/blob/master/LICENSE.md
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Chart=t()}}(function(){return function t(e,a,i){function n(r,l){if(!a[r]){if(!e[r]){var s="function"==typeof require&&require;if(!l&&s)return s(r,!0);if(o)return o(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=a[r]={exports:{}};e[r][0].call(u.exports,function(t){var a=e[r][1][t];return n(a?a:t)},u,u.exports,t,e,a,i)}return a[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)n(i[r]);return n}({1:[function(t,e,a){},{}],2:[function(t,e,a){function i(t){if(t){var e=/^#([a-fA-F0-9]{3})$/,a=/^#([a-fA-F0-9]{6})$/,i=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,n=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,o=/(\w+)/,r=[0,0,0],l=1,s=t.match(e);if(s){s=s[1];for(var d=0;d<r.length;d++)r[d]=parseInt(s[d]+s[d],16)}else if(s=t.match(a)){s=s[1];for(var d=0;d<r.length;d++)r[d]=parseInt(s.slice(2*d,2*d+2),16)}else if(s=t.match(i)){for(var d=0;d<r.length;d++)r[d]=parseInt(s[d+1]);l=parseFloat(s[4])}else if(s=t.match(n)){for(var d=0;d<r.length;d++)r[d]=Math.round(2.55*parseFloat(s[d+1]));l=parseFloat(s[4])}else if(s=t.match(o)){if("transparent"==s[1])return[0,0,0,0];if(r=y[s[1]],!r)return}for(var d=0;d<r.length;d++)r[d]=v(r[d],0,255);return l=l||0==l?v(l,0,1):1,r[3]=l,r}}function n(t){if(t){var e=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,a=t.match(e);if(a){var i=parseFloat(a[4]),n=v(parseInt(a[1]),0,360),o=v(parseFloat(a[2]),0,100),r=v(parseFloat(a[3]),0,100),l=v(isNaN(i)?1:i,0,1);return[n,o,r,l]}}}function o(t){if(t){var e=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,a=t.match(e);if(a){var i=parseFloat(a[4]),n=v(parseInt(a[1]),0,360),o=v(parseFloat(a[2]),0,100),r=v(parseFloat(a[3]),0,100),l=v(isNaN(i)?1:i,0,1);return[n,o,r,l]}}}function r(t){var e=i(t);return e&&e.slice(0,3)}function l(t){var e=n(t);return e&&e.slice(0,3)}function s(t){var e=i(t);return e?e[3]:(e=n(t))?e[3]:(e=o(t))?e[3]:void 0}function d(t){return"#"+x(t[0])+x(t[1])+x(t[2])}function u(t,e){return 1>e||t[3]&&t[3]<1?c(t,e):"rgb("+t[0]+", "+t[1]+", "+t[2]+")"}function c(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function h(t,e){if(1>e||t[3]&&t[3]<1)return f(t,e);var a=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return"rgb("+a+"%, "+i+"%, "+n+"%)"}function f(t,e){var a=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return"rgba("+a+"%, "+i+"%, "+n+"%, "+(e||t[3]||1)+")"}function g(t,e){return 1>e||t[3]&&t[3]<1?p(t,e):"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"}function p(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function m(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"}function b(t){return k[t.slice(0,3)]}function v(t,e,a){return Math.min(Math.max(e,t),a)}function x(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var y=t(6);e.exports={getRgba:i,getHsla:n,getRgb:r,getHsl:l,getHwb:o,getAlpha:s,hexString:d,rgbString:u,rgbaString:c,percentString:h,percentaString:f,hslString:g,hslaString:p,hwbString:m,keyword:b};var k={};for(var S in y)k[y[S]]=S},{6:6}],3:[function(t,e,a){var i=t(5),n=t(2),o=function(t){if(t instanceof o)return t;if(!(this instanceof o))return new o(t);this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var e;if("string"==typeof t)if(e=n.getRgba(t))this.setValues("rgb",e);else if(e=n.getHsla(t))this.setValues("hsl",e);else{if(!(e=n.getHwb(t)))throw new Error('Unable to parse color from string "'+t+'"');this.setValues("hwb",e)}else if("object"==typeof t)if(e=t,void 0!==e.r||void 0!==e.red)this.setValues("rgb",e);else if(void 0!==e.l||void 0!==e.lightness)this.setValues("hsl",e);else if(void 0!==e.v||void 0!==e.value)this.setValues("hsv",e);else if(void 0!==e.w||void 0!==e.whiteness)this.setValues("hwb",e);else{if(void 0===e.c&&void 0===e.cyan)throw new Error("Unable to parse color from object "+JSON.stringify(t));this.setValues("cmyk",e)}};o.prototype={rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t%=360,t=0>t?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return n.hexString(this.values.rgb)},rgbString:function(){return n.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return n.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return n.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return n.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return n.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return n.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return n.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],a=0;a<t.length;a++){var i=t[a]/255;e[a]=.03928>=i?i/12.92:Math.pow((i+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),a=t.luminosity();return e>a?(e+.05)/(a+.05):(a+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},dark:function(){var t=this.values.rgb,e=(299*t[0]+587*t[1]+114*t[2])/1e3;return 128>e},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;3>e;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,a=(e[0]+t)%360;return e[0]=0>a?360+a:a,this.setValues("hsl",e),this},mix:function(t,e){var a=this,i=t,n=void 0===e?.5:e,o=2*n-1,r=a.alpha()-i.alpha(),l=((o*r===-1?o:(o+r)/(1+o*r))+1)/2,s=1-l;return this.rgb(l*a.red()+s*i.red(),l*a.green()+s*i.green(),l*a.blue()+s*i.blue()).alpha(a.alpha()*n+i.alpha()*(1-n))},toJSON:function(){return this.rgb()},clone:function(){var t,e,a=new o,i=this.values,n=a.values;for(var r in i)i.hasOwnProperty(r)&&(t=i[r],e={}.toString.call(t),"[object Array]"===e?n[r]=t.slice(0):"[object Number]"===e?n[r]=t:console.error("unexpected color value:",t));return a}},o.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},o.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},o.prototype.getValues=function(t){for(var e=this.values,a={},i=0;i<t.length;i++)a[t.charAt(i)]=e[t][i];return 1!==e.alpha&&(a.a=e.alpha),a},o.prototype.setValues=function(t,e){var a,n=this.values,o=this.spaces,r=this.maxes,l=1;if("alpha"===t)l=e;else if(e.length)n[t]=e.slice(0,t.length),l=e[t.length];else if(void 0!==e[t.charAt(0)]){for(a=0;a<t.length;a++)n[t][a]=e[t.charAt(a)];l=e.a}else if(void 0!==e[o[t][0]]){var s=o[t];for(a=0;a<t.length;a++)n[t][a]=e[s[a]];l=e.alpha}if(n.alpha=Math.max(0,Math.min(1,void 0===l?n.alpha:l)),"alpha"===t)return!1;var d;for(a=0;a<t.length;a++)d=Math.max(0,Math.min(r[t][a],n[t][a])),n[t][a]=Math.round(d);for(var u in o)u!==t&&(n[u]=i[t][u](n[t]));return!0},o.prototype.setSpace=function(t,e){var a=e[0];return void 0===a?this.getValues(t):("number"==typeof a&&(a=Array.prototype.slice.call(e)),this.setValues(t,a),this)},o.prototype.setChannel=function(t,e,a){var i=this.values[t];return void 0===a?i[e]:a===i[e]?this:(i[e]=a,this.setValues(t,i),this)},"undefined"!=typeof window&&(window.Color=o),e.exports=o},{2:2,5:5}],4:[function(t,e,a){function i(t){var e,a,i,n=t[0]/255,o=t[1]/255,r=t[2]/255,l=Math.min(n,o,r),s=Math.max(n,o,r),d=s-l;return s==l?e=0:n==s?e=(o-r)/d:o==s?e=2+(r-n)/d:r==s&&(e=4+(n-o)/d),e=Math.min(60*e,360),0>e&&(e+=360),i=(l+s)/2,a=s==l?0:.5>=i?d/(s+l):d/(2-s-l),[e,100*a,100*i]}function n(t){var e,a,i,n=t[0],o=t[1],r=t[2],l=Math.min(n,o,r),s=Math.max(n,o,r),d=s-l;return a=0==s?0:d/s*1e3/10,s==l?e=0:n==s?e=(o-r)/d:o==s?e=2+(r-n)/d:r==s&&(e=4+(n-o)/d),e=Math.min(60*e,360),0>e&&(e+=360),i=s/255*1e3/10,[e,a,i]}function o(t){var e=t[0],a=t[1],n=t[2],o=i(t)[0],r=1/255*Math.min(e,Math.min(a,n)),n=1-1/255*Math.max(e,Math.max(a,n));return[o,100*r,100*n]}function l(t){var e,a,i,n,o=t[0]/255,r=t[1]/255,l=t[2]/255;return n=Math.min(1-o,1-r,1-l),e=(1-o-n)/(1-n)||0,a=(1-r-n)/(1-n)||0,i=(1-l-n)/(1-n)||0,[100*e,100*a,100*i,100*n]}function s(t){return Z[JSON.stringify(t)]}function d(t){var e=t[0]/255,a=t[1]/255,i=t[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;var n=.4124*e+.3576*a+.1805*i,o=.2126*e+.7152*a+.0722*i,r=.0193*e+.1192*a+.9505*i;return[100*n,100*o,100*r]}function u(t){var e,a,i,n=d(t),o=n[0],r=n[1],l=n[2];return o/=95.047,r/=100,l/=108.883,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,e=116*r-16,a=500*(o-r),i=200*(r-l),[e,a,i]}function c(t){return W(u(t))}function h(t){var e,a,i,n,o,r=t[0]/360,l=t[1]/100,s=t[2]/100;if(0==l)return o=255*s,[o,o,o];a=.5>s?s*(1+l):s+l-s*l,e=2*s-a,n=[0,0,0];for(var d=0;3>d;d++)i=r+1/3*-(d-1),0>i&&i++,i>1&&i--,o=1>6*i?e+6*(a-e)*i:1>2*i?a:2>3*i?e+(a-e)*(2/3-i)*6:e,n[d]=255*o;return n}function f(t){var e,a,i=t[0],n=t[1]/100,o=t[2]/100;return 0===o?[0,0,0]:(o*=2,n*=1>=o?o:2-o,a=(o+n)/2,e=2*n/(o+n),[i,100*e,100*a])}function p(t){return o(h(t))}function m(t){return l(h(t))}function v(t){return s(h(t))}function x(t){var e=t[0]/60,a=t[1]/100,i=t[2]/100,n=Math.floor(e)%6,o=e-Math.floor(e),r=255*i*(1-a),l=255*i*(1-a*o),s=255*i*(1-a*(1-o)),i=255*i;switch(n){case 0:return[i,s,r];case 1:return[l,i,r];case 2:return[r,i,s];case 3:return[r,l,i];case 4:return[s,r,i];case 5:return[i,r,l]}}function y(t){var e,a,i=t[0],n=t[1]/100,o=t[2]/100;return a=(2-n)*o,e=n*o,e/=1>=a?a:2-a,e=e||0,a/=2,[i,100*e,100*a]}function k(t){return o(x(t))}function S(t){return l(x(t))}function w(t){return s(x(t))}function C(t){var e,a,i,n,o=t[0]/360,l=t[1]/100,s=t[2]/100,d=l+s;switch(d>1&&(l/=d,s/=d),e=Math.floor(6*o),a=1-s,i=6*o-e,0!=(1&e)&&(i=1-i),n=l+i*(a-l),e){default:case 6:case 0:r=a,g=n,b=l;break;case 1:r=n,g=a,b=l;break;case 2:r=l,g=a,b=n;break;case 3:r=l,g=n,b=a;break;case 4:r=n,g=l,b=a;break;case 5:r=a,g=l,b=n}return[255*r,255*g,255*b]}function M(t){return i(C(t))}function D(t){return n(C(t))}function A(t){return l(C(t))}function I(t){return s(C(t))}function T(t){var e,a,i,n=t[0]/100,o=t[1]/100,r=t[2]/100,l=t[3]/100;return e=1-Math.min(1,n*(1-l)+l),a=1-Math.min(1,o*(1-l)+l),i=1-Math.min(1,r*(1-l)+l),[255*e,255*a,255*i]}function F(t){return i(T(t))}function P(t){return n(T(t))}function R(t){return o(T(t))}function _(t){return s(T(t))}function V(t){var e,a,i,n=t[0]/100,o=t[1]/100,r=t[2]/100;return e=3.2406*n+-1.5372*o+r*-.4986,a=n*-.9689+1.8758*o+.0415*r,i=.0557*n+o*-.204+1.057*r,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:e=12.92*e,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=12.92*a,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i=12.92*i,e=Math.min(Math.max(0,e),1),a=Math.min(Math.max(0,a),1),i=Math.min(Math.max(0,i),1),[255*e,255*a,255*i]}function L(t){var e,a,i,n=t[0],o=t[1],r=t[2];return n/=95.047,o/=100,r/=108.883,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,e=116*o-16,a=500*(n-o),i=200*(o-r),[e,a,i]}function O(t){return W(L(t))}function B(t){var e,a,i,n,o=t[0],r=t[1],l=t[2];return 8>=o?(a=100*o/903.3,n=7.787*(a/100)+16/116):(a=100*Math.pow((o+16)/116,3),n=Math.pow(a/100,1/3)),e=.008856>=e/95.047?e=95.047*(r/500+n-16/116)/7.787:95.047*Math.pow(r/500+n,3),i=.008859>=i/108.883?i=108.883*(n-l/200-16/116)/7.787:108.883*Math.pow(n-l/200,3),[e,a,i]}function W(t){var e,a,i,n=t[0],o=t[1],r=t[2];return e=Math.atan2(r,o),a=360*e/2/Math.PI,0>a&&(a+=360),i=Math.sqrt(o*o+r*r),[n,i,a]}function z(t){return V(B(t))}function N(t){var e,a,i,n=t[0],o=t[1],r=t[2];return i=r/360*2*Math.PI,e=o*Math.cos(i),a=o*Math.sin(i),[n,e,a]}function H(t){return B(N(t))}function E(t){return z(N(t))}function U(t){return Q[t]}function q(t){return i(U(t))}function j(t){return n(U(t))}function Y(t){return o(U(t))}function J(t){return l(U(t))}function X(t){return u(U(t))}function G(t){return d(U(t))}e.exports={rgb2hsl:i,rgb2hsv:n,rgb2hwb:o,rgb2cmyk:l,rgb2keyword:s,rgb2xyz:d,rgb2lab:u,rgb2lch:c,hsl2rgb:h,hsl2hsv:f,hsl2hwb:p,hsl2cmyk:m,hsl2keyword:v,hsv2rgb:x,hsv2hsl:y,hsv2hwb:k,hsv2cmyk:S,hsv2keyword:w,hwb2rgb:C,hwb2hsl:M,hwb2hsv:D,hwb2cmyk:A,hwb2keyword:I,cmyk2rgb:T,cmyk2hsl:F,cmyk2hsv:P,cmyk2hwb:R,cmyk2keyword:_,keyword2rgb:U,keyword2hsl:q,keyword2hsv:j,keyword2hwb:Y,keyword2cmyk:J,keyword2lab:X,keyword2xyz:G,xyz2rgb:V,xyz2lab:L,xyz2lch:O,lab2xyz:B,lab2rgb:z,lab2lch:W,lch2lab:N,lch2xyz:H,lch2rgb:E};var Q={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Z={};for(var $ in Q)Z[JSON.stringify(Q[$])]=$},{}],5:[function(t,e,a){var i=t(4),n=function(){return new d};for(var o in i){n[o+"Raw"]=function(t){return function(e){return"number"==typeof e&&(e=Array.prototype.slice.call(arguments)),i[t](e)}}(o);var r=/(\w+)2(\w+)/.exec(o),l=r[1],s=r[2];n[l]=n[l]||{},n[l][s]=n[o]=function(t){return function(e){"number"==typeof e&&(e=Array.prototype.slice.call(arguments));var a=i[t](e);if("string"==typeof a||void 0===a)return a;for(var n=0;n<a.length;n++)a[n]=Math.round(a[n]);return a}}(o)}var d=function(){this.convs={}};d.prototype.routeSpace=function(t,e){var a=e[0];return void 0===a?this.getValues(t):("number"==typeof a&&(a=Array.prototype.slice.call(e)),this.setValues(t,a))},d.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},d.prototype.getValues=function(t){var e=this.convs[t];if(!e){var a=this.space,i=this.convs[a];e=n[a][t](i),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(t){d.prototype[t]=function(e){return this.routeSpace(t,arguments)}}),e.exports=n},{4:4}],6:[function(t,e,a){e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],7:[function(t,e,a){var i=t(27)();t(26)(i),t(22)(i),t(25)(i),t(21)(i),t(23)(i),t(24)(i),t(28)(i),t(32)(i),t(30)(i),t(31)(i),t(33)(i),t(29)(i),t(34)(i),t(35)(i),t(36)(i),t(37)(i),t(38)(i),t(41)(i),t(39)(i),t(40)(i),t(42)(i),t(43)(i),t(44)(i),t(15)(i),t(16)(i),t(17)(i),t(18)(i),t(19)(i),t(20)(i),t(8)(i),t(9)(i),t(10)(i),t(11)(i),t(12)(i),t(13)(i),t(14)(i),window.Chart=e.exports=i},{10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,8:8,9:9}],8:[function(t,e,a){"use strict";e.exports=function(t){t.Bar=function(e,a){return a.type="bar",new t(e,a)}}},{}],9:[function(t,e,a){"use strict";e.exports=function(t){t.Bubble=function(e,a){return a.type="bubble",new t(e,a)}}},{}],10:[function(t,e,a){"use strict";e.exports=function(t){t.Doughnut=function(e,a){return a.type="doughnut",new t(e,a)}}},{}],11:[function(t,e,a){"use strict";e.exports=function(t){t.Line=function(e,a){return a.type="line",new t(e,a)}}},{}],12:[function(t,e,a){"use strict";e.exports=function(t){t.PolarArea=function(e,a){return a.type="polarArea",new t(e,a)}}},{}],13:[function(t,e,a){"use strict";e.exports=function(t){t.Radar=function(e,a){return a.options=t.helpers.configMerge({aspectRatio:1},a.options),a.type="radar",new t(e,a)}}},{}],14:[function(t,e,a){"use strict";e.exports=function(t){var e={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-1"}],yAxes:[{type:"linear",position:"left",id:"y-axis-1"}]},tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}};t.defaults.scatter=e,t.controllers.scatter=t.controllers.line,t.Scatter=function(e,a){return a.type="scatter",new t(e,a)}}},{}],15:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.bar={hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}},t.controllers.bar=t.DatasetController.extend({dataElementType:t.elements.Rectangle,initialize:function(e,a){t.DatasetController.prototype.initialize.call(this,e,a),this.getMeta().bar=!0},getBarCount:function(){var t=this,a=0;return e.each(t.chart.data.datasets,function(e,i){var n=t.chart.getDatasetMeta(i);n.bar&&t.chart.isDatasetVisible(i)&&++a},t),a},update:function(t){var a=this;e.each(a.getMeta().data,function(e,i){a.updateElement(e,i,t)},a)},updateElement:function(t,a,i){var n=this,o=n.getMeta(),r=n.getScaleForId(o.xAxisID),l=n.getScaleForId(o.yAxisID),s=l.getBasePixel(),d=n.chart.options.elements.rectangle,u=t.custom||{},c=n.getDataset();e.extend(t,{_xScale:r,_yScale:l,_datasetIndex:n.index,_index:a,_model:{x:n.calculateBarX(a,n.index),y:i?s:n.calculateBarY(a,n.index),label:n.chart.data.labels[a],datasetLabel:c.label,base:i?s:n.calculateBarBase(n.index,a),width:n.calculateBarWidth(a),backgroundColor:u.backgroundColor?u.backgroundColor:e.getValueAtIndexOrDefault(c.backgroundColor,a,d.backgroundColor),borderSkipped:u.borderSkipped?u.borderSkipped:d.borderSkipped,borderColor:u.borderColor?u.borderColor:e.getValueAtIndexOrDefault(c.borderColor,a,d.borderColor),borderWidth:u.borderWidth?u.borderWidth:e.getValueAtIndexOrDefault(c.borderWidth,a,d.borderWidth)}}),t.pivot()},calculateBarBase:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=0;if(n.options.stacked){for(var r=a.chart,l=r.data.datasets,s=Number(l[t].data[e]),d=0;t>d;d++){var u=l[d],c=r.getDatasetMeta(d);if(c.bar&&c.yAxisID===n.id&&r.isDatasetVisible(d)){var h=Number(u.data[e]);o+=0>s?Math.min(h,0):Math.max(h,0)}}return n.getPixelForValue(o)}return n.getBasePixel()},getRuler:function(t){var e,a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=a.getBarCount();e="category"===n.options.type?n.getPixelForTick(t+1)-n.getPixelForTick(t):n.width/n.ticks.length;var r=e*n.options.categoryPercentage,l=(e-e*n.options.categoryPercentage)/2,s=r/o;if(n.ticks.length!==a.chart.data.labels.length){var d=n.ticks.length/a.chart.data.labels.length;s*=d}var u=s*n.options.barPercentage,c=s-s*n.options.barPercentage;return{datasetCount:o,tickWidth:e,categoryWidth:r,categorySpacing:l,fullBarWidth:s,barWidth:u,barSpacing:c}},calculateBarWidth:function(t){var e=this.getScaleForId(this.getMeta().xAxisID);if(e.options.barThickness)return e.options.barThickness;var a=this.getRuler(t);return e.options.stacked?a.categoryWidth:a.barWidth},getBarIndex:function(t){var e,a,i=0;for(a=0;t>a;++a)e=this.chart.getDatasetMeta(a),e.bar&&this.chart.isDatasetVisible(a)&&++i;return i},calculateBarX:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=a.getBarIndex(e),r=a.getRuler(t),l=n.getPixelForValue(null,t,e,a.chart.isCombo);return l-=a.chart.isCombo?r.tickWidth/2:0,n.options.stacked?l+r.categoryWidth/2+r.categorySpacing:l+r.barWidth/2+r.categorySpacing+r.barWidth*o+r.barSpacing/2+r.barSpacing*o},calculateBarY:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=Number(a.getDataset().data[t]);if(n.options.stacked){for(var r=0,l=0,s=0;e>s;s++){var d=a.chart.data.datasets[s],u=a.chart.getDatasetMeta(s);if(u.bar&&u.yAxisID===n.id&&a.chart.isDatasetVisible(s)){var c=Number(d.data[t]);0>c?l+=c||0:r+=c||0}}return 0>o?n.getPixelForValue(l+o):n.getPixelForValue(r+o)}return n.getPixelForValue(o)},draw:function(t){var a=this,i=t||1;e.each(a.getMeta().data,function(t,e){var n=a.getDataset().data[e];null===n||void 0===n||isNaN(n)||t.transition(i).draw()},a)},setHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=t._model;o.backgroundColor=n.hoverBackgroundColor?n.hoverBackgroundColor:e.getValueAtIndexOrDefault(a.hoverBackgroundColor,i,e.getHoverColor(o.backgroundColor)),o.borderColor=n.hoverBorderColor?n.hoverBorderColor:e.getValueAtIndexOrDefault(a.hoverBorderColor,i,e.getHoverColor(o.borderColor)),o.borderWidth=n.hoverBorderWidth?n.hoverBorderWidth:e.getValueAtIndexOrDefault(a.hoverBorderWidth,i,o.borderWidth)},removeHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=t._model,r=this.chart.options.elements.rectangle;o.backgroundColor=n.backgroundColor?n.backgroundColor:e.getValueAtIndexOrDefault(a.backgroundColor,i,r.backgroundColor),o.borderColor=n.borderColor?n.borderColor:e.getValueAtIndexOrDefault(a.borderColor,i,r.borderColor),o.borderWidth=n.borderWidth?n.borderWidth:e.getValueAtIndexOrDefault(a.borderWidth,i,r.borderWidth)}}),t.defaults.horizontalBar={hover:{mode:"label"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{callbacks:{title:function(t,e){var a="";return t.length>0&&(t[0].yLabel?a=t[0].yLabel:e.labels.length>0&&t[0].index<e.labels.length&&(a=e.labels[t[0].index])),a},label:function(t,e){var a=e.datasets[t.datasetIndex].label||"";return a+": "+t.xLabel}}}},t.controllers.horizontalBar=t.controllers.bar.extend({updateElement:function(t,a,i){var n=this,o=n.getMeta(),r=n.getScaleForId(o.xAxisID),l=n.getScaleForId(o.yAxisID),s=r.getBasePixel(),d=t.custom||{},u=n.getDataset(),c=n.chart.options.elements.rectangle;e.extend(t,{_xScale:r,_yScale:l,_datasetIndex:n.index,_index:a,_model:{x:i?s:n.calculateBarX(a,n.index),y:n.calculateBarY(a,n.index),label:n.chart.data.labels[a],datasetLabel:u.label,base:i?s:n.calculateBarBase(n.index,a),height:n.calculateBarHeight(a),backgroundColor:d.backgroundColor?d.backgroundColor:e.getValueAtIndexOrDefault(u.backgroundColor,a,c.backgroundColor),borderSkipped:d.borderSkipped?d.borderSkipped:c.borderSkipped,borderColor:d.borderColor?d.borderColor:e.getValueAtIndexOrDefault(u.borderColor,a,c.borderColor),borderWidth:d.borderWidth?d.borderWidth:e.getValueAtIndexOrDefault(u.borderWidth,a,c.borderWidth)},draw:function(){function t(t){return s[(u+t)%4]}var e=this._chart.ctx,a=this._view,i=a.height/2,n=a.y-i,o=a.y+i,r=a.base-(a.base-a.x),l=a.borderWidth/2;a.borderWidth&&(n+=l,o-=l,r+=l),e.beginPath(),e.fillStyle=a.backgroundColor,e.strokeStyle=a.borderColor,e.lineWidth=a.borderWidth;var s=[[a.base,o],[a.base,n],[r,n],[r,o]],d=["bottom","left","top","right"],u=d.indexOf(a.borderSkipped,0);-1===u&&(u=0),e.moveTo.apply(e,t(0));for(var c=1;4>c;c++)e.lineTo.apply(e,t(c));e.fill(),a.borderWidth&&e.stroke()},inRange:function(t,e){var a=this._view,i=!1;return a&&(i=a.x<a.base?e>=a.y-a.height/2&&e<=a.y+a.height/2&&t>=a.x&&t<=a.base:e>=a.y-a.height/2&&e<=a.y+a.height/2&&t>=a.base&&t<=a.x),i}}),t.pivot()},calculateBarBase:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=0;
if(n.options.stacked){for(var r=a.chart,l=r.data.datasets,s=Number(l[t].data[e]),d=0;t>d;d++){var u=l[d],c=r.getDatasetMeta(d);if(c.bar&&c.xAxisID===n.id&&r.isDatasetVisible(d)){var h=Number(u.data[e]);o+=0>s?Math.min(h,0):Math.max(h,0)}}return n.getPixelForValue(o)}return n.getBasePixel()},getRuler:function(t){var e,a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=a.getBarCount();e="category"===n.options.type?n.getPixelForTick(t+1)-n.getPixelForTick(t):n.width/n.ticks.length;var r=e*n.options.categoryPercentage,l=(e-e*n.options.categoryPercentage)/2,s=r/o;if(n.ticks.length!==a.chart.data.labels.length){var d=n.ticks.length/a.chart.data.labels.length;s*=d}var u=s*n.options.barPercentage,c=s-s*n.options.barPercentage;return{datasetCount:o,tickHeight:e,categoryHeight:r,categorySpacing:l,fullBarHeight:s,barHeight:u,barSpacing:c}},calculateBarHeight:function(t){var e=this,a=e.getScaleForId(e.getMeta().yAxisID);if(a.options.barThickness)return a.options.barThickness;var i=e.getRuler(t);return a.options.stacked?i.categoryHeight:i.barHeight},calculateBarX:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.xAxisID),o=Number(a.getDataset().data[t]);if(n.options.stacked){for(var r=0,l=0,s=0;e>s;s++){var d=a.chart.data.datasets[s],u=a.chart.getDatasetMeta(s);if(u.bar&&u.xAxisID===n.id&&a.chart.isDatasetVisible(s)){var c=Number(d.data[t]);0>c?l+=c||0:r+=c||0}}return 0>o?n.getPixelForValue(l+o):n.getPixelForValue(r+o)}return n.getPixelForValue(o)},calculateBarY:function(t,e){var a=this,i=a.getMeta(),n=a.getScaleForId(i.yAxisID),o=a.getBarIndex(e),r=a.getRuler(t),l=n.getPixelForValue(null,t,e,a.chart.isCombo);return l-=a.chart.isCombo?r.tickHeight/2:0,n.options.stacked?l+r.categoryHeight/2+r.categorySpacing:l+r.barHeight/2+r.categorySpacing+r.barHeight*o+r.barSpacing/2+r.barSpacing*o}})}},{}],16:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.bubble={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var a=e.datasets[t.datasetIndex].label||"",i=e.datasets[t.datasetIndex].data[t.index];return a+": ("+i.x+", "+i.y+", "+i.r+")"}}}},t.controllers.bubble=t.DatasetController.extend({dataElementType:t.elements.Point,update:function(t){var a=this,i=a.getMeta(),n=i.data;e.each(n,function(e,i){a.updateElement(e,i,t)})},updateElement:function(a,i,n){var o=this,r=o.getMeta(),l=o.getScaleForId(r.xAxisID),s=o.getScaleForId(r.yAxisID),d=a.custom||{},u=o.getDataset(),c=u.data[i],h=o.chart.options.elements.point,f=o.index;e.extend(a,{_xScale:l,_yScale:s,_datasetIndex:f,_index:i,_model:{x:n?l.getPixelForDecimal(.5):l.getPixelForValue("object"==typeof c?c:NaN,i,f,o.chart.isCombo),y:n?s.getBasePixel():s.getPixelForValue(c,i,f),radius:n?0:d.radius?d.radius:o.getRadius(c),hitRadius:d.hitRadius?d.hitRadius:e.getValueAtIndexOrDefault(u.hitRadius,i,h.hitRadius)}}),t.DatasetController.prototype.removeHoverStyle.call(o,a,h);var g=a._model;g.skip=d.skip?d.skip:isNaN(g.x)||isNaN(g.y),a.pivot()},getRadius:function(t){return t.r||this.chart.options.elements.point.radius},setHoverStyle:function(a){var i=this;t.DatasetController.prototype.setHoverStyle.call(i,a);var n=i.chart.data.datasets[a._datasetIndex],o=a._index,r=a.custom||{},l=a._model;l.radius=r.hoverRadius?r.hoverRadius:e.getValueAtIndexOrDefault(n.hoverRadius,o,i.chart.options.elements.point.hoverRadius)+i.getRadius(n.data[o])},removeHoverStyle:function(e){var a=this;t.DatasetController.prototype.removeHoverStyle.call(a,e,a.chart.options.elements.point);var i=a.chart.data.datasets[e._datasetIndex].data[e._index],n=e.custom||{},o=e._model;o.radius=n.radius?n.radius:a.getRadius(i)}})}},{}],17:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults;a.doughnut={animation:{animateRotate:!0,animateScale:!1},aspectRatio:1,hover:{mode:"single"},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var a=t.data,i=a.datasets,n=a.labels;if(i.length)for(var o=0;o<i[0].data.length;++o)e.push('<li><span style="background-color:'+i[0].backgroundColor[o]+'"></span>'),n[o]&&e.push(n[o]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var a=t.data;return a.labels.length&&a.datasets.length?a.labels.map(function(i,n){var o=t.getDatasetMeta(0),r=a.datasets[0],l=o.data[n],s=l&&l.custom||{},d=e.getValueAtIndexOrDefault,u=t.options.elements.arc,c=s.backgroundColor?s.backgroundColor:d(r.backgroundColor,n,u.backgroundColor),h=s.borderColor?s.borderColor:d(r.borderColor,n,u.borderColor),f=s.borderWidth?s.borderWidth:d(r.borderWidth,n,u.borderWidth);return{text:i,fillStyle:c,strokeStyle:h,lineWidth:f,hidden:isNaN(r.data[n])||o.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var a,i,n,o=e.index,r=this.chart;for(a=0,i=(r.data.datasets||[]).length;i>a;++a)n=r.getDatasetMeta(a),n.data[o].hidden=!n.data[o].hidden;r.update()}},cutoutPercentage:50,rotation:Math.PI*-.5,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+e.datasets[t.datasetIndex].data[t.index]}}}},a.pie=e.clone(a.doughnut),e.extend(a.pie,{cutoutPercentage:0}),t.controllers.doughnut=t.controllers.pie=t.DatasetController.extend({dataElementType:t.elements.Arc,linkScales:e.noop,getRingIndex:function(t){for(var e=0,a=0;t>a;++a)this.chart.isDatasetVisible(a)&&++e;return e},update:function(t){var a=this,i=a.chart,n=i.chartArea,o=i.options,r=o.elements.arc,l=n.right-n.left-r.borderWidth,s=n.bottom-n.top-r.borderWidth,d=Math.min(l,s),u={x:0,y:0},c=a.getMeta(),h=o.cutoutPercentage,f=o.circumference;if(f<2*Math.PI){var g=o.rotation%(2*Math.PI);g+=2*Math.PI*(g>=Math.PI?-1:g<-Math.PI?1:0);var p=g+f,m={x:Math.cos(g),y:Math.sin(g)},b={x:Math.cos(p),y:Math.sin(p)},v=0>=g&&p>=0||g<=2*Math.PI&&2*Math.PI<=p,x=g<=.5*Math.PI&&.5*Math.PI<=p||g<=2.5*Math.PI&&2.5*Math.PI<=p,y=g<=-Math.PI&&-Math.PI<=p||g<=Math.PI&&Math.PI<=p,k=g<=.5*-Math.PI&&.5*-Math.PI<=p||g<=1.5*Math.PI&&1.5*Math.PI<=p,S=h/100,w={x:y?-1:Math.min(m.x*(m.x<0?1:S),b.x*(b.x<0?1:S)),y:k?-1:Math.min(m.y*(m.y<0?1:S),b.y*(b.y<0?1:S))},C={x:v?1:Math.max(m.x*(m.x>0?1:S),b.x*(b.x>0?1:S)),y:x?1:Math.max(m.y*(m.y>0?1:S),b.y*(b.y>0?1:S))},M={width:.5*(C.x-w.x),height:.5*(C.y-w.y)};d=Math.min(l/M.width,s/M.height),u={x:(C.x+w.x)*-.5,y:(C.y+w.y)*-.5}}i.borderWidth=a.getMaxBorderWidth(c.data),i.outerRadius=Math.max((d-i.borderWidth)/2,0),i.innerRadius=Math.max(h?i.outerRadius/100*h:1,0),i.radiusLength=(i.outerRadius-i.innerRadius)/i.getVisibleDatasetCount(),i.offsetX=u.x*i.outerRadius,i.offsetY=u.y*i.outerRadius,c.total=a.calculateTotal(),a.outerRadius=i.outerRadius-i.radiusLength*a.getRingIndex(a.index),a.innerRadius=a.outerRadius-i.radiusLength,e.each(c.data,function(e,i){a.updateElement(e,i,t)})},updateElement:function(t,a,i){var n=this,o=n.chart,r=o.chartArea,l=o.options,s=l.animation,d=(r.left+r.right)/2,u=(r.top+r.bottom)/2,c=l.rotation,h=l.rotation,f=n.getDataset(),g=i&&s.animateRotate?0:t.hidden?0:n.calculateCircumference(f.data[a])*(l.circumference/(2*Math.PI)),p=i&&s.animateScale?0:n.innerRadius,m=i&&s.animateScale?0:n.outerRadius,b=e.getValueAtIndexOrDefault;e.extend(t,{_datasetIndex:n.index,_index:a,_model:{x:d+o.offsetX,y:u+o.offsetY,startAngle:c,endAngle:h,circumference:g,outerRadius:m,innerRadius:p,label:b(f.label,a,o.data.labels[a])}});var v=t._model;this.removeHoverStyle(t),i&&s.animateRotate||(0===a?v.startAngle=l.rotation:v.startAngle=n.getMeta().data[a-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},removeHoverStyle:function(e){t.DatasetController.prototype.removeHoverStyle.call(this,e,this.chart.options.elements.arc)},calculateTotal:function(){var t,a=this.getDataset(),i=this.getMeta(),n=0;return e.each(i.data,function(e,i){t=a.data[i],isNaN(t)||e.hidden||(n+=Math.abs(t))}),n},calculateCircumference:function(t){var e=this.getMeta().total;return e>0&&!isNaN(t)?2*Math.PI*(t/e):0},getMaxBorderWidth:function(t){for(var e,a,i=0,n=this.index,o=t.length,r=0;o>r;r++)e=t[r]._model?t[r]._model.borderWidth:0,a=t[r]._chart?t[r]._chart.config.data.datasets[n].hoverBorderWidth:0,i=e>i?e:i,i=a>i?a:i;return i}})}},{}],18:[function(t,e,a){"use strict";e.exports=function(t){function e(t,e){return a.getValueOrDefault(t.showLine,e.showLines)}var a=t.helpers;t.defaults.line={showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}},t.controllers.line=t.DatasetController.extend({datasetElementType:t.elements.Line,dataElementType:t.elements.Point,addElementAndReset:function(a){var i=this,n=i.chart.options,o=i.getMeta();t.DatasetController.prototype.addElementAndReset.call(i,a),e(i.getDataset(),n)&&0!==o.dataset._model.tension&&i.updateBezierControlPoints()},update:function(t){var i,n,o,r=this,l=r.getMeta(),s=l.dataset,d=l.data||[],u=r.chart.options,c=u.elements.line,h=r.getScaleForId(l.yAxisID),f=r.getDataset(),g=e(f,u);for(g&&(o=s.custom||{},void 0!==f.tension&&void 0===f.lineTension&&(f.lineTension=f.tension),s._scale=h,s._datasetIndex=r.index,s._children=d,s._model={spanGaps:f.spanGaps?f.spanGaps:u.spanGaps,tension:o.tension?o.tension:a.getValueOrDefault(f.lineTension,c.tension),backgroundColor:o.backgroundColor?o.backgroundColor:f.backgroundColor||c.backgroundColor,borderWidth:o.borderWidth?o.borderWidth:f.borderWidth||c.borderWidth,borderColor:o.borderColor?o.borderColor:f.borderColor||c.borderColor,borderCapStyle:o.borderCapStyle?o.borderCapStyle:f.borderCapStyle||c.borderCapStyle,borderDash:o.borderDash?o.borderDash:f.borderDash||c.borderDash,borderDashOffset:o.borderDashOffset?o.borderDashOffset:f.borderDashOffset||c.borderDashOffset,borderJoinStyle:o.borderJoinStyle?o.borderJoinStyle:f.borderJoinStyle||c.borderJoinStyle,fill:o.fill?o.fill:void 0!==f.fill?f.fill:c.fill,steppedLine:o.steppedLine?o.steppedLine:a.getValueOrDefault(f.steppedLine,c.stepped),scaleTop:h.top,scaleBottom:h.bottom,scaleZero:h.getBasePixel()},s.pivot()),i=0,n=d.length;n>i;++i)r.updateElement(d[i],i,t);for(g&&0!==s._model.tension&&r.updateBezierControlPoints(),i=0,n=d.length;n>i;++i)d[i].pivot()},getPointBackgroundColor:function(t,e){var i=this.chart.options.elements.point.backgroundColor,n=this.getDataset(),o=t.custom||{};return o.backgroundColor?i=o.backgroundColor:n.pointBackgroundColor?i=a.getValueAtIndexOrDefault(n.pointBackgroundColor,e,i):n.backgroundColor&&(i=n.backgroundColor),i},getPointBorderColor:function(t,e){var i=this.chart.options.elements.point.borderColor,n=this.getDataset(),o=t.custom||{};return o.borderColor?i=o.borderColor:n.pointBorderColor?i=a.getValueAtIndexOrDefault(n.pointBorderColor,e,i):n.borderColor&&(i=n.borderColor),i},getPointBorderWidth:function(t,e){var i=this.chart.options.elements.point.borderWidth,n=this.getDataset(),o=t.custom||{};return o.borderWidth?i=o.borderWidth:n.pointBorderWidth?i=a.getValueAtIndexOrDefault(n.pointBorderWidth,e,i):n.borderWidth&&(i=n.borderWidth),i},updateElement:function(t,e,i){var n,o,r=this,l=r.getMeta(),s=t.custom||{},d=r.getDataset(),u=r.index,c=d.data[e],h=r.getScaleForId(l.yAxisID),f=r.getScaleForId(l.xAxisID),g=r.chart.options.elements.point;void 0!==d.radius&&void 0===d.pointRadius&&(d.pointRadius=d.radius),void 0!==d.hitRadius&&void 0===d.pointHitRadius&&(d.pointHitRadius=d.hitRadius),n=f.getPixelForValue("object"==typeof c?c:NaN,e,u,r.chart.isCombo),o=i?h.getBasePixel():r.calculatePointY(c,e,u),t._xScale=f,t._yScale=h,t._datasetIndex=u,t._index=e,t._model={x:n,y:o,skip:s.skip||isNaN(n)||isNaN(o),radius:s.radius||a.getValueAtIndexOrDefault(d.pointRadius,e,g.radius),pointStyle:s.pointStyle||a.getValueAtIndexOrDefault(d.pointStyle,e,g.pointStyle),backgroundColor:r.getPointBackgroundColor(t,e),borderColor:r.getPointBorderColor(t,e),borderWidth:r.getPointBorderWidth(t,e),tension:l.dataset._model?l.dataset._model.tension:0,steppedLine:l.dataset._model?l.dataset._model.steppedLine:!1,hitRadius:s.hitRadius||a.getValueAtIndexOrDefault(d.pointHitRadius,e,g.hitRadius)}},calculatePointY:function(t,e,a){var i,n,o,r=this,l=r.chart,s=r.getMeta(),d=r.getScaleForId(s.yAxisID),u=0,c=0;if(d.options.stacked){for(i=0;a>i;i++)if(n=l.data.datasets[i],o=l.getDatasetMeta(i),"line"===o.type&&o.yAxisID===d.id&&l.isDatasetVisible(i)){var h=Number(d.getRightValue(n.data[e]));0>h?c+=h||0:u+=h||0}var f=Number(d.getRightValue(t));return 0>f?d.getPixelForValue(c+f):d.getPixelForValue(u+f)}return d.getPixelForValue(t)},updateBezierControlPoints:function(){function t(t,e,a){return c?Math.max(Math.min(t,a),e):t}var e,i,n,o,r,l=this,s=l.getMeta(),d=l.chart.chartArea,u=(s.data||[]).filter(function(t){return!t._model.skip}),c=l.chart.options.elements.line.capBezierPoints;for(e=0,i=u.length;i>e;++e)n=u[e],o=n._model,r=a.splineCurve(a.previousItem(u,e)._model,o,a.nextItem(u,e)._model,s.dataset._model.tension),o.controlPointPreviousX=t(r.previous.x,d.left,d.right),o.controlPointPreviousY=t(r.previous.y,d.top,d.bottom),o.controlPointNextX=t(r.next.x,d.left,d.right),o.controlPointNextY=t(r.next.y,d.top,d.bottom)},draw:function(t){var a,i,n=this,o=n.getMeta(),r=o.data||[],l=t||1;for(a=0,i=r.length;i>a;++a)r[a].transition(l);for(e(n.getDataset(),n.chart.options)&&o.dataset.transition(l).draw(),a=0,i=r.length;i>a;++a)r[a].draw()},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=t._model;o.radius=n.hoverRadius||a.getValueAtIndexOrDefault(e.pointHoverRadius,i,this.chart.options.elements.point.hoverRadius),o.backgroundColor=n.hoverBackgroundColor||a.getValueAtIndexOrDefault(e.pointHoverBackgroundColor,i,a.getHoverColor(o.backgroundColor)),o.borderColor=n.hoverBorderColor||a.getValueAtIndexOrDefault(e.pointHoverBorderColor,i,a.getHoverColor(o.borderColor)),o.borderWidth=n.hoverBorderWidth||a.getValueAtIndexOrDefault(e.pointHoverBorderWidth,i,o.borderWidth)},removeHoverStyle:function(t){var e=this,i=e.chart.data.datasets[t._datasetIndex],n=t._index,o=t.custom||{},r=t._model;void 0!==i.radius&&void 0===i.pointRadius&&(i.pointRadius=i.radius),r.radius=o.radius||a.getValueAtIndexOrDefault(i.pointRadius,n,e.chart.options.elements.point.radius),r.backgroundColor=e.getPointBackgroundColor(t,n),r.borderColor=e.getPointBorderColor(t,n),r.borderWidth=e.getPointBorderWidth(t,n)}})}},{}],19:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.polarArea={scale:{type:"radialLinear",lineArc:!0,ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,aspectRatio:1,legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var a=t.data,i=a.datasets,n=a.labels;if(i.length)for(var o=0;o<i[0].data.length;++o)e.push('<li><span style="background-color:'+i[0].backgroundColor[o]+'">'),n[o]&&e.push(n[o]),e.push("</span></li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var a=t.data;return a.labels.length&&a.datasets.length?a.labels.map(function(i,n){var o=t.getDatasetMeta(0),r=a.datasets[0],l=o.data[n],s=l.custom||{},d=e.getValueAtIndexOrDefault,u=t.options.elements.arc,c=s.backgroundColor?s.backgroundColor:d(r.backgroundColor,n,u.backgroundColor),h=s.borderColor?s.borderColor:d(r.borderColor,n,u.borderColor),f=s.borderWidth?s.borderWidth:d(r.borderWidth,n,u.borderWidth);return{text:i,fillStyle:c,strokeStyle:h,lineWidth:f,hidden:isNaN(r.data[n])||o.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var a,i,n,o=e.index,r=this.chart;for(a=0,i=(r.data.datasets||[]).length;i>a;++a)n=r.getDatasetMeta(a),n.data[o].hidden=!n.data[o].hidden;r.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}},t.controllers.polarArea=t.DatasetController.extend({dataElementType:t.elements.Arc,linkScales:e.noop,update:function(t){var a=this,i=a.chart,n=i.chartArea,o=a.getMeta(),r=i.options,l=r.elements.arc,s=Math.min(n.right-n.left,n.bottom-n.top);i.outerRadius=Math.max((s-l.borderWidth/2)/2,0),i.innerRadius=Math.max(r.cutoutPercentage?i.outerRadius/100*r.cutoutPercentage:1,0),i.radiusLength=(i.outerRadius-i.innerRadius)/i.getVisibleDatasetCount(),a.outerRadius=i.outerRadius-i.radiusLength*a.index,a.innerRadius=a.outerRadius-i.radiusLength,o.count=a.countVisibleElements(),e.each(o.data,function(e,i){a.updateElement(e,i,t)})},updateElement:function(t,a,i){for(var n=this,o=n.chart,r=n.getDataset(),l=o.options,s=l.animation,d=o.scale,u=e.getValueAtIndexOrDefault,c=o.data.labels,h=n.calculateCircumference(r.data[a]),f=d.xCenter,g=d.yCenter,p=0,m=n.getMeta(),b=0;a>b;++b)isNaN(r.data[b])||m.data[b].hidden||++p;var v=l.startAngle,x=t.hidden?0:d.getDistanceFromCenterForValue(r.data[a]),y=v+h*p,k=y+(t.hidden?0:h),S=s.animateScale?0:d.getDistanceFromCenterForValue(r.data[a]);e.extend(t,{_datasetIndex:n.index,_index:a,_scale:d,_model:{x:f,y:g,innerRadius:0,outerRadius:i?S:x,startAngle:i&&s.animateRotate?v:y,endAngle:i&&s.animateRotate?v:k,label:u(c,a,c[a])}}),n.removeHoverStyle(t),t.pivot()},removeHoverStyle:function(e){t.DatasetController.prototype.removeHoverStyle.call(this,e,this.chart.options.elements.arc)},countVisibleElements:function(){var t=this.getDataset(),a=this.getMeta(),i=0;return e.each(a.data,function(e,a){isNaN(t.data[a])||e.hidden||i++}),i},calculateCircumference:function(t){var e=this.getMeta().count;return e>0&&!isNaN(t)?2*Math.PI/e:0}})}},{}],20:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.radar={scale:{type:"radialLinear"},elements:{line:{tension:0}}},t.controllers.radar=t.DatasetController.extend({datasetElementType:t.elements.Line,dataElementType:t.elements.Point,linkScales:e.noop,addElementAndReset:function(e){t.DatasetController.prototype.addElementAndReset.call(this,e),this.updateBezierControlPoints()},update:function(t){var a=this,i=a.getMeta(),n=i.dataset,o=i.data,r=n.custom||{},l=a.getDataset(),s=a.chart.options.elements.line,d=a.chart.scale;void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),e.extend(i.dataset,{_datasetIndex:a.index,_children:o,_loop:!0,_model:{tension:r.tension?r.tension:e.getValueOrDefault(l.lineTension,s.tension),backgroundColor:r.backgroundColor?r.backgroundColor:l.backgroundColor||s.backgroundColor,borderWidth:r.borderWidth?r.borderWidth:l.borderWidth||s.borderWidth,borderColor:r.borderColor?r.borderColor:l.borderColor||s.borderColor,fill:r.fill?r.fill:void 0!==l.fill?l.fill:s.fill,borderCapStyle:r.borderCapStyle?r.borderCapStyle:l.borderCapStyle||s.borderCapStyle,borderDash:r.borderDash?r.borderDash:l.borderDash||s.borderDash,borderDashOffset:r.borderDashOffset?r.borderDashOffset:l.borderDashOffset||s.borderDashOffset,borderJoinStyle:r.borderJoinStyle?r.borderJoinStyle:l.borderJoinStyle||s.borderJoinStyle,scaleTop:d.top,scaleBottom:d.bottom,scaleZero:d.getBasePosition()}}),i.dataset.pivot(),e.each(o,function(e,i){a.updateElement(e,i,t)},a),a.updateBezierControlPoints()},updateElement:function(t,a,i){var n=this,o=t.custom||{},r=n.getDataset(),l=n.chart.scale,s=n.chart.options.elements.point,d=l.getPointPositionForValue(a,r.data[a]);e.extend(t,{_datasetIndex:n.index,_index:a,_scale:l,_model:{x:i?l.xCenter:d.x,y:i?l.yCenter:d.y,tension:o.tension?o.tension:e.getValueOrDefault(r.tension,n.chart.options.elements.line.tension),radius:o.radius?o.radius:e.getValueAtIndexOrDefault(r.pointRadius,a,s.radius),backgroundColor:o.backgroundColor?o.backgroundColor:e.getValueAtIndexOrDefault(r.pointBackgroundColor,a,s.backgroundColor),borderColor:o.borderColor?o.borderColor:e.getValueAtIndexOrDefault(r.pointBorderColor,a,s.borderColor),borderWidth:o.borderWidth?o.borderWidth:e.getValueAtIndexOrDefault(r.pointBorderWidth,a,s.borderWidth),pointStyle:o.pointStyle?o.pointStyle:e.getValueAtIndexOrDefault(r.pointStyle,a,s.pointStyle),hitRadius:o.hitRadius?o.hitRadius:e.getValueAtIndexOrDefault(r.hitRadius,a,s.hitRadius)}}),t._model.skip=o.skip?o.skip:isNaN(t._model.x)||isNaN(t._model.y)},updateBezierControlPoints:function(){var t=this.chart.chartArea,a=this.getMeta();e.each(a.data,function(i,n){var o=i._model,r=e.splineCurve(e.previousItem(a.data,n,!0)._model,o,e.nextItem(a.data,n,!0)._model,o.tension);o.controlPointPreviousX=Math.max(Math.min(r.previous.x,t.right),t.left),o.controlPointPreviousY=Math.max(Math.min(r.previous.y,t.bottom),t.top),o.controlPointNextX=Math.max(Math.min(r.next.x,t.right),t.left),o.controlPointNextY=Math.max(Math.min(r.next.y,t.bottom),t.top),i.pivot()})},draw:function(t){var a=this.getMeta(),i=t||1;e.each(a.data,function(t){t.transition(i)}),a.dataset.transition(i).draw(),e.each(a.data,function(t){t.draw()})},setHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t.custom||{},n=t._index,o=t._model;o.radius=i.hoverRadius?i.hoverRadius:e.getValueAtIndexOrDefault(a.pointHoverRadius,n,this.chart.options.elements.point.hoverRadius),o.backgroundColor=i.hoverBackgroundColor?i.hoverBackgroundColor:e.getValueAtIndexOrDefault(a.pointHoverBackgroundColor,n,e.getHoverColor(o.backgroundColor)),o.borderColor=i.hoverBorderColor?i.hoverBorderColor:e.getValueAtIndexOrDefault(a.pointHoverBorderColor,n,e.getHoverColor(o.borderColor)),o.borderWidth=i.hoverBorderWidth?i.hoverBorderWidth:e.getValueAtIndexOrDefault(a.pointHoverBorderWidth,n,o.borderWidth)},removeHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t.custom||{},n=t._index,o=t._model,r=this.chart.options.elements.point;o.radius=i.radius?i.radius:e.getValueAtIndexOrDefault(a.radius,n,r.radius),o.backgroundColor=i.backgroundColor?i.backgroundColor:e.getValueAtIndexOrDefault(a.pointBackgroundColor,n,r.backgroundColor),o.borderColor=i.borderColor?i.borderColor:e.getValueAtIndexOrDefault(a.pointBorderColor,n,r.borderColor),o.borderWidth=i.borderWidth?i.borderWidth:e.getValueAtIndexOrDefault(a.pointBorderWidth,n,r.borderWidth)}})}},{}],21:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.global.animation={duration:1e3,easing:"easeOutQuart",onProgress:e.noop,onComplete:e.noop},t.Animation=t.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),t.animationService={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(t,e,a,i){var n=this;i||(t.animating=!0);for(var o=0;o<n.animations.length;++o)if(n.animations[o].chartInstance===t)return void(n.animations[o].animationObject=e);n.animations.push({chartInstance:t,animationObject:e}),1===n.animations.length&&n.requestAnimationFrame()},cancelAnimation:function(t){var a=e.findIndex(this.animations,function(e){return e.chartInstance===t});-1!==a&&(this.animations.splice(a,1),t.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=e.requestAnimFrame.call(window,function(){t.request=null,t.startDigest()}))},startDigest:function(){var t=this,e=Date.now(),a=0;t.dropFrames>1&&(a=Math.floor(t.dropFrames),t.dropFrames=t.dropFrames%1);for(var i=0;i<t.animations.length;)null===t.animations[i].animationObject.currentStep&&(t.animations[i].animationObject.currentStep=0),t.animations[i].animationObject.currentStep+=1+a,t.animations[i].animationObject.currentStep>t.animations[i].animationObject.numSteps&&(t.animations[i].animationObject.currentStep=t.animations[i].animationObject.numSteps),t.animations[i].animationObject.render(t.animations[i].chartInstance,t.animations[i].animationObject),t.animations[i].animationObject.onAnimationProgress&&t.animations[i].animationObject.onAnimationProgress.call&&t.animations[i].animationObject.onAnimationProgress.call(t.animations[i].chartInstance,t.animations[i]),t.animations[i].animationObject.currentStep===t.animations[i].animationObject.numSteps?(t.animations[i].animationObject.onAnimationComplete&&t.animations[i].animationObject.onAnimationComplete.call&&t.animations[i].animationObject.onAnimationComplete.call(t.animations[i].chartInstance,t.animations[i]),t.animations[i].chartInstance.animating=!1,t.animations.splice(i,1)):++i;var n=Date.now(),o=(n-e)/t.frameDuration;t.dropFrames+=o,t.animations.length>0&&t.requestAnimationFrame()}}}},{}],22:[function(t,e,a){"use strict";e.exports=function(t){var e=t.canvasHelpers={};e.drawPoint=function(t,e,a,i,n){var o,r,l,s,d,u;if("object"==typeof e&&(o=e.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return void t.drawImage(e,i-e.width/2,n-e.height/2);if(!(isNaN(a)||0>=a)){switch(e){default:t.beginPath(),t.arc(i,n,a,0,2*Math.PI),t.closePath(),t.fill();break;case"triangle":t.beginPath(),r=3*a/Math.sqrt(3),d=r*Math.sqrt(3)/2,t.moveTo(i-r/2,n+d/3),t.lineTo(i+r/2,n+d/3),t.lineTo(i,n-2*d/3),t.closePath(),t.fill();break;case"rect":u=1/Math.SQRT2*a,t.beginPath(),t.fillRect(i-u,n-u,2*u,2*u),t.strokeRect(i-u,n-u,2*u,2*u);break;case"rectRot":u=1/Math.SQRT2*a,t.beginPath(),t.moveTo(i-u,n),t.lineTo(i,n+u),t.lineTo(i+u,n),t.lineTo(i,n-u),t.closePath(),t.fill();break;case"cross":t.beginPath(),t.moveTo(i,n+a),t.lineTo(i,n-a),t.moveTo(i-a,n),t.lineTo(i+a,n),t.closePath();break;case"crossRot":t.beginPath(),l=Math.cos(Math.PI/4)*a,s=Math.sin(Math.PI/4)*a,t.moveTo(i-l,n-s),t.lineTo(i+l,n+s),t.moveTo(i-l,n+s),t.lineTo(i+l,n-s),t.closePath();break;case"star":t.beginPath(),t.moveTo(i,n+a),t.lineTo(i,n-a),t.moveTo(i-a,n),t.lineTo(i+a,n),l=Math.cos(Math.PI/4)*a,s=Math.sin(Math.PI/4)*a,t.moveTo(i-l,n-s),t.lineTo(i+l,n+s),t.moveTo(i-l,n+s),t.lineTo(i+l,n-s),t.closePath();break;case"line":t.beginPath(),t.moveTo(i-a,n),t.lineTo(i+a,n),t.closePath();break;case"dash":t.beginPath(),t.moveTo(i,n),t.lineTo(i+a,n),t.closePath()}t.stroke()}}}},{}],23:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.types={},t.instances={},t.controllers={},t.Controller=function(a){return this.chart=a,this.config=a.config,this.options=this.config.options=e.configMerge(t.defaults.global,t.defaults[this.config.type],this.config.options||{}),this.id=e.uid(),Object.defineProperty(this,"data",{get:function(){return this.config.data}}),t.instances[this.id]=this,this.options.responsive&&this.resize(!0),this.initialize(),this},e.extend(t.Controller.prototype,{initialize:function(){var e=this;return t.plugins.notify("beforeInit",[e]),e.bindEvents(),e.ensureScalesHaveIDs(),e.buildOrUpdateControllers(),e.buildScales(),e.updateLayout(),e.resetElements(),e.initToolTip(),e.update(),t.plugins.notify("afterInit",[e]),e},clear:function(){return e.clear(this.chart),this},stop:function(){return t.animationService.cancelAnimation(this),this},resize:function(a){var i=this,n=i.chart,o=n.canvas,r=e.getMaximumWidth(o),l=n.aspectRatio,s=i.options.maintainAspectRatio&&isNaN(l)===!1&&isFinite(l)&&0!==l?r/l:e.getMaximumHeight(o),d=n.width!==r||n.height!==s;if(!d)return i;o.width=n.width=r,o.height=n.height=s,e.retinaScale(n);var u={width:r,height:s};return t.plugins.notify("resize",[i,u]),i.options.onResize&&i.options.onResize(i,u),a||(i.stop(),i.update(i.options.responsiveAnimationDuration)),i},ensureScalesHaveIDs:function(){var t=this.options,a=t.scales||{},i=t.scale;e.each(a.xAxes,function(t,e){t.id=t.id||"x-axis-"+e}),e.each(a.yAxes,function(t,e){t.id=t.id||"y-axis-"+e}),i&&(i.id=i.id||"scale")},buildScales:function(){var a=this,i=a.options,n=a.scales={},o=[];i.scales&&(o=o.concat((i.scales.xAxes||[]).map(function(t){return{options:t,dtype:"category"}}),(i.scales.yAxes||[]).map(function(t){return{options:t,dtype:"linear"}}))),i.scale&&o.push({options:i.scale,dtype:"radialLinear",isDefault:!0}),e.each(o,function(i){var o=i.options,r=e.getValueOrDefault(o.type,i.dtype),l=t.scaleService.getScaleConstructor(r);if(l){var s=new l({id:o.id,options:o,ctx:a.chart.ctx,chart:a});n[s.id]=s,i.isDefault&&(a.scale=s)}}),t.scaleService.addScalesToLayout(this)},updateLayout:function(){t.layoutService.update(this,this.chart.width,this.chart.height)},buildOrUpdateControllers:function(){var a=this,i=[],n=[];if(e.each(a.data.datasets,function(e,o){var r=a.getDatasetMeta(o);r.type||(r.type=e.type||a.config.type),i.push(r.type),r.controller?r.controller.updateIndex(o):(r.controller=new t.controllers[r.type](a,o),n.push(r.controller))},a),i.length>1)for(var o=1;o<i.length;o++)if(i[o]!==i[o-1]){a.isCombo=!0;break}return n},resetElements:function(){var t=this;e.each(t.data.datasets,function(e,a){t.getDatasetMeta(a).controller.reset()},t)},update:function(a,i){var n=this;t.plugins.notify("beforeUpdate",[n]),n.tooltip._data=n.data;var o=n.buildOrUpdateControllers();e.each(n.data.datasets,function(t,e){n.getDatasetMeta(e).controller.buildOrUpdateElements()},n),t.layoutService.update(n,n.chart.width,n.chart.height),t.plugins.notify("afterScaleUpdate",[n]),e.each(o,function(t){t.reset()}),n.updateDatasets(),t.plugins.notify("afterUpdate",[n]),n.render(a,i)},updateDatasets:function(){var e,a,i=this;if(t.plugins.notify("beforeDatasetsUpdate",[i])){for(e=0,a=i.data.datasets.length;a>e;++e)i.getDatasetMeta(e).controller.update();t.plugins.notify("afterDatasetsUpdate",[i])}},render:function(a,i){var n=this;t.plugins.notify("beforeRender",[n]);var o=n.options.animation;if(o&&("undefined"!=typeof a&&0!==a||"undefined"==typeof a&&0!==o.duration)){var r=new t.Animation;r.numSteps=(a||o.duration)/16.66,r.easing=o.easing,r.render=function(t,a){var i=e.easingEffects[a.easing],n=a.currentStep/a.numSteps,o=i(n);t.draw(o,n,a.currentStep)},r.onAnimationProgress=o.onProgress,r.onAnimationComplete=o.onComplete,t.animationService.addAnimation(n,r,a,i)}else n.draw(),o&&o.onComplete&&o.onComplete.call&&o.onComplete.call(n);return n},draw:function(a){var i=this,n=a||1;i.clear(),t.plugins.notify("beforeDraw",[i,n]),e.each(i.boxes,function(t){t.draw(i.chartArea)},i),i.scale&&i.scale.draw(),t.plugins.notify("beforeDatasetsDraw",[i,n]),e.each(i.data.datasets,function(t,e){i.isDatasetVisible(e)&&i.getDatasetMeta(e).controller.draw(a)},i,!0),t.plugins.notify("afterDatasetsDraw",[i,n]),i.tooltip.transition(n).draw(),t.plugins.notify("afterDraw",[i,n])},getElementAtEvent:function(t){var a=this,i=e.getRelativePosition(t,a.chart),n=[];return e.each(a.data.datasets,function(t,o){if(a.isDatasetVisible(o)){var r=a.getDatasetMeta(o);e.each(r.data,function(t){return t.inRange(i.x,i.y)?(n.push(t),n):void 0})}}),n.slice(0,1)},getElementsAtEvent:function(t){var a=this,i=e.getRelativePosition(t,a.chart),n=[],o=function(){if(a.data.datasets)for(var t=0;t<a.data.datasets.length;t++){var e=a.getDatasetMeta(t);if(a.isDatasetVisible(t))for(var n=0;n<e.data.length;n++)if(e.data[n].inRange(i.x,i.y))return e.data[n]}}.call(a);return o?(e.each(a.data.datasets,function(t,e){if(a.isDatasetVisible(e)){var i=a.getDatasetMeta(e),r=i.data[o._index];r&&!r._view.skip&&n.push(r)}},a),n):n},getElementsAtXAxis:function(t){var a=this,i=e.getRelativePosition(t,a.chart),n=[],o=function(){if(a.data.datasets)for(var t=0;t<a.data.datasets.length;t++){var e=a.getDatasetMeta(t);if(a.isDatasetVisible(t))for(var n=0;n<e.data.length;n++)if(e.data[n].inLabelRange(i.x,i.y))return e.data[n]}}.call(a);return o?(e.each(a.data.datasets,function(t,i){if(a.isDatasetVisible(i)){var r=a.getDatasetMeta(i),l=e.findIndex(r.data,function(t){return o._model.x===t._model.x});-1===l||r.data[l]._view.skip||n.push(r.data[l])}},a),n):n},getElementsAtEventForMode:function(t,e){var a=this;switch(e){case"single":return a.getElementAtEvent(t);case"label":return a.getElementsAtEvent(t);case"dataset":return a.getDatasetAtEvent(t);case"x-axis":return a.getElementsAtXAxis(t);default:return t}},getDatasetAtEvent:function(t){var e=this.getElementAtEvent(t);return e.length>0&&(e=this.getDatasetMeta(e[0]._datasetIndex).data),e},getDatasetMeta:function(t){var e=this,a=e.data.datasets[t];a._meta||(a._meta={});var i=a._meta[e.id];return i||(i=a._meta[e.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,a=this.data.datasets.length;a>e;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden;
},generateLegend:function(){return this.options.legendCallback(this)},destroy:function(){var a=this;a.stop(),a.clear(),e.unbindEvents(a,a.events),e.removeResizeListener(a.chart.canvas.parentNode);var i=a.chart.canvas;i.width=a.chart.width,i.height=a.chart.height,void 0!==a.chart.originalDevicePixelRatio&&a.chart.ctx.scale(1/a.chart.originalDevicePixelRatio,1/a.chart.originalDevicePixelRatio),i.style.width=a.chart.originalCanvasStyleWidth,i.style.height=a.chart.originalCanvasStyleHeight,t.plugins.notify("destroy",[a]),delete t.instances[a.id]},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)},initToolTip:function(){var e=this;e.tooltip=new t.Tooltip({_chart:e.chart,_chartInstance:e,_data:e.data,_options:e.options.tooltips},e)},bindEvents:function(){var t=this;e.bindEvents(t,t.options.events,function(e){t.eventHandler(e)})},updateHoverStyle:function(t,e,a){var i,n,o,r=a?"setHoverStyle":"removeHoverStyle";switch(e){case"single":t=[t[0]];break;case"label":case"dataset":case"x-axis":break;default:return}for(n=0,o=t.length;o>n;++n)i=t[n],i&&this.getDatasetMeta(i._datasetIndex).controller[r](i)},eventHandler:function(t){var a=this,i=a.tooltip,n=a.options||{},o=n.hover,r=n.tooltips;return a.lastActive=a.lastActive||[],a.lastTooltipActive=a.lastTooltipActive||[],"mouseout"===t.type?(a.active=[],a.tooltipActive=[]):(a.active=a.getElementsAtEventForMode(t,o.mode),a.tooltipActive=a.getElementsAtEventForMode(t,r.mode)),o.onHover&&o.onHover.call(a,a.active),("mouseup"===t.type||"click"===t.type)&&(n.onClick&&n.onClick.call(a,t,a.active),a.legend&&a.legend.handleEvent&&a.legend.handleEvent(t)),a.lastActive.length&&a.updateHoverStyle(a.lastActive,o.mode,!1),a.active.length&&o.mode&&a.updateHoverStyle(a.active,o.mode,!0),(r.enabled||r.custom)&&(i.initialize(),i._active=a.tooltipActive,i.update(!0)),i.pivot(),a.animating||e.arrayEquals(a.active,a.lastActive)&&e.arrayEquals(a.tooltipActive,a.lastTooltipActive)||(a.stop(),(r.enabled||r.custom)&&i.update(!0),a.render(o.animationDuration,!0)),a.lastActive=a.active,a.lastTooltipActive=a.tooltipActive,a}})}},{}],24:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=e.noop;t.DatasetController=function(t,e){this.initialize.call(this,t,e)},e.extend(t.DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(t,e){var a=this;a.chart=t,a.index=e,a.linkScales(),a.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){var t=this,e=t.getMeta(),a=t.getDataset();null===e.xAxisID&&(e.xAxisID=a.xAxisID||t.chart.options.scales.xAxes[0].id),null===e.yAxisID&&(e.yAxisID=a.yAxisID||t.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},reset:function(){this.update(!0)},createMetaDataset:function(){var t=this,e=t.datasetElementType;return e&&new e({_chart:t.chart.chart,_datasetIndex:t.index})},createMetaData:function(t){var e=this,a=e.dataElementType;return a&&new a({_chart:e.chart.chart,_datasetIndex:e.index,_index:t})},addElements:function(){var t,e,a=this,i=a.getMeta(),n=a.getDataset().data||[],o=i.data;for(t=0,e=n.length;e>t;++t)o[t]=o[t]||a.createMetaData(i,t);i.dataset=i.dataset||a.createMetaDataset()},addElementAndReset:function(t){var e=this,a=e.createMetaData(t);e.getMeta().data.splice(t,0,a),e.updateElement(a,t,!0)},buildOrUpdateElements:function(){var t=this.getMeta(),e=t.data,a=this.getDataset().data.length,i=e.length;if(i>a)e.splice(a,i-a);else if(a>i)for(var n=i;a>n;++n)this.addElementAndReset(n)},update:a,draw:function(t){var a=t||1;e.each(this.getMeta().data,function(t){t.transition(a).draw()})},removeHoverStyle:function(t,a){var i=this.chart.data.datasets[t._datasetIndex],n=t._index,o=t.custom||{},r=e.getValueAtIndexOrDefault,l=t._model;l.backgroundColor=o.backgroundColor?o.backgroundColor:r(i.backgroundColor,n,a.backgroundColor),l.borderColor=o.borderColor?o.borderColor:r(i.borderColor,n,a.borderColor),l.borderWidth=o.borderWidth?o.borderWidth:r(i.borderWidth,n,a.borderWidth)},setHoverStyle:function(t){var a=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=e.getValueAtIndexOrDefault,r=e.getHoverColor,l=t._model;l.backgroundColor=n.hoverBackgroundColor?n.hoverBackgroundColor:o(a.hoverBackgroundColor,i,r(l.backgroundColor)),l.borderColor=n.hoverBorderColor?n.hoverBorderColor:o(a.hoverBorderColor,i,r(l.borderColor)),l.borderWidth=n.hoverBorderWidth?n.hoverBorderWidth:o(a.hoverBorderWidth,i,l.borderWidth)}}),t.DatasetController.extend=e.inherits}},{}],25:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.elements={},t.Element=function(t){e.extend(this,t),this.initialize.apply(this,arguments)},e.extend(t.Element.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=e.clone(t._model)),t._start=e.clone(t._view),t},transition:function(t){var a=this;return a._view||(a._view=e.clone(a._model)),1===t?(a._view=a._model,a._start=null,a):(a._start||a.pivot(),e.each(a._model,function(i,n){if("_"===n[0]);else if(a._view.hasOwnProperty(n))if(i===a._view[n]);else if("string"==typeof i)try{var o=e.color(a._model[n]).mix(e.color(a._start[n]),t);a._view[n]=o.rgbString()}catch(r){a._view[n]=i}else if("number"==typeof i){var l=void 0!==a._start[n]&&isNaN(a._start[n])===!1?a._start[n]:0;a._view[n]=(a._model[n]-l)*t+l}else a._view[n]=i;else"number"!=typeof i||isNaN(a._view[n])?a._view[n]=i:a._view[n]=i*t},a),a)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return e.isNumber(this._model.x)&&e.isNumber(this._model.y)}}),t.Element.extend=e.inherits}},{}],26:[function(t,e,a){"use strict";var i=t(3);e.exports=function(t){function e(t,e,a){var i;return"string"==typeof t?(i=parseInt(t,10),-1!=t.indexOf("%")&&(i=i/100*e.parentNode[a])):i=t,i}function a(t){return void 0!==t&&null!==t&&"none"!==t}function n(t,i,n){var o=document.defaultView,r=t.parentNode,l=o.getComputedStyle(t)[i],s=o.getComputedStyle(r)[i],d=a(l),u=a(s),c=Number.POSITIVE_INFINITY;return d||u?Math.min(d?e(l,t,n):c,u?e(s,r,n):c):"none"}var o=t.helpers={};o.each=function(t,e,a,i){var n,r;if(o.isArray(t))if(r=t.length,i)for(n=r-1;n>=0;n--)e.call(a,t[n],n);else for(n=0;r>n;n++)e.call(a,t[n],n);else if("object"==typeof t){var l=Object.keys(t);for(r=l.length,n=0;r>n;n++)e.call(a,t[l[n]],l[n])}},o.clone=function(t){var e={};return o.each(t,function(t,a){o.isArray(t)?e[a]=t.slice(0):"object"==typeof t&&null!==t?e[a]=o.clone(t):e[a]=t}),e},o.extend=function(t){for(var e=function(e,a){t[a]=e},a=1,i=arguments.length;i>a;a++)o.each(arguments[a],e);return t},o.configMerge=function(e){var a=o.clone(e);return o.each(Array.prototype.slice.call(arguments,1),function(e){o.each(e,function(e,i){if("scales"===i)a[i]=o.scaleMerge(a.hasOwnProperty(i)?a[i]:{},e);else if("scale"===i)a[i]=o.configMerge(a.hasOwnProperty(i)?a[i]:{},t.scaleService.getScaleDefaults(e.type),e);else if(a.hasOwnProperty(i)&&o.isArray(a[i])&&o.isArray(e)){var n=a[i];o.each(e,function(t,e){e<n.length?"object"==typeof n[e]&&null!==n[e]&&"object"==typeof t&&null!==t?n[e]=o.configMerge(n[e],t):n[e]=t:n.push(t)})}else a.hasOwnProperty(i)&&"object"==typeof a[i]&&null!==a[i]&&"object"==typeof e?a[i]=o.configMerge(a[i],e):a[i]=e})}),a},o.scaleMerge=function(e,a){var i=o.clone(e);return o.each(a,function(e,a){"xAxes"===a||"yAxes"===a?i.hasOwnProperty(a)?o.each(e,function(e,n){var r=o.getValueOrDefault(e.type,"xAxes"===a?"category":"linear"),l=t.scaleService.getScaleDefaults(r);n>=i[a].length||!i[a][n].type?i[a].push(o.configMerge(l,e)):e.type&&e.type!==i[a][n].type?i[a][n]=o.configMerge(i[a][n],l,e):i[a][n]=o.configMerge(i[a][n],e)}):(i[a]=[],o.each(e,function(e){var n=o.getValueOrDefault(e.type,"xAxes"===a?"category":"linear");i[a].push(o.configMerge(t.scaleService.getScaleDefaults(n),e))})):i.hasOwnProperty(a)&&"object"==typeof i[a]&&null!==i[a]&&"object"==typeof e?i[a]=o.configMerge(i[a],e):i[a]=e}),i},o.getValueAtIndexOrDefault=function(t,e,a){return void 0===t||null===t?a:o.isArray(t)?e<t.length?t[e]:a:t},o.getValueOrDefault=function(t,e){return void 0===t?e:t},o.indexOf=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var a=0,i=t.length;i>a;++a)if(t[a]===e)return a;return-1},o.where=function(t,e){if(o.isArray(t)&&Array.prototype.filter)return t.filter(e);var a=[];return o.each(t,function(t){e(t)&&a.push(t)}),a},o.findIndex=Array.prototype.findIndex?function(t,e,a){return t.findIndex(e,a)}:function(t,e,a){a=void 0===a?t:a;for(var i=0,n=t.length;n>i;++i)if(e.call(a,t[i],i,t))return i;return-1},o.findNextWhere=function(t,e,a){(void 0===a||null===a)&&(a=-1);for(var i=a+1;i<t.length;i++){var n=t[i];if(e(n))return n}},o.findPreviousWhere=function(t,e,a){(void 0===a||null===a)&&(a=t.length);for(var i=a-1;i>=0;i--){var n=t[i];if(e(n))return n}},o.inherits=function(t){var e=this,a=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i=function(){this.constructor=a};return i.prototype=e.prototype,a.prototype=new i,a.extend=o.inherits,t&&o.extend(a.prototype,t),a.__super__=e.prototype,a},o.noop=function(){},o.uid=function(){var t=0;return function(){return t++}}(),o.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},o.almostEquals=function(t,e,a){return Math.abs(t-e)<a},o.max=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.max(t,e)},Number.NEGATIVE_INFINITY)},o.min=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.min(t,e)},Number.POSITIVE_INFINITY)},o.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1},o.log10=Math.log10?function(t){return Math.log10(t)}:function(t){return Math.log(t)/Math.LN10},o.toRadians=function(t){return t*(Math.PI/180)},o.toDegrees=function(t){return t*(180/Math.PI)},o.getAngleFromPoint=function(t,e){var a=e.x-t.x,i=e.y-t.y,n=Math.sqrt(a*a+i*i),o=Math.atan2(i,a);return o<-.5*Math.PI&&(o+=2*Math.PI),{angle:o,distance:n}},o.aliasPixel=function(t){return t%2===0?0:.5},o.splineCurve=function(t,e,a,i){var n=t.skip?e:t,o=e,r=a.skip?e:a,l=Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2)),s=Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)),d=l/(l+s),u=s/(l+s);d=isNaN(d)?0:d,u=isNaN(u)?0:u;var c=i*d,h=i*u;return{previous:{x:o.x-c*(r.x-n.x),y:o.y-c*(r.y-n.y)},next:{x:o.x+h*(r.x-n.x),y:o.y+h*(r.y-n.y)}}},o.nextItem=function(t,e,a){return a?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},o.previousItem=function(t,e,a){return a?0>=e?t[t.length-1]:t[e-1]:0>=e?t[0]:t[e-1]},o.niceNum=function(t,e){var a,i=Math.floor(o.log10(t)),n=t/Math.pow(10,i);return a=e?1.5>n?1:3>n?2:7>n?5:10:1>=n?1:2>=n?2:5>=n?5:10,a*Math.pow(10,i)};var r=o.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-0.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-0.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-0.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-0.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,a=0,i=1;return 0===t?0:1===(t/=1)?1:(a||(a=.3),i<Math.abs(1)?(i=1,e=a/4):e=a/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/a)))},easeOutElastic:function(t){var e=1.70158,a=0,i=1;return 0===t?0:1===(t/=1)?1:(a||(a=.3),i<Math.abs(1)?(i=1,e=a/4):e=a/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin((1*t-e)*(2*Math.PI)/a)+1)},easeInOutElastic:function(t){var e=1.70158,a=0,i=1;return 0===t?0:2===(t/=.5)?1:(a||(a=1*(.3*1.5)),i<Math.abs(1)?(i=1,e=a/4):e=a/(2*Math.PI)*Math.asin(1/i),1>t?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/a)):i*Math.pow(2,-10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/a)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:function(t){return 1-r.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?1*(7.5625*t*t):2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*r.easeInBounce(2*t):.5*r.easeOutBounce(2*t-1)+.5}};o.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),o.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),o.getRelativePosition=function(t,e){var a,i,n=t.originalEvent||t,r=t.currentTarget||t.srcElement,l=r.getBoundingClientRect(),s=n.touches;s&&s.length>0?(a=s[0].clientX,i=s[0].clientY):(a=n.clientX,i=n.clientY);var d=parseFloat(o.getStyle(r,"padding-left")),u=parseFloat(o.getStyle(r,"padding-top")),c=parseFloat(o.getStyle(r,"padding-right")),h=parseFloat(o.getStyle(r,"padding-bottom")),f=l.right-l.left-d-c,g=l.bottom-l.top-u-h;return a=Math.round((a-l.left-d)/f*r.width/e.currentDevicePixelRatio),i=Math.round((i-l.top-u)/g*r.height/e.currentDevicePixelRatio),{x:a,y:i}},o.addEvent=function(t,e,a){t.addEventListener?t.addEventListener(e,a):t.attachEvent?t.attachEvent("on"+e,a):t["on"+e]=a},o.removeEvent=function(t,e,a){t.removeEventListener?t.removeEventListener(e,a,!1):t.detachEvent?t.detachEvent("on"+e,a):t["on"+e]=o.noop},o.bindEvents=function(t,e,a){var i=t.events=t.events||{};o.each(e,function(e){i[e]=function(){a.apply(t,arguments)},o.addEvent(t.chart.canvas,e,i[e])})},o.unbindEvents=function(t,e){var a=t.chart.canvas;o.each(e,function(t,e){o.removeEvent(a,e,t)})},o.getConstraintWidth=function(t){return n(t,"max-width","clientWidth")},o.getConstraintHeight=function(t){return n(t,"max-height","clientHeight")},o.getMaximumWidth=function(t){var e=t.parentNode,a=parseInt(o.getStyle(e,"padding-left"))+parseInt(o.getStyle(e,"padding-right")),i=e.clientWidth-a,n=o.getConstraintWidth(t);return isNaN(n)?i:Math.min(i,n)},o.getMaximumHeight=function(t){var e=t.parentNode,a=parseInt(o.getStyle(e,"padding-top"))+parseInt(o.getStyle(e,"padding-bottom")),i=e.clientHeight-a,n=o.getConstraintHeight(t);return isNaN(n)?i:Math.min(i,n)},o.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},o.retinaScale=function(t){var e=t.ctx,a=t.canvas,i=a.width,n=a.height,o=t.currentDevicePixelRatio=window.devicePixelRatio||1;1!==o&&(a.height=n*o,a.width=i*o,e.scale(o,o),t.originalDevicePixelRatio=t.originalDevicePixelRatio||o),a.style.width=i+"px",a.style.height=n+"px"},o.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},o.fontString=function(t,e,a){return e+" "+t+"px "+a},o.longestText=function(t,e,a,i){i=i||{};var n=i.data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(n=i.data={},r=i.garbageCollect=[],i.font=e),t.font=e;var l=0;o.each(a,function(e){void 0!==e&&null!==e&&o.isArray(e)!==!0?l=o.measureText(t,n,r,l,e):o.isArray(e)&&o.each(e,function(e){void 0===e||null===e||o.isArray(e)||(l=o.measureText(t,n,r,l,e))})});var s=r.length/2;if(s>a.length){for(var d=0;s>d;d++)delete n[r[d]];r.splice(0,s)}return l},o.measureText=function(t,e,a,i,n){var o=e[n];return o||(o=e[n]=t.measureText(n).width,a.push(n)),o>i&&(i=o),i},o.numberOfLabelLines=function(t){var e=1;return o.each(t,function(t){o.isArray(t)&&t.length>e&&(e=t.length)}),e},o.drawRoundedRectangle=function(t,e,a,i,n,o){t.beginPath(),t.moveTo(e+o,a),t.lineTo(e+i-o,a),t.quadraticCurveTo(e+i,a,e+i,a+o),t.lineTo(e+i,a+n-o),t.quadraticCurveTo(e+i,a+n,e+i-o,a+n),t.lineTo(e+o,a+n),t.quadraticCurveTo(e,a+n,e,a+n-o),t.lineTo(e,a+o),t.quadraticCurveTo(e,a,e+o,a),t.closePath()},o.color=function(e){return i?i(e instanceof CanvasGradient?t.defaults.global.defaultColor:e):(console.log("Color.js not found!"),e)},o.addResizeListener=function(t,e){var a=document.createElement("iframe"),i="chartjs-hidden-iframe";a.classlist?a.classlist.add(i):a.setAttribute("class",i);var n=a.style;n.width="100%",n.display="block",n.border=0,n.height=0,n.margin=0,n.position="absolute",n.left=0,n.right=0,n.top=0,n.bottom=0,t.insertBefore(a,t.firstChild),(a.contentWindow||a).onresize=function(){e&&e()}},o.removeResizeListener=function(t){var e=t.querySelector(".chartjs-hidden-iframe");e&&e.parentNode.removeChild(e)},o.isArray=Array.isArray?function(t){return Array.isArray(t)}:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o.arrayEquals=function(t,e){var a,i,n,r;if(!t||!e||t.length!=e.length)return!1;for(a=0,i=t.length;i>a;++a)if(n=t[a],r=e[a],n instanceof Array&&r instanceof Array){if(!o.arrayEquals(n,r))return!1}else if(n!=r)return!1;return!0},o.callCallback=function(t,e,a){t&&"function"==typeof t.call&&t.apply(a,e)},o.getHoverColor=function(t){return t instanceof CanvasPattern?t:o.color(t).saturate(.5).darken(.1).rgbString()}}},{3:3}],27:[function(t,e,a){"use strict";e.exports=function(){var t=function(e,a){var i=this,n=t.helpers;return i.config=a||{data:{datasets:[]}},e.length&&e[0].getContext&&(e=e[0]),e.getContext&&(e=e.getContext("2d")),i.ctx=e,i.canvas=e.canvas,e.canvas.style.display=e.canvas.style.display||"block",i.width=e.canvas.width||parseInt(n.getStyle(e.canvas,"width"),10)||n.getMaximumWidth(e.canvas),i.height=e.canvas.height||parseInt(n.getStyle(e.canvas,"height"),10)||n.getMaximumHeight(e.canvas),i.aspectRatio=i.width/i.height,(isNaN(i.aspectRatio)||isFinite(i.aspectRatio)===!1)&&(i.aspectRatio=void 0!==a.aspectRatio?a.aspectRatio:2),i.originalCanvasStyleWidth=e.canvas.style.width,i.originalCanvasStyleHeight=e.canvas.style.height,n.retinaScale(i),i.controller=new t.Controller(i),n.addResizeListener(e.canvas.parentNode,function(){i.controller&&i.controller.config.options.responsive&&i.controller.resize()}),i.controller?i.controller:i};return t.defaults={global:{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"single",animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:!0,elements:{},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');for(var a=0;a<t.data.datasets.length;a++)e.push('<li><span style="background-color:'+t.data.datasets[a].backgroundColor+'"></span>'),t.data.datasets[a].label&&e.push(t.data.datasets[a].label),e.push("</li>");return e.push("</ul>"),e.join("")}}},t.Chart=t,t}},{}],28:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.layoutService={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),t.boxes.push(e)},removeBox:function(t,e){t.boxes&&t.boxes.splice(t.boxes.indexOf(e),1)},update:function(t,a,i){function n(t){var e,a=t.isHorizontal();a?(e=t.update(t.options.fullWidth?p:k,y),S-=e.height):(e=t.update(x,v),k-=e.width),w.push({horizontal:a,minSize:e,box:t})}function o(t){var a=e.findNextWhere(w,function(e){return e.box===t});if(a)if(t.isHorizontal()){var i={left:C,right:M,top:0,bottom:0};t.update(t.options.fullWidth?p:k,m/2,i)}else t.update(a.minSize.width,S)}function r(t){var a=e.findNextWhere(w,function(e){return e.box===t}),i={left:0,right:0,top:D,bottom:A};a&&t.update(a.minSize.width,S,i)}function l(t){t.isHorizontal()?(t.left=t.options.fullWidth?s:C,t.right=t.options.fullWidth?a-s:C+k,t.top=P,t.bottom=P+t.height,P=t.bottom):(t.left=F,t.right=F+t.width,t.top=D,t.bottom=D+S,F=t.right)}if(t){var s=0,d=0,u=e.where(t.boxes,function(t){return"left"===t.options.position}),c=e.where(t.boxes,function(t){return"right"===t.options.position}),h=e.where(t.boxes,function(t){return"top"===t.options.position}),f=e.where(t.boxes,function(t){return"bottom"===t.options.position}),g=e.where(t.boxes,function(t){return"chartArea"===t.options.position});h.sort(function(t,e){return(e.options.fullWidth?1:0)-(t.options.fullWidth?1:0)}),f.sort(function(t,e){return(t.options.fullWidth?1:0)-(e.options.fullWidth?1:0)});var p=a-2*s,m=i-2*d,b=p/2,v=m/2,x=(a-b)/(u.length+c.length),y=(i-v)/(h.length+f.length),k=p,S=m,w=[];e.each(u.concat(c,h,f),n);var C=s,M=s,D=d,A=d;e.each(u.concat(c),o),e.each(u,function(t){C+=t.width}),e.each(c,function(t){M+=t.width}),e.each(h.concat(f),o),e.each(h,function(t){D+=t.height}),e.each(f,function(t){A+=t.height}),e.each(u.concat(c),r),C=s,M=s,D=d,A=d,e.each(u,function(t){C+=t.width}),e.each(c,function(t){M+=t.width}),e.each(h,function(t){D+=t.height}),e.each(f,function(t){A+=t.height});var I=i-D-A,T=a-C-M;(T!==k||I!==S)&&(e.each(u,function(t){t.height=I}),e.each(c,function(t){t.height=I}),e.each(h,function(t){t.options.fullWidth||(t.width=T)}),e.each(f,function(t){t.options.fullWidth||(t.width=T)}),S=I,k=T);var F=s,P=d;e.each(u.concat(h),l),F+=k,P+=S,e.each(c,l),e.each(f,l),t.chartArea={left:C,top:D,right:C+k,bottom:D+S},e.each(g,function(e){e.left=t.chartArea.left,e.top=t.chartArea.top,e.right=t.chartArea.right,e.bottom=t.chartArea.bottom,e.update(k,S)})}}}}},{}],29:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=e.noop;t.defaults.global.legend={display:!0,position:"top",fullWidth:!0,reverse:!1,onClick:function(t,e){var a=e.datasetIndex,i=this.chart,n=i.getDatasetMeta(a);n.hidden=null===n.hidden?!i.data.datasets[a].hidden:null,i.update()},labels:{boxWidth:40,padding:10,generateLabels:function(t){var a=t.data;return e.isArray(a.datasets)?a.datasets.map(function(a,i){return{text:a.label,fillStyle:e.isArray(a.backgroundColor)?a.backgroundColor[0]:a.backgroundColor,hidden:!t.isDatasetVisible(i),lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:a.borderWidth,strokeStyle:a.borderColor,pointStyle:a.pointStyle,datasetIndex:i}},this):[]}}},t.Legend=t.Element.extend({initialize:function(t){e.extend(this,t),this.legendHitBoxes=[],this.doughnutMode=!1},beforeUpdate:a,update:function(t,e,a){var i=this;return i.beforeUpdate(),i.maxWidth=t,i.maxHeight=e,i.margins=a,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:a,beforeSetDimensions:a,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:a,beforeBuildLabels:a,buildLabels:function(){var t=this;t.legendItems=t.options.labels.generateLabels.call(t,t.chart),t.options.reverse&&t.legendItems.reverse()},afterBuildLabels:a,beforeFit:a,fit:function(){var a=this,i=a.options,n=i.labels,o=i.display,r=a.ctx,l=t.defaults.global,s=e.getValueOrDefault,d=s(n.fontSize,l.defaultFontSize),u=s(n.fontStyle,l.defaultFontStyle),c=s(n.fontFamily,l.defaultFontFamily),h=e.fontString(d,u,c),f=a.legendHitBoxes=[],g=a.minSize,p=a.isHorizontal();if(p?(g.width=a.maxWidth,g.height=o?10:0):(g.width=o?10:0,g.height=a.maxHeight),o)if(r.font=h,p){var m=a.lineWidths=[0],b=a.legendItems.length?d+n.padding:0;r.textAlign="left",r.textBaseline="top",e.each(a.legendItems,function(t,e){var i=n.usePointStyle?d*Math.sqrt(2):n.boxWidth,o=i+d/2+r.measureText(t.text).width;m[m.length-1]+o+n.padding>=a.width&&(b+=d+n.padding,m[m.length]=a.left),f[e]={left:0,top:0,width:o,height:d},m[m.length-1]+=o+n.padding}),g.height+=b}else{var v=n.padding,x=a.columnWidths=[],y=n.padding,k=0,S=0,w=d+v;e.each(a.legendItems,function(t,e){var a=n.usePointStyle?2*n.boxWidth:n.boxWidth,i=a+d/2+r.measureText(t.text).width;S+w>g.height&&(y+=k+n.padding,x.push(k),k=0,S=0),k=Math.max(k,i),S+=w,f[e]={left:0,top:0,width:i,height:d}}),y+=k,x.push(k),g.width+=y}a.width=g.width,a.height=g.height},afterFit:a,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var a=this,i=a.options,n=i.labels,o=t.defaults.global,r=o.elements.line,l=a.width,s=a.lineWidths;if(i.display){var d,u=a.ctx,c=e.getValueOrDefault,h=c(n.fontColor,o.defaultFontColor),f=c(n.fontSize,o.defaultFontSize),g=c(n.fontStyle,o.defaultFontStyle),p=c(n.fontFamily,o.defaultFontFamily),m=e.fontString(f,g,p);u.textAlign="left",u.textBaseline="top",u.lineWidth=.5,u.strokeStyle=h,u.fillStyle=h,u.font=m;var b=n.boxWidth,v=a.legendHitBoxes,x=function(e,a,n){if(!(isNaN(b)||0>=b)){if(u.save(),u.fillStyle=c(n.fillStyle,o.defaultColor),u.lineCap=c(n.lineCap,r.borderCapStyle),u.lineDashOffset=c(n.lineDashOffset,r.borderDashOffset),u.lineJoin=c(n.lineJoin,r.borderJoinStyle),u.lineWidth=c(n.lineWidth,r.borderWidth),u.strokeStyle=c(n.strokeStyle,o.defaultColor),u.setLineDash&&u.setLineDash(c(n.lineDash,r.borderDash)),i.labels&&i.labels.usePointStyle){var l=f*Math.SQRT2/2,s=l/Math.SQRT2,d=e+s,h=a+s;t.canvasHelpers.drawPoint(u,n.pointStyle,l,d,h)}else u.strokeRect(e,a,b,f),u.fillRect(e,a,b,f);u.restore()}},y=function(t,e,a,i){u.fillText(a.text,b+f/2+t,e),a.hidden&&(u.beginPath(),u.lineWidth=2,u.moveTo(b+f/2+t,e+f/2),u.lineTo(b+f/2+t+i,e+f/2),u.stroke())},k=a.isHorizontal();d=k?{x:a.left+(l-s[0])/2,y:a.top+n.padding,line:0}:{x:a.left+n.padding,y:a.top+n.padding,line:0};var S=f+n.padding;e.each(a.legendItems,function(t,e){var i=u.measureText(t.text).width,o=n.usePointStyle?f+f/2+i:b+f/2+i,r=d.x,c=d.y;k?r+o>=l&&(c=d.y+=S,d.line++,r=d.x=a.left+(l-s[d.line])/2):c+S>a.bottom&&(r=d.x=r+a.columnWidths[d.line]+n.padding,c=d.y=a.top,d.line++),x(r,c,t),v[e].left=r,v[e].top=c,y(r,c,t,i),k?d.x+=o+n.padding:d.y+=S})}},handleEvent:function(t){var a=this,i=e.getRelativePosition(t,a.chart.chart),n=i.x,o=i.y,r=a.options;if(n>=a.left&&n<=a.right&&o>=a.top&&o<=a.bottom)for(var l=a.legendHitBoxes,s=0;s<l.length;++s){var d=l[s];if(n>=d.left&&n<=d.left+d.width&&o>=d.top&&o<=d.top+d.height){r.onClick&&r.onClick.call(a,t,a.legendItems[s]);break}}}}),t.plugins.register({beforeInit:function(e){var a=e.options,i=a.legend;i&&(e.legend=new t.Legend({ctx:e.chart.ctx,options:i,chart:e}),t.layoutService.addBox(e,e.legend))}})}},{}],30:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers.noop;t.plugins={_plugins:[],register:function(t){var e=this._plugins;[].concat(t).forEach(function(t){-1===e.indexOf(t)&&e.push(t)})},unregister:function(t){var e=this._plugins;[].concat(t).forEach(function(t){var a=e.indexOf(t);-1!==a&&e.splice(a,1)})},clear:function(){this._plugins=[]},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e){var a,i,n=this._plugins,o=n.length;for(a=0;o>a;++a)if(i=n[a],"function"==typeof i[t]&&i[t].apply(i,e||[])===!1)return!1;return!0}},t.PluginBase=t.Element.extend({beforeInit:e,afterInit:e,beforeUpdate:e,afterUpdate:e,beforeDraw:e,afterDraw:e,destroy:e}),t.pluginService=t.plugins}},{}],31:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.scale={display:!0,position:"left",gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",offsetGridLines:!1},scaleLabel:{labelString:"",display:!1},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:10,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:function(t){return e.isArray(t)?t:""+t}}},t.Scale=t.Element.extend({beforeUpdate:function(){e.callCallback(this.options.beforeUpdate,[this])},update:function(t,a,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=a,n.margins=e.extend({left:0,right:0,top:0,bottom:0},i),n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeDataLimits(),n.determineDataLimits(),n.afterDataLimits(),n.beforeBuildTicks(),n.buildTicks(),n.afterBuildTicks(),n.beforeTickToLabelConversion(),n.convertTicksToLabels(),n.afterTickToLabelConversion(),n.beforeCalculateTickRotation(),n.calculateTickRotation(),n.afterCalculateTickRotation(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:function(){e.callCallback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){e.callCallback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){e.callCallback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){e.callCallback(this.options.beforeDataLimits,[this])},determineDataLimits:e.noop,afterDataLimits:function(){e.callCallback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){e.callCallback(this.options.beforeBuildTicks,[this])},buildTicks:e.noop,afterBuildTicks:function(){e.callCallback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){e.callCallback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this;t.ticks=t.ticks.map(function(e,a,i){return t.options.ticks.userCallback?t.options.ticks.userCallback(e,a,i):t.options.ticks.callback(e,a,i)},t)},afterTickToLabelConversion:function(){e.callCallback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){e.callCallback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var a=this,i=a.ctx,n=t.defaults.global,o=a.options.ticks,r=e.getValueOrDefault(o.fontSize,n.defaultFontSize),l=e.getValueOrDefault(o.fontStyle,n.defaultFontStyle),s=e.getValueOrDefault(o.fontFamily,n.defaultFontFamily),d=e.fontString(r,l,s);i.font=d;var u,c=i.measureText(a.ticks[0]).width,h=i.measureText(a.ticks[a.ticks.length-1]).width;if(a.labelRotation=o.minRotation||0,a.paddingRight=0,a.paddingLeft=0,a.options.display&&a.isHorizontal()){a.paddingRight=h/2+3,a.paddingLeft=c/2+3,a.longestTextCache||(a.longestTextCache={});for(var f,g,p=e.longestText(i,d,a.ticks,a.longestTextCache),m=p,b=a.getPixelForTick(1)-a.getPixelForTick(0)-6;m>b&&a.labelRotation<o.maxRotation;){if(f=Math.cos(e.toRadians(a.labelRotation)),g=Math.sin(e.toRadians(a.labelRotation)),u=f*c,u+r/2>a.yLabelWidth&&(a.paddingLeft=u+r/2),a.paddingRight=r/2,g*p>a.maxHeight){a.labelRotation--;break}a.labelRotation++,m=f*p}}a.margins&&(a.paddingLeft=Math.max(a.paddingLeft-a.margins.left,0),a.paddingRight=Math.max(a.paddingRight-a.margins.right,0))},afterCalculateTickRotation:function(){e.callCallback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){e.callCallback(this.options.beforeFit,[this]);
},fit:function(){var a=this,i=a.minSize={width:0,height:0},n=a.options,o=t.defaults.global,r=n.ticks,l=n.scaleLabel,s=n.display,d=a.isHorizontal(),u=e.getValueOrDefault(r.fontSize,o.defaultFontSize),c=e.getValueOrDefault(r.fontStyle,o.defaultFontStyle),h=e.getValueOrDefault(r.fontFamily,o.defaultFontFamily),f=e.fontString(u,c,h),g=e.getValueOrDefault(l.fontSize,o.defaultFontSize),p=n.gridLines.tickMarkLength;if(d?i.width=a.isFullWidth()?a.maxWidth-a.margins.left-a.margins.right:a.maxWidth:i.width=s?p:0,d?i.height=s?p:0:i.height=a.maxHeight,l.display&&s&&(d?i.height+=1.5*g:i.width+=1.5*g),r.display&&s){a.longestTextCache||(a.longestTextCache={});var m=e.longestText(a.ctx,f,a.ticks,a.longestTextCache),b=e.numberOfLabelLines(a.ticks),v=.5*u;if(d){a.longestLabelWidth=m;var x=Math.sin(e.toRadians(a.labelRotation))*a.longestLabelWidth+u*b+v*b;i.height=Math.min(a.maxHeight,i.height+x),a.ctx.font=f;var y=a.ctx.measureText(a.ticks[0]).width,k=a.ctx.measureText(a.ticks[a.ticks.length-1]).width,S=Math.cos(e.toRadians(a.labelRotation)),w=Math.sin(e.toRadians(a.labelRotation));a.paddingLeft=0!==a.labelRotation?S*y+3:y/2+3,a.paddingRight=0!==a.labelRotation?w*(u/2)+3:k/2+3}else{var C=a.maxWidth-i.width,M=r.mirror;M?m=0:m+=a.options.ticks.padding,C>m?i.width+=m:i.width=a.maxWidth,a.paddingTop=u/2,a.paddingBottom=u/2}}a.margins&&(a.paddingLeft=Math.max(a.paddingLeft-a.margins.left,0),a.paddingTop=Math.max(a.paddingTop-a.margins.top,0),a.paddingRight=Math.max(a.paddingRight-a.margins.right,0),a.paddingBottom=Math.max(a.paddingBottom-a.margins.bottom,0)),a.width=i.width,a.height=i.height},afterFit:function(){e.callCallback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){return null===t||"undefined"==typeof t?NaN:"number"==typeof t&&isNaN(t)?NaN:"object"==typeof t?t instanceof Date||t.isValid?t:this.getRightValue(this.isHorizontal()?t.x:t.y):t},getLabelForIndex:e.noop,getPixelForValue:e.noop,getValueForPixel:e.noop,getPixelForTick:function(t,e){var a=this;if(a.isHorizontal()){var i=a.width-(a.paddingLeft+a.paddingRight),n=i/Math.max(a.ticks.length-(a.options.gridLines.offsetGridLines?0:1),1),o=n*t+a.paddingLeft;e&&(o+=n/2);var r=a.left+Math.round(o);return r+=a.isFullWidth()?a.margins.left:0}var l=a.height-(a.paddingTop+a.paddingBottom);return a.top+t*(l/(a.ticks.length-1))},getPixelForDecimal:function(t){var e=this;if(e.isHorizontal()){var a=e.width-(e.paddingLeft+e.paddingRight),i=a*t+e.paddingLeft,n=e.left+Math.round(i);return n+=e.isFullWidth()?e.margins.left:0}return e.top+t*e.height},getBasePixel:function(){var t=this,e=t.min,a=t.max;return t.getPixelForValue(t.beginAtZero?0:0>e&&0>a?a:e>0&&a>0?e:0)},draw:function(a){var i=this,n=i.options;if(n.display){var o,r,l=i.ctx,s=t.defaults.global,d=n.ticks,u=n.gridLines,c=n.scaleLabel,h=0!==i.labelRotation,f=d.autoSkip,g=i.isHorizontal();d.maxTicksLimit&&(r=d.maxTicksLimit);var p=e.getValueOrDefault(d.fontColor,s.defaultFontColor),m=e.getValueOrDefault(d.fontSize,s.defaultFontSize),b=e.getValueOrDefault(d.fontStyle,s.defaultFontStyle),v=e.getValueOrDefault(d.fontFamily,s.defaultFontFamily),x=e.fontString(m,b,v),y=u.tickMarkLength,k=e.getValueOrDefault(c.fontColor,s.defaultFontColor),S=e.getValueOrDefault(c.fontSize,s.defaultFontSize),w=e.getValueOrDefault(c.fontStyle,s.defaultFontStyle),C=e.getValueOrDefault(c.fontFamily,s.defaultFontFamily),M=e.fontString(S,w,C),D=e.toRadians(i.labelRotation),A=Math.cos(D),I=i.longestLabelWidth*A;l.fillStyle=p;var T=[];if(g){if(o=!1,h&&(I/=2),(I+d.autoSkipPadding)*i.ticks.length>i.width-(i.paddingLeft+i.paddingRight)&&(o=1+Math.floor((I+d.autoSkipPadding)*i.ticks.length/(i.width-(i.paddingLeft+i.paddingRight)))),r&&i.ticks.length>r)for(;!o||i.ticks.length/(o||1)>r;)o||(o=1),o+=1;f||(o=!1)}var F="right"===n.position?i.left:i.right-y,P="right"===n.position?i.left+y:i.right,R="bottom"===n.position?i.top:i.bottom-y,_="bottom"===n.position?i.top+y:i.bottom;if(e.each(i.ticks,function(t,r){if(void 0!==t&&null!==t){var l=i.ticks.length===r+1,s=o>1&&r%o>0||r%o===0&&r+o>=i.ticks.length;if((!s||l)&&void 0!==t&&null!==t){var c,f;r===("undefined"!=typeof i.zeroLineIndex?i.zeroLineIndex:0)?(c=u.zeroLineWidth,f=u.zeroLineColor):(c=e.getValueAtIndexOrDefault(u.lineWidth,r),f=e.getValueAtIndexOrDefault(u.color,r));var p,m,b,v,x,k,S,w,C,M,A,I="middle";if(g){h||(I="top"===n.position?"bottom":"top"),A=h?"right":"center";var V=i.getPixelForTick(r)+e.aliasPixel(c);C=i.getPixelForTick(r,u.offsetGridLines)+d.labelOffset,M=h?i.top+12:"top"===n.position?i.bottom-y:i.top+y,p=b=x=S=V,m=R,v=_,k=a.top,w=a.bottom}else{"left"===n.position?d.mirror?(C=i.right+d.padding,A="left"):(C=i.right-d.padding,A="right"):d.mirror?(C=i.left-d.padding,A="right"):(C=i.left+d.padding,A="left");var L=i.getPixelForTick(r);L+=e.aliasPixel(c),M=i.getPixelForTick(r,u.offsetGridLines),p=F,b=P,x=a.left,S=a.right,m=v=k=w=L}T.push({tx1:p,ty1:m,tx2:b,ty2:v,x1:x,y1:k,x2:S,y2:w,labelX:C,labelY:M,glWidth:c,glColor:f,rotation:-1*D,label:t,textBaseline:I,textAlign:A})}}}),e.each(T,function(t){if(u.display&&(l.lineWidth=t.glWidth,l.strokeStyle=t.glColor,l.beginPath(),u.drawTicks&&(l.moveTo(t.tx1,t.ty1),l.lineTo(t.tx2,t.ty2)),u.drawOnChartArea&&(l.moveTo(t.x1,t.y1),l.lineTo(t.x2,t.y2)),l.stroke()),d.display){l.save(),l.translate(t.labelX,t.labelY),l.rotate(t.rotation),l.font=x,l.textBaseline=t.textBaseline,l.textAlign=t.textAlign;var a=t.label;if(e.isArray(a))for(var i=0,n=0;i<a.length;++i)l.fillText(""+a[i],0,n),n+=1.5*m;else l.fillText(a,0,0);l.restore()}}),c.display){var V,L,O=0;if(g)V=i.left+(i.right-i.left)/2,L="bottom"===n.position?i.bottom-S/2:i.top+S/2;else{var B="left"===n.position;V=B?i.left+S/2:i.right-S/2,L=i.top+(i.bottom-i.top)/2,O=B?-.5*Math.PI:.5*Math.PI}l.save(),l.translate(V,L),l.rotate(O),l.textAlign="center",l.textBaseline="middle",l.fillStyle=k,l.font=M,l.fillText(c.labelString,0,0),l.restore()}if(u.drawBorder){l.lineWidth=e.getValueAtIndexOrDefault(u.lineWidth,0),l.strokeStyle=e.getValueAtIndexOrDefault(u.color,0);var W=i.left,z=i.right,N=i.top,H=i.bottom,E=e.aliasPixel(l.lineWidth);g?(N=H="top"===n.position?i.bottom:i.top,N+=E,H+=E):(W=z="left"===n.position?i.right:i.left,W+=E,z+=E),l.beginPath(),l.moveTo(W,N),l.lineTo(z,H),l.stroke()}}}})}},{}],32:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.scaleService={constructors:{},defaults:{},registerScaleType:function(t,a,i){this.constructors[t]=a,this.defaults[t]=e.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(a){return this.defaults.hasOwnProperty(a)?e.scaleMerge(t.defaults.scale,this.defaults[a]):{}},updateScaleDefaults:function(t,a){var i=this.defaults;i.hasOwnProperty(t)&&(i[t]=e.extend(i[t],a))},addScalesToLayout:function(a){e.each(a.scales,function(e){t.layoutService.addBox(a,e)})}}}},{}],33:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers;t.defaults.global.title={display:!1,position:"top",fullWidth:!0,fontStyle:"bold",padding:10,text:""};var a=e.noop;t.Title=t.Element.extend({initialize:function(a){var i=this;e.extend(i,a),i.options=e.configMerge(t.defaults.global.title,a.options),i.legendHitBoxes=[]},beforeUpdate:function(){var a=this.chart.options;a&&a.title&&(this.options=e.configMerge(t.defaults.global.title,a.title))},update:function(t,e,a){var i=this;return i.beforeUpdate(),i.maxWidth=t,i.maxHeight=e,i.margins=a,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:a,beforeSetDimensions:a,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:a,beforeBuildLabels:a,buildLabels:a,afterBuildLabels:a,beforeFit:a,fit:function(){var a=this,i=e.getValueOrDefault,n=a.options,o=t.defaults.global,r=n.display,l=i(n.fontSize,o.defaultFontSize),s=a.minSize;a.isHorizontal()?(s.width=a.maxWidth,s.height=r?l+2*n.padding:0):(s.width=r?l+2*n.padding:0,s.height=a.maxHeight),a.width=s.width,a.height=s.height},afterFit:a,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var a=this,i=a.ctx,n=e.getValueOrDefault,o=a.options,r=t.defaults.global;if(o.display){var l,s,d=n(o.fontSize,r.defaultFontSize),u=n(o.fontStyle,r.defaultFontStyle),c=n(o.fontFamily,r.defaultFontFamily),h=e.fontString(d,u,c),f=0,g=a.top,p=a.left,m=a.bottom,b=a.right;i.fillStyle=n(o.fontColor,r.defaultFontColor),i.font=h,a.isHorizontal()?(l=p+(b-p)/2,s=g+(m-g)/2):(l="left"===o.position?p+d/2:b-d/2,s=g+(m-g)/2,f=Math.PI*("left"===o.position?-.5:.5)),i.save(),i.translate(l,s),i.rotate(f),i.textAlign="center",i.textBaseline="middle",i.fillText(o.text,0,0),i.restore()}}}),t.plugins.register({beforeInit:function(e){var a=e.options,i=a.title;i&&(e.titleBlock=new t.Title({ctx:e.chart.ctx,options:i,chart:e}),t.layoutService.addBox(e,e.titleBlock))}})}},{}],34:[function(t,e,a){"use strict";e.exports=function(t){function e(t,e){return e&&(n.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function a(t){if(!t.length)return!1;var e,a,i=[],n=[];for(e=0,a=t.length;a>e;++e){var o=t[e];if(o&&o.hasValue()){var r=o.tooltipPosition();i.push(r.x),n.push(r.y)}}var l=0,s=0;for(e=0;e<i.length;++e)i[e]&&(l+=i[e],s+=n[e]);return{x:Math.round(l/i.length),y:Math.round(s/i.length)}}function i(t){var e=t._xScale,a=t._yScale||t._scale,i=t._index,n=t._datasetIndex;return{xLabel:e?e.getLabelForIndex(i,n):"",yLabel:a?a.getLabelForIndex(i,n):"",index:i,datasetIndex:n}}var n=t.helpers;t.defaults.global.tooltips={enabled:!0,custom:null,mode:"single",backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,yAlign:"center",xAlign:"center",caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",callbacks:{beforeTitle:n.noop,title:function(t,e){var a="",i=e.labels,n=i?i.length:0;if(t.length>0){var o=t[0];o.xLabel?a=o.xLabel:n>0&&o.index<n&&(a=i[o.index])}return a},afterTitle:n.noop,beforeBody:n.noop,beforeLabel:n.noop,label:function(t,e){var a=e.datasets[t.datasetIndex].label||"";return a+": "+t.yLabel},labelColor:function(t,e){var a=e.getDatasetMeta(t.datasetIndex),i=a.data[t.index],n=i._view;return{borderColor:n.borderColor,backgroundColor:n.backgroundColor}},afterLabel:n.noop,afterBody:n.noop,beforeFooter:n.noop,footer:n.noop,afterFooter:n.noop}},t.Tooltip=t.Element.extend({initialize:function(){var e=this,a=t.defaults.global,i=e._options,o=n.getValueOrDefault;n.extend(e,{_model:{xPadding:i.xPadding,yPadding:i.yPadding,xAlign:i.xAlign,yAlign:i.yAlign,bodyFontColor:i.bodyFontColor,_bodyFontFamily:o(i.bodyFontFamily,a.defaultFontFamily),_bodyFontStyle:o(i.bodyFontStyle,a.defaultFontStyle),_bodyAlign:i.bodyAlign,bodyFontSize:o(i.bodyFontSize,a.defaultFontSize),bodySpacing:i.bodySpacing,titleFontColor:i.titleFontColor,_titleFontFamily:o(i.titleFontFamily,a.defaultFontFamily),_titleFontStyle:o(i.titleFontStyle,a.defaultFontStyle),titleFontSize:o(i.titleFontSize,a.defaultFontSize),_titleAlign:i.titleAlign,titleSpacing:i.titleSpacing,titleMarginBottom:i.titleMarginBottom,footerFontColor:i.footerFontColor,_footerFontFamily:o(i.footerFontFamily,a.defaultFontFamily),_footerFontStyle:o(i.footerFontStyle,a.defaultFontStyle),footerFontSize:o(i.footerFontSize,a.defaultFontSize),_footerAlign:i.footerAlign,footerSpacing:i.footerSpacing,footerMarginTop:i.footerMarginTop,caretSize:i.caretSize,cornerRadius:i.cornerRadius,backgroundColor:i.backgroundColor,opacity:0,legendColorBackground:i.multiKeyBackground}})},getTitle:function(){var t=this,a=t._options,i=a.callbacks,n=i.beforeTitle.apply(t,arguments),o=i.title.apply(t,arguments),r=i.afterTitle.apply(t,arguments),l=[];return l=e(l,n),l=e(l,o),l=e(l,r)},getBeforeBody:function(){var t=this._options.callbacks.beforeBody.apply(this,arguments);return n.isArray(t)?t:void 0!==t?[t]:[]},getBody:function(t,a){var i=this,o=i._options.callbacks,r=[];return n.each(t,function(t){var n={before:[],lines:[],after:[]};e(n.before,o.beforeLabel.call(i,t,a)),e(n.lines,o.label.call(i,t,a)),e(n.after,o.afterLabel.call(i,t,a)),r.push(n)}),r},getAfterBody:function(){var t=this._options.callbacks.afterBody.apply(this,arguments);return n.isArray(t)?t:void 0!==t?[t]:[]},getFooter:function(){var t=this,a=t._options.callbacks,i=a.beforeFooter.apply(t,arguments),n=a.footer.apply(t,arguments),o=a.afterFooter.apply(t,arguments),r=[];return r=e(r,i),r=e(r,n),r=e(r,o)},update:function(t){var e,o,r=this,l=r._options,s=r._model,d=r._active,u=r._data,c=r._chartInstance;if(d.length){s.opacity=1;var h=[],f=a(d),g=[];for(e=0,o=d.length;o>e;++e)g.push(i(d[e]));l.itemSort&&(g=g.sort(l.itemSort)),d.length>1&&n.each(g,function(t){h.push(l.callbacks.labelColor.call(r,t,c))}),n.extend(s,{title:r.getTitle(g,u),beforeBody:r.getBeforeBody(g,u),body:r.getBody(g,u),afterBody:r.getAfterBody(g,u),footer:r.getFooter(g,u),x:Math.round(f.x),y:Math.round(f.y),caretPadding:n.getValueOrDefault(f.padding,2),labelColors:h});var p=r.getTooltipSize(s);r.determineAlignment(p),n.extend(s,r.getBackgroundPoint(s,p))}else r._model.opacity=0;return t&&l.custom&&l.custom.call(r,s),r},getTooltipSize:function(t){var e=this._chart.ctx,a={height:2*t.yPadding,width:0},i=t.body,o=i.reduce(function(t,e){return t+e.before.length+e.lines.length+e.after.length},0);o+=t.beforeBody.length+t.afterBody.length;var r=t.title.length,l=t.footer.length,s=t.titleFontSize,d=t.bodyFontSize,u=t.footerFontSize;a.height+=r*s,a.height+=(r-1)*t.titleSpacing,a.height+=r?t.titleMarginBottom:0,a.height+=o*d,a.height+=o?(o-1)*t.bodySpacing:0,a.height+=l?t.footerMarginTop:0,a.height+=l*u,a.height+=l?(l-1)*t.footerSpacing:0;var c=0,h=function(t){a.width=Math.max(a.width,e.measureText(t).width+c)};return e.font=n.fontString(s,t._titleFontStyle,t._titleFontFamily),n.each(t.title,h),e.font=n.fontString(d,t._bodyFontStyle,t._bodyFontFamily),n.each(t.beforeBody.concat(t.afterBody),h),c=i.length>1?d+2:0,n.each(i,function(t){n.each(t.before,h),n.each(t.lines,h),n.each(t.after,h)}),c=0,e.font=n.fontString(u,t._footerFontStyle,t._footerFontFamily),n.each(t.footer,h),a.width+=2*t.xPadding,a},determineAlignment:function(t){var e=this,a=e._model,i=e._chart,n=e._chartInstance.chartArea;a.y<t.height?a.yAlign="top":a.y>i.height-t.height&&(a.yAlign="bottom");var o,r,l,s,d,u=(n.left+n.right)/2,c=(n.top+n.bottom)/2;"center"===a.yAlign?(o=function(t){return u>=t},r=function(t){return t>u}):(o=function(e){return e<=t.width/2},r=function(e){return e>=i.width-t.width/2}),l=function(e){return e+t.width>i.width},s=function(e){return e-t.width<0},d=function(t){return c>=t?"top":"bottom"},o(a.x)?(a.xAlign="left",l(a.x)&&(a.xAlign="center",a.yAlign=d(a.y))):r(a.x)&&(a.xAlign="right",s(a.x)&&(a.xAlign="center",a.yAlign=d(a.y)))},getBackgroundPoint:function(t,e){var a={x:t.x,y:t.y},i=t.caretSize,n=t.caretPadding,o=t.cornerRadius,r=t.xAlign,l=t.yAlign,s=i+n,d=o+n;return"right"===r?a.x-=e.width:"center"===r&&(a.x-=e.width/2),"top"===l?a.y+=s:"bottom"===l?a.y-=e.height+s:a.y-=e.height/2,"center"===l?"left"===r?a.x+=s:"right"===r&&(a.x-=s):"left"===r?a.x-=d:"right"===r&&(a.x+=d),a},drawCaret:function(t,e,a){var i,o,r,l,s,d,u=this._view,c=this._chart.ctx,h=u.caretSize,f=u.cornerRadius,g=u.xAlign,p=u.yAlign,m=t.x,b=t.y,v=e.width,x=e.height;"center"===p?("left"===g?(i=m,o=i-h,r=i):(i=m+v,o=i+h,r=i),s=b+x/2,l=s-h,d=s+h):("left"===g?(i=m+f,o=i+h,r=o+h):"right"===g?(i=m+v-f,o=i-h,r=o-h):(o=m+v/2,i=o-h,r=o+h),"top"===p?(l=b,s=l-h,d=l):(l=b+x,s=l+h,d=l));var y=n.color(u.backgroundColor);c.fillStyle=y.alpha(a*y.alpha()).rgbString(),c.beginPath(),c.moveTo(i,l),c.lineTo(o,s),c.lineTo(r,d),c.closePath(),c.fill()},drawTitle:function(t,e,a,i){var o=e.title;if(o.length){a.textAlign=e._titleAlign,a.textBaseline="top";var r=e.titleFontSize,l=e.titleSpacing,s=n.color(e.titleFontColor);a.fillStyle=s.alpha(i*s.alpha()).rgbString(),a.font=n.fontString(r,e._titleFontStyle,e._titleFontFamily);var d,u;for(d=0,u=o.length;u>d;++d)a.fillText(o[d],t.x,t.y),t.y+=r+l,d+1===o.length&&(t.y+=e.titleMarginBottom-l)}},drawBody:function(t,e,a,i){var o=e.bodyFontSize,r=e.bodySpacing,l=e.body;a.textAlign=e._bodyAlign,a.textBaseline="top";var s=n.color(e.bodyFontColor),d=s.alpha(i*s.alpha()).rgbString();a.fillStyle=d,a.font=n.fontString(o,e._bodyFontStyle,e._bodyFontFamily);var u=0,c=function(e){a.fillText(e,t.x+u,t.y),t.y+=o+r};n.each(e.beforeBody,c);var h=l.length>1;u=h?o+2:0,n.each(l,function(r,l){n.each(r.before,c),n.each(r.lines,function(r){h&&(a.fillStyle=n.color(e.legendColorBackground).alpha(i).rgbaString(),a.fillRect(t.x,t.y,o,o),a.strokeStyle=n.color(e.labelColors[l].borderColor).alpha(i).rgbaString(),a.strokeRect(t.x,t.y,o,o),a.fillStyle=n.color(e.labelColors[l].backgroundColor).alpha(i).rgbaString(),a.fillRect(t.x+1,t.y+1,o-2,o-2),a.fillStyle=d),c(r)}),n.each(r.after,c)}),u=0,n.each(e.afterBody,c),t.y-=r},drawFooter:function(t,e,a,i){var o=e.footer;if(o.length){t.y+=e.footerMarginTop,a.textAlign=e._footerAlign,a.textBaseline="top";var r=n.color(e.footerFontColor);a.fillStyle=r.alpha(i*r.alpha()).rgbString(),a.font=n.fontString(e.footerFontSize,e._footerFontStyle,e._footerFontFamily),n.each(o,function(i){a.fillText(i,t.x,t.y),t.y+=e.footerFontSize+e.footerSpacing})}},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var a=this.getTooltipSize(e),i={x:e.x,y:e.y},o=Math.abs(e.opacity<.001)?0:e.opacity;if(this._options.enabled){var r=n.color(e.backgroundColor);t.fillStyle=r.alpha(o*r.alpha()).rgbString(),n.drawRoundedRectangle(t,i.x,i.y,a.width,a.height,e.cornerRadius),t.fill(),this.drawCaret(i,a,o),i.x+=e.xPadding,i.y+=e.yPadding,this.drawTitle(i,e,t,o),this.drawBody(i,e,t,o),this.drawFooter(i,e,t,o)}}}})}},{}],35:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global;a.elements.arc={backgroundColor:a.defaultColor,borderColor:"#fff",borderWidth:2},t.elements.Arc=t.Element.extend({inLabelRange:function(t){var e=this._view;return e?Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2):!1},inRange:function(t,a){var i=this._view;if(i){for(var n=e.getAngleFromPoint(i,{x:t,y:a}),o=n.angle,r=n.distance,l=i.startAngle,s=i.endAngle;l>s;)s+=2*Math.PI;for(;o>s;)o-=2*Math.PI;for(;l>o;)o+=2*Math.PI;var d=o>=l&&s>=o,u=r>=i.innerRadius&&r<=i.outerRadius;return d&&u}return!1},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,a=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*a,y:t.y+Math.sin(e)*a}},draw:function(){var t=this._chart.ctx,e=this._view,a=e.startAngle,i=e.endAngle;t.beginPath(),t.arc(e.x,e.y,e.outerRadius,a,i),t.arc(e.x,e.y,e.innerRadius,i,a,!0),t.closePath(),t.strokeStyle=e.borderColor,t.lineWidth=e.borderWidth,t.fillStyle=e.backgroundColor,t.fill(),t.lineJoin="bevel",e.borderWidth&&t.stroke()}})}},{}],36:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global;t.defaults.global.elements.line={tension:.4,backgroundColor:a.defaultColor,borderWidth:3,borderColor:a.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0},t.elements.Line=t.Element.extend({draw:function(){function t(t,e){var a=e._view;e._view.steppedLine===!0?(s.lineTo(e._view.x,t._view.y),s.lineTo(e._view.x,e._view.y)):0===e._view.tension?s.lineTo(a.x,a.y):s.bezierCurveTo(t._view.controlPointNextX,t._view.controlPointNextY,a.controlPointPreviousX,a.controlPointPreviousY,a.x,a.y)}var i=this,n=i._view,o=n.spanGaps,r=n.scaleZero,l=i._loop,s=i._chart.ctx;s.save();var d=i._children.slice(),u=-1;l&&d.length&&d.push(d[0]);var c,h,f,g;if(d.length&&n.fill){for(s.beginPath(),c=0;c<d.length;++c)h=d[c],f=e.previousItem(d,c),g=h._view,0===c?(l?s.moveTo(r.x,r.y):s.moveTo(g.x,r),g.skip||(u=c,s.lineTo(g.x,g.y))):(f=-1===u?f:d[u],g.skip?o||u!==c-1||(l?s.lineTo(r.x,r.y):s.lineTo(f._view.x,r)):(u!==c-1?o&&-1!==u?t(f,h):l?s.lineTo(g.x,g.y):(s.lineTo(g.x,r),s.lineTo(g.x,g.y)):t(f,h),u=c));l||s.lineTo(d[u]._view.x,r),s.fillStyle=n.backgroundColor||a.defaultColor,s.closePath(),s.fill()}var p=a.elements.line;for(s.lineCap=n.borderCapStyle||p.borderCapStyle,s.setLineDash&&s.setLineDash(n.borderDash||p.borderDash),s.lineDashOffset=n.borderDashOffset||p.borderDashOffset,s.lineJoin=n.borderJoinStyle||p.borderJoinStyle,s.lineWidth=n.borderWidth||p.borderWidth,s.strokeStyle=n.borderColor||a.defaultColor,s.beginPath(),u=-1,c=0;c<d.length;++c)h=d[c],f=e.previousItem(d,c),g=h._view,0===c?g.skip||(s.moveTo(g.x,g.y),u=c):(f=-1===u?f:d[u],g.skip||(u!==c-1&&!o||-1===u?s.moveTo(g.x,g.y):t(f,h),u=c));s.stroke(),s.restore()}})}},{}],37:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global,i=a.defaultColor;a.elements.point={radius:3,pointStyle:"circle",backgroundColor:i,borderWidth:1,borderColor:i,hitRadius:1,hoverRadius:4,hoverBorderWidth:1},t.elements.Point=t.Element.extend({inRange:function(t,e){var a=this._view;return a?Math.pow(t-a.x,2)+Math.pow(e-a.y,2)<Math.pow(a.hitRadius+a.radius,2):!1},inLabelRange:function(t){var e=this._view;return e?Math.pow(t-e.x,2)<Math.pow(e.radius+e.hitRadius,2):!1},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(){var n=this._view,o=this._chart.ctx,r=n.pointStyle,l=n.radius,s=n.x,d=n.y;n.skip||(o.strokeStyle=n.borderColor||i,o.lineWidth=e.getValueOrDefault(n.borderWidth,a.elements.point.borderWidth),o.fillStyle=n.backgroundColor||i,t.canvasHelpers.drawPoint(o,r,l,s,d))}})}},{}],38:[function(t,e,a){"use strict";e.exports=function(t){var e=t.defaults.global;e.elements.rectangle={backgroundColor:e.defaultColor,borderWidth:0,borderColor:e.defaultColor,borderSkipped:"bottom"},t.elements.Rectangle=t.Element.extend({draw:function(){function t(t){return s[(u+t)%4]}var e=this._chart.ctx,a=this._view,i=a.width/2,n=a.x-i,o=a.x+i,r=a.base-(a.base-a.y),l=a.borderWidth/2;a.borderWidth&&(n+=l,o-=l,r+=l),e.beginPath(),e.fillStyle=a.backgroundColor,e.strokeStyle=a.borderColor,e.lineWidth=a.borderWidth;var s=[[n,a.base],[n,r],[o,r],[o,a.base]],d=["bottom","left","top","right"],u=d.indexOf(a.borderSkipped,0);-1===u&&(u=0),e.moveTo.apply(e,t(0));for(var c=1;4>c;c++)e.lineTo.apply(e,t(c));e.fill(),a.borderWidth&&e.stroke()},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){var a=this._view;return a?a.y<a.base?t>=a.x-a.width/2&&t<=a.x+a.width/2&&e>=a.y&&e<=a.base:t>=a.x-a.width/2&&t<=a.x+a.width/2&&e>=a.base&&e<=a.y:!1},inLabelRange:function(t){var e=this._view;return e?t>=e.x-e.width/2&&t<=e.x+e.width/2:!1},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}})}},{}],39:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a={position:"bottom"},i=t.Scale.extend({getLabels:function(){var t=this.chart.data;return(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels},determineDataLimits:function(){var t=this,a=t.getLabels();t.minIndex=0,t.maxIndex=a.length-1;var i;void 0!==t.options.ticks.min&&(i=e.indexOf(a,t.options.ticks.min),t.minIndex=-1!==i?i:t.minIndex),void 0!==t.options.ticks.max&&(i=e.indexOf(a,t.options.ticks.max),t.maxIndex=-1!==i?i:t.maxIndex),t.min=a[t.minIndex],t.max=a[t.maxIndex]},buildTicks:function(){var t=this,e=t.getLabels();t.ticks=0===t.minIndex&&t.maxIndex===e.length-1?e:e.slice(t.minIndex,t.maxIndex+1)},getLabelForIndex:function(t){return this.ticks[t]},getPixelForValue:function(t,e,a,i){var n=this,o=Math.max(n.maxIndex+1-n.minIndex-(n.options.gridLines.offsetGridLines?0:1),1);if(void 0!==t){var r=n.getLabels(),l=r.indexOf(t);e=-1!==l?l:e}if(n.isHorizontal()){var s=n.width-(n.paddingLeft+n.paddingRight),d=s/o,u=d*(e-n.minIndex)+n.paddingLeft;return n.options.gridLines.offsetGridLines&&i&&(u+=d/2),n.left+Math.round(u)}var c=n.height-(n.paddingTop+n.paddingBottom),h=c/o,f=h*(e-n.minIndex)+n.paddingTop;return n.options.gridLines.offsetGridLines&&i&&(f+=h/2),n.top+Math.round(f)},getPixelForTick:function(t,e){return this.getPixelForValue(this.ticks[t],t+this.minIndex,null,e)},getValueForPixel:function(t){var e,a=this,i=Math.max(a.ticks.length-(a.options.gridLines.offsetGridLines?0:1),1),n=a.isHorizontal(),o=n?a.width-(a.paddingLeft+a.paddingRight):a.height-(a.paddingTop+a.paddingBottom),r=o/i;return t-=n?a.left:a.top,a.options.gridLines.offsetGridLines&&(t-=r/2),t-=n?a.paddingLeft:a.paddingTop,e=0>=t?0:Math.round(t/r)},getBasePixel:function(){return this.bottom}});t.scaleService.registerScaleType("category",i,a)}},{}],40:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a={position:"left",ticks:{callback:function(t,a,i){var n=i.length>3?i[2]-i[1]:i[1]-i[0];Math.abs(n)>1&&t!==Math.floor(t)&&(n=t-Math.floor(t));var o=e.log10(Math.abs(n)),r="";if(0!==t){var l=-1*Math.floor(o);l=Math.max(Math.min(l,20),0),r=t.toFixed(l)}else r="0";return r}}},i=t.LinearScaleBase.extend({determineDataLimits:function(){function t(t){return l?t.xAxisID===a.id:t.yAxisID===a.id}var a=this,i=a.options,n=a.chart,o=n.data,r=o.datasets,l=a.isHorizontal();if(a.min=null,a.max=null,i.stacked){var s={},d=!1,u=!1;e.each(r,function(o,r){var l=n.getDatasetMeta(r);void 0===s[l.type]&&(s[l.type]={positiveValues:[],negativeValues:[]});var c=s[l.type].positiveValues,h=s[l.type].negativeValues;n.isDatasetVisible(r)&&t(l)&&e.each(o.data,function(t,e){var n=+a.getRightValue(t);isNaN(n)||l.data[e].hidden||(c[e]=c[e]||0,h[e]=h[e]||0,i.relativePoints?c[e]=100:0>n?(u=!0,h[e]+=n):(d=!0,c[e]+=n))})}),e.each(s,function(t){var i=t.positiveValues.concat(t.negativeValues),n=e.min(i),o=e.max(i);a.min=null===a.min?n:Math.min(a.min,n),a.max=null===a.max?o:Math.max(a.max,o)})}else e.each(r,function(i,o){var r=n.getDatasetMeta(o);n.isDatasetVisible(o)&&t(r)&&e.each(i.data,function(t,e){var i=+a.getRightValue(t);isNaN(i)||r.data[e].hidden||(null===a.min?a.min=i:i<a.min&&(a.min=i),null===a.max?a.max=i:i>a.max&&(a.max=i))})});this.handleTickRangeOptions()},getTickLimit:function(){var a,i=this,n=i.options.ticks;if(i.isHorizontal())a=Math.min(n.maxTicksLimit?n.maxTicksLimit:11,Math.ceil(i.width/50));else{var o=e.getValueOrDefault(n.fontSize,t.defaults.global.defaultFontSize);a=Math.min(n.maxTicksLimit?n.maxTicksLimit:11,Math.ceil(i.height/(2*o)))}return a},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){var e,a,i=this,n=i.paddingLeft,o=i.paddingBottom,r=i.start,l=+i.getRightValue(t),s=i.end-r;return i.isHorizontal()?(a=i.width-(n+i.paddingRight),e=i.left+a/s*(l-r),Math.round(e+n)):(a=i.height-(i.paddingTop+o),e=i.bottom-o-a/s*(l-r),Math.round(e))},getValueForPixel:function(t){var e=this,a=e.isHorizontal(),i=e.paddingLeft,n=e.paddingBottom,o=a?e.width-(i+e.paddingRight):e.height-(e.paddingTop+n),r=(a?t-e.left-i:e.bottom-n-t)/o;return e.start+(e.end-e.start)*r},getPixelForTick:function(t){return this.getPixelForValue(this.ticksAsNumbers[t])}});t.scaleService.registerScaleType("linear",i,a)}},{}],41:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=e.noop;t.LinearScaleBase=t.Scale.extend({handleTickRangeOptions:function(){var t=this,a=t.options,i=a.ticks;if(i.beginAtZero){var n=e.sign(t.min),o=e.sign(t.max);0>n&&0>o?t.max=0:n>0&&o>0&&(t.min=0)}void 0!==i.min?t.min=i.min:void 0!==i.suggestedMin&&(t.min=Math.min(t.min,i.suggestedMin)),void 0!==i.max?t.max=i.max:void 0!==i.suggestedMax&&(t.max=Math.max(t.max,i.suggestedMax)),t.min===t.max&&(t.max++,i.beginAtZero||t.min--)},getTickLimit:a,handleDirectionalChanges:a,buildTicks:function(){var t=this,a=t.options,i=t.ticks=[],n=a.ticks,o=e.getValueOrDefault,r=t.getTickLimit();r=Math.max(2,r);var l,s=n.fixedStepSize&&n.fixedStepSize>0||n.stepSize&&n.stepSize>0;if(s)l=o(n.fixedStepSize,n.stepSize);else{var d=e.niceNum(t.max-t.min,!1);l=e.niceNum(d/(r-1),!0)}var u=Math.floor(t.min/l)*l,c=Math.ceil(t.max/l)*l,h=(c-u)/l;h=e.almostEquals(h,Math.round(h),l/1e3)?Math.round(h):Math.ceil(h),i.push(void 0!==n.min?n.min:u);for(var f=1;h>f;++f)i.push(u+f*l);i.push(void 0!==n.max?n.max:c),t.handleDirectionalChanges(),t.max=e.max(i),t.min=e.min(i),n.reverse?(i.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){var e=this;e.ticksAsNumbers=e.ticks.slice(),e.zeroLineIndex=e.ticks.indexOf(0),t.Scale.prototype.convertTicksToLabels.call(e)}})}},{}],42:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a={position:"left",ticks:{callback:function(t,a,i){var n=t/Math.pow(10,Math.floor(e.log10(t)));return 1===n||2===n||5===n||0===a||a===i.length-1?t.toExponential():""}}},i=t.Scale.extend({determineDataLimits:function(){function t(t){return d?t.xAxisID===a.id:t.yAxisID===a.id}var a=this,i=a.options,n=i.ticks,o=a.chart,r=o.data,l=r.datasets,s=e.getValueOrDefault,d=a.isHorizontal();if(a.min=null,a.max=null,i.stacked){var u={};e.each(l,function(n,r){var l=o.getDatasetMeta(r);o.isDatasetVisible(r)&&t(l)&&(void 0===u[l.type]&&(u[l.type]=[]),e.each(n.data,function(t,e){var n=u[l.type],o=+a.getRightValue(t);isNaN(o)||l.data[e].hidden||(n[e]=n[e]||0,i.relativePoints?n[e]=100:n[e]+=o)}))}),e.each(u,function(t){var i=e.min(t),n=e.max(t);a.min=null===a.min?i:Math.min(a.min,i),a.max=null===a.max?n:Math.max(a.max,n)})}else e.each(l,function(i,n){var r=o.getDatasetMeta(n);o.isDatasetVisible(n)&&t(r)&&e.each(i.data,function(t,e){var i=+a.getRightValue(t);isNaN(i)||r.data[e].hidden||(null===a.min?a.min=i:i<a.min&&(a.min=i),null===a.max?a.max=i:i>a.max&&(a.max=i))})});a.min=s(n.min,a.min),a.max=s(n.max,a.max),a.min===a.max&&(0!==a.min&&null!==a.min?(a.min=Math.pow(10,Math.floor(e.log10(a.min))-1),a.max=Math.pow(10,Math.floor(e.log10(a.max))+1)):(a.min=1,a.max=10))},buildTicks:function(){for(var t=this,a=t.options,i=a.ticks,n=e.getValueOrDefault,o=t.ticks=[],r=n(i.min,Math.pow(10,Math.floor(e.log10(t.min))));r<t.max;){o.push(r);var l=Math.floor(e.log10(r)),s=Math.floor(r/Math.pow(10,l))+1;10===s&&(s=1,++l),r=s*Math.pow(10,l)}var d=n(i.max,r);o.push(d),t.isHorizontal()||o.reverse(),t.max=e.max(o),t.min=e.min(o),i.reverse?(o.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),t.Scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},getPixelForValue:function(t){var a,i,n=this,o=n.start,r=+n.getRightValue(t),l=e.log10(n.end)-e.log10(o),s=n.paddingTop,d=n.paddingBottom,u=n.paddingLeft;return n.isHorizontal()?0===r?i=n.left+u:(a=n.width-(u+n.paddingRight),i=n.left+a/l*(e.log10(r)-e.log10(o)),i+=u):0===r?i=n.top+s:(a=n.height-(s+d),i=n.bottom-d-a/l*(e.log10(r)-e.log10(o))),i},getValueForPixel:function(t){var a,i,n=this,o=e.log10(n.end)-e.log10(n.start);return n.isHorizontal()?(i=n.width-(n.paddingLeft+n.paddingRight),a=n.start*Math.pow(10,(t-n.left-n.paddingLeft)*o/i)):(i=n.height-(n.paddingTop+n.paddingBottom),a=Math.pow(10,(n.bottom-n.paddingBottom-t)*o/i)/n.start),a}});t.scaleService.registerScaleType("logarithmic",i,a)}},{}],43:[function(t,e,a){"use strict";e.exports=function(t){var e=t.helpers,a=t.defaults.global,i={display:!0,animate:!0,lineArc:!1,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2},pointLabels:{fontSize:10,callback:function(t){return t}}},n=t.LinearScaleBase.extend({getValueCount:function(){return this.chart.data.labels.length;
},setDimensions:function(){var t=this,i=t.options,n=i.ticks;t.width=t.maxWidth,t.height=t.maxHeight,t.xCenter=Math.round(t.width/2),t.yCenter=Math.round(t.height/2);var o=e.min([t.height,t.width]),r=e.getValueOrDefault(n.fontSize,a.defaultFontSize);t.drawingArea=i.display?o/2-(r/2+n.backdropPaddingY):o/2},determineDataLimits:function(){var t=this,a=t.chart;t.min=null,t.max=null,e.each(a.data.datasets,function(i,n){if(a.isDatasetVisible(n)){var o=a.getDatasetMeta(n);e.each(i.data,function(e,a){var i=+t.getRightValue(e);isNaN(i)||o.data[a].hidden||(null===t.min?t.min=i:i<t.min&&(t.min=i),null===t.max?t.max=i:i>t.max&&(t.max=i))})}}),t.handleTickRangeOptions()},getTickLimit:function(){var t=this.options.ticks,i=e.getValueOrDefault(t.fontSize,a.defaultFontSize);return Math.min(t.maxTicksLimit?t.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*i)))},convertTicksToLabels:function(){var e=this;t.LinearScaleBase.prototype.convertTicksToLabels.call(e),e.pointLabels=e.chart.data.labels.map(e.options.pointLabels.callback,e)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t,i,n,o,r,l,s,d,u,c,h,f,g=this.options.pointLabels,p=e.getValueOrDefault(g.fontSize,a.defaultFontSize),m=e.getValueOrDefault(g.fontStyle,a.defaultFontStyle),b=e.getValueOrDefault(g.fontFamily,a.defaultFontFamily),v=e.fontString(p,m,b),x=e.min([this.height/2-p-5,this.width/2]),y=this.width,k=0;for(this.ctx.font=v,i=0;i<this.getValueCount();i++){t=this.getPointPosition(i,x),n=this.ctx.measureText(this.pointLabels[i]?this.pointLabels[i]:"").width+5;var S=this.getIndexAngle(i)+Math.PI/2,w=360*S/(2*Math.PI)%360;0===w||180===w?(o=n/2,t.x+o>y&&(y=t.x+o,r=i),t.x-o<k&&(k=t.x-o,s=i)):180>w?t.x+n>y&&(y=t.x+n,r=i):t.x-n<k&&(k=t.x-n,s=i)}u=k,c=Math.ceil(y-this.width),l=this.getIndexAngle(r),d=this.getIndexAngle(s),h=c/Math.sin(l+Math.PI/2),f=u/Math.sin(d+Math.PI/2),h=e.isNumber(h)?h:0,f=e.isNumber(f)?f:0,this.drawingArea=Math.round(x-(f+h)/2),this.setCenterPoint(f,h)},setCenterPoint:function(t,e){var a=this,i=a.width-e-a.drawingArea,n=t+a.drawingArea;a.xCenter=Math.round((n+i)/2+a.left),a.yCenter=Math.round(a.height/2+a.top)},getIndexAngle:function(t){var e=2*Math.PI/this.getValueCount(),a=this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0,i=a*Math.PI*2/360;return t*e-Math.PI/2+i},getDistanceFromCenterForValue:function(t){var e=this;if(null===t)return 0;var a=e.drawingArea/(e.max-e.min);return e.options.reverse?(e.max-t)*a:(t-e.min)*a},getPointPosition:function(t,e){var a=this,i=a.getIndexAngle(t);return{x:Math.round(Math.cos(i)*e)+a.xCenter,y:Math.round(Math.sin(i)*e)+a.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this,e=t.min,a=t.max;return t.getPointPositionForValue(0,t.beginAtZero?0:0>e&&0>a?a:e>0&&a>0?e:0)},draw:function(){var t=this,i=t.options,n=i.gridLines,o=i.ticks,r=i.angleLines,l=i.pointLabels,s=e.getValueOrDefault;if(i.display){var d=t.ctx,u=s(o.fontSize,a.defaultFontSize),c=s(o.fontStyle,a.defaultFontStyle),h=s(o.fontFamily,a.defaultFontFamily),f=e.fontString(u,c,h);if(e.each(t.ticks,function(r,l){if(l>0||i.reverse){var c=t.getDistanceFromCenterForValue(t.ticksAsNumbers[l]),h=t.yCenter-c;if(n.display&&0!==l)if(d.strokeStyle=e.getValueAtIndexOrDefault(n.color,l-1),d.lineWidth=e.getValueAtIndexOrDefault(n.lineWidth,l-1),i.lineArc)d.beginPath(),d.arc(t.xCenter,t.yCenter,c,0,2*Math.PI),d.closePath(),d.stroke();else{d.beginPath();for(var g=0;g<t.getValueCount();g++){var p=t.getPointPosition(g,c);0===g?d.moveTo(p.x,p.y):d.lineTo(p.x,p.y)}d.closePath(),d.stroke()}if(o.display){var m=s(o.fontColor,a.defaultFontColor);if(d.font=f,o.showLabelBackdrop){var b=d.measureText(r).width;d.fillStyle=o.backdropColor,d.fillRect(t.xCenter-b/2-o.backdropPaddingX,h-u/2-o.backdropPaddingY,b+2*o.backdropPaddingX,u+2*o.backdropPaddingY)}d.textAlign="center",d.textBaseline="middle",d.fillStyle=m,d.fillText(r,t.xCenter,h)}}}),!i.lineArc){d.lineWidth=r.lineWidth,d.strokeStyle=r.color;for(var g=t.getDistanceFromCenterForValue(i.reverse?t.min:t.max),p=s(l.fontSize,a.defaultFontSize),m=s(l.fontStyle,a.defaultFontStyle),b=s(l.fontFamily,a.defaultFontFamily),v=e.fontString(p,m,b),x=t.getValueCount()-1;x>=0;x--){if(r.display){var y=t.getPointPosition(x,g);d.beginPath(),d.moveTo(t.xCenter,t.yCenter),d.lineTo(y.x,y.y),d.stroke(),d.closePath()}var k=t.getPointPosition(x,g+5),S=s(l.fontColor,a.defaultFontColor);d.font=v,d.fillStyle=S;var w=t.pointLabels,C=this.getIndexAngle(x)+Math.PI/2,M=360*C/(2*Math.PI)%360;0===M||180===M?d.textAlign="center":180>M?d.textAlign="left":d.textAlign="right",90===M||270===M?d.textBaseline="middle":M>270||90>M?d.textBaseline="bottom":d.textBaseline="top",d.fillText(w[x]?w[x]:"",k.x,k.y)}}}}});t.scaleService.registerScaleType("radialLinear",n,i)}},{}],44:[function(t,e,a){"use strict";var i=t(1);i="function"==typeof i?i:window.moment,e.exports=function(t){var e=t.helpers,a={units:[{name:"millisecond",steps:[1,2,5,10,20,50,100,250,500]},{name:"second",steps:[1,2,5,10,30]},{name:"minute",steps:[1,2,5,10,30]},{name:"hour",steps:[1,2,3,6,12]},{name:"day",steps:[1,2,5]},{name:"week",maxStep:4},{name:"month",maxStep:3},{name:"quarter",maxStep:4},{name:"year",maxStep:!1}]},n={position:"bottom",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm:ss a",hour:"MMM D, hA",day:"ll",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1}},o=t.Scale.extend({initialize:function(){if(!i)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");t.Scale.prototype.initialize.call(this)},getLabelMoment:function(t,e){return"undefined"!=typeof this.labelMoments[t]?this.labelMoments[t][e]:null},getMomentStartOf:function(t){var e=this;return"week"===e.options.time.unit&&e.options.time.isoWeekday!==!1?t.clone().startOf("isoWeek").isoWeekday(e.options.time.isoWeekday):t.clone().startOf(e.tickUnit)},determineDataLimits:function(){var t=this;t.labelMoments=[];var a=[];t.chart.data.labels&&t.chart.data.labels.length>0?(e.each(t.chart.data.labels,function(e){var i=t.parseTime(e);i.isValid()&&(t.options.time.round&&i.startOf(t.options.time.round),a.push(i))},t),t.firstTick=i.min.call(t,a),t.lastTick=i.max.call(t,a)):(t.firstTick=null,t.lastTick=null),e.each(t.chart.data.datasets,function(n,o){var r=[],l=t.chart.isDatasetVisible(o);"object"==typeof n.data[0]&&null!==n.data[0]?e.each(n.data,function(e){var a=t.parseTime(t.getRightValue(e));a.isValid()&&(t.options.time.round&&a.startOf(t.options.time.round),r.push(a),l&&(t.firstTick=null!==t.firstTick?i.min(t.firstTick,a):a,t.lastTick=null!==t.lastTick?i.max(t.lastTick,a):a))},t):r=a,t.labelMoments.push(r)},t),t.options.time.min&&(t.firstTick=t.parseTime(t.options.time.min)),t.options.time.max&&(t.lastTick=t.parseTime(t.options.time.max)),t.firstTick=(t.firstTick||i()).clone(),t.lastTick=(t.lastTick||i()).clone()},buildTicks:function(){var i=this;i.ctx.save();var n=e.getValueOrDefault(i.options.ticks.fontSize,t.defaults.global.defaultFontSize),o=e.getValueOrDefault(i.options.ticks.fontStyle,t.defaults.global.defaultFontStyle),r=e.getValueOrDefault(i.options.ticks.fontFamily,t.defaults.global.defaultFontFamily),l=e.fontString(n,o,r);if(i.ctx.font=l,i.ticks=[],i.unitScale=1,i.scaleSizeInUnits=0,i.options.time.unit)i.tickUnit=i.options.time.unit||"day",i.displayFormat=i.options.time.displayFormats[i.tickUnit],i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0),i.unitScale=e.getValueOrDefault(i.options.time.unitStepSize,1);else{var s=i.isHorizontal()?i.width-(i.paddingLeft+i.paddingRight):i.height-(i.paddingTop+i.paddingBottom),d=i.tickFormatFunction(i.firstTick,0,[]),u=i.ctx.measureText(d).width,c=Math.cos(e.toRadians(i.options.ticks.maxRotation)),h=Math.sin(e.toRadians(i.options.ticks.maxRotation));u=u*c+n*h;var f=s/u;i.tickUnit="millisecond",i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0),i.displayFormat=i.options.time.displayFormats[i.tickUnit];for(var g=0,p=a.units[g];g<a.units.length;){if(i.unitScale=1,e.isArray(p.steps)&&Math.ceil(i.scaleSizeInUnits/f)<e.max(p.steps)){for(var m=0;m<p.steps.length;++m)if(p.steps[m]>=Math.ceil(i.scaleSizeInUnits/f)){i.unitScale=e.getValueOrDefault(i.options.time.unitStepSize,p.steps[m]);break}break}if(p.maxStep===!1||Math.ceil(i.scaleSizeInUnits/f)<p.maxStep){i.unitScale=e.getValueOrDefault(i.options.time.unitStepSize,Math.ceil(i.scaleSizeInUnits/f));break}++g,p=a.units[g],i.tickUnit=p.name;var b=i.firstTick.diff(i.getMomentStartOf(i.firstTick),i.tickUnit,!0),v=i.getMomentStartOf(i.lastTick.clone().add(1,i.tickUnit)).diff(i.lastTick,i.tickUnit,!0);i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0)+b+v,i.displayFormat=i.options.time.displayFormats[p.name]}}var x;if(i.options.time.min?x=i.getMomentStartOf(i.firstTick):(i.firstTick=i.getMomentStartOf(i.firstTick),x=i.firstTick),!i.options.time.max){var y=i.getMomentStartOf(i.lastTick),k=y.diff(i.lastTick,i.tickUnit,!0);0>k?i.lastTick=i.getMomentStartOf(i.lastTick.add(1,i.tickUnit)):k>=0&&(i.lastTick=y),i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0)}i.smallestLabelSeparation=i.width,e.each(i.chart.data.datasets,function(t,e){for(var a=1;a<i.labelMoments[e].length;a++)i.smallestLabelSeparation=Math.min(i.smallestLabelSeparation,i.labelMoments[e][a].diff(i.labelMoments[e][a-1],i.tickUnit,!0))},i),i.options.time.displayFormat&&(i.displayFormat=i.options.time.displayFormat),i.ticks.push(i.firstTick.clone());for(var S=1;S<=i.scaleSizeInUnits;++S){var w=x.clone().add(S,i.tickUnit);if(i.options.time.max&&w.diff(i.lastTick,i.tickUnit,!0)>=0)break;S%i.unitScale===0&&i.ticks.push(w)}var C=i.ticks[i.ticks.length-1].diff(i.lastTick,i.tickUnit);(0!==C||0===i.scaleSizeInUnits)&&(i.options.time.max?(i.ticks.push(i.lastTick.clone()),i.scaleSizeInUnits=i.lastTick.diff(i.ticks[0],i.tickUnit,!0)):(i.ticks.push(i.lastTick.clone()),i.scaleSizeInUnits=i.lastTick.diff(i.firstTick,i.tickUnit,!0))),i.ctx.restore()},getLabelForIndex:function(t,e){var a=this,i=a.chart.data.labels&&t<a.chart.data.labels.length?a.chart.data.labels[t]:"";return"object"==typeof a.chart.data.datasets[e].data[0]&&(i=a.getRightValue(a.chart.data.datasets[e].data[t])),a.options.time.tooltipFormat&&(i=a.parseTime(i).format(a.options.time.tooltipFormat)),i},tickFormatFunction:function(t,a,i){var n=t.format(this.displayFormat),o=this.options.ticks,r=e.getValueOrDefault(o.callback,o.userCallback);return r?r(n,a,i):n},convertTicksToLabels:function(){var t=this;t.tickMoments=t.ticks,t.ticks=t.ticks.map(t.tickFormatFunction,t)},getPixelForValue:function(t,e,a){var n=this;t&&t.isValid||(t=i(n.getRightValue(t)));var o=t&&t.isValid&&t.isValid()?t:n.getLabelMoment(a,e);if(o){var r=o.diff(n.firstTick,n.tickUnit,!0),l=0!==r?r/n.scaleSizeInUnits:r;if(n.isHorizontal()){var s=n.width-(n.paddingLeft+n.paddingRight),d=s*l+n.paddingLeft;return n.left+Math.round(d)}var u=n.height-(n.paddingTop+n.paddingBottom),c=u*l+n.paddingTop;return n.top+Math.round(c)}},getPixelForTick:function(t){return this.getPixelForValue(this.tickMoments[t],null,null)},getValueForPixel:function(t){var e=this,a=e.isHorizontal()?e.width-(e.paddingLeft+e.paddingRight):e.height-(e.paddingTop+e.paddingBottom),n=(t-(e.isHorizontal()?e.left+e.paddingLeft:e.top+e.paddingTop))/a;return n*=e.scaleSizeInUnits,e.firstTick.clone().add(i.duration(n,e.tickUnit).asSeconds(),"seconds")},parseTime:function(t){var e=this;return"string"==typeof e.options.time.parser?i(t,e.options.time.parser):"function"==typeof e.options.time.parser?e.options.time.parser(t):"function"==typeof t.getMonth||"number"==typeof t?i(t):t.isValid&&t.isValid()?t:"string"!=typeof e.options.time.format&&e.options.time.format.call?(console.warn("options.time.format is deprecated and replaced by options.time.parser. See http://nnnick.github.io/Chart.js/docs-v2/#scales-time-scale"),e.options.time.format(t)):i(t,e.options.time.format)}});t.scaleService.registerScaleType("time",o,n)}},{1:1}]},{},[7])(7)});
/*! jQuery Validation Plugin - v1.11.0 - 2/4/2013
* https://github.com/jzaefferer/jquery-validation
* Copyright (c) 2013 Jrn Zaefferer; Licensed MIT */

(function($) {

$.extend($.fn, {
	// http://docs.jquery.com/Plugins/Validation/validate
	validate: function( options ) {

		// if nothing is selected, return nothing; can't chain anyway
		if ( !this.length ) {
			if ( options && options.debug && window.console ) {
				console.warn( "Nothing selected, can't validate, returning nothing." );
			}
			return;
		}

		// check if a validator for this form was already created
		var validator = $.data( this[0], "validator" );
		if ( validator ) {
			return validator;
		}

		// Add novalidate tag if HTML5.
		this.attr( "novalidate", "novalidate" );

		validator = new $.validator( options, this[0] );
		$.data( this[0], "validator", validator );

		if ( validator.settings.onsubmit ) {

			this.validateDelegate( ":submit", "click", function( event ) {
				if ( validator.settings.submitHandler ) {
					validator.submitButton = event.target;
				}
				// allow suppressing validation by adding a cancel class to the submit button
				if ( $(event.target).hasClass("cancel") ) {
					validator.cancelSubmit = true;
				}
			});

			// validate the form on submit
			this.submit( function( event ) {
				if ( validator.settings.debug ) {
					// prevent form submit to be able to see console output
					event.preventDefault();
				}
				function handle() {
					var hidden;
					if ( validator.settings.submitHandler ) {
						if ( validator.submitButton ) {
							// insert a hidden input as a replacement for the missing submit button
							hidden = $("<input type='hidden'/>").attr("name", validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);
						}
						validator.settings.submitHandler.call( validator, validator.currentForm, event );
						if ( validator.submitButton ) {
							// and clean up afterwards; thanks to no-block-scope, hidden can be referenced
							hidden.remove();
						}
						return false;
					}
					return true;
				}

				// prevent submit for invalid forms or custom submit handlers
				if ( validator.cancelSubmit ) {
					validator.cancelSubmit = false;
					return handle();
				}
				if ( validator.form() ) {
					if ( validator.pendingRequest ) {
						validator.formSubmitted = true;
						return false;
					}
					return handle();
				} else {
					validator.focusInvalid();
					return false;
				}
			});
		}

		return validator;
	},
	// http://docs.jquery.com/Plugins/Validation/valid
	valid: function() {
		if ( $(this[0]).is("form")) {
			return this.validate().form();
		} else {
			var valid = true;
			var validator = $(this[0].form).validate();
			this.each(function() {
				valid &= validator.element(this);
			});
			return valid;
		}
	},
	// attributes: space seperated list of attributes to retrieve and remove
	removeAttrs: function( attributes ) {
		var result = {},
			$element = this;
		$.each(attributes.split(/\s/), function( index, value ) {
			result[value] = $element.attr(value);
			$element.removeAttr(value);
		});
		return result;
	},
	// http://docs.jquery.com/Plugins/Validation/rules
	rules: function( command, argument ) {
		var element = this[0];

		if ( command ) {
			var settings = $.data(element.form, "validator").settings;
			var staticRules = settings.rules;
			var existingRules = $.validator.staticRules(element);
			switch(command) {
			case "add":
				$.extend(existingRules, $.validator.normalizeRule(argument));
				staticRules[element.name] = existingRules;
				if ( argument.messages ) {
					settings.messages[element.name] = $.extend( settings.messages[element.name], argument.messages );
				}
				break;
			case "remove":
				if ( !argument ) {
					delete staticRules[element.name];
					return existingRules;
				}
				var filtered = {};
				$.each(argument.split(/\s/), function( index, method ) {
					filtered[method] = existingRules[method];
					delete existingRules[method];
				});
				return filtered;
			}
		}

		var data = $.validator.normalizeRules(
		$.extend(
			{},
			$.validator.classRules(element),
			$.validator.attributeRules(element),
			$.validator.dataRules(element),
			$.validator.staticRules(element)
		), element);

		// make sure required is at front
		if ( data.required ) {
			var param = data.required;
			delete data.required;
			data = $.extend({required: param}, data);
		}

		return data;
	}
});

// Custom selectors
$.extend($.expr[":"], {
	// http://docs.jquery.com/Plugins/Validation/blank
	blank: function( a ) { return !$.trim("" + a.value); },
	// http://docs.jquery.com/Plugins/Validation/filled
	filled: function( a ) { return !!$.trim("" + a.value); },
	// http://docs.jquery.com/Plugins/Validation/unchecked
	unchecked: function( a ) { return !a.checked; }
});

// constructor for validator
$.validator = function( options, form ) {
	this.settings = $.extend( true, {}, $.validator.defaults, options );
	this.currentForm = form;
	this.init();
};

$.validator.format = function( source, params ) {
	if ( arguments.length === 1 ) {
		return function() {
			var args = $.makeArray(arguments);
			args.unshift(source);
			return $.validator.format.apply( this, args );
		};
	}
	if ( arguments.length > 2 && params.constructor !== Array  ) {
		params = $.makeArray(arguments).slice(1);
	}
	if ( params.constructor !== Array ) {
		params = [ params ];
	}
	$.each(params, function( i, n ) {
		source = source.replace( new RegExp("\\{" + i + "\\}", "g"), function() {
			return n;
		});
	});
	return source;
};

$.extend($.validator, {

	defaults: {
		messages: {},
		groups: {},
		rules: {},
		errorClass: "error",
		validClass: "valid",
		errorElement: "label",
		focusInvalid: true,
		errorContainer: $([]),
		errorLabelContainer: $([]),
		onsubmit: true,
		ignore: ":hidden",
		ignoreTitle: false,
		onfocusin: function( element, event ) {
			this.lastActive = element;

			// hide error label and remove error class on focus if enabled
			if ( this.settings.focusCleanup && !this.blockFocusCleanup ) {
				if ( this.settings.unhighlight ) {
					this.settings.unhighlight.call( this, element, this.settings.errorClass, this.settings.validClass );
				}
				this.addWrapper(this.errorsFor(element)).hide();
			}
		},
		onfocusout: function( element, event ) {
			if ( !this.checkable(element) && (element.name in this.submitted || !this.optional(element)) ) {
				this.element(element);
			}
		},
		onkeyup: function( element, event ) {
			if ( event.which === 9 && this.elementValue(element) === "" ) {
				return;
			} else if ( element.name in this.submitted || element === this.lastElement ) {
				this.element(element);
			}
		},
		onclick: function( element, event ) {
			// click on selects, radiobuttons and checkboxes
			if ( element.name in this.submitted ) {
				this.element(element);
			}
			// or option elements, check parent select in that case
			else if ( element.parentNode.name in this.submitted ) {
				this.element(element.parentNode);
			}
		},
		highlight: function( element, errorClass, validClass ) {
			if ( element.type === "radio" ) {
				this.findByName(element.name).addClass(errorClass).removeClass(validClass);
			} else {
				$(element).addClass(errorClass).removeClass(validClass);
			}
		},
		unhighlight: function( element, errorClass, validClass ) {
			if ( element.type === "radio" ) {
				this.findByName(element.name).removeClass(errorClass).addClass(validClass);
			} else {
				$(element).removeClass(errorClass).addClass(validClass);
			}
		}
	},

	// http://docs.jquery.com/Plugins/Validation/Validator/setDefaults
	setDefaults: function( settings ) {
		$.extend( $.validator.defaults, settings );
	},

	messages: {
		required: "This field is required.",
		remote: "Please fix this field.",
		email: "Please enter a valid email address",
		url: "Please enter a valid URL.",
		date: "Please enter a valid date.",
		dateISO: "Please enter a valid date (ISO).",
		number: "Please enter a valid number.",
		digits: "Please enter only digits.",
		creditcard: "Please enter a valid credit card number.",
		equalTo: "Please enter the same value again.",
		maxlength: $.validator.format("Please enter no more than {0} characters."),
		minlength: $.validator.format("Please enter at least {0} characters."),
		rangelength: $.validator.format("Please enter a value between {0} and {1} characters long."),
		range: $.validator.format("Please enter a value between {0} and {1}."),
		max: $.validator.format("Please enter a value less than or equal to {0}."),
		min: $.validator.format("Please enter a value greater than or equal to {0}.")
	},

	autoCreateRanges: false,

	prototype: {

		init: function() {
			this.labelContainer = $(this.settings.errorLabelContainer);
			this.errorContext = this.labelContainer.length && this.labelContainer || $(this.currentForm);
			this.containers = $(this.settings.errorContainer).add( this.settings.errorLabelContainer );
			this.submitted = {};
			this.valueCache = {};
			this.pendingRequest = 0;
			this.pending = {};
			this.invalid = {};
			this.reset();

			var groups = (this.groups = {});
			$.each(this.settings.groups, function( key, value ) {
				if ( typeof value === "string" ) {
					value = value.split(/\s/);
				}
				$.each(value, function( index, name ) {
					groups[name] = key;
				});
			});
			var rules = this.settings.rules;
			$.each(rules, function( key, value ) {
				rules[key] = $.validator.normalizeRule(value);
			});

			function delegate(event) {
				var validator = $.data(this[0].form, "validator"),
					eventType = "on" + event.type.replace(/^validate/, "");
				if ( validator.settings[eventType] ) {
					validator.settings[eventType].call(validator, this[0], event);
				}
			}
			$(this.currentForm)
				.validateDelegate(":text, [type='password'], [type='file'], select, textarea, " +
					"[type='number'], [type='search'] ,[type='tel'], [type='url'], " +
					"[type='email'], [type='datetime'], [type='date'], [type='month'], " +
					"[type='week'], [type='time'], [type='datetime-local'], " +
					"[type='range'], [type='color'] ",
					"focusin focusout keyup", delegate)
				.validateDelegate("[type='radio'], [type='checkbox'], select, option", "click", delegate);

			if ( this.settings.invalidHandler ) {
				$(this.currentForm).bind("invalid-form.validate", this.settings.invalidHandler);
			}
		},

		// http://docs.jquery.com/Plugins/Validation/Validator/form
		form: function() {
			this.checkForm();
			$.extend(this.submitted, this.errorMap);
			this.invalid = $.extend({}, this.errorMap);
			if ( !this.valid() ) {
				$(this.currentForm).triggerHandler("invalid-form", [this]);
			}
			this.showErrors();
			return this.valid();
		},

		checkForm: function() {
			this.prepareForm();
			for ( var i = 0, elements = (this.currentElements = this.elements()); elements[i]; i++ ) {
				this.check( elements[i] );
			}
			return this.valid();
		},

		// http://docs.jquery.com/Plugins/Validation/Validator/element
		element: function( element ) {
			element = this.validationTargetFor( this.clean( element ) );
			this.lastElement = element;
			this.prepareElement( element );
			this.currentElements = $(element);
			var result = this.check( element ) !== false;
			if ( result ) {
				delete this.invalid[element.name];
			} else {
				this.invalid[element.name] = true;
			}
			if ( !this.numberOfInvalids() ) {
				// Hide error containers on last error
				this.toHide = this.toHide.add( this.containers );
			}
			this.showErrors();
			return result;
		},

		// http://docs.jquery.com/Plugins/Validation/Validator/showErrors
		showErrors: function( errors ) {
			if ( errors ) {
				// add items to error list and map
				$.extend( this.errorMap, errors );
				this.errorList = [];
				for ( var name in errors ) {
					this.errorList.push({
						message: errors[name],
						element: this.findByName(name)[0]
					});
				}
				// remove items from success list
				this.successList = $.grep( this.successList, function( element ) {
					return !(element.name in errors);
				});
			}
			if ( this.settings.showErrors ) {
				this.settings.showErrors.call( this, this.errorMap, this.errorList );
			} else {
				this.defaultShowErrors();
			}
		},

		// http://docs.jquery.com/Plugins/Validation/Validator/resetForm
		resetForm: function() {
			if ( $.fn.resetForm ) {
				$(this.currentForm).resetForm();
			}
			this.submitted = {};
			this.lastElement = null;
			this.prepareForm();
			this.hideErrors();
			this.elements().removeClass( this.settings.errorClass ).removeData( "previousValue" );
		},

		numberOfInvalids: function() {
			return this.objectLength(this.invalid);
		},

		objectLength: function( obj ) {
			var count = 0;
			for ( var i in obj ) {
				count++;
			}
			return count;
		},

		hideErrors: function() {
			this.addWrapper( this.toHide ).hide();
		},

		valid: function() {
			return this.size() === 0;
		},

		size: function() {
			return this.errorList.length;
		},

		focusInvalid: function() {
			if ( this.settings.focusInvalid ) {
				try {
					$(this.findLastActive() || this.errorList.length && this.errorList[0].element || [])
					.filter(":visible")
					.focus()
					// manually trigger focusin event; without it, focusin handler isn't called, findLastActive won't have anything to find
					.trigger("focusin");
				} catch(e) {
					// ignore IE throwing errors when focusing hidden elements
				}
			}
		},

		findLastActive: function() {
			var lastActive = this.lastActive;
			return lastActive && $.grep(this.errorList, function( n ) {
				return n.element.name === lastActive.name;
			}).length === 1 && lastActive;
		},

		elements: function() {
			var validator = this,
				rulesCache = {};

			// select all valid inputs inside the form (no submit or reset buttons)
			return $(this.currentForm)
			.find("input, select, textarea")
			.not(":submit, :reset, :image, [disabled]")
			.not( this.settings.ignore )
			.filter(function() {
				if ( !this.name && validator.settings.debug && window.console ) {
					console.error( "%o has no name assigned", this);
				}

				// select only the first element for each name, and only those with rules specified
				if ( this.name in rulesCache || !validator.objectLength($(this).rules()) ) {
					return false;
				}

				rulesCache[this.name] = true;
				return true;
			});
		},

		clean: function( selector ) {
			return $(selector)[0];
		},

		errors: function() {
			var errorClass = this.settings.errorClass.replace(" ", ".");
			return $(this.settings.errorElement + "." + errorClass, this.errorContext);
		},

		reset: function() {
			this.successList = [];
			this.errorList = [];
			this.errorMap = {};
			this.toShow = $([]);
			this.toHide = $([]);
			this.currentElements = $([]);
		},

		prepareForm: function() {
			this.reset();
			this.toHide = this.errors().add( this.containers );
		},

		prepareElement: function( element ) {
			this.reset();
			this.toHide = this.errorsFor(element);
		},

		elementValue: function( element ) {
			var type = $(element).attr("type"),
				val = $(element).val();

			if ( type === "radio" || type === "checkbox" ) {
				return $("input[name='" + $(element).attr("name") + "']:checked").val();
			}

			if ( typeof val === "string" ) {
				return val.replace(/\r/g, "");
			}
			return val;
		},

		check: function( element ) {
			element = this.validationTargetFor( this.clean( element ) );

			var rules = $(element).rules();
			var dependencyMismatch = false;
			var val = this.elementValue(element);
			var result;

			for (var method in rules ) {
				var rule = { method: method, parameters: rules[method] };
				try {

					result = $.validator.methods[method].call( this, val, element, rule.parameters );

					// if a method indicates that the field is optional and therefore valid,
					// don't mark it as valid when there are no other rules
					if ( result === "dependency-mismatch" ) {
						dependencyMismatch = true;
						continue;
					}
					dependencyMismatch = false;

					if ( result === "pending" ) {
						this.toHide = this.toHide.not( this.errorsFor(element) );
						return;
					}

					if ( !result ) {
						this.formatAndAdd( element, rule );
						return false;
					}
				} catch(e) {
					if ( this.settings.debug && window.console ) {
						console.log( "Exception occured when checking element " + element.id + ", check the '" + rule.method + "' method.", e );
					}
					throw e;
				}
			}
			if ( dependencyMismatch ) {
				return;
			}
			if ( this.objectLength(rules) ) {
				this.successList.push(element);
			}
			return true;
		},

		// return the custom message for the given element and validation method
		// specified in the element's HTML5 data attribute
		customDataMessage: function( element, method ) {
			return $(element).data("msg-" + method.toLowerCase()) || (element.attributes && $(element).attr("data-msg-" + method.toLowerCase()));
		},

		// return the custom message for the given element name and validation method
		customMessage: function( name, method ) {
			var m = this.settings.messages[name];
			return m && (m.constructor === String ? m : m[method]);
		},

		// return the first defined argument, allowing empty strings
		findDefined: function() {
			for(var i = 0; i < arguments.length; i++) {
				if ( arguments[i] !== undefined ) {
					return arguments[i];
				}
			}
			return undefined;
		},

		defaultMessage: function( element, method ) {
			return this.findDefined(
				this.customMessage( element.name, method ),
				this.customDataMessage( element, method ),
				// title is never undefined, so handle empty string as undefined
				!this.settings.ignoreTitle && element.title || undefined,
				$.validator.messages[method],
				"<strong>Warning: No message defined for " + element.name + "</strong>"
			);
		},

		formatAndAdd: function( element, rule ) {
			var message = this.defaultMessage( element, rule.method ),
				theregex = /\$?\{(\d+)\}/g;
			if ( typeof message === "function" ) {
				message = message.call(this, rule.parameters, element);
			} else if (theregex.test(message)) {
				message = $.validator.format(message.replace(theregex, "{$1}"), rule.parameters);
			}
			this.errorList.push({
				message: message,
				element: element
			});

			this.errorMap[element.name] = message;
			this.submitted[element.name] = message;
		},

		addWrapper: function( toToggle ) {
			if ( this.settings.wrapper ) {
				toToggle = toToggle.add( toToggle.parent( this.settings.wrapper ) );
			}
			return toToggle;
		},

		defaultShowErrors: function() {
			var i, elements;
			for ( i = 0; this.errorList[i]; i++ ) {
				var error = this.errorList[i];
				if ( this.settings.highlight ) {
					this.settings.highlight.call( this, error.element, this.settings.errorClass, this.settings.validClass );
				}
				this.showLabel( error.element, error.message );
			}
			if ( this.errorList.length ) {
				this.toShow = this.toShow.add( this.containers );
			}
			if ( this.settings.success ) {
				for ( i = 0; this.successList[i]; i++ ) {
					this.showLabel( this.successList[i] );
				}
			}
			if ( this.settings.unhighlight ) {
				for ( i = 0, elements = this.validElements(); elements[i]; i++ ) {
					this.settings.unhighlight.call( this, elements[i], this.settings.errorClass, this.settings.validClass );
				}
			}
			this.toHide = this.toHide.not( this.toShow );
			this.hideErrors();
			this.addWrapper( this.toShow ).show();
		},

		validElements: function() {
			return this.currentElements.not(this.invalidElements());
		},

		invalidElements: function() {
			return $(this.errorList).map(function() {
				return this.element;
			});
		},

		showLabel: function( element, message ) {
			var label = this.errorsFor( element );
			if ( label.length ) {
				// refresh error/success class
				label.removeClass( this.settings.validClass ).addClass( this.settings.errorClass );
				// replace message on existing label
				label.html(message);
			} else {
				// create label
				label = $("<" + this.settings.errorElement + ">")
					.attr("for", this.idOrName(element))
					.addClass(this.settings.errorClass)
					.html(message || "");
				if ( this.settings.wrapper ) {
					// make sure the element is visible, even in IE
					// actually showing the wrapped element is handled elsewhere
					label = label.hide().show().wrap("<" + this.settings.wrapper + "/>").parent();
				}
				if ( !this.labelContainer.append(label).length ) {
					if ( this.settings.errorPlacement ) {
						this.settings.errorPlacement(label, $(element) );
					} else {
						label.insertAfter(element);
					}
				}
			}
			if ( !message && this.settings.success ) {
				label.text("");
				if ( typeof this.settings.success === "string" ) {
					label.addClass( this.settings.success );
				} else {
					this.settings.success( label, element );
				}
			}
			this.toShow = this.toShow.add(label);
		},

		errorsFor: function( element ) {
			var name = this.idOrName(element);
			return this.errors().filter(function() {
				return $(this).attr("for") === name;
			});
		},

		idOrName: function( element ) {
			return this.groups[element.name] || (this.checkable(element) ? element.name : element.id || element.name);
		},

		validationTargetFor: function( element ) {
			// if radio/checkbox, validate first element in group instead
			if ( this.checkable(element) ) {
				element = this.findByName( element.name ).not(this.settings.ignore)[0];
			}
			return element;
		},

		checkable: function( element ) {
			return (/radio|checkbox/i).test(element.type);
		},

		findByName: function( name ) {
			return $(this.currentForm).find("[name='" + name + "']");
		},

		getLength: function( value, element ) {
			switch( element.nodeName.toLowerCase() ) {
			case "select":
				return $("option:selected", element).length;
			case "input":
				if ( this.checkable( element) ) {
					return this.findByName(element.name).filter(":checked").length;
				}
			}
			return value.length;
		},

		depend: function( param, element ) {
			return this.dependTypes[typeof param] ? this.dependTypes[typeof param](param, element) : true;
		},

		dependTypes: {
			"boolean": function( param, element ) {
				return param;
			},
			"string": function( param, element ) {
				return !!$(param, element.form).length;
			},
			"function": function( param, element ) {
				return param(element);
			}
		},

		optional: function( element ) {
			var val = this.elementValue(element);
			return !$.validator.methods.required.call(this, val, element) && "dependency-mismatch";
		},

		startRequest: function( element ) {
			if ( !this.pending[element.name] ) {
				this.pendingRequest++;
				this.pending[element.name] = true;
			}
		},

		stopRequest: function( element, valid ) {
			this.pendingRequest--;
			// sometimes synchronization fails, make sure pendingRequest is never < 0
			if ( this.pendingRequest < 0 ) {
				this.pendingRequest = 0;
			}
			delete this.pending[element.name];
			if ( valid && this.pendingRequest === 0 && this.formSubmitted && this.form() ) {
				$(this.currentForm).submit();
				this.formSubmitted = false;
			} else if (!valid && this.pendingRequest === 0 && this.formSubmitted) {
				$(this.currentForm).triggerHandler("invalid-form", [this]);
				this.formSubmitted = false;
			}
		},

		previousValue: function( element ) {
			return $.data(element, "previousValue") || $.data(element, "previousValue", {
				old: null,
				valid: true,
				message: this.defaultMessage( element, "remote" )
			});
		}

	},

	classRuleSettings: {
		required: {required: true},
		email: {email: true},
		url: {url: true},
		date: {date: true},
		dateISO: {dateISO: true},
		number: {number: true},
		digits: {digits: true},
		creditcard: {creditcard: true}
	},

	addClassRules: function( className, rules ) {
		if ( className.constructor === String ) {
			this.classRuleSettings[className] = rules;
		} else {
			$.extend(this.classRuleSettings, className);
		}
	},

	classRules: function( element ) {
		var rules = {};
		var classes = $(element).attr("class");
		if ( classes ) {
			$.each(classes.split(" "), function() {
				if ( this in $.validator.classRuleSettings ) {
					$.extend(rules, $.validator.classRuleSettings[this]);
				}
			});
		}
		return rules;
	},

	attributeRules: function( element ) {
		var rules = {};
		var $element = $(element);

		for (var method in $.validator.methods) {
			var value;

			// support for <input required> in both html5 and older browsers
			if ( method === "required" ) {
				value = $element.get(0).getAttribute(method);
				// Some browsers return an empty string for the required attribute
				// and non-HTML5 browsers might have required="" markup
				if ( value === "" ) {
					value = true;
				}
				// force non-HTML5 browsers to return bool
				value = !!value;
			} else {
				value = $element.attr(method);
			}

			if ( value ) {
				rules[method] = value;
			} else if ( $element[0].getAttribute("type") === method ) {
				rules[method] = true;
			}
		}

		// maxlength may be returned as -1, 2147483647 (IE) and 524288 (safari) for text inputs
		if ( rules.maxlength && /-1|2147483647|524288/.test(rules.maxlength) ) {
			delete rules.maxlength;
		}

		return rules;
	},

	dataRules: function( element ) {
		var method, value,
			rules = {}, $element = $(element);
		for (method in $.validator.methods) {
			value = $element.data("rule-" + method.toLowerCase());
			if ( value !== undefined ) {
				rules[method] = value;
			}
		}
		return rules;
	},

	staticRules: function( element ) {
		var rules = {};
		var validator = $.data(element.form, "validator");
		if ( validator.settings.rules ) {
			rules = $.validator.normalizeRule(validator.settings.rules[element.name]) || {};
		}
		return rules;
	},

	normalizeRules: function( rules, element ) {
		// handle dependency check
		$.each(rules, function( prop, val ) {
			// ignore rule when param is explicitly false, eg. required:false
			if ( val === false ) {
				delete rules[prop];
				return;
			}
			if ( val.param || val.depends ) {
				var keepRule = true;
				switch (typeof val.depends) {
				case "string":
					keepRule = !!$(val.depends, element.form).length;
					break;
				case "function":
					keepRule = val.depends.call(element, element);
					break;
				}
				if ( keepRule ) {
					rules[prop] = val.param !== undefined ? val.param : true;
				} else {
					delete rules[prop];
				}
			}
		});

		// evaluate parameters
		$.each(rules, function( rule, parameter ) {
			rules[rule] = $.isFunction(parameter) ? parameter(element) : parameter;
		});

		// clean number parameters
		$.each(['minlength', 'maxlength'], function() {
			if ( rules[this] ) {
				rules[this] = Number(rules[this]);
			}
		});
		$.each(['rangelength'], function() {
			var parts;
			if ( rules[this] ) {
				if ( $.isArray(rules[this]) ) {
					rules[this] = [Number(rules[this][0]), Number(rules[this][1])];
				} else if ( typeof rules[this] === "string" ) {
					parts = rules[this].split(/[\s,]+/);
					rules[this] = [Number(parts[0]), Number(parts[1])];
				}
			}
		});

		if ( $.validator.autoCreateRanges ) {
			// auto-create ranges
			if ( rules.min && rules.max ) {
				rules.range = [rules.min, rules.max];
				delete rules.min;
				delete rules.max;
			}
			if ( rules.minlength && rules.maxlength ) {
				rules.rangelength = [rules.minlength, rules.maxlength];
				delete rules.minlength;
				delete rules.maxlength;
			}
		}

		return rules;
	},

	// Converts a simple string to a {string: true} rule, e.g., "required" to {required:true}
	normalizeRule: function( data ) {
		if ( typeof data === "string" ) {
			var transformed = {};
			$.each(data.split(/\s/), function() {
				transformed[this] = true;
			});
			data = transformed;
		}
		return data;
	},

	// http://docs.jquery.com/Plugins/Validation/Validator/addMethod
	addMethod: function( name, method, message ) {
		$.validator.methods[name] = method;
		$.validator.messages[name] = message !== undefined ? message : $.validator.messages[name];
		if ( method.length < 3 ) {
			$.validator.addClassRules(name, $.validator.normalizeRule(name));
		}
	},

	methods: {

		// http://docs.jquery.com/Plugins/Validation/Methods/required
		required: function( value, element, param ) {
			// check if dependency is met
			if ( !this.depend(param, element) ) {
				return "dependency-mismatch";
			}
			if ( element.nodeName.toLowerCase() === "select" ) {
				// could be an array for select-multiple or a string, both are fine this way
				var val = $(element).val();
				return val && val.length > 0;
			}
			if ( this.checkable(element) ) {
				return this.getLength(value, element) > 0;
			}
			return $.trim(value).length > 0;
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/remote
		remote: function( value, element, param ) {
			if ( this.optional(element) ) {
				return "dependency-mismatch";
			}

			var previous = this.previousValue(element);
			if (!this.settings.messages[element.name] ) {
				this.settings.messages[element.name] = {};
			}
			previous.originalMessage = this.settings.messages[element.name].remote;
			this.settings.messages[element.name].remote = previous.message;

			param = typeof param === "string" && {url:param} || param;

			if ( previous.old === value ) {
				return previous.valid;
			}

			previous.old = value;
			var validator = this;
			this.startRequest(element);
			var data = {};
			data[element.name] = value;
			$.ajax($.extend(true, {
				url: param,
				mode: "abort",
				port: "validate" + element.name,
				dataType: "json",
				data: data,
				success: function( response ) {
					validator.settings.messages[element.name].remote = previous.originalMessage;
					var valid = response === true || response === "true";
					if ( valid ) {
						var submitted = validator.formSubmitted;
						validator.prepareElement(element);
						validator.formSubmitted = submitted;
						validator.successList.push(element);
						delete validator.invalid[element.name];
						validator.showErrors();
					} else {
						var errors = {};
						var message = response || validator.defaultMessage( element, "remote" );
						errors[element.name] = previous.message = $.isFunction(message) ? message(value) : message;
						validator.invalid[element.name] = true;
						validator.showErrors(errors);
					}
					previous.valid = valid;
					validator.stopRequest(element, valid);
				}
			}, param));
			return "pending";
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/minlength
		minlength: function( value, element, param ) {
			var length = $.isArray( value ) ? value.length : this.getLength($.trim(value), element);
			return this.optional(element) || length >= param;
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/maxlength
		maxlength: function( value, element, param ) {
			var length = $.isArray( value ) ? value.length : this.getLength($.trim(value), element);
			return this.optional(element) || length <= param;
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/rangelength
		rangelength: function( value, element, param ) {
			var length = $.isArray( value ) ? value.length : this.getLength($.trim(value), element);
			return this.optional(element) || ( length >= param[0] && length <= param[1] );
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/min
		min: function( value, element, param ) {
			return this.optional(element) || value >= param;
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/max
		max: function( value, element, param ) {
			return this.optional(element) || value <= param;
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/range
		range: function( value, element, param ) {
			return this.optional(element) || ( value >= param[0] && value <= param[1] );
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/email
		email: function( value, element ) {
			// contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
			return this.optional(element) || /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value);
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/url
		url: function( value, element ) {
			// contributed by Scott Gonzalez: http://projects.scottsplayground.com/iri/
			return this.optional(element) || /^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value);
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/date
		date: function( value, element ) {
			return this.optional(element) || !/Invalid|NaN/.test(new Date(value).toString());
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/dateISO
		dateISO: function( value, element ) {
			return this.optional(element) || /^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(value);
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/number
		number: function( value, element ) {
			return this.optional(element) || /^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(value);
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/digits
		digits: function( value, element ) {
			return this.optional(element) || /^\d+$/.test(value);
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/creditcard
		// based on http://en.wikipedia.org/wiki/Luhn
		creditcard: function( value, element ) {
			if ( this.optional(element) ) {
				return "dependency-mismatch";
			}
			// accept only spaces, digits and dashes
			if ( /[^0-9 \-]+/.test(value) ) {
				return false;
			}
			var nCheck = 0,
				nDigit = 0,
				bEven = false;

			value = value.replace(/\D/g, "");

			for (var n = value.length - 1; n >= 0; n--) {
				var cDigit = value.charAt(n);
				nDigit = parseInt(cDigit, 10);
				if ( bEven ) {
					if ( (nDigit *= 2) > 9 ) {
						nDigit -= 9;
					}
				}
				nCheck += nDigit;
				bEven = !bEven;
			}

			return (nCheck % 10) === 0;
		},

		// http://docs.jquery.com/Plugins/Validation/Methods/equalTo
		equalTo: function( value, element, param ) {
			// bind to the blur event of the target in order to revalidate whenever the target field is updated
			// TODO find a way to bind the event just once, avoiding the unbind-rebind overhead
			var target = $(param);
			if ( this.settings.onfocusout ) {
				target.unbind(".validate-equalTo").bind("blur.validate-equalTo", function() {
					$(element).valid();
				});
			}
			return value === target.val();
		}

	}

});

// deprecated, use $.validator.format instead
$.format = $.validator.format;

}(jQuery));

// ajax mode: abort
// usage: $.ajax({ mode: "abort"[, port: "uniqueport"]});
// if mode:"abort" is used, the previous request on that port (port can be undefined) is aborted via XMLHttpRequest.abort()
(function($) {
	var pendingRequests = {};
	// Use a prefilter if available (1.5+)
	if ( $.ajaxPrefilter ) {
		$.ajaxPrefilter(function( settings, _, xhr ) {
			var port = settings.port;
			if ( settings.mode === "abort" ) {
				if ( pendingRequests[port] ) {
					pendingRequests[port].abort();
				}
				pendingRequests[port] = xhr;
			}
		});
	} else {
		// Proxy ajax
		var ajax = $.ajax;
		$.ajax = function( settings ) {
			var mode = ( "mode" in settings ? settings : $.ajaxSettings ).mode,
				port = ( "port" in settings ? settings : $.ajaxSettings ).port;
			if ( mode === "abort" ) {
				if ( pendingRequests[port] ) {
					pendingRequests[port].abort();
				}
				return (pendingRequests[port] = ajax.apply(this, arguments));
			}
			return ajax.apply(this, arguments);
		};
	}
}(jQuery));

// provides delegate(type: String, delegate: Selector, handler: Callback) plugin for easier event delegation
// handler is only called when $(event.target).is(delegate), in the scope of the jquery-object for event.target
(function($) {
	$.extend($.fn, {
		validateDelegate: function( delegate, type, handler ) {
			return this.bind(type, function( event ) {
				var target = $(event.target);
				if ( target.is(delegate) ) {
					return handler.apply(target, arguments);
				}
			});
		}
	});
}(jQuery));

/**
 * @author zhixin wen <wenzhixin2010@gmail.com>
 * @version 1.2.1
 *
 * http://wenzhixin.net.cn/p/multiple-select/
 */


(function ($) {

    'use strict';

    // it only does '%s', and return '' when arguments are undefined
    var sprintf = function (str) {
        var args = arguments,
            flag = true,
            i = 1;

        str = str.replace(/%s/g, function () {
            var arg = args[i++];

            if (typeof arg === 'undefined') {
                flag = false;
                return '';
            }
            return arg;
        });
        return flag ? str : '';
    };

    var removeDiacritics = function (str) {
        var defaultDiacriticsRemovalMap = [
            {'base':'A', 'letters':/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},
            {'base':'AA','letters':/[\uA732]/g},
            {'base':'AE','letters':/[\u00C6\u01FC\u01E2]/g},
            {'base':'AO','letters':/[\uA734]/g},
            {'base':'AU','letters':/[\uA736]/g},
            {'base':'AV','letters':/[\uA738\uA73A]/g},
            {'base':'AY','letters':/[\uA73C]/g},
            {'base':'B', 'letters':/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},
            {'base':'C', 'letters':/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},
            {'base':'D', 'letters':/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},
            {'base':'DZ','letters':/[\u01F1\u01C4]/g},
            {'base':'Dz','letters':/[\u01F2\u01C5]/g},
            {'base':'E', 'letters':/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},
            {'base':'F', 'letters':/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},
            {'base':'G', 'letters':/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},
            {'base':'H', 'letters':/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},
            {'base':'I', 'letters':/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},
            {'base':'J', 'letters':/[\u004A\u24BF\uFF2A\u0134\u0248]/g},
            {'base':'K', 'letters':/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},
            {'base':'L', 'letters':/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},
            {'base':'LJ','letters':/[\u01C7]/g},
            {'base':'Lj','letters':/[\u01C8]/g},
            {'base':'M', 'letters':/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},
            {'base':'N', 'letters':/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},
            {'base':'NJ','letters':/[\u01CA]/g},
            {'base':'Nj','letters':/[\u01CB]/g},
            {'base':'O', 'letters':/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},
            {'base':'OI','letters':/[\u01A2]/g},
            {'base':'OO','letters':/[\uA74E]/g},
            {'base':'OU','letters':/[\u0222]/g},
            {'base':'P', 'letters':/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},
            {'base':'Q', 'letters':/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},
            {'base':'R', 'letters':/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},
            {'base':'S', 'letters':/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},
            {'base':'T', 'letters':/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},
            {'base':'TZ','letters':/[\uA728]/g},
            {'base':'U', 'letters':/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},
            {'base':'V', 'letters':/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},
            {'base':'VY','letters':/[\uA760]/g},
            {'base':'W', 'letters':/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},
            {'base':'X', 'letters':/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},
            {'base':'Y', 'letters':/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},
            {'base':'Z', 'letters':/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},
            {'base':'a', 'letters':/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},
            {'base':'aa','letters':/[\uA733]/g},
            {'base':'ae','letters':/[\u00E6\u01FD\u01E3]/g},
            {'base':'ao','letters':/[\uA735]/g},
            {'base':'au','letters':/[\uA737]/g},
            {'base':'av','letters':/[\uA739\uA73B]/g},
            {'base':'ay','letters':/[\uA73D]/g},
            {'base':'b', 'letters':/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},
            {'base':'c', 'letters':/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},
            {'base':'d', 'letters':/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},
            {'base':'dz','letters':/[\u01F3\u01C6]/g},
            {'base':'e', 'letters':/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},
            {'base':'f', 'letters':/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},
            {'base':'g', 'letters':/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},
            {'base':'h', 'letters':/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},
            {'base':'hv','letters':/[\u0195]/g},
            {'base':'i', 'letters':/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},
            {'base':'j', 'letters':/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},
            {'base':'k', 'letters':/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},
            {'base':'l', 'letters':/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},
            {'base':'lj','letters':/[\u01C9]/g},
            {'base':'m', 'letters':/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},
            {'base':'n', 'letters':/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},
            {'base':'nj','letters':/[\u01CC]/g},
            {'base':'o', 'letters':/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},
            {'base':'oi','letters':/[\u01A3]/g},
            {'base':'ou','letters':/[\u0223]/g},
            {'base':'oo','letters':/[\uA74F]/g},
            {'base':'p','letters':/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},
            {'base':'q','letters':/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},
            {'base':'r','letters':/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},
            {'base':'s','letters':/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},
            {'base':'t','letters':/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},
            {'base':'tz','letters':/[\uA729]/g},
            {'base':'u','letters':/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},
            {'base':'v','letters':/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},
            {'base':'vy','letters':/[\uA761]/g},
            {'base':'w','letters':/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},
            {'base':'x','letters':/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},
            {'base':'y','letters':/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},
            {'base':'z','letters':/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}
        ];

        for (var i = 0; i < defaultDiacriticsRemovalMap.length; i++) {
            str = str.replace(defaultDiacriticsRemovalMap[i].letters, defaultDiacriticsRemovalMap[i].base);
        }

        return str;

   };

    function MultipleSelect($el, options) {
        var that = this,
            name = $el.attr('name') || options.name || '';

        this.options = options;

        // hide select element
        this.$el = $el.hide();

        // label element
        this.$label = this.$el.closest('label');
        if (this.$label.length === 0 && this.$el.attr('id')) {
            this.$label = $(sprintf('label[for="%s"]', this.$el.attr('id').replace(/:/g, '\\:')));
        }

        // restore class and title from select element
        this.$parent = $(sprintf(
            '<div class="ms-parent %s" %s/>',
            $el.attr('class') || '',
            sprintf('title="%s"', $el.attr('title'))));

        // add placeholder to choice button
        this.$choice = $(sprintf([
                '<button type="button" class="ms-choice" aria-expanded="false">',
                '<span class="placeholder">%s</span>',
                '<div></div>',
                '</button>'
            ].join(''),
            this.options.placeholder));

        // default position is bottom
        this.$drop = $(sprintf('<div class="ms-drop %s"%s></div>',
            this.options.position,
            sprintf(' style="width: %s"', this.options.dropWidth)));

        this.$el.after(this.$parent);
        this.$parent.append(this.$choice);
        this.$parent.append(this.$drop);

        if (this.$el.prop('disabled')) {
            this.$choice.addClass('disabled');
        }
        this.$parent.css('width',
            this.options.width ||
            this.$el.css('width') ||
            this.$el.outerWidth() + 20);

        this.selectAllName = 'data-name="selectAll' + name + '"';
        this.selectGroupName = 'data-name="selectGroup' + name + '"';
        this.selectItemName = 'data-name="selectItem' + name + '"';

        if (!this.options.keepOpen) {
            $(document).click(function (e) {
                if ($(e.target)[0] === that.$choice[0] ||
                    $(e.target).parents('.ms-choice')[0] === that.$choice[0]) {
                    return;
                }
                if (($(e.target)[0] === that.$drop[0] ||
                    $(e.target).parents('.ms-drop')[0] !== that.$drop[0] && e.target !== $el[0]) &&
                    that.options.isOpen) {
                    that.close();
                }
            });
        }
    }

    MultipleSelect.prototype = {
        constructor: MultipleSelect,

        init: function () {
            var that = this,
                $ul = $('<ul></ul>');

            this.$drop.html('');

            if (this.options.filter) {
                this.$drop.append([
                    '<div class="ms-search">',
                    '<input type="text" autocomplete="off" autocorrect="off" autocapitilize="off" spellcheck="false">',
                    '</div>'].join('')
                );
            }

            if (this.options.selectAll && !this.options.single) {
                $ul.append([
                    '<li class="ms-select-all">',
                    '<label>',
                    sprintf('<input type="checkbox" %s /> ', this.selectAllName),
                    this.options.selectAllDelimiter[0],
                    this.options.selectAllText,
                    this.options.selectAllDelimiter[1],
                    '</label>',
                    '</li>'
                ].join(''));
            }

            $.each(this.$el.children(), function (i, elm) {
                $ul.append(that.optionToHtml(i, elm));
            });
            $ul.append(sprintf('<li class="ms-no-results">%s</li>', this.options.noMatchesFound));
            this.$drop.append($ul);

            this.$drop.find('ul').css('max-height', this.options.maxHeight + 'px');
            this.$drop.find('.multiple').css('width', this.options.multipleWidth + 'px');

            this.$searchInput = this.$drop.find('.ms-search input');
            this.$selectAll = this.$drop.find('input[' + this.selectAllName + ']');
            this.$selectGroups = this.$drop.find('input[' + this.selectGroupName + ']');
            this.$selectItems = this.$drop.find('input[' + this.selectItemName + ']:enabled');
            this.$disableItems = this.$drop.find('input[' + this.selectItemName + ']:disabled');
            this.$noResults = this.$drop.find('.ms-no-results');

            this.events();
            this.updateSelectAll(true);
            this.update(true);

            if (this.options.isOpen) {
                this.open();
            }
        },

        optionToHtml: function (i, elm, group, groupDisabled) {
            var that = this,
                $elm = $(elm),
                classes = $elm.attr('class') || '',
                title = sprintf('title="%s"', $elm.attr('title')),
                multiple = this.options.multiple ? 'multiple' : '',
                disabled,
                type = this.options.single ? 'radio' : 'checkbox';

            if ($elm.is('option')) {
                var value = $elm.val(),
                    text = that.options.textTemplate($elm),
                    selected = $elm.prop('selected'),
                    style = sprintf('style="%s"', this.options.styler(value)),
                    $el;

                disabled = groupDisabled || $elm.prop('disabled');

                $el = $([
                    sprintf('<li class="%s %s" %s %s>', multiple, classes, title, style),
                    sprintf('<label class="%s">', disabled ? 'disabled' : ''),
                    sprintf('<input type="%s" %s%s%s%s>',
                        type, this.selectItemName,
                        selected ? ' checked="checked"' : '',
                        disabled ? ' disabled="disabled"' : '',
                        sprintf(' data-group="%s"', group)),
                    sprintf('<span>%s</span>', text),
                    '</label>',
                    '</li>'
                ].join(''));
                $el.find('input').val(value);
                return $el;
            }
            if ($elm.is('optgroup')) {
                var label = that.options.labelTemplate($elm),
                    $group = $('<div/>');

                group = 'group_' + i;
                disabled = $elm.prop('disabled');

                $group.append([
                    '<li class="group">',
                    sprintf('<label class="optgroup %s" data-group="%s">', disabled ? 'disabled' : '', group),
                    this.options.hideOptgroupCheckboxes || this.options.single ? '' :
                        sprintf('<input type="checkbox" %s %s>',
                        this.selectGroupName, disabled ? 'disabled="disabled"' : ''),
                    label,
                    '</label>',
                    '</li>'
                ].join(''));

                $.each($elm.children(), function (i, elm) {
                    $group.append(that.optionToHtml(i, elm, group, disabled));
                });
                return $group.html();
            }
        },

        events: function () {
            var that = this,
                toggleOpen = function (e) {
                    e.preventDefault();
                    that[that.options.isOpen ? 'close' : 'open']();
                };

            if (this.$label) {
                this.$label.off('click').on('click', function (e) {
                    if (e.target.nodeName.toLowerCase() !== 'label' || e.target !== this) {
                        return;
                    }
                    toggleOpen(e);
                    if (!that.options.filter || !that.options.isOpen) {
                        that.focus();
                    }
                    e.stopPropagation(); // Causes lost focus otherwise
                });
            }

            this.$choice.off('click').on('click', toggleOpen)
                .off('focus').on('focus', this.options.onFocus)
                .off('blur').on('blur', this.options.onBlur);

            this.$parent.off('keydown').on('keydown', function (e) {
                switch (e.which) {
                    case 27: // esc key
                        that.close();
                        that.$choice.focus();
                        break;
                }
            });

            this.$searchInput.off('keydown').on('keydown',function (e) {
                // Ensure shift-tab causes lost focus from filter as with clicking away
                if (e.keyCode === 9 && e.shiftKey) {
                    that.close();
                }
            }).off('keyup').on('keyup', function (e) {
                // enter or space
                // Avoid selecting/deselecting if no choices made
                if (that.options.filterAcceptOnEnter && (e.which === 13 || e.which == 32) && that.$searchInput.val()) {
                    that.$selectAll.click();
                    that.close();
                    that.focus();
                    return;
                }
                that.filter();
            });

            this.$selectAll.off('click').on('click', function () {
                var checked = $(this).prop('checked'),
                    $items = that.$selectItems.filter(':visible');

                if ($items.length === that.$selectItems.length) {
                    that[checked ? 'checkAll' : 'uncheckAll']();
                } else { // when the filter option is true
                    that.$selectGroups.prop('checked', checked);
                    $items.prop('checked', checked);
                    that.options[checked ? 'onCheckAll' : 'onUncheckAll']();
                    that.update();
                }
            });
            this.$selectGroups.off('click').on('click', function () {
                var group = $(this).parent().attr('data-group'),
                    $items = that.$selectItems.filter(':visible'),
                    $children = $items.filter(sprintf('[data-group="%s"]', group)),
                    checked = $children.length !== $children.filter(':checked').length;

                $children.prop('checked', checked);
                that.updateSelectAll();
                that.update();
                that.options.onOptgroupClick({
                    label: $(this).parent().text(),
                    checked: checked,
                    children: $children.get(),
                    instance: that
                });
            });
            this.$selectItems.off('click').on('click', function () {
                that.updateSelectAll();
                that.update();
                that.updateOptGroupSelect();
                that.options.onClick({
                    label: $(this).parent().text(),
                    value: $(this).val(),
                    checked: $(this).prop('checked'),
                    instance: that
                });

                if (that.options.single && that.options.isOpen && !that.options.keepOpen) {
                    that.close();
                }

                if (that.options.single) {
                    var clickedVal = $(this).val();
                    that.$selectItems.filter(function() {
                        return $(this).val() !== clickedVal;
                    }).each(function() {
                        $(this).prop('checked', false);
                    });
                    that.update();
                }
            });
        },

        open: function () {
            if (this.$choice.hasClass('disabled')) {
                return;
            }
            this.$choice.attr("aria-expanded",true);
            this.options.isOpen = true;
            this.$choice.find('>div').addClass('open');
            this.$drop[this.animateMethod('show')]();

            // fix filter bug: no results show
            this.$selectAll.parent().show();
            this.$noResults.hide();

            // Fix #77: 'All selected' when no options
            if (!this.$el.children().length) {
                this.$selectAll.parent().hide();
                this.$noResults.show();
            }

            if (this.options.container) {
                var offset = this.$drop.offset();
                this.$drop.appendTo($(this.options.container));
                this.$drop.offset({
                    top: offset.top,
                    left: offset.left
                });
            }

            if (this.options.filter) {
                this.$searchInput.val('');
                this.$searchInput.focus();
                this.filter();
            }
            this.options.onOpen();
        },

        close: function () {
            this.options.isOpen = false;
            this.$choice.attr("aria-expanded",false);
            this.$choice.find('>div').removeClass('open');
            this.$drop[this.animateMethod('hide')]();
            if (this.options.container) {
                this.$parent.append(this.$drop);
                this.$drop.css({
                    'top': 'auto',
                    'left': 'auto'
                });
            }
            this.options.onClose();
        },

        animateMethod: function (method) {
            var methods = {
                show: {
                    fade: 'fadeIn',
                    slide: 'slideDown'
                },
                hide: {
                    fade: 'fadeOut',
                    slide: 'slideUp'
                }
            };

            return methods[method][this.options.animate] || method;
        },

        update: function (isInit) {
            var selects = this.options.displayValues ? this.getSelects() : this.getSelects('text'),
                $span = this.$choice.find('>span'),
                sl = selects.length;

            if (sl === 0) {
                $span.addClass('placeholder').html(this.options.placeholder);
            } else if (this.options.allSelected && sl === this.$selectItems.length + this.$disableItems.length) {
                $span.removeClass('placeholder').html(this.options.allSelected);
            } else if (this.options.ellipsis && sl > this.options.minimumCountSelected) {
                $span.removeClass('placeholder').text(selects.slice(0, this.options.minimumCountSelected)
                    .join(this.options.delimiter) + '...');
            } else if (this.options.countSelected && sl > this.options.minimumCountSelected) {
                $span.removeClass('placeholder').html(this.options.countSelected
                    .replace('#', selects.length)
                    .replace('%', this.$selectItems.length + this.$disableItems.length));
            } else {
                $span.removeClass('placeholder').text(selects.join(this.options.delimiter));
            }

            if (this.options.addTitle) {
                $span.prop('title', this.getSelects('text'));
            }

            // set selects to select
            this.$el.val(this.getSelects()).trigger('change');

            // add selected class to selected li
            this.$drop.find('li').removeClass('selected');
            this.$drop.find('input:checked').each(function () {
                $(this).parents('li').first().addClass('selected');
            });

            // trigger <select> change event
            if (!isInit) {
                this.$el.trigger('change');
            }
        },

        updateSelectAll: function (isInit) {
            var $items = this.$selectItems;

            if (!isInit) {
                $items = $items.filter(':visible');
            }
            this.$selectAll.prop('checked', $items.length &&
                $items.length === $items.filter(':checked').length);
            if (!isInit && this.$selectAll.prop('checked')) {
                this.options.onCheckAll();
            }
        },

        updateOptGroupSelect: function () {
            var $items = this.$selectItems.filter(':visible');
            $.each(this.$selectGroups, function (i, val) {
                var group = $(val).parent().attr('data-group'),
                    $children = $items.filter(sprintf('[data-group="%s"]', group));
                $(val).prop('checked', $children.length &&
                    $children.length === $children.filter(':checked').length);
            });
        },

        //value or text, default: 'value'
        getSelects: function (type) {
            var that = this,
                texts = [],
                values = [];
            this.$drop.find(sprintf('input[%s]:checked', this.selectItemName)).each(function () {
                texts.push($(this).parents('li').first().text());
                values.push($(this).val());
            });

            if (type === 'text' && this.$selectGroups.length) {
                texts = [];
                this.$selectGroups.each(function () {
                    var html = [],
                        text = $.trim($(this).parent().text()),
                        group = $(this).parent().data('group'),
                        $children = that.$drop.find(sprintf('[%s][data-group="%s"]', that.selectItemName, group)),
                        $selected = $children.filter(':checked');

                    if (!$selected.length) {
                        return;
                    }

                    html.push('[');
                    html.push(text);
                    if ($children.length > $selected.length) {
                        var list = [];
                        $selected.each(function () {
                            list.push($(this).parent().text());
                        });
                        html.push(': ' + list.join(', '));
                    }
                    html.push(']');
                    texts.push(html.join(''));
                });
            }
            return type === 'text' ? texts : values;
        },

        setSelects: function (values) {
            var that = this;
            this.$selectItems.prop('checked', false);
            this.$disableItems.prop('checked', false);
            $.each(values, function (i, value) {
                that.$selectItems.filter(sprintf('[value="%s"]', value)).prop('checked', true);
                that.$disableItems.filter(sprintf('[value="%s"]', value)).prop('checked', true);
            });
            this.$selectAll.prop('checked', this.$selectItems.length ===
                this.$selectItems.filter(':checked').length + this.$disableItems.filter(':checked').length);

            $.each(that.$selectGroups, function (i, val) {
                var group = $(val).parent().attr('data-group'),
                    $children = that.$selectItems.filter('[data-group="' + group + '"]');
                $(val).prop('checked', $children.length &&
                    $children.length === $children.filter(':checked').length);
            });

            this.update();
        },

        enable: function () {
            this.$choice.removeClass('disabled');
        },

        disable: function () {
            this.$choice.addClass('disabled');
        },

        checkAll: function () {
            this.$selectItems.prop('checked', true);
            this.$selectGroups.prop('checked', true);
            this.$selectAll.prop('checked', true);
            this.update();
            this.options.onCheckAll();
        },

        uncheckAll: function () {
            this.$selectItems.prop('checked', false);
            this.$selectGroups.prop('checked', false);
            this.$selectAll.prop('checked', false);
            this.update();
            this.options.onUncheckAll();
        },

        focus: function () {
            this.$choice.focus();
            this.options.onFocus();
        },

        blur: function () {
            this.$choice.blur();
            this.options.onBlur();
        },

        refresh: function () {
            this.init();
        },
		
        destroy: function () {
            this.$el.show();
            this.$parent.remove();
            this.$el.data('multipleSelect', null);
        },

        filter: function () {
            var that = this,
                text = $.trim(this.$searchInput.val()).toLowerCase();

            if (text.length === 0) {
                this.$selectAll.parent().show();
                this.$selectItems.parent().show();
                this.$disableItems.parent().show();
                this.$selectGroups.parent().show();
                this.$noResults.hide();
            } else {
                this.$selectItems.each(function () {
                    var $parent = $(this).parent();
                    $parent[removeDiacritics($parent.text().toLowerCase()).indexOf(removeDiacritics(text)) < 0 ? 'hide' : 'show']();
                });
                this.$disableItems.parent().hide();
                this.$selectGroups.each(function () {
                    var $parent = $(this).parent();
                    var group = $parent.attr('data-group'),
                        $items = that.$selectItems.filter(':visible');
                    $parent[$items.filter(sprintf('[data-group="%s"]', group)).length ? 'show' : 'hide']();
                });

                //Check if no matches found
                if (this.$selectItems.parent().filter(':visible').length) {
                    this.$selectAll.parent().show();
                    this.$noResults.hide();
                } else {
                    this.$selectAll.parent().hide();
                    this.$noResults.show();
                }
            }
            this.updateOptGroupSelect();
            this.updateSelectAll();
            this.options.onFilter(text);
        }
    };

    $.fn.multipleSelect = function () {
        var option = arguments[0],
            args = arguments,

            value,
            allowedMethods = [
                'getSelects', 'setSelects',
                'enable', 'disable',
                'open', 'close',
                'checkAll', 'uncheckAll',
                'focus', 'blur',
                'refresh', 'destroy'
            ];

        this.each(function () {
            var $this = $(this),
                data = $this.data('multipleSelect'),
                options = $.extend({}, $.fn.multipleSelect.defaults,
                    $this.data(), typeof option === 'object' && option);

            if (!data) {
                data = new MultipleSelect($this, options);
                $this.data('multipleSelect', data);
            }

            if (typeof option === 'string') {
                if ($.inArray(option, allowedMethods) < 0) {
                    throw 'Unknown method: ' + option;
                }
                value = data[option](args[1]);
            } else {
                data.init();
                if (args[1]) {
                    value = data[args[1]].apply(data, [].slice.call(args, 2));
                }
            }
        });

        return typeof value !== 'undefined' ? value : this;
    };

    $.fn.multipleSelect.defaults = {
        name: '',
        isOpen: false,
        placeholder: '',
        selectAll: true,
        selectAllDelimiter: ['[', ']'],
        minimumCountSelected: 3,
        ellipsis: false,
        multiple: false,
        multipleWidth: 80,
        single: false,
        filter: false,
        width: undefined,
        dropWidth: undefined,
        maxHeight: 250,
        container: null,
        position: 'bottom',
        keepOpen: false,
        animate: 'none', // 'none', 'fade', 'slide'
        displayValues: false,
        delimiter: ', ',
        addTitle: false,
        filterAcceptOnEnter: false,
        hideOptgroupCheckboxes: false,

        selectAllText: 'Select all',
        allSelected: 'All selected',
        countSelected: '# of % selected',
        noMatchesFound: 'No matches found',

        styler: function () {
            return false;
        },
        textTemplate: function ($elm) {
            return $elm.html();
        },
        labelTemplate: function ($elm) {
            return $elm.attr('label');
        },

        onOpen: function () {
            return false;
        },
        onClose: function () {
            return false;
        },
        onCheckAll: function () {
            return false;
        },
        onUncheckAll: function () {
            return false;
        },
        onFocus: function () {
            return false;
        },
        onBlur: function () {
            return false;
        },
        onOptgroupClick: function () {
            return false;
        },
        onClick: function () {
            return false;
        },
        onFilter: function () {
            return false;
        }
    };
})(jQuery);

/*!
 DataTables 1.10.13
 2008-2016 SpryMedia Ltd - datatables.net/license
*/
/*
 Edited for pagination accessibility fix - Arjun , Anjali
 * */
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e,window,document)}):"object"==typeof exports?module.exports=function(e,n){return e||(e=window),n||(n="undefined"!=typeof window?require("jquery"):require("jquery")(e)),t(n,e,e.document)}:t(jQuery,window,document)}(function(t,e,n,a){"use strict";function r(e){var n,a,o={};t.each(e,function(t,i){(n=t.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(n[1]+" ")&&(a=t.replace(n[0],n[2].toLowerCase()),o[a]=t,"o"===n[1]&&r(e[t]))}),e._hungarianMap=o}function o(e,n,i){e._hungarianMap||r(e);var s;t.each(n,function(r,l){(s=e._hungarianMap[r])===a||!i&&n[s]!==a||("o"===s.charAt(0)?(n[s]||(n[s]={}),t.extend(!0,n[s],n[r]),o(e[s],n[s],i)):n[s]=n[r])})}function i(t){var e=qt.defaults.oLanguage,n=t.sZeroRecords;!t.sEmptyTable&&n&&"No data available in table"===e.sEmptyTable&&Pt(t,t,"sZeroRecords","sEmptyTable"),!t.sLoadingRecords&&n&&"Loading..."===e.sLoadingRecords&&Pt(t,t,"sZeroRecords","sLoadingRecords"),t.sInfoThousands&&(t.sThousands=t.sInfoThousands);var a=t.sDecimal;a&&Ut(a)}function s(t){fe(t,"ordering","bSort"),fe(t,"orderMulti","bSortMulti"),fe(t,"orderClasses","bSortClasses"),fe(t,"orderCellsTop","bSortCellsTop"),fe(t,"order","aaSorting"),fe(t,"orderFixed","aaSortingFixed"),fe(t,"paging","bPaginate"),fe(t,"pagingType","sPaginationType"),fe(t,"pageLength","iDisplayLength"),fe(t,"searching","bFilter"),"boolean"==typeof t.sScrollX&&(t.sScrollX=t.sScrollX?"100%":""),"boolean"==typeof t.scrollX&&(t.scrollX=t.scrollX?"100%":"");var e=t.aoSearchCols;if(e)for(var n=0,a=e.length;n<a;n++)e[n]&&o(qt.models.oSearch,e[n])}function l(e){fe(e,"orderable","bSortable"),fe(e,"orderData","aDataSort"),fe(e,"orderSequence","asSorting"),fe(e,"orderDataType","sortDataType");var n=e.aDataSort;n&&!t.isArray(n)&&(e.aDataSort=[n])}function u(n){if(!qt.__browser){var a={};qt.__browser=a;var r=t("<div/>").css({position:"fixed",top:0,left:-1*t(e).scrollLeft(),height:1,width:1,overflow:"hidden"}).append(t("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(t("<div/>").css({width:"100%",height:10}))).appendTo("body"),o=r.children(),i=o.children();a.barWidth=o[0].offsetWidth-o[0].clientWidth,a.bScrollOversize=100===i[0].offsetWidth&&100!==o[0].clientWidth,a.bScrollbarLeft=1!==Math.round(i.offset().left),a.bBounding=!!r[0].getBoundingClientRect().width,r.remove()}t.extend(n.oBrowser,qt.__browser),n.oScroll.iBarWidth=qt.__browser.barWidth}function c(t,e,n,r,o,i){var s,l=r,u=!1;for(n!==a&&(s=n,u=!0);l!==o;)t.hasOwnProperty(l)&&(s=u?e(s,t[l],l,t):t[l],u=!0,l+=i);return s}function f(e,a){var r=qt.defaults.column,o=e.aoColumns.length,i=t.extend({},qt.models.oColumn,r,{nTh:a||n.createElement("th"),sTitle:r.sTitle?r.sTitle:a?a.innerHTML:"",aDataSort:r.aDataSort?r.aDataSort:[o],mData:r.mData?r.mData:o,idx:o});e.aoColumns.push(i);var s=e.aoPreSearchCols;s[o]=t.extend({},qt.models.oSearch,s[o]),d(e,o,t(a).data())}function d(e,n,r){var i=e.aoColumns[n],s=e.oClasses,u=t(i.nTh);if(!i.sWidthOrig){i.sWidthOrig=u.attr("width")||null;var c=(u.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);c&&(i.sWidthOrig=c[1])}r!==a&&null!==r&&(l(r),o(qt.defaults.column,r),r.mDataProp===a||r.mData||(r.mData=r.mDataProp),r.sType&&(i._sManualType=r.sType),r.className&&!r.sClass&&(r.sClass=r.className),t.extend(i,r),Pt(i,r,"sWidth","sWidthOrig"),r.iDataSort!==a&&(i.aDataSort=[r.iDataSort]),Pt(i,r,"aDataSort"));var f=i.mData,d=w(f),h=i.mRender?w(i.mRender):null,p=function(t){return"string"==typeof t&&-1!==t.indexOf("@")};i._bAttrSrc=t.isPlainObject(f)&&(p(f.sort)||p(f.type)||p(f.filter)),i._setter=null,i.fnGetData=function(t,e,n){var r=d(t,e,a,n);return h&&e?h(r,e,t,n):r},i.fnSetData=function(t,e,n){return x(f)(t,e,n)},"number"!=typeof f&&(e._rowReadObject=!0),e.oFeatures.bSort||(i.bSortable=!1,u.addClass(s.sSortableNone));var g=-1!==t.inArray("asc",i.asSorting),b=-1!==t.inArray("desc",i.asSorting);i.bSortable&&(g||b)?g&&!b?(i.sSortingClass=s.sSortableAsc,i.sSortingClassJUI=s.sSortJUIAscAllowed):!g&&b?(i.sSortingClass=s.sSortableDesc,i.sSortingClassJUI=s.sSortJUIDescAllowed):(i.sSortingClass=s.sSortable,i.sSortingClassJUI=s.sSortJUI):(i.sSortingClass=s.sSortableNone,i.sSortingClassJUI="")}function h(t){if(!1!==t.oFeatures.bAutoWidth){var e=t.aoColumns;gt(t);for(var n=0,a=e.length;n<a;n++)e[n].nTh.style.width=e[n].sWidth}var r=t.oScroll;""===r.sY&&""===r.sX||ht(t),Nt(t,null,"column-sizing",[t])}function p(t,e){var n=v(t,"bVisible");return"number"==typeof n[e]?n[e]:null}function g(e,n){var a=v(e,"bVisible"),r=t.inArray(n,a);return-1!==r?r:null}function b(e){var n=0;return t.each(e.aoColumns,function(e,a){a.bVisible&&"none"!==t(a.nTh).css("display")&&n++}),n}function v(e,n){var a=[];return t.map(e.aoColumns,function(t,e){t[n]&&a.push(e)}),a}function S(t){var e,n,r,o,i,s,l,u,c,f=t.aoColumns,d=t.aoData,h=qt.ext.type.detect;for(e=0,n=f.length;e<n;e++)if(l=f[e],c=[],!l.sType&&l._sManualType)l.sType=l._sManualType;else if(!l.sType){for(r=0,o=h.length;r<o;r++){for(i=0,s=d.length;i<s&&(c[i]===a&&(c[i]=_(t,i,e,"type")),(u=h[r](c[i],t))||r===h.length-1)&&"html"!==u;i++);if(u){l.sType=u;break}}l.sType||(l.sType="string")}}function m(e,n,r,o){var i,s,l,u,c,d,h,p=e.aoColumns;if(n)for(i=n.length-1;i>=0;i--){var g=(h=n[i]).targets!==a?h.targets:h.aTargets;for(t.isArray(g)||(g=[g]),l=0,u=g.length;l<u;l++)if("number"==typeof g[l]&&g[l]>=0){for(;p.length<=g[l];)f(e);o(g[l],h)}else if("number"==typeof g[l]&&g[l]<0)o(p.length+g[l],h);else if("string"==typeof g[l])for(c=0,d=p.length;c<d;c++)("_all"==g[l]||t(p[c].nTh).hasClass(g[l]))&&o(c,h)}if(r)for(i=0,s=r.length;i<s;i++)o(i,r[i])}function D(e,n,r,o){var i=e.aoData.length,s=t.extend(!0,{},qt.models.oRow,{src:r?"dom":"data",idx:i});s._aData=n,e.aoData.push(s);for(var l=e.aoColumns,u=0,c=l.length;u<c;u++)l[u].sType=null;e.aiDisplayMaster.push(i);var f=e.rowIdFn(n);return f!==a&&(e.aIds[f]=s),!r&&e.oFeatures.bDeferRender||R(e,i,r,o),i}function y(e,n){var a;return n instanceof t||(n=t(n)),n.map(function(t,n){return a=P(e,n),D(e,a.data,n,a.cells)})}function _(t,e,n,r){var o=t.iDraw,i=t.aoColumns[n],s=t.aoData[e]._aData,l=i.sDefaultContent,u=i.fnGetData(s,r,{settings:t,row:e,col:n});if(u===a)return t.iDrawError!=o&&null===l&&(Lt(t,0,"Requested unknown parameter "+("function"==typeof i.mData?"{function}":"'"+i.mData+"'")+" for row "+e+", column "+n,4),t.iDrawError=o),l;if(u!==s&&null!==u||null===l||r===a){if("function"==typeof u)return u.call(s)}else u=l;return null===u&&"display"==r?"":u}function T(t,e,n,a){var r=t.aoColumns[n],o=t.aoData[e]._aData;r.fnSetData(o,a,{settings:t,row:e,col:n})}function C(e){return t.map(e.match(/(\\.|[^\.])+/g)||[""],function(t){return t.replace(/\\\./g,".")})}function w(e){if(t.isPlainObject(e)){var n={};return t.each(e,function(t,e){e&&(n[t]=w(e))}),function(t,e,r,o){var i=n[e]||n._;return i!==a?i(t,e,r,o):t}}if(null===e)return function(t){return t};if("function"==typeof e)return function(t,n,a,r){return e(t,n,a,r)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("[")&&-1===e.indexOf("("))return function(t,n){return t[e]};var r=function(e,n,o){var i,s,l,u;if(""!==o)for(var c=C(o),f=0,d=c.length;f<d;f++){if(i=c[f].match(de),s=c[f].match(he),i){if(c[f]=c[f].replace(de,""),""!==c[f]&&(e=e[c[f]]),l=[],c.splice(0,f+1),u=c.join("."),t.isArray(e))for(var h=0,p=e.length;h<p;h++)l.push(r(e[h],n,u));var g=i[0].substring(1,i[0].length-1);e=""===g?l:l.join(g);break}if(s)c[f]=c[f].replace(he,""),e=e[c[f]]();else{if(null===e||e[c[f]]===a)return a;e=e[c[f]]}}return e};return function(t,n){return r(t,n,e)}}function x(e){if(t.isPlainObject(e))return x(e._);if(null===e)return function(){};if("function"==typeof e)return function(t,n,a){e(t,"set",n,a)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("[")&&-1===e.indexOf("("))return function(t,n){t[e]=n};var n=function(e,r,o){for(var i,s,l,u,c,f=C(o),d=f[f.length-1],h=0,p=f.length-1;h<p;h++){if(s=f[h].match(de),l=f[h].match(he),s){if(f[h]=f[h].replace(de,""),e[f[h]]=[],(i=f.slice()).splice(0,h+1),c=i.join("."),t.isArray(r))for(var g=0,b=r.length;g<b;g++)n(u={},r[g],c),e[f[h]].push(u);else e[f[h]]=r;return}l&&(f[h]=f[h].replace(he,""),e=e[f[h]](r)),null!==e[f[h]]&&e[f[h]]!==a||(e[f[h]]={}),e=e[f[h]]}d.match(he)?e=e[d.replace(he,"")](r):e[d.replace(de,"")]=r};return function(t,a){return n(t,a,e)}}function I(t){return oe(t.aoData,"_aData")}function A(t){t.aoData.length=0,t.aiDisplayMaster.length=0,t.aiDisplay.length=0,t.aIds={}}function F(t,e,n){for(var r=-1,o=0,i=t.length;o<i;o++)t[o]==e?r=o:t[o]>e&&t[o]--;-1!=r&&n===a&&t.splice(r,1)}function L(t,e,n,r){var o,i,s=t.aoData[e],l=function(n,a){for(;n.childNodes.length;)n.removeChild(n.firstChild);n.innerHTML=_(t,e,a,"display")};if("dom"!==n&&(n&&"auto"!==n||"dom"!==s.src)){var u=s.anCells;if(u)if(r!==a)l(u[r],r);else for(o=0,i=u.length;o<i;o++)l(u[o],o)}else s._aData=P(t,s,r,r===a?a:s._aData).data;s._aSortData=null,s._aFilterData=null;var c=t.aoColumns;if(r!==a)c[r].sType=null;else{for(o=0,i=c.length;o<i;o++)c[o].sType=null;j(t,s)}}function P(e,n,r,o){var i,s,l,u=[],c=n.firstChild,f=0,d=e.aoColumns,h=e._rowReadObject;o=o!==a?o:h?{}:[];var p=function(t,e){if("string"==typeof t){var n=t.indexOf("@");if(-1!==n){var a=t.substring(n+1);x(t)(o,e.getAttribute(a))}}},g=function(e){r!==a&&r!==f||(s=d[f],l=t.trim(e.innerHTML),s&&s._bAttrSrc?(x(s.mData._)(o,l),p(s.mData.sort,e),p(s.mData.type,e),p(s.mData.filter,e)):h?(s._setter||(s._setter=x(s.mData)),s._setter(o,l)):o[f]=l),f++};if(c)for(;c;)"TD"!=(i=c.nodeName.toUpperCase())&&"TH"!=i||(g(c),u.push(c)),c=c.nextSibling;else for(var b=0,v=(u=n.anCells).length;b<v;b++)g(u[b]);var S=n.firstChild?n:n.nTr;if(S){var m=S.getAttribute("id");m&&x(e.rowId)(o,m)}return{data:o,cells:u}}function R(e,a,r,o){var i,s,l,u,c,f=e.aoData[a],d=f._aData,h=[];if(null===f.nTr){for(i=r||n.createElement("tr"),f.nTr=i,f.anCells=h,i._DT_RowIndex=a,j(e,f),u=0,c=e.aoColumns.length;u<c;u++)l=e.aoColumns[u],(s=r?o[u]:n.createElement(l.sCellType))._DT_CellIndex={row:a,column:u},h.push(s),r&&!l.mRender&&l.mData===u||t.isPlainObject(l.mData)&&l.mData._===u+".display"||(s.innerHTML=_(e,a,u,"display")),l.sClass&&(s.className+=" "+l.sClass),l.bVisible&&!r?i.appendChild(s):!l.bVisible&&r&&s.parentNode.removeChild(s),l.fnCreatedCell&&l.fnCreatedCell.call(e.oInstance,s,_(e,a,u),d,a,u);Nt(e,"aoRowCreatedCallback",null,[i,d,a])}f.nTr.setAttribute("role","row")}function j(e,n){var a=n.nTr,r=n._aData;if(a){var o=e.rowIdFn(r);if(o&&(a.id=o),r.DT_RowClass){var i=r.DT_RowClass.split(" ");n.__rowc=n.__rowc?ce(n.__rowc.concat(i)):i,t(a).removeClass(n.__rowc.join(" ")).addClass(r.DT_RowClass)}r.DT_RowAttr&&t(a).attr(r.DT_RowAttr),r.DT_RowData&&t(a).data(r.DT_RowData)}}function H(e){var n,a,r,o,i,s=e.nTHead,l=e.nTFoot,u=0===t("th, td",s).length,c=e.oClasses,f=e.aoColumns;for(u&&(o=t("<tr/>").appendTo(s)),n=0,a=f.length;n<a;n++)i=f[n],r=t(i.nTh).addClass(i.sClass),u&&r.appendTo(o),e.oFeatures.bSort&&(r.addClass(i.sSortingClass),!1!==i.bSortable&&(r.attr("tabindex",e.iTabIndex).attr("aria-controls",e.sTableId),Ct(e,i.nTh,n))),i.sTitle!=r[0].innerHTML&&r.html(i.sTitle),kt(e,"header")(e,r,i,c);if(u&&W(e.aoHeader,s),t(s).find(">tr").attr("role","row"),t(s).find(">tr>th, >tr>td").addClass(c.sHeaderTH),t(l).find(">tr>th, >tr>td").addClass(c.sFooterTH),null!==l){var d=e.aoFooter[0];for(n=0,a=d.length;n<a;n++)(i=f[n]).nTf=d[n].cell,i.sClass&&t(i.nTf).addClass(i.sClass)}}function N(e,n,r){var o,i,s,l,u,c,f,d,h,p=[],g=[],b=e.aoColumns.length;if(n){for(r===a&&(r=!1),o=0,i=n.length;o<i;o++){for(p[o]=n[o].slice(),p[o].nTr=n[o].nTr,s=b-1;s>=0;s--)e.aoColumns[s].bVisible||r||p[o].splice(s,1);g.push([])}for(o=0,i=p.length;o<i;o++){if(f=p[o].nTr)for(;c=f.firstChild;)f.removeChild(c);for(s=0,l=p[o].length;s<l;s++)if(d=1,h=1,g[o][s]===a){for(f.appendChild(p[o][s].cell),g[o][s]=1;p[o+d]!==a&&p[o][s].cell==p[o+d][s].cell;)g[o+d][s]=1,d++;for(;p[o][s+h]!==a&&p[o][s].cell==p[o][s+h].cell;){for(u=0;u<d;u++)g[o+u][s+h]=1;h++}t(p[o][s].cell).attr("rowspan",d).attr("colspan",h)}}}}function O(e){var n=Nt(e,"aoPreDrawCallback","preDraw",[e]);if(-1===t.inArray(!1,n)){var r=[],o=0,i=e.asStripeClasses,s=i.length,l=(e.aoOpenRows.length,e.oLanguage),u=e.iInitDisplayStart,c="ssp"==Mt(e),f=e.aiDisplay;e.bDrawing=!0,u!==a&&-1!==u&&(e._iDisplayStart=c?u:u>=e.fnRecordsDisplay()?0:u,e.iInitDisplayStart=-1);var d=e._iDisplayStart,h=e.fnDisplayEnd();if(e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++,ft(e,!1);else if(c){if(!e.bDestroying&&!E(e))return}else e.iDraw++;if(0!==f.length)for(var p=c?0:d,g=c?e.aoData.length:h,v=p;v<g;v++){var S=f[v],m=e.aoData[S];null===m.nTr&&R(e,S);var D=m.nTr;if(0!==s){var y=i[o%s];m._sRowStripe!=y&&(t(D).removeClass(m._sRowStripe).addClass(y),m._sRowStripe=y)}Nt(e,"aoRowCallback",null,[D,m._aData,o,v]),r.push(D),o++}else{var _=l.sZeroRecords;1==e.iDraw&&"ajax"==Mt(e)?_=l.sLoadingRecords:l.sEmptyTable&&0===e.fnRecordsTotal()&&(_=l.sEmptyTable),r[0]=t("<tr/>",{class:s?i[0]:""}).append(t("<td />",{valign:"top",colSpan:b(e),class:e.oClasses.sRowEmpty}).html(_))[0]}Nt(e,"aoHeaderCallback","header",[t(e.nTHead).children("tr")[0],I(e),d,h,f]),Nt(e,"aoFooterCallback","footer",[t(e.nTFoot).children("tr")[0],I(e),d,h,f]);var T=t(e.nTBody);T.children().detach(),T.append(t(r)),Nt(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1}else ft(e,!1)}function k(t,e){var n=t.oFeatures,a=n.bSort,r=n.bFilter;a&&yt(t),r?G(t,t.oPreviousSearch):t.aiDisplay=t.aiDisplayMaster.slice(),!0!==e&&(t._iDisplayStart=0),t._drawHold=e,O(t),t._drawHold=!1}function M(e){var n=e.oClasses,a=t(e.nTable),r=t("<div/>").insertBefore(a),o=e.oFeatures,i=t("<div/>",{id:e.sTableId+"_wrapper",class:n.sWrapper+(e.nTFoot?"":" "+n.sNoFooter)});e.nHolding=r[0],e.nTableWrapper=i[0],e.nTableReinsertBefore=e.nTable.nextSibling;for(var s,l,u,c,f,d,h=e.sDom.split(""),p=0;p<h.length;p++){if(s=null,"<"==(l=h[p])){if(u=t("<div/>")[0],"'"==(c=h[p+1])||'"'==c){for(f="",d=2;h[p+d]!=c;)f+=h[p+d],d++;if("H"==f?f=n.sJUIHeader:"F"==f&&(f=n.sJUIFooter),-1!=f.indexOf(".")){var g=f.split(".");u.id=g[0].substr(1,g[0].length-1),u.className=g[1]}else"#"==f.charAt(0)?u.id=f.substr(1,f.length-1):u.className=f;p+=d}i.append(u),i=t(u)}else if(">"==l)i=i.parent();else if("l"==l&&o.bPaginate&&o.bLengthChange)s=st(e);else if("f"==l&&o.bFilter)s=q(e);else if("r"==l&&o.bProcessing)s=ct(e);else if("t"==l)s=dt(e);else if("i"==l&&o.bInfo)s=et(e);else if("p"==l&&o.bPaginate)s=lt(e);else if(0!==qt.ext.feature.length)for(var b=qt.ext.feature,v=0,S=b.length;v<S;v++)if(l==b[v].cFeature){s=b[v].fnInit(e);break}if(s){var m=e.aanFeatures;m[l]||(m[l]=[]),m[l].push(s),i.append(s)}}r.replaceWith(i),e.nHolding=null}function W(e,n){var a,r,o,i,s,l,u,c,f,d,h,p=t(n).children("tr");for(e.splice(0,e.length),o=0,l=p.length;o<l;o++)e.push([]);for(o=0,l=p.length;o<l;o++)for(c=0,r=(a=p[o]).firstChild;r;){if("TD"==r.nodeName.toUpperCase()||"TH"==r.nodeName.toUpperCase())for(f=1*r.getAttribute("colspan"),d=1*r.getAttribute("rowspan"),f=f&&0!==f&&1!==f?f:1,d=d&&0!==d&&1!==d?d:1,u=function(t,e,n){for(var a=t[e];a[n];)n++;return n}(e,o,c),h=1===f,s=0;s<f;s++)for(i=0;i<d;i++)e[o+i][u+s]={cell:r,unique:h},e[o+i].nTr=a;r=r.nextSibling}}function U(t,e,n){var a=[];n||(n=t.aoHeader,e&&W(n=[],e));for(var r=0,o=n.length;r<o;r++)for(var i=0,s=n[r].length;i<s;i++)!n[r][i].unique||a[i]&&t.bSortCellsTop||(a[i]=n[r][i].cell);return a}function B(e,n,a){if(Nt(e,"aoServerParams","serverParams",[n]),n&&t.isArray(n)){var r={},o=/(.*?)\[\]$/;t.each(n,function(t,e){var n=e.name.match(o);if(n){var a=n[0];r[a]||(r[a]=[]),r[a].push(e.value)}else r[e.name]=e.value}),n=r}var i,s=e.ajax,l=e.oInstance,u=function(t){Nt(e,null,"xhr",[e,t,e.jqXHR]),a(t)};if(t.isPlainObject(s)&&s.data){i=s.data;var c=t.isFunction(i)?i(n,e):i;n=t.isFunction(i)&&c?c:t.extend(!0,n,c),delete s.data}var f={data:n,success:function(t){var n=t.error||t.sError;n&&Lt(e,0,n),e.json=t,u(t)},dataType:"json",cache:!1,type:e.sServerMethod,error:function(n,a,r){var o=Nt(e,null,"xhr",[e,null,e.jqXHR]);-1===t.inArray(!0,o)&&("parsererror"==a?Lt(e,0,"Invalid JSON response",1):4===n.readyState&&Lt(e,0,"Ajax error",7)),ft(e,!1)}};e.oAjaxData=n,Nt(e,null,"preXhr",[e,n]),e.fnServerData?e.fnServerData.call(l,e.sAjaxSource,t.map(n,function(t,e){return{name:e,value:t}}),u,e):e.sAjaxSource||"string"==typeof s?e.jqXHR=t.ajax(t.extend(f,{url:s||e.sAjaxSource})):t.isFunction(s)?e.jqXHR=s.call(l,n,u,e):(e.jqXHR=t.ajax(t.extend(f,s)),s.data=i)}function E(t){return!t.bAjaxDataGet||(t.iDraw++,ft(t,!0),B(t,J(t),function(e){V(t,e)}),!1)}function J(e){var n,a,r,o,i=e.aoColumns,s=i.length,l=e.oFeatures,u=e.oPreviousSearch,c=e.aoPreSearchCols,f=[],d=Dt(e),h=e._iDisplayStart,p=!1!==l.bPaginate?e._iDisplayLength:-1,g=function(t,e){f.push({name:t,value:e})};g("sEcho",e.iDraw),g("iColumns",s),g("sColumns",oe(i,"sName").join(",")),g("iDisplayStart",h),g("iDisplayLength",p);var b={draw:e.iDraw,columns:[],order:[],start:h,length:p,search:{value:u.sSearch,regex:u.bRegex}};for(n=0;n<s;n++)r=i[n],o=c[n],a="function"==typeof r.mData?"function":r.mData,b.columns.push({data:a,name:r.sName,searchable:r.bSearchable,orderable:r.bSortable,search:{value:o.sSearch,regex:o.bRegex}}),g("mDataProp_"+n,a),l.bFilter&&(g("sSearch_"+n,o.sSearch),g("bRegex_"+n,o.bRegex),g("bSearchable_"+n,r.bSearchable)),l.bSort&&g("bSortable_"+n,r.bSortable);l.bFilter&&(g("sSearch",u.sSearch),g("bRegex",u.bRegex)),l.bSort&&(t.each(d,function(t,e){b.order.push({column:e.col,dir:e.dir}),g("iSortCol_"+t,e.col),g("sSortDir_"+t,e.dir)}),g("iSortingCols",d.length));var v=qt.ext.legacy.ajax;return null===v?e.sAjaxSource?f:b:v?f:b}function V(t,e){var n=function(t,n){return e[t]!==a?e[t]:e[n]},r=X(t,e),o=n("sEcho","draw"),i=n("iTotalRecords","recordsTotal"),s=n("iTotalDisplayRecords","recordsFiltered");if(o){if(1*o<t.iDraw)return;t.iDraw=1*o}A(t),t._iRecordsTotal=parseInt(i,10),t._iRecordsDisplay=parseInt(s,10);for(var l=0,u=r.length;l<u;l++)D(t,r[l]);t.aiDisplay=t.aiDisplayMaster.slice(),t.bAjaxDataGet=!1,O(t),t._bInitComplete||ot(t,e),t.bAjaxDataGet=!0,ft(t,!1)}function X(e,n){var r=t.isPlainObject(e.ajax)&&e.ajax.dataSrc!==a?e.ajax.dataSrc:e.sAjaxDataProp;return"data"===r?n.aaData||n[r]:""!==r?w(r)(n):n}function q(e){var a=e.oClasses,r=e.sTableId,o=e.oLanguage,i=e.oPreviousSearch,s=e.aanFeatures,l='<input type="search" class="'+a.sFilterInput+'"/>',u=o.sSearch;u=u.match(/_INPUT_/)?u.replace("_INPUT_",l):u+l;var c=t("<div/>",{id:s.f?null:r+"_filter",class:a.sFilter}).append(t("<label/>").append(u)),f=function(){s.f;var t=this.value?this.value:"";t!=i.sSearch&&(G(e,{sSearch:t,bRegex:i.bRegex,bSmart:i.bSmart,bCaseInsensitive:i.bCaseInsensitive}),e._iDisplayStart=0,O(e))},d=null!==e.searchDelay?e.searchDelay:"ssp"===Mt(e)?400:0,h=t("input",c).val(i.sSearch).attr("placeholder",o.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",d?Se(f,d):f).on("keypress.DT",function(t){if(13==t.keyCode)return!1}).attr("aria-controls",r);return t(e.nTable).on("search.dt.DT",function(t,a){if(e===a)try{h[0]!==n.activeElement&&h.val(i.sSearch)}catch(t){}}),c[0]}function G(t,e,n){var r=t.oPreviousSearch,o=t.aoPreSearchCols,i=function(t){r.sSearch=t.sSearch,r.bRegex=t.bRegex,r.bSmart=t.bSmart,r.bCaseInsensitive=t.bCaseInsensitive},s=function(t){return t.bEscapeRegex!==a?!t.bEscapeRegex:t.bRegex};if(S(t),"ssp"!=Mt(t)){Y(t,e.sSearch,n,s(e),e.bSmart,e.bCaseInsensitive),i(e);for(var l=0;l<o.length;l++)z(t,o[l].sSearch,l,s(o[l]),o[l].bSmart,o[l].bCaseInsensitive);$(t)}else i(e);t.bFiltered=!0,Nt(t,null,"search",[t])}function $(e){for(var n,a,r=qt.ext.search,o=e.aiDisplay,i=0,s=r.length;i<s;i++){for(var l=[],u=0,c=o.length;u<c;u++)a=o[u],n=e.aoData[a],r[i](e,n._aFilterData,a,n._aData,u)&&l.push(a);o.length=0,t.merge(o,l)}}function z(t,e,n,a,r,o){if(""!==e){for(var i,s=[],l=t.aiDisplay,u=Z(e,a,r,o),c=0;c<l.length;c++)i=t.aoData[l[c]]._aFilterData[n],u.test(i)&&s.push(l[c]);t.aiDisplay=s}}function Y(t,e,n,a,r,o){var i,s,l,u=Z(e,a,r,o),c=t.oPreviousSearch.sSearch,f=t.aiDisplayMaster,d=[];if(0!==qt.ext.search.length&&(n=!0),s=Q(t),e.length<=0)t.aiDisplay=f.slice();else{for((s||n||c.length>e.length||0!==e.indexOf(c)||t.bSorted)&&(t.aiDisplay=f.slice()),i=t.aiDisplay,l=0;l<i.length;l++)u.test(t.aoData[i[l]]._sFilterRow)&&d.push(i[l]);t.aiDisplay=d}}function Z(e,n,a,r){return e=n?e:pe(e),a&&(e="^(?=.*?"+t.map(e.match(/"[^"]+"|[^ ]+/g)||[""],function(t){if('"'===t.charAt(0)){var e=t.match(/^"(.*)"$/);t=e?e[1]:t}return t.replace('"',"")}).join(")(?=.*?")+").*$"),new RegExp(e,r?"i":"")}function Q(t){var e,n,a,r,o,i,s,l,u=t.aoColumns,c=qt.ext.type.search,f=!1;for(n=0,r=t.aoData.length;n<r;n++)if(!(l=t.aoData[n])._aFilterData){for(i=[],a=0,o=u.length;a<o;a++)(e=u[a]).bSearchable?(s=_(t,n,a,"filter"),c[e.sType]&&(s=c[e.sType](s)),null===s&&(s=""),"string"!=typeof s&&s.toString&&(s=s.toString())):s="",s.indexOf&&-1!==s.indexOf("&")&&(ge.innerHTML=s,s=be?ge.textContent:ge.innerText),s.replace&&(s=s.replace(/[\r\n]/g,"")),i.push(s);l._aFilterData=i,l._sFilterRow=i.join("  "),f=!0}return f}function K(t){return{search:t.sSearch,smart:t.bSmart,regex:t.bRegex,caseInsensitive:t.bCaseInsensitive}}function tt(t){return{sSearch:t.search,bSmart:t.smart,bRegex:t.regex,bCaseInsensitive:t.caseInsensitive}}function et(e){var n=e.sTableId,a=e.aanFeatures.i,r=t("<div/>",{class:e.oClasses.sInfo,id:a?null:n+"_info"});return a||(e.aoDrawCallback.push({fn:nt,sName:"information"}),r.attr("role","status").attr("aria-live","polite"),t(e.nTable).attr("aria-describedby",n+"_info")),r[0]}function nt(e){var n=e.aanFeatures.i;if(0!==n.length){var a=e.oLanguage,r=e._iDisplayStart+1,o=e.fnDisplayEnd(),i=e.fnRecordsTotal(),s=e.fnRecordsDisplay(),l=s?a.sInfo:a.sInfoEmpty;s!==i&&(l+=" "+a.sInfoFiltered),l=at(e,l+=a.sInfoPostFix);var u=a.fnInfoCallback;null!==u&&(l=u.call(e.oInstance,e,r,o,i,s,l)),t(n).html(l)}}function at(t,e){var n=t.fnFormatNumber,a=t._iDisplayStart+1,r=t._iDisplayLength,o=t.fnRecordsDisplay(),i=-1===r;return e.replace(/_START_/g,n.call(t,a)).replace(/_END_/g,n.call(t,t.fnDisplayEnd())).replace(/_MAX_/g,n.call(t,t.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(t,o)).replace(/_PAGE_/g,n.call(t,i?1:Math.ceil(a/r))).replace(/_PAGES_/g,n.call(t,i?1:Math.ceil(o/r)))}function rt(t){var e,n,a,r=t.iInitDisplayStart,o=t.aoColumns,i=t.oFeatures,s=t.bDeferLoading;if(t.bInitialised){for(M(t),H(t),N(t,t.aoHeader),N(t,t.aoFooter),ft(t,!0),i.bAutoWidth&&gt(t),e=0,n=o.length;e<n;e++)(a=o[e]).sWidth&&(a.nTh.style.width=mt(a.sWidth));Nt(t,null,"preInit",[t]),k(t);var l=Mt(t);("ssp"!=l||s)&&("ajax"==l?B(t,[],function(n){var a=X(t,n);for(e=0;e<a.length;e++)D(t,a[e]);t.iInitDisplayStart=r,k(t),ft(t,!1),ot(t,n)},t):(ft(t,!1),ot(t)))}else setTimeout(function(){rt(t)},200)}function ot(t,e){t._bInitComplete=!0,(e||t.oInit.aaData)&&h(t),Nt(t,null,"plugin-init",[t,e]),Nt(t,"aoInitComplete","init",[t,e])}function it(t,e){var n=parseInt(e,10);t._iDisplayLength=n,Ot(t),Nt(t,null,"length",[t,n])}function st(e){for(var n=e.oClasses,a=e.sTableId,r=e.aLengthMenu,o=t.isArray(r[0]),i=o?r[0]:r,s=o?r[1]:r,l=t("<select/>",{name:a+"_length","aria-controls":a,class:n.sLengthSelect}),u=0,c=i.length;u<c;u++)l[0][u]=new Option(s[u],i[u]);var f=t("<div><label/></div>").addClass(n.sLength);return e.aanFeatures.l||(f[0].id=a+"_length"),f.children().append(e.oLanguage.sLengthMenu.replace("_MENU_",l[0].outerHTML)),t("select",f).val(e._iDisplayLength).on("change.DT",function(n){it(e,t(this).val()),O(e)}),t(e.nTable).on("length.dt.DT",function(n,a,r){e===a&&t("select",f).val(r)}),f[0]}function lt(e){var n=e.sPaginationType,a=qt.ext.pager[n],r="function"==typeof a,o=function(t){O(t)},i=t("<div/>").addClass(e.oClasses.sPaging+n)[0],s=e.aanFeatures;return r||a.fnInit(e,i,o),s.p||(i.id=e.sTableId+"_paginate",e.aoDrawCallback.push({fn:function(t){if(r){var e,n,i=t._iDisplayStart,l=t._iDisplayLength,u=t.fnRecordsDisplay(),c=-1===l,f=c?0:Math.ceil(i/l),d=c?1:Math.ceil(u/l),h=a(f,d);for(e=0,n=s.p.length;e<n;e++)kt(t,"pageButton")(t,s.p[e],e,h,f,d)}else a.fnUpdate(t,o)},sName:"pagination"})),i}function ut(t,e,n){var a=t._iDisplayStart,r=t._iDisplayLength,o=t.fnRecordsDisplay();0===o||-1===r?a=0:"number"==typeof e?(a=e*r)>o&&(a=0):"first"==e?a=0:"previous"==e?(a=r>=0?a-r:0)<0&&(a=0):"next"==e?a+r<o&&(a+=r):"last"==e?a=Math.floor((o-1)/r)*r:Lt(t,0,"Unknown paging action: "+e,5);var i=t._iDisplayStart!==a;return t._iDisplayStart=a,i&&(Nt(t,null,"page",[t]),n&&O(t)),i}function ct(e){return t("<div/>",{id:e.aanFeatures.r?null:e.sTableId+"_processing",class:e.oClasses.sProcessing}).html(e.oLanguage.sProcessing).insertBefore(e.nTable)[0]}function ft(e,n){e.oFeatures.bProcessing&&t(e.aanFeatures.r).css("display",n?"block":"none"),Nt(e,null,"processing",[e,n])}function dt(e){var n=t(e.nTable);n.attr("role","grid");var a=e.oScroll;if(""===a.sX&&""===a.sY)return e.nTable;var r=a.sX,o=a.sY,i=e.oClasses,s=n.children("caption"),l=s.length?s[0]._captionSide:null,u=t(n[0].cloneNode(!1)),c=t(n[0].cloneNode(!1)),f=n.children("tfoot"),d="<div/>",h=function(t){return t?mt(t):null};f.length||(f=null);var p=t(d,{class:i.sScrollWrapper}).append(t(d,{class:i.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:r?h(r):"100%"}).append(t(d,{class:i.sScrollHeadInner}).css({"box-sizing":"content-box",width:a.sXInner||"100%"}).append(u.removeAttr("id").css("margin-left",0).append("top"===l?s:null).append(n.children("thead"))))).append(t(d,{class:i.sScrollBody}).css({position:"relative",overflow:"auto",width:h(r)}).append(n));f&&p.append(t(d,{class:i.sScrollFoot}).css({overflow:"hidden",border:0,width:r?h(r):"100%"}).append(t(d,{class:i.sScrollFootInner}).append(c.removeAttr("id").css("margin-left",0).append("bottom"===l?s:null).append(n.children("tfoot")))));var g=p.children(),b=g[0],v=g[1],S=f?g[2]:null;return r&&t(v).on("scroll.DT",function(t){var e=this.scrollLeft;b.scrollLeft=e,f&&(S.scrollLeft=e)}),t(v).css(o&&a.bCollapse?"max-height":"height",o),e.nScrollHead=b,e.nScrollBody=v,e.nScrollFoot=S,e.aoDrawCallback.push({fn:ht,sName:"scrolling"}),p[0]}function ht(e){var n,r,o,i,s,l,u,c,f,d=e.oScroll,g=d.sX,b=d.sXInner,v=d.sY,S=d.iBarWidth,m=t(e.nScrollHead),D=m[0].style,y=m.children("div"),_=y[0].style,T=y.children("table"),C=e.nScrollBody,w=t(C),x=C.style,I=t(e.nScrollFoot).children("div"),A=I.children("table"),F=t(e.nTHead),L=t(e.nTable),P=L[0],R=P.style,j=e.nTFoot?t(e.nTFoot):null,H=e.oBrowser,N=H.bScrollOversize,O=oe(e.aoColumns,"nTh"),k=[],M=[],W=[],B=[],E=function(t){var e=t.style;e.paddingTop="0",e.paddingBottom="0",e.borderTopWidth="0",e.borderBottomWidth="0",e.height=0},J=C.scrollHeight>C.clientHeight;if(e.scrollBarVis!==J&&e.scrollBarVis!==a)return e.scrollBarVis=J,void h(e);e.scrollBarVis=J,L.children("thead, tfoot").remove(),j&&(l=j.clone().prependTo(L),r=j.find("tr"),i=l.find("tr")),s=F.clone().prependTo(L),n=F.find("tr"),o=s.find("tr"),s.find("th, td").removeAttr("tabindex"),g||(x.width="100%",m[0].style.width="100%"),t.each(U(e,s),function(t,n){u=p(e,t),n.style.width=e.aoColumns[u].sWidth}),j&&pt(function(t){t.style.width=""},i),f=L.outerWidth(),""===g?(R.width="100%",N&&(L.find("tbody").height()>C.offsetHeight||"scroll"==w.css("overflow-y"))&&(R.width=mt(L.outerWidth()-S)),f=L.outerWidth()):""!==b&&(R.width=mt(b),f=L.outerWidth()),pt(E,o),pt(function(e){W.push(e.innerHTML),k.push(mt(t(e).css("width")))},o),pt(function(e,n){-1!==t.inArray(e,O)&&(e.style.width=k[n])},n),t(o).height(0),j&&(pt(E,i),pt(function(e){B.push(e.innerHTML),M.push(mt(t(e).css("width")))},i),pt(function(t,e){t.style.width=M[e]},r),t(i).height(0)),pt(function(t,e){t.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+W[e]+"</div>",t.style.width=k[e]},o),j&&pt(function(t,e){t.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+B[e]+"</div>",t.style.width=M[e]},i),L.outerWidth()<f?(c=C.scrollHeight>C.offsetHeight||"scroll"==w.css("overflow-y")?f+S:f,N&&(C.scrollHeight>C.offsetHeight||"scroll"==w.css("overflow-y"))&&(R.width=mt(c-S)),""!==g&&""===b||Lt(e,1,"Possible column misalignment",6)):c="100%",x.width=mt(c),D.width=mt(c),j&&(e.nScrollFoot.style.width=mt(c)),v||N&&(x.height=mt(P.offsetHeight+S));var V=L.outerWidth();T[0].style.width=mt(V),_.width=mt(V);var X=L.height()>C.clientHeight||"scroll"==w.css("overflow-y"),q="padding"+(H.bScrollbarLeft?"Left":"Right");_[q]=X?S+"px":"0px",j&&(A[0].style.width=mt(V),I[0].style.width=mt(V),I[0].style[q]=X?S+"px":"0px"),L.children("colgroup").insertBefore(L.children("thead")),w.scroll(),!e.bSorted&&!e.bFiltered||e._drawHold||(C.scrollTop=0)}function pt(t,e,n){for(var a,r,o=0,i=0,s=e.length;i<s;){for(a=e[i].firstChild,r=n?n[i].firstChild:null;a;)1===a.nodeType&&(n?t(a,r,o):t(a,o),o++),a=a.nextSibling,r=n?r.nextSibling:null;i++}}function gt(n){var a,r,o,i=n.nTable,s=n.aoColumns,l=n.oScroll,u=l.sY,c=l.sX,f=l.sXInner,d=s.length,g=v(n,"bVisible"),S=t("th",n.nTHead),m=i.getAttribute("width"),D=i.parentNode,y=!1,_=n.oBrowser,T=_.bScrollOversize,C=i.style.width;for(C&&-1!==C.indexOf("%")&&(m=C),a=0;a<g.length;a++)null!==(r=s[g[a]]).sWidth&&(r.sWidth=bt(r.sWidthOrig,D),y=!0);if(T||!y&&!c&&!u&&d==b(n)&&d==S.length)for(a=0;a<d;a++){var w=p(n,a);null!==w&&(s[w].sWidth=mt(S.eq(a).width()))}else{var x=t(i).clone().css("visibility","hidden").removeAttr("id");x.find("tbody tr").remove();var I=t("<tr/>").appendTo(x.find("tbody"));for(x.find("thead, tfoot").remove(),x.append(t(n.nTHead).clone()).append(t(n.nTFoot).clone()),x.find("tfoot th, tfoot td").css("width",""),S=U(n,x.find("thead")[0]),a=0;a<g.length;a++)r=s[g[a]],S[a].style.width=null!==r.sWidthOrig&&""!==r.sWidthOrig?mt(r.sWidthOrig):"",r.sWidthOrig&&c&&t(S[a]).append(t("<div/>").css({width:r.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(n.aoData.length)for(a=0;a<g.length;a++)r=s[o=g[a]],t(vt(n,o)).clone(!1).append(r.sContentPadding).appendTo(I);t("[name]",x).removeAttr("name");var A=t("<div/>").css(c||u?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(x).appendTo(D);c&&f?x.width(f):c?(x.css("width","auto"),x.removeAttr("width"),x.width()<D.clientWidth&&m&&x.width(D.clientWidth)):u?x.width(D.clientWidth):m&&x.width(m);var F=0;for(a=0;a<g.length;a++){var L=t(S[a]),P=L.outerWidth()-L.width(),R=_.bBounding?Math.ceil(S[a].getBoundingClientRect().width):L.outerWidth();F+=R,s[g[a]].sWidth=mt(R-P)}i.style.width=mt(F),A.remove()}if(m&&(i.style.width=mt(m)),(m||c)&&!n._reszEvt){var j=function(){t(e).on("resize.DT-"+n.sInstance,Se(function(){h(n)}))};T?setTimeout(j,1e3):j(),n._reszEvt=!0}}function bt(e,a){if(!e)return 0;var r=t("<div/>").css("width",mt(e)).appendTo(a||n.body),o=r[0].offsetWidth;return r.remove(),o}function vt(e,n){var a=St(e,n);if(a<0)return null;var r=e.aoData[a];return r.nTr?r.anCells[n]:t("<td/>").html(_(e,a,n,"display"))[0]}function St(t,e){for(var n,a=-1,r=-1,o=0,i=t.aoData.length;o<i;o++)(n=(n=(n=_(t,o,e,"display")+"").replace(ve,"")).replace(/&nbsp;/g," ")).length>a&&(a=n.length,r=o);return r}function mt(t){return null===t?"0px":"number"==typeof t?t<0?"0px":t+"px":t.match(/\d$/)?t+"px":t}function Dt(e){var n,r,o,i,s,l,u,c=[],f=e.aoColumns,d=e.aaSortingFixed,h=t.isPlainObject(d),p=[],g=function(e){e.length&&!t.isArray(e[0])?p.push(e):t.merge(p,e)};for(t.isArray(d)&&g(d),h&&d.pre&&g(d.pre),g(e.aaSorting),h&&d.post&&g(d.post),n=0;n<p.length;n++)for(r=0,o=(i=f[u=p[n][0]].aDataSort).length;r<o;r++)l=f[s=i[r]].sType||"string",p[n]._idx===a&&(p[n]._idx=t.inArray(p[n][1],f[s].asSorting)),c.push({src:u,col:s,dir:p[n][1],index:p[n]._idx,type:l,formatter:qt.ext.type.order[l+"-pre"]});return c}function yt(t){var e,n,a,r,o,i=[],s=qt.ext.type.order,l=t.aoData,u=(t.aoColumns,0),c=t.aiDisplayMaster;for(S(t),e=0,n=(o=Dt(t)).length;e<n;e++)(r=o[e]).formatter&&u++,xt(t,r.col);if("ssp"!=Mt(t)&&0!==o.length){for(e=0,a=c.length;e<a;e++)i[c[e]]=e;u===o.length?c.sort(function(t,e){var n,a,r,s,u,c=o.length,f=l[t]._aSortData,d=l[e]._aSortData;for(r=0;r<c;r++)if(u=o[r],n=f[u.col],a=d[u.col],0!==(s=n<a?-1:n>a?1:0))return"asc"===u.dir?s:-s;return n=i[t],a=i[e],n<a?-1:n>a?1:0}):c.sort(function(t,e){var n,a,r,u,c,f,d=o.length,h=l[t]._aSortData,p=l[e]._aSortData;for(r=0;r<d;r++)if(c=o[r],n=h[c.col],a=p[c.col],f=s[c.type+"-"+c.dir]||s["string-"+c.dir],0!==(u=f(n,a)))return u;return n=i[t],a=i[e],n<a?-1:n>a?1:0})}t.bSorted=!0}function _t(t){for(var e,n,a=t.aoColumns,r=Dt(t),o=t.oLanguage.oAria,i=0,s=a.length;i<s;i++){var l=a[i],u=l.asSorting,c=l.sTitle.replace(/<.*?>/g,""),f=l.nTh;f.removeAttribute("aria-sort"),l.bSortable?(r.length>0&&r[0].col==i?(f.setAttribute("aria-sort","asc"==r[0].dir?"ascending":"descending"),n=u[r[0].index+1]||u[0]):n=u[0],e=c+("asc"===n?o.sSortAscending:o.sSortDescending)):e=c,f.setAttribute("aria-label",e)}}function Tt(e,n,r,o){var i,s=e.aoColumns[n],l=e.aaSorting,u=s.asSorting,c=function(e,n){var r=e._idx;return r===a&&(r=t.inArray(e[1],u)),r+1<u.length?r+1:n?null:0};if("number"==typeof l[0]&&(l=e.aaSorting=[l]),r&&e.oFeatures.bSortMulti){var f=t.inArray(n,oe(l,"0"));-1!==f?(null===(i=c(l[f],!0))&&1===l.length&&(i=0),null===i?l.splice(f,1):(l[f][1]=u[i],l[f]._idx=i)):(l.push([n,u[0],0]),l[l.length-1]._idx=0)}else l.length&&l[0][0]==n?(i=c(l[0]),l.length=1,l[0][1]=u[i],l[0]._idx=i):(l.length=0,l.push([n,u[0]]),l[0]._idx=0);k(e),"function"==typeof o&&o(e)}function Ct(t,e,n,a){var r=t.aoColumns[n];jt(e,{},function(e){!1!==r.bSortable&&(t.oFeatures.bProcessing?(ft(t,!0),setTimeout(function(){Tt(t,n,e.shiftKey,a),"ssp"!==Mt(t)&&ft(t,!1)},0)):Tt(t,n,e.shiftKey,a))})}function wt(e){var n,a,r,o=e.aLastSort,i=e.oClasses.sSortColumn,s=Dt(e),l=e.oFeatures;if(l.bSort&&l.bSortClasses){for(n=0,a=o.length;n<a;n++)r=o[n].src,t(oe(e.aoData,"anCells",r)).removeClass(i+(n<2?n+1:3));for(n=0,a=s.length;n<a;n++)r=s[n].src,t(oe(e.aoData,"anCells",r)).addClass(i+(n<2?n+1:3))}e.aLastSort=s}function xt(t,e){var n,a=t.aoColumns[e],r=qt.ext.order[a.sSortDataType];r&&(n=r.call(t.oInstance,t,e,g(t,e)));for(var o,i,s=qt.ext.type.order[a.sType+"-pre"],l=0,u=t.aoData.length;l<u;l++)(o=t.aoData[l])._aSortData||(o._aSortData=[]),o._aSortData[e]&&!r||(i=r?n[l]:_(t,l,e,"sort"),o._aSortData[e]=s?s(i):i)}function It(e){if(e.oFeatures.bStateSave&&!e.bDestroying){var n={time:+new Date,start:e._iDisplayStart,length:e._iDisplayLength,order:t.extend(!0,[],e.aaSorting),search:K(e.oPreviousSearch),columns:t.map(e.aoColumns,function(t,n){return{visible:t.bVisible,search:K(e.aoPreSearchCols[n])}})};Nt(e,"aoStateSaveParams","stateSaveParams",[e,n]),e.oSavedState=n,e.fnStateSaveCallback.call(e.oInstance,e,n)}}function At(e,n,r){var o,i,s=e.aoColumns,l=function(n){if(n&&n.time){var l=Nt(e,"aoStateLoadParams","stateLoadParams",[e,u]);if(-1===t.inArray(!1,l)){var c=e.iStateDuration;if(c>0&&n.time<+new Date-1e3*c)r();else if(n.columns&&s.length!==n.columns.length)r();else{if(e.oLoadedState=t.extend(!0,{},u),n.start!==a&&(e._iDisplayStart=n.start,e.iInitDisplayStart=n.start),n.length!==a&&(e._iDisplayLength=n.length),n.order!==a&&(e.aaSorting=[],t.each(n.order,function(t,n){e.aaSorting.push(n[0]>=s.length?[0,n[1]]:n)})),n.search!==a&&t.extend(e.oPreviousSearch,tt(n.search)),n.columns)for(o=0,i=n.columns.length;o<i;o++){var f=n.columns[o];f.visible!==a&&(s[o].bVisible=f.visible),f.search!==a&&t.extend(e.aoPreSearchCols[o],tt(f.search))}Nt(e,"aoStateLoaded","stateLoaded",[e,u]),r()}}else r()}else r()};if(e.oFeatures.bStateSave){var u=e.fnStateLoadCallback.call(e.oInstance,e,l);u!==a&&l(u)}else r()}function Ft(e){var n=qt.settings,a=t.inArray(e,oe(n,"nTable"));return-1!==a?n[a]:null}function Lt(t,n,a,r){if(a="DataTables warning: "+(t?"table id="+t.sTableId+" - ":"")+a,r&&(a+=". For more information about this error, please see http://datatables.net/tn/"+r),n)e.console&&console.log&&console.log(a);else{var o=qt.ext,i=o.sErrMode||o.errMode;if(t&&Nt(t,null,"error",[t,r,a]),"alert"==i)alert(a);else{if("throw"==i)throw new Error(a);"function"==typeof i&&i(t,r,a)}}}function Pt(e,n,r,o){t.isArray(r)?t.each(r,function(a,r){t.isArray(r)?Pt(e,n,r[0],r[1]):Pt(e,n,r)}):(o===a&&(o=r),n[r]!==a&&(e[o]=n[r]))}function Rt(e,n,a){var r;for(var o in n)n.hasOwnProperty(o)&&(r=n[o],t.isPlainObject(r)?(t.isPlainObject(e[o])||(e[o]={}),t.extend(!0,e[o],r)):a&&"data"!==o&&"aaData"!==o&&t.isArray(r)?e[o]=r.slice():e[o]=r);return e}function jt(e,n,a){t(e).on("click.DT",n,function(t){e.blur(),a(t)}).on("keypress.DT",n,function(t){13===t.which&&(t.preventDefault(),a(t))}).on("selectstart.DT",function(){return!1})}function Ht(t,e,n,a){n&&t[e].push({fn:n,sName:a})}function Nt(e,n,a,r){var o=[];if(n&&(o=t.map(e[n].slice().reverse(),function(t,n){return t.fn.apply(e.oInstance,r)})),null!==a){var i=t.Event(a+".dt");t(e.nTable).trigger(i,r),o.push(i.result)}return o}function Ot(t){var e=t._iDisplayStart,n=t.fnDisplayEnd(),a=t._iDisplayLength;e>=n&&(e=n-a),e-=e%a,(-1===a||e<0)&&(e=0),t._iDisplayStart=e}function kt(e,n){var a=e.renderer,r=qt.ext.renderer[n];return t.isPlainObject(a)&&a[n]?r[a[n]]||r._:"string"==typeof a?r[a]||r._:r._}function Mt(t){return t.oFeatures.bServerSide?"ssp":t.ajax||t.sAjaxSource?"ajax":"dom"}function Wt(t,e){var n=[],a=Me.numbers_length,r=Math.floor(a/2);return e<=a?n=se(0,e):t<=r?((n=se(0,a-2)).push("ellipsis"),n.push(e-1)):t>=e-1-r?((n=se(e-(a-2),e)).splice(0,0,"ellipsis"),n.splice(0,0,0)):((n=se(t-r+2,t+r-1)).push("ellipsis"),n.push(e-1),n.splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}function Ut(e){t.each({num:function(t){return We(t,e)},"num-fmt":function(t){return We(t,e,Qt)},"html-num":function(t){return We(t,e,zt)},"html-num-fmt":function(t){return We(t,e,zt,Qt)}},function(t,n){Et.type.order[t+e+"-pre"]=n,t.match(/^html\-/)&&(Et.type.search[t+e]=Et.type.search.html)})}function Bt(t){return function(){var e=[Ft(this[qt.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return qt.ext.internal[t].apply(this,e)}}var Et,Jt,Vt,Xt,qt=function(e){this.$=function(t,e){return this.api(!0).$(t,e)},this._=function(t,e){return this.api(!0).rows(t,e).data()},this.api=function(t){return new Jt(t?Ft(this[Et.iApiIndex]):this)},this.fnAddData=function(e,n){var r=this.api(!0),o=t.isArray(e)&&(t.isArray(e[0])||t.isPlainObject(e[0]))?r.rows.add(e):r.row.add(e);return(n===a||n)&&r.draw(),o.flatten().toArray()},this.fnAdjustColumnSizing=function(t){var e=this.api(!0).columns.adjust(),n=e.settings()[0],r=n.oScroll;t===a||t?e.draw(!1):""===r.sX&&""===r.sY||ht(n)},this.fnClearTable=function(t){var e=this.api(!0).clear();(t===a||t)&&e.draw()},this.fnClose=function(t){this.api(!0).row(t).child.hide()},this.fnDeleteRow=function(t,e,n){var r=this.api(!0),o=r.rows(t),i=o.settings()[0],s=i.aoData[o[0][0]];return o.remove(),e&&e.call(this,i,s),(n===a||n)&&r.draw(),s},this.fnDestroy=function(t){this.api(!0).destroy(t)},this.fnDraw=function(t){this.api(!0).draw(t)},this.fnFilter=function(t,e,n,r,o,i){var s=this.api(!0);null===e||e===a?s.search(t,n,r,i):s.column(e).search(t,n,r,i),s.draw()},this.fnGetData=function(t,e){var n=this.api(!0);if(t!==a){var r=t.nodeName?t.nodeName.toLowerCase():"";return e!==a||"td"==r||"th"==r?n.cell(t,e).data():n.row(t).data()||null}return n.data().toArray()},this.fnGetNodes=function(t){var e=this.api(!0);return t!==a?e.row(t).node():e.rows().nodes().flatten().toArray()},this.fnGetPosition=function(t){var e=this.api(!0),n=t.nodeName.toUpperCase();if("TR"==n)return e.row(t).index();if("TD"==n||"TH"==n){var a=e.cell(t).index();return[a.row,a.columnVisible,a.column]}return null},this.fnIsOpen=function(t){return this.api(!0).row(t).child.isShown()},this.fnOpen=function(t,e,n){return this.api(!0).row(t).child(e,n).show().child()[0]},this.fnPageChange=function(t,e){var n=this.api(!0).page(t);(e===a||e)&&n.draw(!1)},this.fnSetColumnVis=function(t,e,n){var r=this.api(!0).column(t).visible(e);(n===a||n)&&r.columns.adjust().draw()},this.fnSettings=function(){return Ft(this[Et.iApiIndex])},this.fnSort=function(t){this.api(!0).order(t).draw()},this.fnSortListener=function(t,e,n){this.api(!0).order.listener(t,e,n)},this.fnUpdate=function(t,e,n,r,o){var i=this.api(!0);return n===a||null===n?i.row(e).data(t):i.cell(e,n).data(t),(o===a||o)&&i.columns.adjust(),(r===a||r)&&i.draw(),0},this.fnVersionCheck=Et.fnVersionCheck;var n=this,r=e===a,c=this.length;r&&(e={}),this.oApi=this.internal=Et.internal;for(var h in qt.ext.internal)h&&(this[h]=Bt(h));return this.each(function(){var h,p={},g=c>1?Rt(p,e,!0):e,b=0,v=this.getAttribute("id"),S=!1,_=qt.defaults,T=t(this);if("table"==this.nodeName.toLowerCase()){s(_),l(_.column),o(_,_,!0),o(_.column,_.column,!0),o(_,t.extend(g,T.data()));var C=qt.settings;for(b=0,h=C.length;b<h;b++){var x=C[b];if(x.nTable==this||x.nTHead.parentNode==this||x.nTFoot&&x.nTFoot.parentNode==this){var I=g.bRetrieve!==a?g.bRetrieve:_.bRetrieve,A=g.bDestroy!==a?g.bDestroy:_.bDestroy;if(r||I)return x.oInstance;if(A){x.oInstance.fnDestroy();break}return void Lt(x,0,"Cannot reinitialise DataTable",3)}if(x.sTableId==this.id){C.splice(b,1);break}}null!==v&&""!==v||(v="DataTables_Table_"+qt.ext._unique++,this.id=v);var F=t.extend(!0,{},qt.models.oSettings,{sDestroyWidth:T[0].style.width,sInstance:v,sTableId:v});F.nTable=this,F.oApi=n.internal,F.oInit=g,C.push(F),F.oInstance=1===n.length?n:T.dataTable(),s(g),g.oLanguage&&i(g.oLanguage),g.aLengthMenu&&!g.iDisplayLength&&(g.iDisplayLength=t.isArray(g.aLengthMenu[0])?g.aLengthMenu[0][0]:g.aLengthMenu[0]),g=Rt(t.extend(!0,{},_),g),Pt(F.oFeatures,g,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),Pt(F,g,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),Pt(F.oScroll,g,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Pt(F.oLanguage,g,"fnInfoCallback"),Ht(F,"aoDrawCallback",g.fnDrawCallback,"user"),Ht(F,"aoServerParams",g.fnServerParams,"user"),Ht(F,"aoStateSaveParams",g.fnStateSaveParams,"user"),Ht(F,"aoStateLoadParams",g.fnStateLoadParams,"user"),Ht(F,"aoStateLoaded",g.fnStateLoaded,"user"),Ht(F,"aoRowCallback",g.fnRowCallback,"user"),Ht(F,"aoRowCreatedCallback",g.fnCreatedRow,"user"),Ht(F,"aoHeaderCallback",g.fnHeaderCallback,"user"),Ht(F,"aoFooterCallback",g.fnFooterCallback,"user"),Ht(F,"aoInitComplete",g.fnInitComplete,"user"),Ht(F,"aoPreDrawCallback",g.fnPreDrawCallback,"user"),F.rowIdFn=w(g.rowId),u(F);var L=F.oClasses;if(g.bJQueryUI?(t.extend(L,qt.ext.oJUIClasses,g.oClasses),g.sDom===_.sDom&&"lfrtip"===_.sDom&&(F.sDom='<"H"lfr>t<"F"ip>'),F.renderer?t.isPlainObject(F.renderer)&&!F.renderer.header&&(F.renderer.header="jqueryui"):F.renderer="jqueryui"):t.extend(L,qt.ext.classes,g.oClasses),T.addClass(L.sTable),F.iInitDisplayStart===a&&(F.iInitDisplayStart=g.iDisplayStart,F._iDisplayStart=g.iDisplayStart),null!==g.iDeferLoading){F.bDeferLoading=!0;var P=t.isArray(g.iDeferLoading);F._iRecordsDisplay=P?g.iDeferLoading[0]:g.iDeferLoading,F._iRecordsTotal=P?g.iDeferLoading[1]:g.iDeferLoading}var R=F.oLanguage;t.extend(!0,R,g.oLanguage),R.sUrl&&(t.ajax({dataType:"json",url:R.sUrl,success:function(e){i(e),o(_.oLanguage,e),t.extend(!0,R,e),rt(F)},error:function(){rt(F)}}),S=!0),null===g.asStripeClasses&&(F.asStripeClasses=[L.sStripeOdd,L.sStripeEven]);var j=F.asStripeClasses,H=T.children("tbody").find("tr").eq(0);-1!==t.inArray(!0,t.map(j,function(t,e){return H.hasClass(t)}))&&(t("tbody tr",this).removeClass(j.join(" ")),F.asDestroyStripes=j.slice());var N,O=[],k=this.getElementsByTagName("thead");if(0!==k.length&&(W(F.aoHeader,k[0]),O=U(F)),null===g.aoColumns)for(N=[],b=0,h=O.length;b<h;b++)N.push(null);else N=g.aoColumns;for(b=0,h=N.length;b<h;b++)f(F,O?O[b]:null);if(m(F,g.aoColumnDefs,N,function(t,e){d(F,t,e)}),H.length){var M=function(t,e){return null!==t.getAttribute("data-"+e)?e:null};t(H[0]).children("th, td").each(function(t,e){var n=F.aoColumns[t];if(n.mData===t){var r=M(e,"sort")||M(e,"order"),o=M(e,"filter")||M(e,"search");null===r&&null===o||(n.mData={_:t+".display",sort:null!==r?t+".@data-"+r:a,type:null!==r?t+".@data-"+r:a,filter:null!==o?t+".@data-"+o:a},d(F,t))}})}var B=F.oFeatures,E=function(){if(g.aaSorting===a){var e=F.aaSorting;for(b=0,h=e.length;b<h;b++)e[b][1]=F.aoColumns[b].asSorting[0]}wt(F),B.bSort&&Ht(F,"aoDrawCallback",function(){if(F.bSorted){var e=Dt(F),n={};t.each(e,function(t,e){n[e.src]=e.dir}),Nt(F,null,"order",[F,e,n]),_t(F)}}),Ht(F,"aoDrawCallback",function(){(F.bSorted||"ssp"===Mt(F)||B.bDeferRender)&&wt(F)},"sc");var n=T.children("caption").each(function(){this._captionSide=t(this).css("caption-side")}),r=T.children("thead");0===r.length&&(r=t("<thead/>").appendTo(T)),F.nTHead=r[0];var o=T.children("tbody");0===o.length&&(o=t("<tbody/>").appendTo(T)),F.nTBody=o[0];var i=T.children("tfoot");if(0===i.length&&n.length>0&&(""!==F.oScroll.sX||""!==F.oScroll.sY)&&(i=t("<tfoot/>").appendTo(T)),0===i.length||0===i.children().length?T.addClass(L.sNoFooter):i.length>0&&(F.nTFoot=i[0],W(F.aoFooter,F.nTFoot)),g.aaData)for(b=0;b<g.aaData.length;b++)D(F,g.aaData[b]);else(F.bDeferLoading||"dom"==Mt(F))&&y(F,t(F.nTBody).children("tr"));F.aiDisplay=F.aiDisplayMaster.slice(),F.bInitialised=!0,!1===S&&rt(F)};g.bStateSave?(B.bStateSave=!0,Ht(F,"aoDrawCallback",It,"state_save"),At(F,g,E)):E()}else Lt(null,0,"Non-table node initialisation ("+this.nodeName+")",2)}),n=null,this},Gt={},$t=/[\r\n]/g,zt=/<.*?>/g,Yt=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,Zt=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),Qt=/[',$%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,Kt=function(t){return!t||!0===t||"-"===t},te=function(t){var e=parseInt(t,10);return!isNaN(e)&&isFinite(t)?e:null},ee=function(t,e){return Gt[e]||(Gt[e]=new RegExp(pe(e),"g")),"string"==typeof t&&"."!==e?t.replace(/\./g,"").replace(Gt[e],"."):t},ne=function(t,e,n){var a="string"==typeof t;return!!Kt(t)||(e&&a&&(t=ee(t,e)),n&&a&&(t=t.replace(Qt,"")),!isNaN(parseFloat(t))&&isFinite(t))},ae=function(t){return Kt(t)||"string"==typeof t},re=function(t,e,n){return!!Kt(t)||(ae(t)?!!ne(ue(t),e,n)||null:null)},oe=function(t,e,n){var r=[],o=0,i=t.length;if(n!==a)for(;o<i;o++)t[o]&&t[o][e]&&r.push(t[o][e][n]);else for(;o<i;o++)t[o]&&r.push(t[o][e]);return r},ie=function(t,e,n,r){var o=[],i=0,s=e.length;if(r!==a)for(;i<s;i++)t[e[i]][n]&&o.push(t[e[i]][n][r]);else for(;i<s;i++)o.push(t[e[i]][n]);return o},se=function(t,e){var n,r=[];e===a?(e=0,n=t):(n=e,e=t);for(var o=e;o<n;o++)r.push(o);return r},le=function(t){for(var e=[],n=0,a=t.length;n<a;n++)t[n]&&e.push(t[n]);return e},ue=function(t){return t.replace(zt,"")},ce=function(t){var e,n,a,r=[],o=t.length,i=0;t:for(n=0;n<o;n++){for(e=t[n],a=0;a<i;a++)if(r[a]===e)continue t;r.push(e),i++}return r};qt.util={throttle:function(t,e){var n,r,o=e!==a?e:200;return function(){var e=this,i=+new Date,s=arguments;n&&i<n+o?(clearTimeout(r),r=setTimeout(function(){n=a,t.apply(e,s)},o)):(n=i,t.apply(e,s))}},escapeRegex:function(t){return t.replace(Zt,"\\$1")}};var fe=function(t,e,n){t[e]!==a&&(t[n]=t[e])},de=/\[.*?\]$/,he=/\(\)$/,pe=qt.util.escapeRegex,ge=t("<div>")[0],be=ge.textContent!==a,ve=/<.*?>/g,Se=qt.util.throttle,me=[],De=Array.prototype,ye=function(e){var n,a,r=qt.settings,o=t.map(r,function(t,e){return t.nTable});return e?e.nTable&&e.oApi?[e]:e.nodeName&&"table"===e.nodeName.toLowerCase()?(n=t.inArray(e,o),-1!==n?[r[n]]:null):e&&"function"==typeof e.settings?e.settings().toArray():("string"==typeof e?a=t(e):e instanceof t&&(a=e),a?a.map(function(e){return n=t.inArray(this,o),-1!==n?r[n]:null}).toArray():void 0):[]};Jt=function(e,n){if(!(this instanceof Jt))return new Jt(e,n);var a=[],r=function(t){var e=ye(t);e&&(a=a.concat(e))};if(t.isArray(e))for(var o=0,i=e.length;o<i;o++)r(e[o]);else r(e);this.context=ce(a),n&&t.merge(this,n),this.selector={rows:null,cols:null,opts:null},Jt.extend(this,this,me)},qt.Api=Jt,t.extend(Jt.prototype,{any:function(){return 0!==this.count()},concat:De.concat,context:[],count:function(){return this.flatten().length},each:function(t){for(var e=0,n=this.length;e<n;e++)t.call(this,this[e],e,this);return this},eq:function(t){var e=this.context;return e.length>t?new Jt(e[t],this[t]):null},filter:function(t){var e=[];if(De.filter)e=De.filter.call(this,t,this);else for(var n=0,a=this.length;n<a;n++)t.call(this,this[n],n,this)&&e.push(this[n]);return new Jt(this.context,e)},flatten:function(){var t=[];return new Jt(this.context,t.concat.apply(t,this.toArray()))},join:De.join,indexOf:De.indexOf||function(t,e){for(var n=e||0,a=this.length;n<a;n++)if(this[n]===t)return n;return-1},iterator:function(t,e,n,r){var o,i,s,l,u,c,f,d,h=[],p=this.context,g=this.selector;for("string"==typeof t&&(r=n,n=e,e=t,t=!1),i=0,s=p.length;i<s;i++){var b=new Jt(p[i]);if("table"===e)(o=n.call(b,p[i],i))!==a&&h.push(o);else if("columns"===e||"rows"===e)(o=n.call(b,p[i],this[i],i))!==a&&h.push(o);else if("column"===e||"column-rows"===e||"row"===e||"cell"===e)for(f=this[i],"column-rows"===e&&(c=Ie(p[i],g.opts)),l=0,u=f.length;l<u;l++)d=f[l],(o="cell"===e?n.call(b,p[i],d.row,d.column,i,l):n.call(b,p[i],d,i,l,c))!==a&&h.push(o)}if(h.length||r){var v=new Jt(p,t?h.concat.apply([],h):h),S=v.selector;return S.rows=g.rows,S.cols=g.cols,S.opts=g.opts,v}return this},lastIndexOf:De.lastIndexOf||function(t,e){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(t){var e=[];if(De.map)e=De.map.call(this,t,this);else for(var n=0,a=this.length;n<a;n++)e.push(t.call(this,this[n],n));return new Jt(this.context,e)},pluck:function(t){return this.map(function(e){return e[t]})},pop:De.pop,push:De.push,reduce:De.reduce||function(t,e){return c(this,t,e,0,this.length,1)},reduceRight:De.reduceRight||function(t,e){return c(this,t,e,this.length-1,-1,-1)},reverse:De.reverse,selector:null,shift:De.shift,sort:De.sort,splice:De.splice,toArray:function(){return De.slice.call(this)},to$:function(){return t(this)},toJQuery:function(){return t(this)},unique:function(){return new Jt(this.context,ce(this))},unshift:De.unshift}),Jt.extend=function(e,n,a){if(a.length&&n&&(n instanceof Jt||n.__dt_wrapper)){var r,o,i;for(r=0,o=a.length;r<o;r++)n[(i=a[r]).name]="function"==typeof i.val?function(t,e,n){return function(){var a=e.apply(t,arguments);return Jt.extend(a,a,n.methodExt),a}}(e,i.val,i):t.isPlainObject(i.val)?{}:i.val,n[i.name].__dt_wrapper=!0,Jt.extend(e,n[i.name],i.propExt)}},Jt.register=Vt=function(e,n){if(t.isArray(e))for(var a=0,r=e.length;a<r;a++)Jt.register(e[a],n);else{var o,i,s,l,u=e.split("."),c=me;for(o=0,i=u.length;o<i;o++){var f=function(t,e){for(var n=0,a=t.length;n<a;n++)if(t[n].name===e)return t[n];return null}(c,s=(l=-1!==u[o].indexOf("()"))?u[o].replace("()",""):u[o]);f||(f={name:s,val:{},methodExt:[],propExt:[]},c.push(f)),o===i-1?f.val=n:c=l?f.methodExt:f.propExt}}},Jt.registerPlural=Xt=function(e,n,r){Jt.register(e,r),Jt.register(n,function(){var e=r.apply(this,arguments);return e===this?this:e instanceof Jt?e.length?t.isArray(e[0])?new Jt(e.context,e[0]):e[0]:a:e})};var _e=function(e,n){if("number"==typeof e)return[n[e]];var a=t.map(n,function(t,e){return t.nTable});return t(a).filter(e).map(function(e){var r=t.inArray(this,a);return n[r]}).toArray()};Vt("tables()",function(t){return t?new Jt(_e(t,this.context)):this}),Vt("table()",function(t){var e=this.tables(t),n=e.context;return n.length?new Jt(n[0]):e}),Xt("tables().nodes()","table().node()",function(){return this.iterator("table",function(t){return t.nTable},1)}),Xt("tables().body()","table().body()",function(){return this.iterator("table",function(t){return t.nTBody},1)}),Xt("tables().header()","table().header()",function(){return this.iterator("table",function(t){return t.nTHead},1)}),Xt("tables().footer()","table().footer()",function(){return this.iterator("table",function(t){return t.nTFoot},1)}),Xt("tables().containers()","table().container()",function(){return this.iterator("table",function(t){return t.nTableWrapper},1)}),Vt("draw()",function(t){return this.iterator("table",function(e){"page"===t?O(e):("string"==typeof t&&(t="full-hold"!==t),k(e,!1===t))})}),Vt("page()",function(t){return t===a?this.page.info().page:this.iterator("table",function(e){ut(e,t)})}),Vt("page.info()",function(t){if(0===this.context.length)return a;var e=this.context[0],n=e._iDisplayStart,r=e.oFeatures.bPaginate?e._iDisplayLength:-1,o=e.fnRecordsDisplay(),i=-1===r;return{page:i?0:Math.floor(n/r),pages:i?1:Math.ceil(o/r),start:n,end:e.fnDisplayEnd(),length:r,recordsTotal:e.fnRecordsTotal(),recordsDisplay:o,serverSide:"ssp"===Mt(e)}}),Vt("page.len()",function(t){return t===a?0!==this.context.length?this.context[0]._iDisplayLength:a:this.iterator("table",function(e){it(e,t)})});var Te=function(t,e,n){if(n){var a=new Jt(t);a.one("draw",function(){n(a.ajax.json())})}if("ssp"==Mt(t))k(t,e);else{ft(t,!0);var r=t.jqXHR;r&&4!==r.readyState&&r.abort(),B(t,[],function(n){A(t);for(var a=X(t,n),r=0,o=a.length;r<o;r++)D(t,a[r]);k(t,e),ft(t,!1)})}};Vt("ajax.json()",function(){var t=this.context;if(t.length>0)return t[0].json}),Vt("ajax.params()",function(){var t=this.context;if(t.length>0)return t[0].oAjaxData}),Vt("ajax.reload()",function(t,e){return this.iterator("table",function(n){Te(n,!1===e,t)})}),Vt("ajax.url()",function(e){var n=this.context;return e===a?0===n.length?a:(n=n[0],n.ajax?t.isPlainObject(n.ajax)?n.ajax.url:n.ajax:n.sAjaxSource):this.iterator("table",function(n){t.isPlainObject(n.ajax)?n.ajax.url=e:n.ajax=e})}),Vt("ajax.url().load()",function(t,e){return this.iterator("table",function(n){Te(n,!1===e,t)})});var Ce=function(e,n,r,o,i){var s,l,u,c,f,d,h=[],p=typeof n;for(n&&"string"!==p&&"function"!==p&&n.length!==a||(n=[n]),u=0,c=n.length;u<c;u++)for(f=0,d=(l=n[u]&&n[u].split&&!n[u].match(/[\[\(:]/)?n[u].split(","):[n[u]]).length;f<d;f++)(s=r("string"==typeof l[f]?t.trim(l[f]):l[f]))&&s.length&&(h=h.concat(s));var g=Et.selector[e];if(g.length)for(u=0,c=g.length;u<c;u++)h=g[u](o,i,h);return ce(h)},we=function(e){return e||(e={}),e.filter&&e.search===a&&(e.search=e.filter),t.extend({search:"none",order:"current",page:"all"},e)},xe=function(t){for(var e=0,n=t.length;e<n;e++)if(t[e].length>0)return t[0]=t[e],t[0].length=1,t.length=1,t.context=[t.context[e]],t;return t.length=0,t},Ie=function(e,n){var a,r,o,i=[],s=e.aiDisplay,l=e.aiDisplayMaster,u=n.search,c=n.order,f=n.page;if("ssp"==Mt(e))return"removed"===u?[]:se(0,l.length);if("current"==f)for(a=e._iDisplayStart,r=e.fnDisplayEnd();a<r;a++)i.push(s[a]);else if("current"==c||"applied"==c)i="none"==u?l.slice():"applied"==u?s.slice():t.map(l,function(e,n){return-1===t.inArray(e,s)?e:null});else if("index"==c||"original"==c)for(a=0,r=e.aoData.length;a<r;a++)"none"==u?i.push(a):(-1===(o=t.inArray(a,s))&&"removed"==u||o>=0&&"applied"==u)&&i.push(a);return i},Ae=function(e,n,r){var o;return Ce("row",n,function(n){var i=te(n);if(null!==i&&!r)return[i];if(o||(o=Ie(e,r)),null!==i&&-1!==t.inArray(i,o))return[i];if(null===n||n===a||""===n)return o;if("function"==typeof n)return t.map(o,function(t){var a=e.aoData[t];return n(t,a._aData,a.nTr)?t:null});var s=le(ie(e.aoData,o,"nTr"));if(n.nodeName){if(n._DT_RowIndex!==a)return[n._DT_RowIndex];if(n._DT_CellIndex)return[n._DT_CellIndex.row];var l=t(n).closest("*[data-dt-row]");return l.length?[l.data("dt-row")]:[]}if("string"==typeof n&&"#"===n.charAt(0)){var u=e.aIds[n.replace(/^#/,"")];if(u!==a)return[u.idx]}return t(s).filter(n).map(function(){return this._DT_RowIndex}).toArray()},e,r)};Vt("rows()",function(e,n){e===a?e="":t.isPlainObject(e)&&(n=e,e=""),n=we(n);var r=this.iterator("table",function(t){return Ae(t,e,n)},1);return r.selector.rows=e,r.selector.opts=n,r}),Vt("rows().nodes()",function(){return this.iterator("row",function(t,e){return t.aoData[e].nTr||a},1)}),Vt("rows().data()",function(){return this.iterator(!0,"rows",function(t,e){return ie(t.aoData,e,"_aData")},1)}),Xt("rows().cache()","row().cache()",function(t){return this.iterator("row",function(e,n){var a=e.aoData[n];return"search"===t?a._aFilterData:a._aSortData},1)}),Xt("rows().invalidate()","row().invalidate()",function(t){return this.iterator("row",function(e,n){L(e,n,t)})}),Xt("rows().indexes()","row().index()",function(){return this.iterator("row",function(t,e){return e},1)}),Xt("rows().ids()","row().id()",function(t){for(var e=[],n=this.context,a=0,r=n.length;a<r;a++)for(var o=0,i=this[a].length;o<i;o++){var s=n[a].rowIdFn(n[a].aoData[this[a][o]]._aData);e.push((!0===t?"#":"")+s)}return new Jt(n,e)}),Xt("rows().remove()","row().remove()",function(){var t=this;return this.iterator("row",function(e,n,r){var o,i,s,l,u,c,f=e.aoData,d=f[n];for(f.splice(n,1),o=0,i=f.length;o<i;o++)if(u=f[o],c=u.anCells,null!==u.nTr&&(u.nTr._DT_RowIndex=o),null!==c)for(s=0,l=c.length;s<l;s++)c[s]._DT_CellIndex.row=o;F(e.aiDisplayMaster,n),F(e.aiDisplay,n),F(t[r],n,!1),Ot(e);var h=e.rowIdFn(d._aData);h!==a&&delete e.aIds[h]}),this.iterator("table",function(t){for(var e=0,n=t.aoData.length;e<n;e++)t.aoData[e].idx=e}),this}),Vt("rows.add()",function(e){var n=this.iterator("table",function(t){var n,a,r,o=[];for(a=0,r=e.length;a<r;a++)(n=e[a]).nodeName&&"TR"===n.nodeName.toUpperCase()?o.push(y(t,n)[0]):o.push(D(t,n));return o},1),a=this.rows(-1);return a.pop(),t.merge(a,n),a}),Vt("row()",function(t,e){return xe(this.rows(t,e))}),Vt("row().data()",function(t){var e=this.context;return t===a?e.length&&this.length?e[0].aoData[this[0]]._aData:a:(e[0].aoData[this[0]]._aData=t,L(e[0],this[0],"data"),this)}),Vt("row().node()",function(){var t=this.context;return t.length&&this.length?t[0].aoData[this[0]].nTr||null:null}),Vt("row.add()",function(e){e instanceof t&&e.length&&(e=e[0]);var n=this.iterator("table",function(t){return e.nodeName&&"TR"===e.nodeName.toUpperCase()?y(t,e)[0]:D(t,e)});return this.row(n[0])});var Fe=function(e,n,a,r){var o=[],i=function(n,a){if(t.isArray(n)||n instanceof t)for(var r=0,s=n.length;r<s;r++)i(n[r],a);else if(n.nodeName&&"tr"===n.nodeName.toLowerCase())o.push(n);else{var l=t("<tr><td/></tr>").addClass(a);t("td",l).addClass(a).html(n)[0].colSpan=b(e),o.push(l[0])}};i(a,r),n._details&&n._details.detach(),n._details=t(o),n._detailsShow&&n._details.insertAfter(n.nTr)},Le=function(t,e){var n=t.context;if(n.length){var r=n[0].aoData[e!==a?e:t[0]];r&&r._details&&(r._details.remove(),r._detailsShow=a,r._details=a)}},Pe=function(t,e){var n=t.context;if(n.length&&t.length){var a=n[0].aoData[t[0]];a._details&&(a._detailsShow=e,e?a._details.insertAfter(a.nTr):a._details.detach(),Re(n[0]))}},Re=function(t){var e=new Jt(t),n=t.aoData;e.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),oe(n,"_details").length>0&&(e.on("draw.dt.DT_details",function(a,r){t===r&&e.rows({page:"current"}).eq(0).each(function(t){var e=n[t];e._detailsShow&&e._details.insertAfter(e.nTr)})}),e.on("column-visibility.dt.DT_details",function(e,a,r,o){if(t===a)for(var i,s=b(a),l=0,u=n.length;l<u;l++)(i=n[l])._details&&i._details.children("td[colspan]").attr("colspan",s)}),e.on("destroy.dt.DT_details",function(a,r){if(t===r)for(var o=0,i=n.length;o<i;o++)n[o]._details&&Le(e,o)}))};Vt("row().child()",function(t,e){var n=this.context;return t===a?n.length&&this.length?n[0].aoData[this[0]]._details:a:(!0===t?this.child.show():!1===t?Le(this):n.length&&this.length&&Fe(n[0],n[0].aoData[this[0]],t,e),this)}),Vt(["row().child.show()","row().child().show()"],function(t){return Pe(this,!0),this}),Vt(["row().child.hide()","row().child().hide()"],function(){return Pe(this,!1),this}),Vt(["row().child.remove()","row().child().remove()"],function(){return Le(this),this}),Vt("row().child.isShown()",function(){var t=this.context;return!(!t.length||!this.length)&&(t[0].aoData[this[0]]._detailsShow||!1)});var je=/^([^:]+):(name|visIdx|visible)$/,He=function(t,e,n,a,r){for(var o=[],i=0,s=r.length;i<s;i++)o.push(_(t,r[i],e));return o},Ne=function(e,n,a){var r=e.aoColumns,o=oe(r,"sName"),i=oe(r,"nTh");return Ce("column",n,function(n){var s=te(n);if(""===n)return se(r.length);if(null!==s)return[s>=0?s:r.length+s];if("function"==typeof n){var l=Ie(e,a);return t.map(r,function(t,a){return n(a,He(e,a,0,0,l),i[a])?a:null})}var u="string"==typeof n?n.match(je):"";if(u)switch(u[2]){case"visIdx":case"visible":var c=parseInt(u[1],10);if(c<0){var f=t.map(r,function(t,e){return t.bVisible?e:null});return[f[f.length+c]]}return[p(e,c)];case"name":return t.map(o,function(t,e){return t===u[1]?e:null});default:return[]}if(n.nodeName&&n._DT_CellIndex)return[n._DT_CellIndex.column];var d=t(i).filter(n).map(function(){return t.inArray(this,i)}).toArray();if(d.length||!n.nodeName)return d;var h=t(n).closest("*[data-dt-column]");return h.length?[h.data("dt-column")]:[]},e,a)},Oe=function(e,n,r){var o,i,s,l,u=e.aoColumns,c=u[n],f=e.aoData;if(r===a)return c.bVisible;if(c.bVisible!==r){if(r){var d=t.inArray(!0,oe(u,"bVisible"),n+1);for(i=0,s=f.length;i<s;i++)l=f[i].nTr,o=f[i].anCells,l&&l.insertBefore(o[n],o[d]||null)}else t(oe(e.aoData,"anCells",n)).detach();c.bVisible=r,N(e,e.aoHeader),N(e,e.aoFooter),It(e)}};Vt("columns()",function(e,n){e===a?e="":t.isPlainObject(e)&&(n=e,e=""),n=we(n);var r=this.iterator("table",function(t){return Ne(t,e,n)},1);return r.selector.cols=e,r.selector.opts=n,r}),Xt("columns().header()","column().header()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTh},1)}),Xt("columns().footer()","column().footer()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTf},1)}),Xt("columns().data()","column().data()",function(){return this.iterator("column-rows",He,1)}),Xt("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].mData},1)}),Xt("columns().cache()","column().cache()",function(t){return this.iterator("column-rows",function(e,n,a,r,o){return ie(e.aoData,o,"search"===t?"_aFilterData":"_aSortData",n)},1)}),Xt("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(t,e,n,a,r){return ie(t.aoData,r,"anCells",e)},1)}),Xt("columns().visible()","column().visible()",function(t,e){var n=this.iterator("column",function(e,n){if(t===a)return e.aoColumns[n].bVisible;Oe(e,n,t)});return t!==a&&(this.iterator("column",function(n,a){Nt(n,null,"column-visibility",[n,a,t,e])}),(e===a||e)&&this.columns.adjust()),n}),Xt("columns().indexes()","column().index()",function(t){return this.iterator("column",function(e,n){return"visible"===t?g(e,n):n},1)}),Vt("columns.adjust()",function(){return this.iterator("table",function(t){h(t)},1)}),Vt("column.index()",function(t,e){if(0!==this.context.length){var n=this.context[0];if("fromVisible"===t||"toData"===t)return p(n,e);if("fromData"===t||"toVisible"===t)return g(n,e)}}),Vt("column()",function(t,e){return xe(this.columns(t,e))});var ke=function(e,n,r){var o,i,s,l,u,c,f,d=e.aoData,h=Ie(e,r),p=le(ie(d,h,"anCells")),g=t([].concat.apply([],p)),b=e.aoColumns.length;return Ce("cell",n,function(n){var r="function"==typeof n;if(null===n||n===a||r){for(i=[],s=0,l=h.length;s<l;s++)for(o=h[s],u=0;u<b;u++)c={row:o,column:u},r?(f=d[o],n(c,_(e,o,u),f.anCells?f.anCells[u]:null)&&i.push(c)):i.push(c);return i}if(t.isPlainObject(n))return[n];var p=g.filter(n).map(function(t,e){return{row:e._DT_CellIndex.row,column:e._DT_CellIndex.column}}).toArray();return p.length||!n.nodeName?p:(f=t(n).closest("*[data-dt-row]"),f.length?[{row:f.data("dt-row"),column:f.data("dt-column")}]:[])},e,r)};Vt("cells()",function(e,n,r){if(t.isPlainObject(e)&&(e.row===a?(r=e,e=null):(r=n,n=null)),t.isPlainObject(n)&&(r=n,n=null),null===n||n===a)return this.iterator("table",function(t){return ke(t,e,we(r))});var o,i,s,l,u,c=this.columns(n,r),f=this.rows(e,r),d=this.iterator("table",function(t,e){for(o=[],i=0,s=f[e].length;i<s;i++)for(l=0,u=c[e].length;l<u;l++)o.push({row:f[e][i],column:c[e][l]});return o},1);return t.extend(d.selector,{cols:n,rows:e,opts:r}),d}),Xt("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(t,e,n){var r=t.aoData[e];return r&&r.anCells?r.anCells[n]:a},1)}),Vt("cells().data()",function(){return this.iterator("cell",function(t,e,n){return _(t,e,n)},1)}),Xt("cells().cache()","cell().cache()",function(t){return t="search"===t?"_aFilterData":"_aSortData",this.iterator("cell",function(e,n,a){return e.aoData[n][t][a]},1)}),Xt("cells().render()","cell().render()",function(t){return this.iterator("cell",function(e,n,a){return _(e,n,a,t)},1)}),Xt("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(t,e,n){return{row:e,column:n,columnVisible:g(t,n)}},1)}),Xt("cells().invalidate()","cell().invalidate()",function(t){return this.iterator("cell",function(e,n,a){L(e,n,t,a)})}),Vt("cell()",function(t,e,n){return xe(this.cells(t,e,n))}),Vt("cell().data()",function(t){var e=this.context,n=this[0];return t===a?e.length&&n.length?_(e[0],n[0].row,n[0].column):a:(T(e[0],n[0].row,n[0].column,t),L(e[0],n[0].row,"data",n[0].column),this)}),Vt("order()",function(e,n){var r=this.context;return e===a?0!==r.length?r[0].aaSorting:a:("number"==typeof e?e=[[e,n]]:e.length&&!t.isArray(e[0])&&(e=Array.prototype.slice.call(arguments)),this.iterator("table",function(t){t.aaSorting=e.slice()}))}),Vt("order.listener()",function(t,e,n){return this.iterator("table",function(a){Ct(a,t,e,n)})}),Vt("order.fixed()",function(e){if(!e){var n=this.context,r=n.length?n[0].aaSortingFixed:a;return t.isArray(r)?{pre:r}:r}return this.iterator("table",function(n){n.aaSortingFixed=t.extend(!0,{},e)})}),Vt(["columns().order()","column().order()"],function(e){var n=this;return this.iterator("table",function(a,r){var o=[];t.each(n[r],function(t,n){o.push([n,e])}),a.aaSorting=o})}),Vt("search()",function(e,n,r,o){var i=this.context;return e===a?0!==i.length?i[0].oPreviousSearch.sSearch:a:this.iterator("table",function(a){a.oFeatures.bFilter&&G(a,t.extend({},a.oPreviousSearch,{sSearch:e+"",bRegex:null!==n&&n,bSmart:null===r||r,bCaseInsensitive:null===o||o}),1)})}),Xt("columns().search()","column().search()",function(e,n,r,o){return this.iterator("column",function(i,s){var l=i.aoPreSearchCols;if(e===a)return l[s].sSearch;i.oFeatures.bFilter&&(t.extend(l[s],{sSearch:e+"",bRegex:null!==n&&n,bSmart:null===r||r,bCaseInsensitive:null===o||o}),G(i,i.oPreviousSearch,1))})}),Vt("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Vt("state.clear()",function(){return this.iterator("table",function(t){t.fnStateSaveCallback.call(t.oInstance,t,{})})}),Vt("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Vt("state.save()",function(){return this.iterator("table",function(t){It(t)})}),qt.versionCheck=qt.fnVersionCheck=function(t){for(var e,n,a=qt.version.split("."),r=t.split("."),o=0,i=r.length;o<i;o++)if(e=parseInt(a[o],10)||0,n=parseInt(r[o],10)||0,e!==n)return e>n;return!0},qt.isDataTable=qt.fnIsDataTable=function(e){var n=t(e).get(0),a=!1;return e instanceof qt.Api||(t.each(qt.settings,function(e,r){var o=r.nScrollHead?t("table",r.nScrollHead)[0]:null,i=r.nScrollFoot?t("table",r.nScrollFoot)[0]:null;r.nTable!==n&&o!==n&&i!==n||(a=!0)}),a)},qt.tables=qt.fnTables=function(e){var n=!1;t.isPlainObject(e)&&(n=e.api,e=e.visible);var a=t.map(qt.settings,function(n){if(!e||e&&t(n.nTable).is(":visible"))return n.nTable});return n?new Jt(a):a},qt.camelToHungarian=o,Vt("$()",function(e,n){var a=this.rows(n).nodes(),r=t(a);return t([].concat(r.filter(e).toArray(),r.find(e).toArray()))}),t.each(["on","one","off"],function(e,n){Vt(n+"()",function(){var e=Array.prototype.slice.call(arguments);e[0]=t.map(e[0].split(/\s/),function(t){return t.match(/\.dt\b/)?t:t+".dt"}).join(" ");var a=t(this.tables().nodes());return a[n].apply(a,e),this})}),Vt("clear()",function(){return this.iterator("table",function(t){A(t)})}),Vt("settings()",function(){return new Jt(this.context,this.context)}),Vt("init()",function(){var t=this.context;return t.length?t[0].oInit:null}),Vt("data()",function(){return this.iterator("table",function(t){return oe(t.aoData,"_aData")}).flatten()}),Vt("destroy()",function(n){return n=n||!1,this.iterator("table",function(a){var r,o=a.nTableWrapper.parentNode,i=a.oClasses,s=a.nTable,l=a.nTBody,u=a.nTHead,c=a.nTFoot,f=t(s),d=t(l),h=t(a.nTableWrapper),p=t.map(a.aoData,function(t){return t.nTr});a.bDestroying=!0,Nt(a,"aoDestroyCallback","destroy",[a]),n||new Jt(a).columns().visible(!0),h.off(".DT").find(":not(tbody *)").off(".DT"),t(e).off(".DT-"+a.sInstance),s!=u.parentNode&&(f.children("thead").detach(),f.append(u)),c&&s!=c.parentNode&&(f.children("tfoot").detach(),f.append(c)),a.aaSorting=[],a.aaSortingFixed=[],wt(a),t(p).removeClass(a.asStripeClasses.join(" ")),t("th, td",u).removeClass(i.sSortable+" "+i.sSortableAsc+" "+i.sSortableDesc+" "+i.sSortableNone),a.bJUI&&(t("th span."+i.sSortIcon+", td span."+i.sSortIcon,u).detach(),t("th, td",u).each(function(){var e=t("div."+i.sSortJUIWrapper,this);t(this).append(e.contents()),e.detach()})),d.children().detach(),d.append(p);var g=n?"remove":"detach";f[g](),h[g](),!n&&o&&(o.insertBefore(s,a.nTableReinsertBefore),f.css("width",a.sDestroyWidth).removeClass(i.sTable),(r=a.asDestroyStripes.length)&&d.children().each(function(e){t(this).addClass(a.asDestroyStripes[e%r])}));var b=t.inArray(a,qt.settings);-1!==b&&qt.settings.splice(b,1)})}),t.each(["column","row","cell"],function(t,e){Vt(e+"s().every()",function(t){var n=this.selector.opts,r=this;return this.iterator(e,function(o,i,s,l,u){t.call(r[e](i,"cell"===e?s:n,"cell"===e?n:a),i,s,l,u)})})}),Vt("i18n()",function(e,n,r){var o=this.context[0],i=w(e)(o.oLanguage);return i===a&&(i=n),r!==a&&t.isPlainObject(i)&&(i=i[r]!==a?i[r]:i._),i.replace("%d",r)}),qt.version="1.10.13",qt.settings=[],qt.models={},qt.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},qt.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},qt.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},qt.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(t){try{return JSON.parse((-1===t.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+t.sInstance+"_"+location.pathname))}catch(t){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(t,e){try{(-1===t.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+t.sInstance+"_"+location.pathname,JSON.stringify(e))}catch(t){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:t.extend({},qt.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},r(qt.defaults),qt.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},r(qt.defaults.column),qt.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:a,oAjaxData:a,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==Mt(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==Mt(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var t=this._iDisplayLength,e=this._iDisplayStart,n=e+t,a=this.aiDisplay.length,r=this.oFeatures,o=r.bPaginate;return r.bServerSide?!1===o||-1===t?e+a:Math.min(e+t,this._iRecordsDisplay):!o||n>a||-1===t?a:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},qt.ext=Et={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:qt.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:qt.version},t.extend(Et,{afnFiltering:Et.search,aTypes:Et.type.detect,ofnSearch:Et.type.search,oSort:Et.type.order,afnSortData:Et.order,aoFeatures:Et.feature,oApi:Et.internal,oStdClasses:Et.classes,oPagination:Et.pager}),t.extend(qt.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),function(){var e="ui-state-default",n="css_right ui-icon ui-icon-",a="fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";t.extend(qt.ext.oJUIClasses,qt.ext.classes,{sPageButton:"fg-button ui-button "+e,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:e+" sorting_asc",sSortDesc:e+" sorting_desc",sSortable:e+" sorting",sSortableAsc:e+" sorting_asc_disabled",sSortableDesc:e+" sorting_desc_disabled",sSortableNone:e+" sorting_disabled",sSortJUIAsc:n+"triangle-1-n",sSortJUIDesc:n+"triangle-1-s",sSortJUI:n+"carat-2-n-s",sSortJUIAscAllowed:n+"carat-1-n",sSortJUIDescAllowed:n+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+e,sScrollFoot:"dataTables_scrollFoot "+e,sHeaderTH:e,sFooterTH:e,sJUIHeader:a+" ui-corner-tl ui-corner-tr",sJUIFooter:a+" ui-corner-bl ui-corner-br"})}();var Me=qt.ext.pager;t.extend(Me,{simple:function(t,e){return["previous","next"]},full:function(t,e){return["first","previous","next","last"]},numbers:function(t,e){return[Wt(t,e)]},simple_numbers:function(t,e){return["previous",Wt(t,e),"next"]},full_numbers:function(t,e){return["first","previous",Wt(t,e),"next","last"]},first_last_numbers:function(t,e){return["first",Wt(t,e),"last"]},_numbers:Wt,numbers_length:7}),t.extend(!0,qt.ext.renderer,{pageButton:{_:function(e,r,o,i,s,l){var u,c,f,d,h=e.oClasses,p=e.oLanguage.oPaginate,g=e.oLanguage.oAria.paginate||{},b=0,v=function(n,a){var r,i,d;for(r=0,i=a.length;r<i;r++)if(d=a[r],t.isArray(d)){var S=t("<"+(d.DT_el||"div")+"/>").appendTo(n);v(S,d)}else{switch(u=null,c="",f=0,d){case"ellipsis":n.append('<span class="ellipsis">&#x2026;</span>');break;case"first":u=p.sFirst,c=d+(s>0?"":" "+h.sPageButtonDisabled),f=s>0?e.iTabIndex:-1;break;case"previous":u=p.sPrevious,c=d+(s>0?"":" "+h.sPageButtonDisabled),f=s>0?e.iTabIndex:-1;break;case"next":u=p.sNext,c=d+(s<l-1?"":" "+h.sPageButtonDisabled),f=s<l-1?e.iTabIndex:-1;break;case"last":u=p.sLast,c=d+(s<l-1?"":" "+h.sPageButtonDisabled),f=s<l-1?e.iTabIndex:-1;break;default:u=d+1,c=s===d?h.sPageButtonActive:""}null!==u&&(jt(t("<a>",{class:h.sPageButton+" "+c,"aria-controls":e.sTableId,"aria-label":g[d],"data-dt-idx":b,"href":"#",tabindex:f,id:0===o&&"string"==typeof d?e.sTableId+"_"+d:null}).html(u).appendTo(n),{action:d},function(t){ut(e,t.data.action,!0)}),b++)}};try{d=t(r).find(n.activeElement).data("dt-idx")}catch(t){}v(t(r).empty(),i),d!==a&&t(r).find("[data-dt-idx="+d+"]").focus()}}}),t.extend(qt.ext.type.detect,[function(t,e){var n=e.oLanguage.sDecimal;return ne(t,n)?"num"+n:null},function(t,e){if(t&&!(t instanceof Date)&&!Yt.test(t))return null;var n=Date.parse(t);return null!==n&&!isNaN(n)||Kt(t)?"date":null},function(t,e){var n=e.oLanguage.sDecimal;return ne(t,n,!0)?"num-fmt"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return re(t,n)?"html-num"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return re(t,n,!0)?"html-num-fmt"+n:null},function(t,e){return Kt(t)||"string"==typeof t&&-1!==t.indexOf("<")?"html":null}]),t.extend(qt.ext.type.search,{html:function(t){return Kt(t)?t:"string"==typeof t?t.replace($t," ").replace(zt,""):""},string:function(t){return Kt(t)?t:"string"==typeof t?t.replace($t," "):t}});var We=function(t,e,n,a){return 0===t||t&&"-"!==t?(e&&(t=ee(t,e)),t.replace&&(n&&(t=t.replace(n,"")),a&&(t=t.replace(a,""))),1*t):-1/0};t.extend(Et.type.order,{"date-pre":function(t){return Date.parse(t)||-1/0},"html-pre":function(t){return Kt(t)?"":t.replace?t.replace(/<.*?>/g,"").toLowerCase():t+""},"string-pre":function(t){return Kt(t)?"":"string"==typeof t?t.toLowerCase():t.toString?t.toString():""},"string-asc":function(t,e){return t<e?-1:t>e?1:0},"string-desc":function(t,e){return t<e?1:t>e?-1:0}}),Ut(""),t.extend(!0,qt.ext.renderer,{header:{_:function(e,n,a,r){t(e.nTable).on("order.dt.DT",function(t,o,i,s){if(e===o){var l=a.idx;n.removeClass(a.sSortingClass+" "+r.sSortAsc+" "+r.sSortDesc).addClass("asc"==s[l]?r.sSortAsc:"desc"==s[l]?r.sSortDesc:a.sSortingClass)}})},jqueryui:function(e,n,a,r){t("<div/>").addClass(r.sSortJUIWrapper).append(n.contents()).append(t("<span/>").addClass(r.sSortIcon+" "+a.sSortingClassJUI)).appendTo(n),t(e.nTable).on("order.dt.DT",function(t,o,i,s){if(e===o){var l=a.idx;n.removeClass(r.sSortAsc+" "+r.sSortDesc).addClass("asc"==s[l]?r.sSortAsc:"desc"==s[l]?r.sSortDesc:a.sSortingClass),n.find("span."+r.sSortIcon).removeClass(r.sSortJUIAsc+" "+r.sSortJUIDesc+" "+r.sSortJUI+" "+r.sSortJUIAscAllowed+" "+r.sSortJUIDescAllowed).addClass("asc"==s[l]?r.sSortJUIAsc:"desc"==s[l]?r.sSortJUIDesc:a.sSortingClassJUI)}})}}});var Ue=function(t){return"string"==typeof t?t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):t};return qt.render={number:function(t,e,n,a,r){return{display:function(o){if("number"!=typeof o&&"string"!=typeof o)return o;var i=o<0?"-":"",s=parseFloat(o);if(isNaN(s))return Ue(o);s=s.toFixed(n),o=Math.abs(s);var l=parseInt(o,10),u=n?e+(o-l).toFixed(n).substring(2):"";return i+(a||"")+l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,t)+u+(r||"")}}},text:function(){return{display:Ue}}},t.extend(qt.ext.internal,{_fnExternApiFunc:Bt,_fnBuildAjax:B,_fnAjaxUpdate:E,_fnAjaxParameters:J,_fnAjaxUpdateDraw:V,_fnAjaxDataSrc:X,_fnAddColumn:f,_fnColumnOptions:d,_fnAdjustColumnSizing:h,_fnVisibleToColumnIndex:p,_fnColumnIndexToVisible:g,_fnVisbleColumns:b,_fnGetColumns:v,_fnColumnTypes:S,_fnApplyColumnDefs:m,_fnHungarianMap:r,_fnCamelToHungarian:o,_fnLanguageCompat:i,_fnBrowserDetect:u,_fnAddData:D,_fnAddTr:y,_fnNodeToDataIndex:function(t,e){return e._DT_RowIndex!==a?e._DT_RowIndex:null},_fnNodeToColumnIndex:function(e,n,a){return t.inArray(a,e.aoData[n].anCells)},_fnGetCellData:_,_fnSetCellData:T,_fnSplitObjNotation:C,_fnGetObjectDataFn:w,_fnSetObjectDataFn:x,_fnGetDataMaster:I,_fnClearTable:A,_fnDeleteIndex:F,_fnInvalidate:L,_fnGetRowElements:P,_fnCreateTr:R,_fnBuildHead:H,_fnDrawHead:N,_fnDraw:O,_fnReDraw:k,_fnAddOptionsHtml:M,_fnDetectHeader:W,_fnGetUniqueThs:U,_fnFeatureHtmlFilter:q,_fnFilterComplete:G,_fnFilterCustom:$,_fnFilterColumn:z,_fnFilter:Y,_fnFilterCreateSearch:Z,_fnEscapeRegex:pe,_fnFilterData:Q,_fnFeatureHtmlInfo:et,_fnUpdateInfo:nt,_fnInfoMacros:at,_fnInitialise:rt,_fnInitComplete:ot,_fnLengthChange:it,_fnFeatureHtmlLength:st,_fnFeatureHtmlPaginate:lt,_fnPageChange:ut,_fnFeatureHtmlProcessing:ct,_fnProcessingDisplay:ft,_fnFeatureHtmlTable:dt,_fnScrollDraw:ht,_fnApplyToChildren:pt,_fnCalculateColumnWidths:gt,_fnThrottle:Se,_fnConvertToWidth:bt,_fnGetWidestNode:vt,_fnGetMaxLenString:St,_fnStringToCss:mt,_fnSortFlatten:Dt,_fnSort:yt,_fnSortAria:_t,_fnSortListener:Tt,_fnSortAttachListener:Ct,_fnSortingClasses:wt,_fnSortData:xt,_fnSaveState:It,_fnLoadState:At,_fnSettingsFromNode:Ft,_fnLog:Lt,_fnMap:Pt,_fnBindAction:jt,_fnCallbackReg:Ht,_fnCallbackFire:Nt,_fnLengthOverflow:Ot,_fnRenderer:kt,_fnDataSource:Mt,_fnRowAttributes:j,_fnCalculateEnd:function(){}}),t.fn.dataTable=qt,qt.$=t,t.fn.dataTableSettings=qt.settings,t.fn.dataTableExt=qt.ext,t.fn.DataTable=function(e){return t(this).dataTable(e).api()},t.each(qt,function(e,n){t.fn.DataTable[e]=n}),t.fn.dataTable});
/**
 * Legend
browser:
	ed = Microsoft Edge
	ie9 = Explorer 9
	ie10 = Explorer 10
	ie11 = Explorer 11
	ie? = Explorer 8 and below
	ff = Firefox
	gc = Google Chrome
	sa = Safari
	op = Opera
os:
	win7
	win8
	win9
	win10
	winvista
	winxp
	winnt
	mac
	linux
	nix
mobile - including tablets:
	0 = Not a mobile or tablet device
	w = Windows Phone (Nokia Lumia)
	i = iOS (iPhone iPad)
	a = Android
	b = Blackberry
	s = Undetected mobile device running Safari
	1 = Undetected mobile device
tablet:
	true
	false
touch:
	true
	false
 */
ACC.browserDetect = {

	_autoload: [
		"checkCompliance"
	],
	
	ua : navigator.userAgent,
	
	checkCompliance: function(){
		// detectme 
		var isOld = ACC.browserDetect.isIEOld();
		var detectBrowser = $("#browserDetectModal");
		if(detectBrowser.length){
			if(isOld){
				detectBrowser.modal("show");
			}else{
				// Hide Modal
			}
		}
	},
	
	returnBrowser: function(ua){
		var browser;
		if (/Edge\/\d+/.test(ua)) {
			browser = 'ed';
		} else if(/Firefox\W\d/.test(ua)) {
			browser = 'ff';
		} else if(/Chrom(e|ium)\W\d|CriOS\W\d/.test(ua)) {
			browser = 'gc';
		} else if(/\bSafari\W\d/.test(ua)) {
			browser = 'sa';
		} else if(/\bOpera\W\d/.test(ua) || /\bOPR\W\d/i.test(ua)) {
			browser = 'op';
		} else{
			browser = ACC.browserDetect.returnIE(ua);
		}
		return browser;
	},
	
	returnIE: function(ua){
		var ie;
		if(/MSIE 9/.test(ua)) {
			ie = 'ie9';
		} else if(/MSIE 10/.test(ua)) {
			ie = 'ie10';
		} else if(/MSIE 11/.test(ua) || /rv\:11/.test(ua)) {
			ie = 'ie11';
		} else if(/MSIE\s\d/.test(ua) || typeof MSPointerEvent !== 'undefined') {
			ie = 'ie?';
		}
		return ie;
	},
	
	returnOs: function(ua){
		var os;
		if (/Windows NT 10/.test(ua)) {
			os = 'win10';
		} else if(/Windows NT 6\.0/.test(ua)) {
			os = 'winvista';
		} else if(/Windows NT 6\.1/.test(ua)) {
			os = 'win7';
		} else if(/Windows NT 6\.\d/.test(ua)) {
			os = 'win8';
		} else if(/Windows NT 5\.1/.test(ua)) {
			os = 'winxp';
		} else if(/Windows NT [1-5]\./.test(ua)) {
			os = 'winnt';
		} else if(/Mac/.test(ua)) {
			os = 'mac';
		} else if(/Linux/.test(ua)) {
			os = 'linux';
		} else if(/X11/.test(ua)) {
			os = 'nix';
		}
		return os;
	},
		
	returnMobile: function(ua){
		var mobile;
		if (/IEMobile|Windows Phone|Lumia/i.test(ua)) {
			mobile = 'w';
		} else if(/iPhone|iP[oa]d/.test(ua)) {
			mobile = 'iOS';
		} else if(/Android/.test(ua)) {
			mobile = 'a';
		} else if(/BlackBerry|PlayBook|BB10/.test(ua)) {
			mobile = 'b';
		} else if(/Mobile Safari/.test(ua)) {
			mobile = 's';
		} else if(/webOS|Mobile|Tablet|Opera Mini|\bCrMo\/|Opera Mobi/i.test(ua)) {
			mobile = 1;
		}
		return mobile;
	},
		
	isiOS: function(){
		return ACC.browserDetect.returnMobile(ACC.browserDetect.ua) === "iOS";
	},
		
	isAndroid: function(){
		return ACC.browserDetect.returnMobile(ACC.browserDetect.ua) === "a";
	},
		
	isFirefox: function(){
		return ACC.browserDetect.returnBrowser(ACC.browserDetect.ua) === "ff";
	},

	isMobile: function(){
		return typeof( ACC.browserDetect.returnMobile(ACC.browserDetect.ua) ) !== "undefined";
	},
	
	detectMe: function (){
		var ua = ACC.browserDetect.ua, browser, os, mobile;
		
		browser = ACC.browserDetect.returnBrowser(ua);
		
		var touch = 'ontouchstart' in document.documentElement;
		var tablet = /Tablet|iPad/i.test(ua);
		
		os = ACC.browserDetect.returnOs(ua);
		
		mobile = ACC.browserDetect.returnMobile(ua);
		
		return {
			"browser": browser,
		    "os": os,
		    "mobile": mobile,
		    "touch": touch,
		    "tablet": tablet
		};
	},
	
	isIEOld: function (){
		//userAgent in IE7 WinXP returns: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727)
		//userAgent in IE11 Win7 returns: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko
		var detectIEregexp;
		
		if (navigator.userAgent.indexOf('MSIE') !== -1){
			detectIEregexp = /MSIE (\d+\.\d+);/ ;//test for MSIE x.x
		}
		else {
			// if no "MSIE" string in userAgent
			detectIEregexp = /Trident.*rv[ :]*(\d+\.\d+)/ ;//test for rv:x.x or rv x.x where Trident string exists
		
		}
		if (detectIEregexp.test(navigator.userAgent)){ //if some form of IE
		 var ieversion = parseInt(RegExp.$1); // capture x.x portion and store as a number
         return (ieversion>=10) ? false : true ;
		}
	},
	
	getIEVersion: function (){
		var detectIEregexp;
		if (navigator.userAgent.indexOf('MSIE') !== -1){
			detectIEregexp = /MSIE (\d+\.\d+);/ ;//test for MSIE x.x
		}
		else {
			// if no "MSIE" string in userAgent
			detectIEregexp = /Trident.*rv[ :]*(\d+\.\d+)/ ;//test for rv:x.x or rv x.x where Trident string exists
		}
		if (detectIEregexp.test(navigator.userAgent)){ //if some form of IE
			return parseInt(RegExp.$1); // capture x.x portion and store as a number
		}
	},
	
	doNotCall: function(){
		// detectme 
		ACC.browserDetect.detectMe();
	}
};

$(document).ready(function (){
	// For IE less than 10
	ACC.browserDetect.checkCompliance();
	
	var browser = ACC.browserDetect.detectMe();
	$("body").addClass("browser-"+browser.browser +" os-" +browser.os);
});

/*!
 * Timepicker Component for Twitter Bootstrap
 *
 * Copyright 2013 Joris de Wit and bootstrap-timepicker contributors
 *
 * Contributors https://github.com/jdewit/bootstrap-timepicker/graphs/contributors
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
(function($, window, document) {
  'use strict';

  // TIMEPICKER PUBLIC CLASS DEFINITION
  var Timepicker = function(element, options) {
    this.widget = '';
    this.$element = $(element);
    this.defaultTime = options.defaultTime;
    this.disableFocus = options.disableFocus;
    this.disableMousewheel = options.disableMousewheel;
    this.isOpen = options.isOpen;
    this.minuteStep = options.minuteStep;
    this.modalBackdrop = options.modalBackdrop;
    this.orientation = options.orientation;
    this.secondStep = options.secondStep;
    this.snapToStep = options.snapToStep;
    this.showInputs = options.showInputs;
    this.showMeridian = options.showMeridian;
    this.showSeconds = options.showSeconds;
    this.template = options.template;
    this.appendWidgetTo = options.appendWidgetTo;
    this.showWidgetOnAddonClick = options.showWidgetOnAddonClick;
    this.icons = options.icons;
    this.maxHours = options.maxHours;
    this.explicitMode = options.explicitMode; // If true 123 = 1:23, 12345 = 1:23:45, else invalid.

    this.handleDocumentClick = function (e) {
      var self = e.data.scope;
      // This condition was inspired by bootstrap-datepicker.
      // The element the timepicker is invoked on is the input but it has a sibling for addon/button.
      if (!(self.$element.parent().find(e.target).length ||
          self.$widget.is(e.target) ||
          self.$widget.find(e.target).length)) {
        self.hideWidget();
      }
    };

    this._init();
  };

  Timepicker.prototype = {

    constructor: Timepicker,
    _init: function() {
      var self = this;

      if (this.showWidgetOnAddonClick && (this.$element.parent().hasClass('input-group') && this.$element.parent().hasClass('bootstrap-timepicker'))) {
        this.$element.parent('.input-group.bootstrap-timepicker').find('.input-group-addon').on({
          'click.timepicker': $.proxy(this.showWidget, this)
        });
        this.$element.on({
          'focus.timepicker': $.proxy(this.highlightUnit, this),
          'click.timepicker': $.proxy(this.highlightUnit, this),
          'keydown.timepicker': $.proxy(this.elementKeydown, this),
          'blur.timepicker': $.proxy(this.blurElement, this),
          'mousewheel.timepicker DOMMouseScroll.timepicker': $.proxy(this.mousewheel, this)
        });
      } else {
        if (this.template) {
          this.$element.on({
            'focus.timepicker': $.proxy(this.showWidget, this),
            'click.timepicker': $.proxy(this.showWidget, this),
            'blur.timepicker': $.proxy(this.blurElement, this),
            'mousewheel.timepicker DOMMouseScroll.timepicker': $.proxy(this.mousewheel, this)
          });
        } else {
          this.$element.on({
            'focus.timepicker': $.proxy(this.highlightUnit, this),
            'click.timepicker': $.proxy(this.highlightUnit, this),
            'keydown.timepicker': $.proxy(this.elementKeydown, this),
            'blur.timepicker': $.proxy(this.blurElement, this),
            'mousewheel.timepicker DOMMouseScroll.timepicker': $.proxy(this.mousewheel, this)
          });
        }
      }

      if (this.template !== false) {
        this.$widget = $(this.getTemplate()).on('click', $.proxy(this.widgetClick, this));
      } else {
        this.$widget = false;
      }

      if (this.showInputs && this.$widget !== false) {
        this.$widget.find('input').each(function() {
          $(this).on({
            'click.timepicker': function() { $(this).select(); },
            'keydown.timepicker': $.proxy(self.widgetKeydown, self),
            'keyup.timepicker': $.proxy(self.widgetKeyup, self)
          });
        });
      }

      this.setDefaultTime(this.defaultTime);
    },

    blurElement: function() {
      this.highlightedUnit = null;
      this.updateFromElementVal();
    },

    clear: function() {
      this.hour = '';
      this.minute = '';
      this.second = '';
      this.meridian = '';

      this.$element.val('');
    },

    decrementHour: function() {
      if (this.showMeridian) {
        if (this.hour === 1) {
          this.hour = 12;
        } else if (this.hour === 12) {
          this.hour--;

          return this.toggleMeridian();
        } else if (this.hour === 0) {
          this.hour = 11;

          return this.toggleMeridian();
        } else {
          this.hour--;
        }
      } else {
        if (this.hour <= 0) {
          this.hour = this.maxHours - 1;
        } else {
          this.hour--;
        }
      }
    },

    decrementMinute: function(step) {
      var newVal;

      if (step) {
        newVal = this.minute - step;
      } else {
        newVal = this.minute - this.minuteStep;
      }

      if (newVal < 0) {
        this.decrementHour();
        this.minute = newVal + 60;
      } else {
        this.minute = newVal;
      }
    },

    decrementSecond: function() {
      var newVal = this.second - this.secondStep;

      if (newVal < 0) {
        this.decrementMinute(true);
        this.second = newVal + 60;
      } else {
        this.second = newVal;
      }
    },

    elementKeydown: function(e) {
      switch (e.which) {
      case 9: //tab
        if (e.shiftKey) {
          if (this.highlightedUnit === 'hour') {
            this.hideWidget();
            break;
          }
          this.highlightPrevUnit();
        } else if ((this.showMeridian && this.highlightedUnit === 'meridian') || (this.showSeconds && this.highlightedUnit === 'second') || (!this.showMeridian && !this.showSeconds && this.highlightedUnit ==='minute')) {
          this.hideWidget();
          break;
        } else {
          this.highlightNextUnit();
        }
        e.preventDefault();
        this.updateFromElementVal();
        break;
      case 27: // escape
        this.updateFromElementVal();
        break;
      case 37: // left arrow
        e.preventDefault();
        this.highlightPrevUnit();
        this.updateFromElementVal();
        break;
      case 38: // up arrow
        e.preventDefault();
        switch (this.highlightedUnit) {
        case 'hour':
          this.incrementHour();
          this.highlightHour();
          break;
        case 'minute':
          this.incrementMinute();
          this.highlightMinute();
          break;
        case 'second':
          this.incrementSecond();
          this.highlightSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          this.highlightMeridian();
          break;
        }
        this.update();
        break;
      case 39: // right arrow
        e.preventDefault();
        this.highlightNextUnit();
        this.updateFromElementVal();
        break;
      case 40: // down arrow
        e.preventDefault();
        switch (this.highlightedUnit) {
        case 'hour':
          this.decrementHour();
          this.highlightHour();
          break;
        case 'minute':
          this.decrementMinute();
          this.highlightMinute();
          break;
        case 'second':
          this.decrementSecond();
          this.highlightSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          this.highlightMeridian();
          break;
        }

        this.update();
        break;
      }
    },

    getCursorPosition: function() {
      var input = this.$element.get(0);

      if ('selectionStart' in input) {// Standard-compliant browsers

        return input.selectionStart;
      } else if (document.selection) {// IE fix
        input.focus();
        var sel = document.selection.createRange(),
          selLen = document.selection.createRange().text.length;

        sel.moveStart('character', - input.value.length);

        return sel.text.length - selLen;
      }
    },

    getTemplate: function() {
      var template,
        hourTemplate,
        minuteTemplate,
        secondTemplate,
        meridianTemplate,
        templateContent;

      if (this.showInputs) {
        hourTemplate = '<input type="text" class="bootstrap-timepicker-hour" maxlength="2"/>';
        minuteTemplate = '<input type="text" class="bootstrap-timepicker-minute" maxlength="2"/>';
        secondTemplate = '<input type="text" class="bootstrap-timepicker-second" maxlength="2"/>';
        meridianTemplate = '<input type="text" class="bootstrap-timepicker-meridian" maxlength="2"/>';
      } else {
        hourTemplate = '<span class="bootstrap-timepicker-hour"></span>';
        minuteTemplate = '<span class="bootstrap-timepicker-minute"></span>';
        secondTemplate = '<span class="bootstrap-timepicker-second"></span>';
        meridianTemplate = '<span class="bootstrap-timepicker-meridian"></span>';
      }

      templateContent = '<table>'+
         '<tr>'+
           '<td><a href="#" data-action="incrementHour"><span class="'+ this.icons.up +'"></span></a></td>'+
           '<td class="separator">&nbsp;</td>'+
           '<td><a href="#" data-action="incrementMinute"><span class="'+ this.icons.up +'"></span></a></td>'+
           (this.showSeconds ?
             '<td class="separator">&nbsp;</td>'+
             '<td><a href="#" data-action="incrementSecond"><span class="'+ this.icons.up +'"></span></a></td>'
           : '') +
           (this.showMeridian ?
             '<td class="separator">&nbsp;</td>'+
             '<td class="meridian-column"><a href="#" data-action="toggleMeridian"><span class="'+ this.icons.up +'"></span></a></td>'
           : '') +
         '</tr>'+
         '<tr>'+
           '<td>'+ hourTemplate +'</td> '+
           '<td class="separator">:</td>'+
           '<td>'+ minuteTemplate +'</td> '+
           (this.showSeconds ?
            '<td class="separator">:</td>'+
            '<td>'+ secondTemplate +'</td>'
           : '') +
           (this.showMeridian ?
            '<td class="separator">&nbsp;</td>'+
            '<td>'+ meridianTemplate +'</td>'
           : '') +
         '</tr>'+
         '<tr>'+
           '<td><a href="#" data-action="decrementHour"><span class="'+ this.icons.down +'"></span></a></td>'+
           '<td class="separator"></td>'+
           '<td><a href="#" data-action="decrementMinute"><span class="'+ this.icons.down +'"></span></a></td>'+
           (this.showSeconds ?
            '<td class="separator">&nbsp;</td>'+
            '<td><a href="#" data-action="decrementSecond"><span class="'+ this.icons.down +'"></span></a></td>'
           : '') +
           (this.showMeridian ?
            '<td class="separator">&nbsp;</td>'+
            '<td><a href="#" data-action="toggleMeridian"><span class="'+ this.icons.down +'"></span></a></td>'
           : '') +
         '</tr>'+
       '</table>';

      switch(this.template) {
      case 'modal':
        template = '<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+ (this.modalBackdrop ? 'true' : 'false') +'">'+
          '<div class="modal-header">'+
            '<a href="#" class="close" data-dismiss="modal">&times;</a>'+
            '<h3>Pick a Time</h3>'+
          '</div>'+
          '<div class="modal-content">'+
            templateContent +
          '</div>'+
          '<div class="modal-footer">'+
            '<a href="#" class="btn btn-primary" data-dismiss="modal">OK</a>'+
          '</div>'+
        '</div>';
        break;
      case 'dropdown':
        template = '<div class="bootstrap-timepicker-widget dropdown-menu">'+ templateContent +'</div>';
        break;
      }

      return template;
    },

    getTime: function() {
      if (this.hour === '') {
        return '';
      }

      return this.hour + ':' + (this.minute.toString().length === 1 ? '0' + this.minute : this.minute) + (this.showSeconds ? ':' + (this.second.toString().length === 1 ? '0' + this.second : this.second) : '') + (this.showMeridian ? ' ' + this.meridian : '');
    },

    hideWidget: function() {
      if (this.isOpen === false) {
        return;
      }

      this.$element.trigger({
        'type': 'hide.timepicker',
        'time': {
          'value': this.getTime(),
          'hours': this.hour,
          'minutes': this.minute,
          'seconds': this.second,
          'meridian': this.meridian
        }
      });

      if (this.template === 'modal' && this.$widget.modal) {
        this.$widget.modal('hide');
      } else {
        this.$widget.removeClass('open');
      }

      $(document).off('mousedown.timepicker, touchend.timepicker', this.handleDocumentClick);

      this.isOpen = false;
      // show/hide approach taken by datepicker
      this.$widget.detach();
    },

    highlightUnit: function() {
      this.position = this.getCursorPosition();
      if (this.position >= 0 && this.position <= 2) {
        this.highlightHour();
      } else if (this.position >= 3 && this.position <= 5) {
        this.highlightMinute();
      } else if (this.position >= 6 && this.position <= 8) {
        if (this.showSeconds) {
          this.highlightSecond();
        } else {
          this.highlightMeridian();
        }
      } else if (this.position >= 9 && this.position <= 11) {
        this.highlightMeridian();
      }
    },

    highlightNextUnit: function() {
      switch (this.highlightedUnit) {
      case 'hour':
        this.highlightMinute();
        break;
      case 'minute':
        if (this.showSeconds) {
          this.highlightSecond();
        } else if (this.showMeridian){
          this.highlightMeridian();
        } else {
          this.highlightHour();
        }
        break;
      case 'second':
        if (this.showMeridian) {
          this.highlightMeridian();
        } else {
          this.highlightHour();
        }
        break;
      case 'meridian':
        this.highlightHour();
        break;
      }
    },

    highlightPrevUnit: function() {
      switch (this.highlightedUnit) {
      case 'hour':
        if(this.showMeridian){
          this.highlightMeridian();
        } else if (this.showSeconds) {
          this.highlightSecond();
        } else {
          this.highlightMinute();
        }
        break;
      case 'minute':
        this.highlightHour();
        break;
      case 'second':
        this.highlightMinute();
        break;
      case 'meridian':
        if (this.showSeconds) {
          this.highlightSecond();
        } else {
          this.highlightMinute();
        }
        break;
      }
    },

    highlightHour: function() {
      var $element = this.$element.get(0),
          self = this;

      this.highlightedUnit = 'hour';

      if ($element.setSelectionRange) {
        setTimeout(function() {
          if (self.hour < 10) {
            $element.setSelectionRange(0,1);
          } else {
            $element.setSelectionRange(0,2);
          }
        }, 0);
      }
    },

    highlightMinute: function() {
      var $element = this.$element.get(0),
          self = this;

      this.highlightedUnit = 'minute';

      if ($element.setSelectionRange) {
        setTimeout(function() {
          if (self.hour < 10) {
            $element.setSelectionRange(2,4);
          } else {
            $element.setSelectionRange(3,5);
          }
        }, 0);
      }
    },

    highlightSecond: function() {
      var $element = this.$element.get(0),
          self = this;

      this.highlightedUnit = 'second';

      if ($element.setSelectionRange) {
        setTimeout(function() {
          if (self.hour < 10) {
            $element.setSelectionRange(5,7);
          } else {
            $element.setSelectionRange(6,8);
          }
        }, 0);
      }
    },

    highlightMeridian: function() {
      var $element = this.$element.get(0),
          self = this;

      this.highlightedUnit = 'meridian';

      if ($element.setSelectionRange) {
        if (this.showSeconds) {
          setTimeout(function() {
            if (self.hour < 10) {
              $element.setSelectionRange(8,10);
            } else {
              $element.setSelectionRange(9,11);
            }
          }, 0);
        } else {
          setTimeout(function() {
            if (self.hour < 10) {
              $element.setSelectionRange(5,7);
            } else {
              $element.setSelectionRange(6,8);
            }
          }, 0);
        }
      }
    },

    incrementHour: function() {
      if (this.showMeridian) {
        if (this.hour === 11) {
          this.hour++;
          return this.toggleMeridian();
        } else if (this.hour === 12) {
          this.hour = 0;
        }
      }
      if (this.hour === this.maxHours - 1) {
        this.hour = 0;

        return;
      }
      this.hour++;
    },

    incrementMinute: function(step) {
      var newVal;

      if (step) {
        newVal = this.minute + step;
      } else {
        newVal = this.minute + this.minuteStep - (this.minute % this.minuteStep);
      }

      if (newVal > 59) {
        this.incrementHour();
        this.minute = newVal - 60;
      } else {
        this.minute = newVal;
      }
    },

    incrementSecond: function() {
      var newVal = this.second + this.secondStep - (this.second % this.secondStep);

      if (newVal > 59) {
        this.incrementMinute(true);
        this.second = newVal - 60;
      } else {
        this.second = newVal;
      }
    },

    mousewheel: function(e) {
      if (this.disableMousewheel) {
        return;
      }

      e.preventDefault();
      e.stopPropagation();

      var delta = e.originalEvent.wheelDelta || -e.originalEvent.detail,
          scrollTo = null;

      if (e.type === 'mousewheel') {
        scrollTo = (e.originalEvent.wheelDelta * -1);
      }
      else if (e.type === 'DOMMouseScroll') {
        scrollTo = 40 * e.originalEvent.detail;
      }

      if (scrollTo) {
        e.preventDefault();
        $(this).scrollTop(scrollTo + $(this).scrollTop());
      }

      switch (this.highlightedUnit) {
      case 'minute':
        if (delta > 0) {
          this.incrementMinute();
        } else {
          this.decrementMinute();
        }
        this.highlightMinute();
        break;
      case 'second':
        if (delta > 0) {
          this.incrementSecond();
        } else {
          this.decrementSecond();
        }
        this.highlightSecond();
        break;
      case 'meridian':
        this.toggleMeridian();
        this.highlightMeridian();
        break;
      default:
        if (delta > 0) {
          this.incrementHour();
        } else {
          this.decrementHour();
        }
        this.highlightHour();
        break;
      }

      return false;
    },

    /**
     * Given a segment value like 43, will round and snap the segment
     * to the nearest "step", like 45 if step is 15. Segment will
     * "overflow" to 0 if it's larger than 59 or would otherwise
     * round up to 60.
     */
    changeToNearestStep: function (segment, step) {
      if (segment % step === 0) {
        return segment;
      }
      if (Math.round((segment % step) / step)) {
        return (segment + (step - segment % step)) % 60;
      } else {
        return segment - segment % step;
      }
    },

    // This method was adapted from bootstrap-datepicker.
    place : function() {
      if (this.isInline) {
        return;
      }
      var widgetWidth = this.$widget.outerWidth(), widgetHeight = this.$widget.outerHeight(), visualPadding = 10, windowWidth =
        $(window).width(), windowHeight = $(window).height(), scrollTop = $(window).scrollTop();

      var zIndex = parseInt(this.$element.parents().filter(function() { return $(this).css('z-index') !== 'auto'; }).first().css('z-index'), 10) + 10;
      var offset = this.component ? this.component.parent().offset() : this.$element.offset();
      var height = this.component ? this.component.outerHeight(true) : this.$element.outerHeight(false);
      var width = this.component ? this.component.outerWidth(true) : this.$element.outerWidth(false);
      var left = offset.left, top = offset.top;

      this.$widget.removeClass('timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left');

      if (this.orientation.x !== 'auto') {
        this.$widget.addClass('timepicker-orient-' + this.orientation.x);
        if (this.orientation.x === 'right') {
          left -= widgetWidth - width;
        }
      } else{
        // auto x orientation is best-placement: if it crosses a window edge, fudge it sideways
        // Default to left
        this.$widget.addClass('timepicker-orient-left');
        if (offset.left < 0) {
          left -= offset.left - visualPadding;
        } else if (offset.left + widgetWidth > windowWidth) {
          left = windowWidth - widgetWidth - visualPadding;
        }
      }
      // auto y orientation is best-situation: top or bottom, no fudging, decision based on which shows more of the widget
      var yorient = this.orientation.y, topOverflow, bottomOverflow;
      if (yorient === 'auto') {
        topOverflow = -scrollTop + offset.top - widgetHeight;
        bottomOverflow = scrollTop + windowHeight - (offset.top + height + widgetHeight);
        if (Math.max(topOverflow, bottomOverflow) === bottomOverflow) {
          yorient = 'top';
        } else {
          yorient = 'bottom';
        }
      }
      this.$widget.addClass('timepicker-orient-' + yorient);
      if (yorient === 'top'){
        top += height;
      } else{
        top -= widgetHeight + parseInt(this.$widget.css('padding-top'), 10);
      }

      this.$widget.css({
        top : top,
        left : left,
        zIndex : zIndex
      });
    },

    remove: function() {
      $('document').off('.timepicker');
      if (this.$widget) {
        this.$widget.remove();
      }
      delete this.$element.data().timepicker;
    },

    setDefaultTime: function(defaultTime) {
      if (!this.$element.val()) {
        if (defaultTime === 'current') {
          var dTime = new Date(),
            hours = dTime.getHours(),
            minutes = dTime.getMinutes(),
            seconds = dTime.getSeconds(),
            meridian = 'AM';

          if (seconds !== 0) {
            seconds = Math.ceil(dTime.getSeconds() / this.secondStep) * this.secondStep;
            if (seconds === 60) {
              minutes += 1;
              seconds = 0;
            }
          }

          if (minutes !== 0) {
            minutes = Math.ceil(dTime.getMinutes() / this.minuteStep) * this.minuteStep;
            if (minutes === 60) {
              hours += 1;
              minutes = 0;
            }
          }

          if (this.showMeridian) {
            if (hours === 0) {
              hours = 12;
            } else if (hours >= 12) {
              if (hours > 12) {
                hours = hours - 12;
              }
              meridian = 'PM';
            } else {
              meridian = 'AM';
            }
          }

          this.hour = hours;
          this.minute = minutes;
          this.second = seconds;
          this.meridian = meridian;

          this.update();

        } else if (defaultTime === false) {
          this.hour = 0;
          this.minute = 0;
          this.second = 0;
          this.meridian = 'AM';
        } else {
          this.setTime(defaultTime);
        }
      } else {
        this.updateFromElementVal();
      }
    },

    setTime: function(time, ignoreWidget) {
      if (!time) {
        this.clear();
        return;
      }

      var timeMode,
          timeArray,
          hour,
          minute,
          second,
          meridian;

      if (typeof time === 'object' && time.getMonth){
        // this is a date object
        hour    = time.getHours();
        minute  = time.getMinutes();
        second  = time.getSeconds();

        if (this.showMeridian){
          meridian = 'AM';
          if (hour > 12){
            meridian = 'PM';
            hour = hour % 12;
          }

          if (hour === 12){
            meridian = 'PM';
          }
        }
      } else {
        timeMode = ((/a/i).test(time) ? 1 : 0) + ((/p/i).test(time) ? 2 : 0); // 0 = none, 1 = AM, 2 = PM, 3 = BOTH.
        if (timeMode > 2) { // If both are present, fail.
          this.clear();
          return;
        }

        timeArray = time.replace(/[^0-9\:]/g, '').split(':');

        hour = timeArray[0] ? timeArray[0].toString() : timeArray.toString();

        if(this.explicitMode && hour.length > 2 && (hour.length % 2) !== 0 ) {
          this.clear();
          return;
        }

        minute = timeArray[1] ? timeArray[1].toString() : '';
        second = timeArray[2] ? timeArray[2].toString() : '';

        // adaptive time parsing
        if (hour.length > 4) {
          second = hour.slice(-2);
          hour = hour.slice(0, -2);
        }

        if (hour.length > 2) {
          minute = hour.slice(-2);
          hour = hour.slice(0, -2);
        }

        if (minute.length > 2) {
          second = minute.slice(-2);
          minute = minute.slice(0, -2);
        }

        hour = parseInt(hour, 10);
        minute = parseInt(minute, 10);
        second = parseInt(second, 10);

        if (isNaN(hour)) {
          hour = 0;
        }
        if (isNaN(minute)) {
          minute = 0;
        }
        if (isNaN(second)) {
          second = 0;
        }

        // Adjust the time based upon unit boundary.
        // NOTE: Negatives will never occur due to time.replace() above.
        if (second > 59) {
          second = 59;
        }

        if (minute > 59) {
          minute = 59;
        }

        if (hour >= this.maxHours) {
          // No day/date handling.
          hour = this.maxHours - 1;
        }

        if (this.showMeridian) {
          if (hour > 12) {
            // Force PM.
            timeMode = 2;
            hour -= 12;
          }
          if (!timeMode) {
            timeMode = 1;
          }
          if (hour === 0) {
            hour = 12; // AM or PM, reset to 12.  0 AM = 12 AM.  0 PM = 12 PM, etc.
          }
          meridian = timeMode === 1 ? 'AM' : 'PM';
        } else if (hour < 12 && timeMode === 2) {
          hour += 12;
        } else {
          if (hour >= this.maxHours) {
            hour = this.maxHours - 1;
          } else if ((hour < 0) || (hour === 12 && timeMode === 1)){
            hour = 0;
          }
        }
      }

      this.hour = hour;
      if (this.snapToStep) {
        this.minute = this.changeToNearestStep(minute, this.minuteStep);
        this.second = this.changeToNearestStep(second, this.secondStep);
      } else {
        this.minute = minute;
        this.second = second;
      }
      this.meridian = meridian;

      this.update(ignoreWidget);
    },

    showWidget: function() {
      if (this.isOpen) {
        return;
      }

      if (this.$element.is(':disabled')) {
        return;
      }

      // show/hide approach taken by datepicker
      this.$widget.appendTo(this.appendWidgetTo);
      $(document).on('mousedown.timepicker, touchend.timepicker', {scope: this}, this.handleDocumentClick);

      this.$element.trigger({
        'type': 'show.timepicker',
        'time': {
          'value': this.getTime(),
          'hours': this.hour,
          'minutes': this.minute,
          'seconds': this.second,
          'meridian': this.meridian
        }
      });

      this.place();
      if (this.disableFocus) {
        this.$element.blur();
      }

      // widget shouldn't be empty on open
      if (this.hour === '') {
        if (this.defaultTime) {
          this.setDefaultTime(this.defaultTime);
        } else {
          this.setTime('0:0:0');
        }
      }

      if (this.template === 'modal' && this.$widget.modal) {
        this.$widget.modal('show').on('hidden', $.proxy(this.hideWidget, this));
      } else {
        if (this.isOpen === false) {
          this.$widget.addClass('open');
        }
      }

      this.isOpen = true;
    },

    toggleMeridian: function() {
      this.meridian = this.meridian === 'AM' ? 'PM' : 'AM';
    },

    update: function(ignoreWidget) {
      this.updateElement();
      if (!ignoreWidget) {
        this.updateWidget();
      }

      this.$element.trigger({
        'type': 'changeTime.timepicker',
        'time': {
          'value': this.getTime(),
          'hours': this.hour,
          'minutes': this.minute,
          'seconds': this.second,
          'meridian': this.meridian
        }
      });
    },

    updateElement: function() {
      this.$element.val(this.getTime()).change();
    },

    updateFromElementVal: function() {
      this.setTime(this.$element.val());
    },

    updateWidget: function() {
      if (this.$widget === false) {
        return;
      }

      var hour = this.hour,
          minute = this.minute.toString().length === 1 ? '0' + this.minute : this.minute,
          second = this.second.toString().length === 1 ? '0' + this.second : this.second;

      if (this.showInputs) {
        this.$widget.find('input.bootstrap-timepicker-hour').val(hour);
        this.$widget.find('input.bootstrap-timepicker-minute').val(minute);

        if (this.showSeconds) {
          this.$widget.find('input.bootstrap-timepicker-second').val(second);
        }
        if (this.showMeridian) {
          this.$widget.find('input.bootstrap-timepicker-meridian').val(this.meridian);
        }
      } else {
        this.$widget.find('span.bootstrap-timepicker-hour').text(hour);
        this.$widget.find('span.bootstrap-timepicker-minute').text(minute);

        if (this.showSeconds) {
          this.$widget.find('span.bootstrap-timepicker-second').text(second);
        }
        if (this.showMeridian) {
          this.$widget.find('span.bootstrap-timepicker-meridian').text(this.meridian);
        }
      }
    },

    updateFromWidgetInputs: function() {
      if (this.$widget === false) {
        return;
      }

      var t = this.$widget.find('input.bootstrap-timepicker-hour').val() + ':' +
              this.$widget.find('input.bootstrap-timepicker-minute').val() +
              (this.showSeconds ? ':' + this.$widget.find('input.bootstrap-timepicker-second').val() : '') +
              (this.showMeridian ? this.$widget.find('input.bootstrap-timepicker-meridian').val() : '')
      ;

      this.setTime(t, true);
    },

    widgetClick: function(e) {
      e.stopPropagation();
      e.preventDefault();

      var $input = $(e.target),
          action = $input.closest('a').data('action');

      if (action) {
        this[action]();
      }
      this.update();

      if ($input.is('input')) {
        $input.get(0).setSelectionRange(0,2);
      }
    },

    widgetKeydown: function(e) {
      var $input = $(e.target),
          name = $input.attr('class').replace('bootstrap-timepicker-', '');

      switch (e.which) {
      case 9: //tab
        if (e.shiftKey) {
          if (name === 'hour') {
            return this.hideWidget();
          }
        } else if ((this.showMeridian && name === 'meridian') || (this.showSeconds && name === 'second') || (!this.showMeridian && !this.showSeconds && name === 'minute')) {
          return this.hideWidget();
        }
        break;
      case 27: // escape
        this.hideWidget();
        break;
      case 38: // up arrow
        e.preventDefault();
        switch (name) {
        case 'hour':
          this.incrementHour();
          break;
        case 'minute':
          this.incrementMinute();
          break;
        case 'second':
          this.incrementSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          break;
        }
        this.setTime(this.getTime());
        $input.get(0).setSelectionRange(0,2);
        break;
      case 40: // down arrow
        e.preventDefault();
        switch (name) {
        case 'hour':
          this.decrementHour();
          break;
        case 'minute':
          this.decrementMinute();
          break;
        case 'second':
          this.decrementSecond();
          break;
        case 'meridian':
          this.toggleMeridian();
          break;
        }
        this.setTime(this.getTime());
        $input.get(0).setSelectionRange(0,2);
        break;
      }
    },

    widgetKeyup: function(e) {
      if ((e.which === 65) || (e.which === 77) || (e.which === 80) || (e.which === 46) || (e.which === 8) || (e.which >= 48 && e.which <= 57) || (e.which >= 96 && e.which <= 105)) {
        this.updateFromWidgetInputs();
      }
    }
  };

  //TIMEPICKER PLUGIN DEFINITION
  $.fn.timepicker = function(option) {
    var args = Array.apply(null, arguments);
    args.shift();
    return this.each(function() {
      var $this = $(this),
        data = $this.data('timepicker'),
        options = typeof option === 'object' && option;

      if (!data) {
        $this.data('timepicker', (data = new Timepicker(this, $.extend({}, $.fn.timepicker.defaults, options, $(this).data()))));
      }

      if (typeof option === 'string') {
        data[option].apply(data, args);
      }
    });
  };

  $.fn.timepicker.defaults = {
    defaultTime: 'current',
    disableFocus: false,
    disableMousewheel: false,
    isOpen: false,
    minuteStep: 15,
    modalBackdrop: false,
    orientation: { x: 'auto', y: 'auto'},
    secondStep: 15,
    snapToStep: false,
    showSeconds: false,
    showInputs: true,
    showMeridian: true,
    template: 'dropdown',
    appendWidgetTo: 'body',
    showWidgetOnAddonClick: true,
    icons: {
      up: 'glyphicon glyphicon-chevron-up',
      down: 'glyphicon glyphicon-chevron-down'
    },
    maxHours: 24,
    explicitMode: false
  };

  $.fn.timepicker.Constructor = Timepicker;

  $(document).on(
    'focus.timepicker.data-api click.timepicker.data-api',
    '[data-provide="timepicker"]',
    function(e){
      var $this = $(this);
      if ($this.data('timepicker')) {
        return;
      }
      e.preventDefault();
      // component click requires us to explicitly show it
      $this.timepicker();
    }
  );

})(jQuery, window, document);

ACC.address = {

	_autoload: [
		"bindToChangeAddressButton",
		"bindCreateUpdateAddressForm",
		"bindSuggestedDeliveryAddresses",
		"bindCountrySpecificAddressForms",
		"showAddressFormButtonPanel",
		"bindViewAddressBook",
		"bindToColorboxClose",
		"showRemoveAddressFromBookConfirmation",
		"backToListAddresses"
	],

	spinner: $("<img src='" + ACC.config.commonResourcePath + "/images/spinner.gif' />"),
	addressID: '',

	handleChangeAddressButtonClick: function ()
	{


		ACC.address.addressID = ($(this).data("address")) ? $(this).data("address") : '';
		$('#summaryDeliveryAddressFormContainer').show();
		$('#summaryOverlayViewAddressBook').show();
		$('#summaryDeliveryAddressBook').hide();


		$.getJSON(getDeliveryAddressesUrl, ACC.address.handleAddressDataLoad);
		return false;
	},

	handleAddressDataLoad: function (data)
	{
		ACC.address.setupDeliveryAddressPopupForm(data);

		// Show the delivery address popup
		ACC.colorbox.open("",{
		 	inline: true,
			href: "#summaryDeliveryAddressOverlay",
			overlayClose: false,
			onOpen: function (){
				// empty address form fields
				// emptyAddressForm Removed as it deteced in Checkmarx Report, but the element, where click event is triggered exist in Desktop Folder
				$(document).on('change', '#saveAddress', function ()
				{
					var saveAddressChecked = $(this).prop('checked');
					$('#defaultAddress').prop('disabled', !saveAddressChecked);
					if (!saveAddressChecked)
					{
						$('#defaultAddress').prop('checked', false);
					}
				});
			}
		});

	},

	setupDeliveryAddressPopupForm: function (data)
	{
		// Fill the available delivery addresses
		$('#summaryDeliveryAddressBook').html($('#deliveryAddressesTemplate').tmpl({addresses: data}));
		// Handle selection of address
		$('#summaryDeliveryAddressBook button.use_address').click(ACC.address.handleSelectExistingAddressClick);
		// Handle edit address
		$('#summaryDeliveryAddressBook button.edit').click(ACC.address.handleEditAddressClick);
		// Handle set default address
		$('#summaryDeliveryAddressBook button.default').click(ACC.address.handleDefaultAddressClick);
	},

	handleSelectExistingAddressClick: function ()
	{
		var addressId = $(this).attr('data-address');
		$.postJSON(setDeliveryAddressUrl, {addressId: addressId}, ACC.address.handleSelectExitingAddressSuccess);
		return false;
	},

	handleEditAddressClick: function ()
	{

		$('#summaryDeliveryAddressFormContainer').show();
		$('#summaryOverlayViewAddressBook').show();
		$('#summaryDeliveryAddressBook').hide();

		var addressId = $(this).attr('data-address');
		var options = {
			url: getDeliveryAddressFormUrl,
			data: {addressId: addressId, createUpdateStatus: ''},
			target: '#summaryDeliveryAddressFormContainer',
			type: 'GET',
			success: function (data)
			{
				ACC.address.bindCreateUpdateAddressForm();
				ACC.colorbox.resize();
			},
			error: function (xht, textStatus, ex)
			{
				alert("Failed to update cart. Error details [" + xht + ", " + textStatus + ", " + ex + "]");
			}
		};

		$(this).ajaxSubmit(options);
		return false;
	},

	handleDefaultAddressClick: function ()
	{
		var addressId = $(this).attr('data-address');
		var options = {
			url: setDefaultAddressUrl,
			data: {addressId: addressId},
			type: 'GET',
			success: function (data)
			{
				ACC.address.setupDeliveryAddressPopupForm(data);
			},
			error: function (xht, textStatus, ex)
			{
				alert("Failed to update address book. Error details [" + xht + ", " + textStatus + ", " + ex + "]");
			}
		};

		$(this).ajaxSubmit(options);
		return false;
	},

	handleSelectExitingAddressSuccess: function (data)
	{
		if (data != null)
		{
			ACC.refresh.refreshPage(data);
			ACC.colorbox.close();
		}
		else
		{
			alert("Failed to set delivery address");
		}
	},

	bindCreateUpdateAddressForm: function ()
	{
		$('.create_update_address_form').each(function ()
		{
			var options = {
				type: 'POST',
				beforeSubmit: function ()
				{
					$('#checkout_delivery_address').block({ message: ACC.address.spinner });
				},
				success: function (data)
				{
					$('#summaryDeliveryAddressFormContainer').html(data);
					var status = $('.create_update_address_id').attr('status');
					if (status != null && "success" === status.toLowerCase())
					{
						ACC.refresh.getCheckoutCartDataAndRefreshPage();
						ACC.colorbox.close();
					}
					else
					{
						ACC.address.bindCreateUpdateAddressForm();
						ACC.colorbox.resize();
					}
				},
				error: function (xht, textStatus, ex)
				{
					alert("Failed to update cart. Error details [" + xht + ", " + textStatus + ", " + ex + "]");
				},
				complete: function ()
				{
					$('#checkout_delivery_address').unblock();
				}
			};

			$(this).ajaxForm(options);
		});
	},

	refreshDeliveryAddressSection: function (data)
	{
		$('.summaryDeliveryAddress').replaceWith($('#deliveryAddressSummaryTemplate').tmpl(data));

	},

	bindSuggestedDeliveryAddresses: function ()
	{
		var status = $('.add_edit_delivery_address_id').attr('status');
		if (status != null && "hasSuggestedAddresses" == status)
		{
			ACC.address.showSuggestedAddressesPopup();
		}
	},

	showSuggestedAddressesPopup: function ()
	{

		ACC.colorbox.open("",{
			href: "#popup_suggested_delivery_addresses",
			inline: true,
			overlayClose: false,
			width: 525,
		});
	},

	bindCountrySpecificAddressForms: function (){
		$(document).on("change",'#countrySelector select', function (){
			var options = {
				'addressCode': '',
				'countryIsoCode': $(this).val()
			};
			ACC.address.displayCountrySpecificAddressForm(options, ACC.address.showAddressFormButtonPanel);
		})

	},

	showAddressFormButtonPanel: function ()
	{
		if ($('#countrySelector :input').val() !== '')
		{
			$('#addressform_button_panel').show();
		}
	},

	bindToColorboxClose: function ()
	{
		$(document).on("click", ".closeColorBox", function ()
		{
			ACC.colorbox.close();
		})
	},


	displayCountrySpecificAddressForm: function (options, callback)
	{
		$.ajax({
			url: ACC.config.encodedContextPath + '/my-account/addressform',
			async: true,
			data: options,
			dataType: "html",
			beforeSend: function ()
			{
				$("#i18nAddressForm").html(ACC.address.spinner);
			}
		}).done(function (data)
				{
					$("#i18nAddressForm").html($(data).html());
					if (typeof callback == 'function')
					{
						callback.call();
					}
				});
	},

	bindToChangeAddressButton: function ()
	{
		$(document).on("click", '.summaryDeliveryAddress .editButton', ACC.address.handleChangeAddressButtonClick);
	},

	bindViewAddressBook: function ()
	{

		$(document).on("click",".js-address-book",function(e){
			e.preventDefault();

			ACC.colorbox.open("Saved Addresses",{
				href: "#addressbook",
				inline: true,
				width:"380px"
			});
			
		})

		
		$(document).on("click", '#summaryOverlayViewAddressBook', function ()
		{
			$('#summaryDeliveryAddressFormContainer').hide();
			$('#summaryOverlayViewAddressBook').hide();
			$('#summaryDeliveryAddressBook').show();
			ACC.colorbox.resize();
		});
	},
	
	showRemoveAddressFromBookConfirmation: function ()
	{
		$(document).on("click", ".removeAddressFromBookButton", function ()
		{
			var addressId = $(this).data("addressId");
			var popupTitle = $(this).data("popupTitle");

			ACC.colorbox.open(popupTitle,{
				inline: true,
				height: false,
				href: "#popup_confirm_address_removal_" + addressId,
				onComplete: function ()
				{

					$(this).colorbox.resize();
				}
			});

		})
	},

	backToListAddresses: function(){
		$(".addressBackBtn").on("click", function(){
			var sUrl = $(this).data("backToAddresses");
			window.location = sUrl;
		});
	}
};

ACC.autocomplete = {

	_autoload: [
		"bindSearchAutocomplete"
	],
	callFrom : null,
	bindSearchAutocompleteOptions : {
		cache:{}, // init cache per instance
		focus: function (){return false;}, // prevent textfield value replacement on item focus
		select: function (event, ui){
            window.location.href = ui.item.url;
        }
	},
	getRenderItem: function(ul, item){
		var renderHtml;
		if (item.type == "autoSuggestion"){
			renderHtml = "<a href='"+ item.url + "' ><div class='name'>" + item.value + "</div></a>";
			return $("<li>")
					.data("item.autocomplete", item)
					.append(renderHtml)
					.appendTo(ul);
		}
		else if (item.type == "productResult"){

			renderHtml = "<a href='" + item.url + "' >";
			
			if (item.image != null){
				renderHtml += "<div class='thumb'><img class='img-responsive' src='" + item.image + "'  /></div>";
			}
			
			renderHtml += "<div class='ac-prod-data'>";
			renderHtml += "<div class='name'>" + item.value +"</div>";
			
			if (item.desc != null){
				renderHtml += "<div class='ac-prod-desc'>" + item.desc + "</div>";
			}
			
		
			
			renderHtml += "</div>";	
			renderHtml += "</a>";

			return $("<li>").data("item.autocomplete", item).append(renderHtml).appendTo(ul);
		}
		else if (item.type == "noResults"){
			renderHtml = "<div class='name'><i>No Results Found</i></div>";
			return $("<li>").append(renderHtml).appendTo(ul);
		}
	},
	
	getRecipeProduct: function(autoSearchData, obj, self){
		var description;
		if(obj.productType=="RecipeProduct"){
			description=obj.subHeadLine;
		}
		else if(obj.productType=="ArticleProduct"){
			description="";
		}
		else {
			description=obj.description;
		}
		if( ACC.autocomplete.callFrom === "PES" ){
			autoSearchData.push({
				value: obj.question,
				type: "autoSuggestion",
				url: ACC.config.encodedContextPath +obj.label
			});
		}else{
			autoSearchData.push({
				value: obj.name,
				code: obj.code,
				desc: description,
				manufacturer: obj.manufacturer,
				url:  ACC.config.encodedContextPath + obj.url,
				price: obj.price.formattedValue,
				type: "productResult",
				image: (obj.images!=null && self.options.displayProductImages) ? obj.images[0].url : null, // prevent errors if obj.images = null
				mainCategory: (obj.categories !=null )  ? obj.categories[0].name : null, 
				subCategory: (obj.categories !=null )  ? obj.categories[1].name : null
			});
		}
		return autoSearchData;
	},
	
	getAutoSearchData: function(data, self){
		var autoSearchData = [];
		if (data.suggestions !== null && data.suggestions.length < 1 && data.products.length < 1) {
			autoSearchData.push({
				type: "noResults"
			});
		}
		if(data.suggestions != null){
			$.each(data.suggestions, function (i, obj){
				autoSearchData.push({
					value: obj.term,
					url: ACC.config.encodedContextPath + "/search?text=" + obj.term,
					type: "autoSuggestion"
				});
			});
		}
		if(data.products != null){
			$.each(data.products, function (i, obj)	{
				autoSearchData = ACC.autocomplete.getRecipeProduct(autoSearchData, obj, self);
			});
		}
		if(data.contents != null){
			$.each(data.contents, function (i, obj)	{
				autoSearchData = ACC.autocomplete.getRecipeProduct(autoSearchData, obj, self);
			});
		}
		return autoSearchData;
	},
	
	bindSearchAutocomplete: function ()	{
		// extend the default autocomplete widget, to solve issue on multiple instances of the searchbox component
		$.widget( "custom.yautocomplete", $.ui.autocomplete, {
			_create:function(){
				
				// get instance specific options form the html data attr
				var option = this.element.data("options");
				// set the options to the widget
				this._setOptions({
					minLength: option.minCharactersBeforeRequest,
					displayProductImages: option.displayProductImages,
					delay: option.waitTimeBeforeRequest,
					autocompleteUrl: option.autocompleteUrl,
					source: this.source
				});
				
				// call the _super()
				$.ui.autocomplete.prototype._create.call(this);
				
			},
			options:ACC.autocomplete.bindSearchAutocompleteOptions,
			_renderItem : function (ul, item){
				return ACC.autocomplete.getRenderItem(ul, item);
			},
			source: function (request, response){
				var self=this;
				var $parent = $(this)[0].element.closest(".pes-search");
				if( $parent.length ){
					ACC.autocomplete.callFrom = "PES";
				}
				var term = request.term.toLowerCase();
				if (term in self.options.cache)	{
					return response(self.options.cache[term]);
				}
				
				$.getJSON(self.options.autocompleteUrl, {term: request.term}, function (data){
					var searchData = ACC.autocomplete.getAutoSearchData(data, self);
					
					self.options.cache[term] = searchData;
					return response(searchData);
				});
			}

		});

	
		ACC.autocomplete.callAutoComplete();
	},
	
	callAutoComplete: function(){
		var $search = $(".js-site-search-input");
		if($search.length>0){
			$search.yautocomplete();
		}
	}
};
ACC.carousel = {

	_autoload: [
		["bindCarousel", $(".js-owl-carousel").length >0], 
		"bindGAnalytics"
	],
	
	callMouseUpOnEnter: function(e, $el){
		var code = e.keyCode || e.which;
		if (!e.shiftKey && code === 13) { 
			$el.mouseup();
        }
	},
	
	owlPrevKeyDown: function( $carouselContainer ){
		$carouselContainer.find('.owl-prev').on("keydown", function(e){
			ACC.carousel.callMouseUpOnEnter(e, $(this));
    	});
	},
	
	owlNextKeyDown: function( $carouselContainer ){
		$carouselContainer.find('.owl-next').on("keydown", function(e){
			ACC.carousel.callMouseUpOnEnter(e, $(this));
    	});
	},
	
	owlPauseKeyDown: function($carouselContainer){
		$carouselContainer.find('.owl-controls').on("keydown",".owl-pause", function(e){
    		var code = e.keyCode || e.which;
    		if (!e.shiftKey && code === 13) { 
    			if($(this).hasClass("paused")) {
    				$carouselContainer.data('owlCarousel').play();
    				$(this).removeClass("paused");
    				$(this).attr("aria-label","pause");
    			}
    			else {
    				$carouselContainer.data('owlCarousel').stop();
    				$(this).addClass("paused");
    				$(this).attr("aria-label","play");
    			}
            }
    	});
	},
	
	owlPageKeyDown: function($carouselContainer){
		$carouselContainer.find('.owl-controls').on("keydown",".owl-page", function(e){
			ACC.carousel.callMouseUpOnEnter(e, $(this));
    	});
	},
	
	setOwlItemTabIndex: function($carouselContainer){
		$carouselContainer.find('.owl-item').find('a').attr("tabindex",-1);
        $carouselContainer.find('.owl-item.active').find('a').attr("tabindex",0);
	},
	
	setTabIndexOnTimeOut: function($carouselContainer){
		setTimeout(function(){
			ACC.carousel.setOwlItemTabIndex($carouselContainer);
	    },500);
	},
	
	carouselConfig:{
		"default":{
			navigation:true,
			navigationText : ["previous slide","next slide"],
			pagination:true,
			setpaginationtab:true,
			rewindSpeed : 0,
			pause:true,/* requires pagination to also be true */
			itemsCustom : [[0, 2.5], [460, 2.5], [740, 2.5], [1000, 4], [1380, 5]],
			paginationWrapper: "<div class=\"owl-pagination hide-in-mobile\"/>",
			autoPlay:true,
			addClassActive : true,
		    afterInit : function($carouselContainer) { 
			    
		    	ACC.carousel.setTabIndexOnTimeOut($carouselContainer);
		    	
		    	ACC.carousel.owlPrevKeyDown($carouselContainer);
		    	
		    	ACC.carousel.owlNextKeyDown($carouselContainer);
		    	
		    	ACC.carousel.owlPauseKeyDown($carouselContainer);
		    	
		    	ACC.carousel.owlPageKeyDown($carouselContainer);
		    	
			},
			afterAction: function($carouselContainer){
		    	// owl carousel's afterAction callback is fired after every user interaction
		    	// and also after initialisation
				ACC.carousel.setOwlItemTabIndex($carouselContainer);
		    }
		},
		
		"brand":{
			navigation:true,
			navigationText:["<span class='fa fa-chevron-left'></span><span class='sr-only'>previous slide</span>","<span class='fa fa-chevron-right'></span><span class='sr-only'>next slide</span>"],
			pagination:true,
			paginationWrapper: "<div class=\"owl-pagination hide\"/>",
			itemsCustom : [[0, 1], [460, 1], [740, 4], [1000, 6], [1380, 6]],
			rewindNav:false,
			addClassActive : true,
		    afterInit : function($carouselContainer) { 
			    
				// make individual items focusable
		    	ACC.carousel.setTabIndexOnTimeOut($carouselContainer);
		    	
		    	ACC.carousel.owlPrevKeyDown($carouselContainer);
		    	
		    	ACC.carousel.owlNextKeyDown($carouselContainer);
		    	
			    
				//to make it center aligned 
				$('.js-owl-brand').find('.owl-wrapper').each(function () {
                    var w = $(this).width() / 2;
                    $(this).width(w);
                    $(this).css('margin', '0 auto');
                });
			},
			afterAction: function($carouselContainer){
		    	// owl carousel's afterAction callback is fired after every user interaction
		    	// and also after initialisation
				ACC.carousel.setOwlItemTabIndex($carouselContainer);
			    
		    },
			afterUpdate: function () {
				
				//to make it center aligned 
				$('.js-owl-brand').find('.owl-wrapper').each(function () {
                    var w = $(this).width() / 2;
                    $(this).width(w);
                    $(this).css('margin', '0 auto');
                });
				
				
            }
		},
		
		
		"rotating-image":{
			navigation:false,
			pagination:true,
			singleItem : true,
		},
		"rotating-image-autoplay":{
			navigation:true,
			navigationText : ["previous slide","next slide"],
			pagination:true,
			setpaginationtab:true,
			rewindSpeed : 0,
			pause:true,/* requires pagination to also be true */
			singleItem : true,
			theme : "owl-theme-small",
			autoPlay:true,
			addClassActive : true,
		    afterInit: function($carouselContainer){
		    	
		    	ACC.carousel.owlPrevKeyDown($carouselContainer);
		    	
		    	ACC.carousel.owlNextKeyDown($carouselContainer);
		    	
		    	ACC.carousel.owlPauseKeyDown($carouselContainer);
		    	
		    	ACC.carousel.owlPageKeyDown($carouselContainer);
		    	
		    	
		    	$( window ).on('load', function() {
		    		ACC.carousel.centerCarouselControls($carouselContainer);
			    });
		    	var resizetimer;
			    $( window ).on('resize', function() {
			    	clearTimeout(resizetimer);
			    	resizetimer = setTimeout(function(){
			    		ACC.carousel.centerCarouselControls($carouselContainer);
			        },500);
		    	});
		    	
		    },
		    afterAction: function($carouselContainer){
		    	// owl carousel's afterAction callback is fired after every user interaction
		    	// and also after initialisation
		    	ACC.carousel.setOwlItemTabIndex($carouselContainer);
		    }
		},
		"rotating-image-autoplay-brand":{
			navigation:true,
			navigationText : ["previous slide","next slide"],
			pagination:true,
			setpaginationtab:true,
			rewindSpeed : 0,
			pause:true,/* requires pagination to also be true */
			singleItem : true,
			theme : "owl-theme-brand",
			autoPlay:true,
			addClassActive : true,
	    	afterInit: function($carouselContainer){
		    	
	    		ACC.carousel.owlPrevKeyDown($carouselContainer);
		    	
	    		ACC.carousel.owlNextKeyDown($carouselContainer);
		    	
	    		ACC.carousel.owlPauseKeyDown($carouselContainer);
		    	
	    		ACC.carousel.owlPageKeyDown($carouselContainer);
		    	
		    	
		    	$( window ).on('load', function() {
		    		ACC.carousel.centerCarouselControls($carouselContainer);
			    });
		    	var resizetimer;
			    $( window ).on('resize', function() {
			    	clearTimeout(resizetimer);
			    	resizetimer = setTimeout(function(){
			    		ACC.carousel.centerCarouselControls($carouselContainer);
			        },500);
		    	});
		    	
		    },
		    afterAction: function($carouselContainer){
		    	// owl carousel's afterAction callback is fired after every user interaction
		    	// and also after initialisation
		    	ACC.carousel.setOwlItemTabIndex($carouselContainer);
		    }
		},
		"rotating-image-autoplay-hero":{
			navigation:true,
			navigationText : ["previous slide","next slide"],
			pagination:true,
			setpaginationtab:true,
			rewindSpeed : 0,
			pause:true,/* requires pagination to also be true */
			singleItem : true,
			theme : "owl-theme-hero",
			autoPlay:ACC.carouselSpeed,
			autoHeight :true,
			stopOnHover : true,
			stopOnFocus : true,
		    autoPlayHoverPause:true,
		    scrollPerPage: true,
		    addClassActive : true,
		    afterInit: function($carouselContainer){
		    	
		    	ACC.carousel.owlPrevKeyDown($carouselContainer);
		    	
	    		ACC.carousel.owlNextKeyDown($carouselContainer);
		    	
	    		ACC.carousel.owlPauseKeyDown($carouselContainer);
		    	
	    		ACC.carousel.owlPageKeyDown($carouselContainer);
		    	
		    },
		    afterAction: function($carouselContainer){
		    	// owl carousel's afterAction callback is fired after every user interaction
		    	// and also after initialisation
		    	ACC.carousel.setOwlItemTabIndex($carouselContainer);
		    }
		},
		
		"lazy-reference":{
			navigation:true,
			pagination:true,
			rewindSpeed : 0,
			itemsCustom : [[0, 1.5], [460, 2.5], [740, 3.5], [1000, 4], [1380, 5]], 
			paginationWrapper: "<div class=\"owl-pagination hidden-xs hidden-sm\"/>",
			lazyLoad:true,
			addClassActive : true,
			afterInit : function($carouselContainer) { 
			    
				// make individual items focusable
				$carouselContainer.find('.owl-item a').attr('aria-selected','false').attr('tabindex','0');
				$carouselContainer.attr('tabindex','0');
				
				// show instructions to keyboard users when the carousel is focused

				
			    // on when an item has focus, let screen readers know it is active
				$carouselContainer.find('.owl-item a').on('focus',function() {
					$carouselContainer.find('.owl-item a').attr('aria-selected','false');
					$(this).attr('aria-selected','true');
					$carouselContainer.trigger("owl.stop");
			    });
				
				$carouselContainer.find('.owl-item a').on('blur',function() {
					$carouselContainer.trigger("owl.play", [5000]);
			    });
				
				ACC.carousel.carouselContainerKeyDown($carouselContainer);
			    
			}
		}
	},
	
	carouselContainerKeyDown: function($carouselContainer){
		$carouselContainer.on("keydown", function(e){

	          // first of all make sure we override the default keyboard behaviour
	          // only for the wrapper and not everything inside it
	          if ( $(e.target).is(".js-owl-carousel")  ) {

	            var code = e.keyCode || e.which;

	            if (code === 39) {
	            	// arrow right - next slide
	            	$carouselContainer.data('owlCarousel').next();
	            } else if (code === 37) {
	            	// arrow left - previous slide
	            	$carouselContainer.data('owlCarousel').prev();
	            }
	          }
		});
	},
	
	bindCarousel: function(){
		
		$(".js-owl-carousel").each(function(){
			var $c = $(this)
			$.each(ACC.carousel.carouselConfig,function(key,config){
				if($c.hasClass("js-owl-"+key)){
					var $e = $(".js-owl-"+key);
					$e.owlCarousel(config);
				}
			});
		});

	},
	bindGAnalytics: function(){
		
		$(".newForYou").on("click",".carousel__item",function(){
			localStorage.setItem('pgnm', 'wnc');
			var itemIndex = $(this).data("pepsiGaPrdCrlWhnIndex");
			var itemCof = $(this).data("pepsiGaPrdCrlWhnCof");
			var itemId = $(this).data("pepsiGaPrdCrlWhnId");
			var itemEmailId = $(this).data("pepsiGaPrdCrlWhnEmailId");
			ACC.track.trackProductViews(ACC.whatsNewCarousel, itemId, itemIndex,itemCof, itemEmailId);
		});
		$(".do-not-forget").on("click",".js-link-item",function(){
			var itemIndex = $(this).data("index");
			var itemCof = ACC.CofNo;
			var itemId = $(this).data("sku");
			ACC.track.trackProductViews(ACC.mustHaveCarousel, itemId, itemIndex, itemCof, "");
		});
	},
	centerCarouselControls: function(carouselContainer) {
		  var carouselImage = $(carouselContainer).find('.owl-item img');
		  var carouselImageHeight = carouselImage.outerHeight();
		  var carouselButtonsTop = (carouselImageHeight / 2)+"px";
		  $(carouselContainer).find('.owl-prev').attr("style","top:"+ carouselButtonsTop + "!important");
		  $(carouselContainer).find('.owl-next').attr("style","top:"+ carouselButtonsTop + "!important");
	}
	
	
};


/**
 * 
 */

ACC.brandlanding = {

    _autoload: [
        "getBrandsFromCarousel",
        "accessibility"
    ],
    
    firstItemShiftTabTriggered: false,
    
    accessibility : function(){
		enquire.register("screen and (max-width:" + screenXsMax + ")", {

            match: function () {
            	$('.brand-carousel').attr('aria-hidden',true);
            	$('.brandComboBox').removeAttr('aria-hidden');
            },

            unmatch: function () {
            	$('.brandComboBox').attr('aria-hidden',true);
            	$('.brand-carousel').removeAttr('aria-hidden');
               
            },
            setup:function(){
            	if($('.brand-carousel').filter(":hidden").length > 0){
            		$('.brand-carousel').attr('aria-hidden',true);
            	}else{
            		$('.brand-carousel').removeAttr('aria-hidden');
            	}
            	if($('.brandComboBox').filter(":hidden").length > 0){
            		$('.brandComboBox').attr('aria-hidden',true);
            	}else{
            		$('.brandComboBox').removeAttr('aria-hidden');
            	}
            }

        });
	},
    getBrandsFromCarousel: function(){
    	$('#brandComboBox').change(function(){
    		var categoryCode = $(this).find('option:selected').data('navitemcode');
			var sourceCategoryCode = $(this).find('option:selected').data('navsourcecode');
			var rootCategoryCode = $(this).find('option:selected').data('navrootcode');
			
			var query = ACC.brandlanding.getQfromUrl(location.search);
			
			ACC.brandlanding.ajaxCall(categoryCode,sourceCategoryCode,rootCategoryCode,query);
    	});
    	
		$('.jsBrands').click(function(e){
			e.preventDefault();
			
			$('.underline').removeClass('underline');
			$(this).addClass('underline');
			
			var categoryCode = $(this).siblings('.navItemCode').val();
			var sourceCategoryCode = $(this).siblings('.navSourceCode').val();
			var rootCategoryCode = $(this).siblings('.navRootCode').val();
			
			var url = $(this).attr("href");
			var query = url.substring(url.indexOf("?"));
			query = ACC.brandlanding.getQfromUrl(query);
			
			ACC.brandlanding.ajaxCall(categoryCode,sourceCategoryCode,rootCategoryCode,query);
			
			$('.jsBrands').attr("tabindex", "-1");
			$(this).attr("tabindex", "0");
			
			$('.jsBrands').attr("aria-expanded", false);
			$(this).attr("aria-expanded", true);
		});
		
		ACC.brandlanding.brandsOnFocus();
		
		ACC.brandlanding.focusOnTab();
	},
	
	brandsOnFocus: function(){
		$('.jsBrands').on("focus", function(){
			if( ACC.brandlanding.firstItemShiftTabTriggered ){
				$('.jsBrands').attr("tabindex", "0");
			}
			ACC.brandlanding.firstItemShiftTabTriggered = false;
		});
		ACC.brandlanding.firstItemShiftTab();
	},
		
	firstItemShiftTab: function(){
		$(".js-wrapper").on("keydown", ".js-item-link, .js-productNotFound", function(e){
			var code = e.keyCode || e.which;
			if (code === 9 && e.shiftKey) { // SHIFT + TAB
				ACC.brandlanding.firstItemShiftTabTriggered = true;
		}
		});
	},
	
	getQfromUrl: function(str){
		var query = null;
		if(str.length > 0){
			var paramList = ACC.common.splitParamsFromUrl(str);
			if(paramList["q"]){
				query = paramList["q"];
			}
		}
		return query;
	},
	
	focusOnTab: function(){
		$(".js-wrapper").on("focusin", ".js-item-link", function(){
			$(this).find(".tile-hover").addClass("display-block");
		});
		$(".js-wrapper").on("focusout", ".js-item-link", function(){
			$(this).find(".tile-hover").removeClass("display-block");
		});
		$(".js-wrapper").on("mouseenter", ".js-item-link", function(){
			$(".js-item-link").find(".tile-hover").removeClass("display-block");
		});
	},
	
	ajaxCall : function(categoryCode,sourceCategoryCode,rootCategoryCode,query){
		if($('.js-brandContainer').find('.js-'+categoryCode+'_container').hasClass('loaded')){
			$('.js-brandContainer').find('.js-wrapper').addClass('hide').attr("aria-hidden", true);
			$('.js-brandContainer').find('.js-'+categoryCode+'_container').removeClass('hide').attr("aria-hidden", false);
			var itemLink = $('.js-'+categoryCode+'_container').find(".js-item-link");
			if(itemLink.length > 0){
				itemLink.first().focus();
			}else if( $(".js-productNotFound").length > 0 ){
				$(".js-productNotFound").focus();
			}
		}else{
			if( $("#commonSpinner").length > 0 ){
				$("#commonSpinner").removeClass("display-none");
			}
			$.ajax({
	            url: ACC.config.encodedContextPath + '/c/getBrands',
	            method: "GET",
	            data:{categoryCode:categoryCode,source:sourceCategoryCode,root:rootCategoryCode,q:query},
	            success: function (data) {
	            	ACC.brandlanding.ajaxCallSuccess(data,categoryCode,sourceCategoryCode,rootCategoryCode);
	            },
	            error: function( jqXHR, textStatus, errorThrown){
	            	$('.js-pepsicobrands').empty().text("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
	            	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
	            },
	            complete: function(){
	            	$('.js-brandContainer').find('.js-wrapper').addClass('hide').attr("aria-hidden", true);
	            	$('.js-brandContainer').find('.js-'+categoryCode+'_container').removeClass('hide').addClass('loaded').attr("aria-hidden", false);
	            	var itemLink = $('.js-'+categoryCode+'_container').find(".js-item-link");
	            	if(itemLink.length > 0){
	            		itemLink.first().focus();
	    			}else{
	    				$('.js-'+categoryCode+'_container').find('.js-pepsicobrands').empty().append( $("<div></div>").addClass("productNotFound js-productNotFound text-azure text-center").text(ACC.brandsNoProduct).attr({"tabindex": 0, "role":"region"}) );
	    				$('.js-'+categoryCode+'_container').find('.js-other-shadow, .js-other-container').addClass('hide').attr("aria-hidden", true);
	    				
	    			}
	            	if( $("#commonSpinner").length > 0 ){
	    				$("#commonSpinner").addClass("display-none").attr("aria-hidden", true);
	    			}
	            }
	        });
		}
	},
	
	ajaxCallSuccess: function(data,categoryCode,sourceCategoryCode,rootCategoryCode){
		if( data.hasOwnProperty("pepsicobrands") || data.hasOwnProperty("otherbrands") ){
    		$.each(data, function(key, value) {
    			if(key=='pepsicobrands'){
    				ACC.brandlanding.itemCode(value, $('.js-'+categoryCode+'_container').find('.js-pepsicobrands'),sourceCategoryCode,rootCategoryCode);
    			}
    			if(key=='otherbrands'){
    				ACC.brandlanding.itemCode(value, $('.js-'+categoryCode+'_container').find('.js-otherbrands'),sourceCategoryCode,rootCategoryCode);
    			}
    		});
		}
	},
	
	itemCode: function(facets, $el,source,root){
    	if( facets === null ){
    		return false;
    	}
    	$el.empty();
    	var hasImage = false;
		$.each( facets, function(index, item){
    		if( item.image ){
    			hasImage = true;
    			ACC.brandlanding.createHtml(item, $el,source,root);
    		}
		});
    	
    	if( $el.hasClass("js-otherbrands") && facets.length > 0 ){
    		if( hasImage ){
    			$el.closest(".js-wrapper").find(".js-otherBrandHeading").removeClass('hide').attr("aria-hidden", false);
    		}else{
    			$el.closest(".js-wrapper").find('.js-other-shadow, .js-other-container').addClass('hide').attr("aria-hidden", true);
    		}
    	}
	},
	createHtml: function(values,el,source,root){
		var pepsicoHtml="";
			pepsicoHtml = pepsicoHtml + "<div class='col-sm-4 js-item'>"+
			"<div class='tile-outer'>"+
			"<div class='tile'>"+
			"<a class='display-block js-item-link' href='"+ (values.url ? values.url+"?source="+source+"&root="+root+"&selectedBrand="+values.code : "javascript:void(0)") +"' >"+
			"<div class='js-item-content'  aria-hidden='true'>"+
			"<img src='"+values.image.url+"' class='img-responsive' alt='Image' title='"+values.name+"'>"+
			"<div class='prodName text-center'>"+values.name+"</div>"+
			"</div>";
			if( values.description && values.description.length > 0 ){
				pepsicoHtml = pepsicoHtml + "<div class='tile-hover'>"+
							"<span class='tile-heading'>"+(values.name ? values.name : "")+"</span>"+
							"<span class='border'></span> "+
							"<span class='tile-content'>"+ values.description +"</span>"+
						"</div>";
			}
			
			pepsicoHtml = pepsicoHtml + "</a>"	+	
			"</div>"+
		
			"</div>"+
			"</div>";
		el.append(pepsicoHtml);
	}
}


ACC.cart = {

    _autoload: [
        "bindHelp",
        "cartRestoration",
        "bindCartPage",
        "bindMultiDEntryRemoval",
        "bindMultidCartProduct",
        "dismissPopupCartUndeliveredItems",
        ["bindApplyVoucher", $("#js-voucher-apply-btn").length != 0],
        ["bindToReleaseVoucher", $("#js-applied-vouchers").length != 0],
	    ["bindOrderComment", $("#commentTitle").length != 0],
	    ["bindPO", $("#po").length != 0],
	    ["validatePO", ACC.pageName == "cartPage"],
	    //["showOpenOrderModal", ACC.pageName == "cartPage"],
	    "checkItemsInCart",
		"discardCart",
		"mergeExpressCart",
		"checkCartEntriesForExpOrder",
		"reorder",
		"discardReorder",
	    ["addToCartUndeliveredAndEmptyReturnItems", ACC.pageName == "cartPage"]
    ],
    undeliveredAndEmptyReturnItemsJSON: null,
    bindHelp: function () {
        $(document).on("click", ".js-cart-help", function (e) {
            e.preventDefault();
            var title = $(this).data("help");
            ACC.colorbox.open(title, {
                html: $(".js-help-popup-content").html(),
                width: "300px"
            });
        });
        
        $("#orderCommentTextId").on("blur", function(){
        	
        	ACC.cart.ajaxCommentUpdate("Other", $("#orderCommentTextId").val());
        })
    },

    cartRestoration: function () {
        $('.cartRestoration').click(function () {
            var sCartUrl = $(this).data("cartUrl");
            window.location = sCartUrl;
        });
    },

    bindCartPage: function () {
        // link to display the multi-d grid in read-only mode
        $(document).on("click", '.js-show-editable-grid', function (event) {
            ACC.cart.populateAndShowEditableGrid(this, event);
        });
    },

    bindMultiDEntryRemoval: function () {
        $(document).on("click", '.js-submit-remove-product-multi-d', function () {
            var itemIndex = $(this).data("index");
            var $form = $('#updateCartForm' + itemIndex);
            var initialCartQuantity = $form.find('input[name=initialQuantity]');
            var cartQuantity = $form.find('input[name=quantity]');
            var productCode = $form.find('input[name=productCode]').val();

            cartQuantity.val(0);
            initialCartQuantity.val(0);

            ACC.track.trackRemoveFromCart(productCode, initialCartQuantity, cartQuantity.val());

            var method = $form.attr("method") ? $form.attr("method").toUpperCase() : "GET";
            $.ajax({
                url: $form.attr("action"),
                data: $form.serialize(),
                type: method,
                success: function () {
                    location.reload();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
                }

            });

        });
    },


    populateAndShowEditableGrid: function (element, event) {
    	ACC.common.logEvent(event.target.className);
    	
    	var readOnly = $(element).data("readOnlyMultidGrid");
        var itemIndex = $(element).data("index");
        var grid = $("#ajaxGrid" + itemIndex);

        var gridEntries = $('#grid' + itemIndex);
        var strSubEntries = gridEntries.data("sub-entries");
        var arrSubEntries = strSubEntries.split(',');
        var firstVariantCode = arrSubEntries[0].split(':')[0];

        $(element).toggleClass('open');

        var targetUrl = gridEntries.data("target-url");
        
        var mapCodeQuantity = {};
        for (var i = 0; i < arrSubEntries.length; i++) {
            var arrValue = arrSubEntries[i].split(":");
            mapCodeQuantity[arrValue[0]] = arrValue[1];
        }

        if (grid.children('#cartOrderGridForm').length > 0) {
            grid.slideToggle("slow");
        }
        else {
            var method = "GET";
            $.ajax({
                url: targetUrl,
                data: {productCode: firstVariantCode, readOnly: readOnly},
                type: method,
                success: function (data) {
                    grid.html(data);
                    $("#ajaxGrid").removeAttr('id');
                    var $gridContainer = grid.find(".product-grid-container");
                    var numGrids = $gridContainer.length;
                    for (var i = 0; i < numGrids; i++) {
                        ACC.cart.getProductQuantity($gridContainer.eq(i), mapCodeQuantity, i);
                    }
                    grid.slideDown("slow");
                    ACC.cart.coreCartGridTableActions(element, mapCodeQuantity);
                    ACC.productorderform.coreTableScrollActions(grid.children('#cartOrderGridForm'));
                },
                error: function (xhr, textStatus, errorThrown) {
                	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
                }

            });
        }
    },

    setSelectedVariants: function(_this, quantityBefore){
        var priceSibling = $(this).siblings('.price');
        var propSibling = $(this).siblings('.variant-prop');
        var currentSkuId = $(this).next('.td_stock').data('sku-id');
        var currentBaseTotal = $(this).siblings('.data-grid-total');
        
    	if (_this.value != quantityBefore) {
            var newVariant = true;
            ACC.productorderform.selectedVariants.forEach(function (item, index) {
                if (item.id === currentSkuId) {
                    newVariant = false;

                    if(_this.value === '0' || _this.value === 0){
                        ACC.productorderform.selectedVariants.splice(index, 1);
                    } else {
                        ACC.productorderform.selectedVariants[index].quantity = _this.value;
                        ACC.productorderform.selectedVariants[index].total = ACC.productorderform.updateVariantTotal(priceSibling, _this.value, currentBaseTotal);
                    }
                }
            });

            if(newVariant && _this.value > 0){
                // update variantData
                ACC.productorderform.selectedVariants.push({
                    id: currentSkuId,
                    size: propSibling.data('variant-prop'),
                    quantity: _this.value,
                    total: ACC.productorderform.updateVariantTotal(priceSibling, _this.value, currentBaseTotal)
                });
            }
        }
    },
    
    selectProductOrderFormTable: function(_this, quantityBefore){
    	if (_this.value > 0 && _this.value != quantityBefore) {
            $(_this).parents('table').addClass('selected');
        } else {
            if (ACC.productorderform.selectedVariants.length === 0) {
                $(_this).parents('table').removeClass('selected').find('.variant-summary').remove();
            }
        }
    },

    coreCartGridTableActions: function (element, mapCodeQuantity) {
        ACC.productorderform.bindUpdateFutureStockButton(".update_future_stock_button");
        ACC.productorderform.bindVariantSelect($(".variant-select-btn"), 'cartOrderGridForm');
        var itemIndex = $(element).data("index");
        var skuQuantityClass = '.sku-quantity';

        var quantityBefore = 0;
        var grid = $('#ajaxGrid' + itemIndex + " .product-grid-container");

        grid.on('focusin', skuQuantityClass, function (event) {
        	ACC.common.logEvent(event.target.className);
        	
        	quantityBefore = jQuery.trim(this.value);

            $(this).parents('tr').next('.variant-summary').remove();
            if ($(this).parents('table').data(ACC.productorderform.selectedVariantData)) {
                ACC.productorderform.selectedVariants = $(this).parents('table').data(ACC.productorderform.selectedVariantData);
            } else {
                ACC.productorderform.selectedVariants = [];
            }

            if (quantityBefore == "") {
                quantityBefore = 0;
                this.value = 0;
            }
        });

        grid.on('focusout', skuQuantityClass, function (event) {
        	ACC.common.logEvent(event.target.className);
        	
            var gridLevelTotalPrice = "";

            var indexPattern = "[0-9]+";
            var currentIndex = parseInt($(this).attr("id").match(indexPattern));

            this.value = ACC.productorderform.filterSkuEntry(this.value);

            var quantityAfter = jQuery.trim(this.value);
            var variantCode = $("input[id='cartEntries[" + currentIndex + "].sku']").val();

            if (isNaN(jQuery.trim(this.value))) {
                this.value = 0;
            }

            if (quantityAfter == "") {
                quantityAfter = 0;
                this.value = 0;
            }

            var $gridTotalValue = grid.find("[data-grid-total-id=" + 'total_value_' + currentIndex + "]");
            var currentPrice = $("input[id='productPrice[" + currentIndex + "]']").val();

            if (quantityAfter > 0) {
                gridLevelTotalPrice = ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice) * parseInt(quantityAfter));
            }

            $gridTotalValue.html(gridLevelTotalPrice);

            ACC.cart.setSelectedVariants(this, quantityBefore);

            ACC.productorderform.showSelectedVariant($(this).parents('table'));

            ACC.cart.selectProductOrderFormTable(this, quantityBefore);

            ACC.cart.updateMultiStepCart(quantityBefore, quantityAfter, variantCode, itemIndex, mapCodeQuantity);
        });
    },
    
    updateMultiStepCart: function(quantityBefore, quantityAfter, variantCode, itemIndex, mapCodeQuantity){
            if (quantityBefore != quantityAfter) {
                var method = "POST";
                $.ajax({
                    url: ACC.config.encodedContextPath + '/cart/updateMultiD',
                    data: {productCode: variantCode, quantity: quantityAfter, entryNumber: -1},
                    type: method,
                    success: function (data, textStatus, jqXHR) {
                        ACC.cart.refreshCartData(data, -1, quantityAfter, itemIndex);
                        mapCodeQuantity[variantCode] = quantityAfter;
                        ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        var redirectUrl = xhr.getResponseHeader("redirectUrl");
                        var connection = xhr.getResponseHeader("Connection");
                        // check if error leads to a redirect
                        if (redirectUrl !== null) {
                            window.location = redirectUrl;
                            // check if error is caused by a closed connection
                        } else if (connection === "close") {
                            window.location.reload();
                        }
                        ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
                    }
                });
            }
    },

    refreshCartData: function (cartData, entryNum, quantity, itemIndex) {
        // if cart is empty, we need to reload the whole page
        if (cartData.entries.length == 0) {
            location.reload();
        }
        else {
            if (entryNum == -1) { // grouped item
            	ACC.cart.refreshCartItemPrice(itemIndex, cartData);
            }

            ACC.cart.refreshCartPageWithJSONResponse(cartData);
        }
    },
    
    refreshCartItemPrice: function(itemIndex, cartData){
    	var form = $('.js-qty-form' + itemIndex);
                var productCode = form.find('input[name=productCode]').val();

                var local_quantity = 0;
        var entryPrice;
                for (var i = 0; i < cartData.entries.length; i++) {
                    var entry = cartData.entries[i];
                    if (entry.product.code == productCode) {
                    	local_quantity = entry.quantity;
                        entryPrice = entry.totalPrice;
                        break;
                    }
                }

                if (local_quantity == 0) {
                    location.reload();
                }
                else {
                    form.find(".qtyValue").html(local_quantity);
            form.parent().parent().find(".js-item-total").html( entryPrice != null ? entryPrice.formattedValue : "" );
        }
    },

    refreshCartPageWithJSONResponse: function (cartData) {
        // refresh mini cart
        ACC.minicart.updateMiniCartDisplay();
        $('.js-cart-top-totals').html($("#cartTopTotalSectionTemplate").tmpl(cartData));
        $('div .cartpotproline').remove();
        $('div .cartproline').remove();
        $('.js-cart-totals').remove();
        $('#ajaxCartPotentialPromotionSection').html($("#cartPotentialPromotionSectionTemplate").tmpl(cartData));
        $('#ajaxCartPromotionSection').html($("#cartPromotionSectionTemplate").tmpl(cartData));
        $('#ajaxCart').html($("#cartTotalsTemplate").tmpl(cartData));
        ACC.cart.appendAppliedVoucherCodes(cartData);
    },

    getProductQuantity: function (gridContainer, mapData, i) {
    	ACC.common.logConsole(i);
    	var tables = gridContainer.find("table");

        $.each(tables, function (index, currentTable) {
            var skus = jQuery.map($(currentTable).find("input[type='hidden'].sku"), function (o) {
                return o.value
            });
            var quantities = jQuery.map($(currentTable).find("input[type='textbox'].sku-quantity"), function (o) {
                return o
            });
            var selectedVariants = [];

            $.each(skus, function (index, skuId) {
                var quantity = mapData[skuId];
                if (quantity != undefined) {
                    quantities[index].value = quantity;

                    var indexPattern = "[0-9]+";
                    var currentIndex = parseInt(quantities[index].id.match(indexPattern));
                    var gridTotalValue = gridContainer.find("[data-grid-total-id=" + 'total_value_' + currentIndex + "]");
                    var gridLevelTotalPrice = "";
                    var currentPrice = $("input[id='productPrice[" + currentIndex + "]']").val();
                    if (quantity > 0) {
                        gridLevelTotalPrice = ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice) * parseInt(quantity));
                    }
                    gridTotalValue.html(gridLevelTotalPrice);

                    selectedVariants.push({
                        id: skuId,
                        size: $(quantities[index]).siblings('.variant-prop').data('variant-prop'),
                        quantity: quantity,
                        total: gridLevelTotalPrice
                    });
                }
            });

            if (selectedVariants.length != 0) {
                $.tmpl(ACC.productorderform.$variantSummaryTemplate, {
                    variants: selectedVariants
                }).appendTo($(currentTable).addClass('selected'));
                $(currentTable).find('.variant-summary .variant-property').html($(currentTable).find('.variant-detail').data('variant-property'));
                $(currentTable).data(ACC.productorderform.selectedVariantData, selectedVariants);
            }
        });

    },

    bindMultidCartProduct: function () {
        // link to display the multi-d grid in read-only mode
        $(document).on("click",'.showQuantityProduct', function (event){
            ACC.multidgrid.populateAndShowGrid(this, event, true);
        });

        // link to display the multi-d grid in read-only mode
        $(document).on("click",'.showQuantityProductOverlay', function (event){
            ACC.multidgrid.populateAndShowGridOverlay(this, event);
        });

    },

    bindApplyVoucher: function () {

        $(document).on("click", "#js-voucher-apply-btn", function (e) {
            ACC.cart.handleApplyVoucher(e);
        });

        $(document).on("keypress", "#js-voucher-code-text", function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13) {
                ACC.cart.handleApplyVoucher(e);
            }
        });
    },

    handleApplyVoucher: function (e) {
    	ACC.common.logEvent(e.target.className);
    	var voucherCode = $.trim($('.js-voucher-code').val());
        var url = ACC.config.encodedContextPath + '/voucher/apply';
        var postData = {voucherCode: voucherCode};
        $('.js-voucher-respond').removeClass('has-success has-error');
        if (voucherCode != '' && voucherCode.length > 0) {
            $.post(url, postData).done(function (result, textStatus, jqXHR) {
                if (result.errorMsg != null && result.errorMsg.length > 0) {
                    $('.js-voucher-respond').addClass('has-error');
                    $('.js-voucher-validation-container').text(result.errorMsg);
                } else {
                    location.reload();
                    $('.js-voucher-respond').addClass('has-success');
                    $('.js-voucher-validation-container').text(result.successMsg);
                    $('.js-voucher-code').val('');
                }
                $('.js-voucher-code').focusin();
                ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
            })
            .fail(function(jqXHR, textStatus, errorThrown) {
            	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
            })
            .always(function(jqXHR, textStatus) {
            	ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
            });
        }

    },

    appendAppliedVoucherCodes: function (cartData) {
        $('#js-applied-vouchers').empty();
        $('.js-voucher-validation-container').empty();
        $('.js-voucher-respond').removeClass('has-error');
        $('#js-applied-vouchers').html($("#applied-voucher-codes-template").tmpl(cartData));
        ACC.cart.bindToReleaseVoucher();
    },

    bindToReleaseVoucher: function () {
        $('.js-release-voucher-remove-btn').on("click", function (event) {
            var voucherCode = $(this).parent('.js-release-voucher').data('voucher-code');
            var voucherReleaseUrl = ACC.config.encodedContextPath + '/voucher/' + voucherCode + '/remove';
            $.ajax({
                url: voucherReleaseUrl,
                type: 'DELETE',
                success: function (response) {
                    $('.js-voucher-respond').removeClass('has-success');
                    $('.js-voucher-validation-container').empty();
                    if (response.errorMsg != null && response.errorMsg.length > 0) {
                        $('.js-voucher-respond').addClass('has-error');
                        $('.js-voucher-validation-container').text(response.errorMsg);
                    } else {
                        $('.js-voucher-respond').removeClass('has-error');
                        $('.js-voucher-validation-container').empty();
                        $(event.target).parent('.js-release-voucher').remove();
                        location.reload();
                    }
                }
            });
        });
    },
	
	bindOrderComment: function(){ 
		if( $("#commentTitle").val() === "Other" ){
			$("#orderCommentTextId").removeAttr("disabled");
		}
    	$("#commentTitle").on("change", function(){
			var thisVal = $(this).val();
			var thisText= $(this).find("option:selected").text();
			$('#orderComment').val(thisText);
			ACC.cart.populateOrderCommentFields(thisVal,thisText);
			
			if( thisVal !== "Other" ){
				ACC.cart.ajaxCommentUpdate(thisVal,thisText);
			}
		});
    },
    
    
    
    ajaxCommentUpdate: function(thisVal, thisText){
    	$.ajax({
			data: {"orderCommentCode":thisVal, "orderComment":thisText},
			url: ACC.config.encodedContextPath + "/cart/setOrderComment", 
			async: false,
			method: "GET",
			success: function(){
				ACC.cart.populateOrderCommentFields(thisVal, thisText);
	    	}
	    });
    },
    
    showUndeliveredAndEmptyReturnItems:function(){
    	if(ACC.pageName==="cartPage"){
    		$.ajax({
                url: ACC.config.encodedContextPath + '/cart/showUndeliveredAndEmptyReturnsPopup',
                method: "GET",
                success: function (data) {
                	var result = data;
                	result = result.replace(/(?:\r\n|\r|\n)/g, '');
                	                   	
                	if(result!=''){
                	ACC.cart.showUndeliveredAndEmptyReturnPopup(data);
                	}
                }
            });
    	}
    },
    
	
	populateOrderCommentFields : function(thisVal,thisText){
		if( thisVal === "Other" ){
			$("#orderCommentTextId").removeAttr("disabled").val(thisText !== 'Other' ? thisText : '');
			$('#orderComment').val(thisText);
		}else{
			$("#orderCommentTextId").attr("disabled", "disabled");
			if( thisVal !== '-1' ){
				$("#orderCommentTextId").val(thisText != '-1' ? thisText : '');
			}else{
				$("#orderCommentTextId").val('');
			}
		}
	},
	
	
	bindPO: function(){ 
    	$("#po").on("blur", function(){
			var thisVal = $(this).val();
			$('#poNumber').val(thisVal);
			
			$.ajax({
				url: ACC.config.encodedContextPath + "/cart/setPONumber", 
				data: {"purchaseOrder":thisVal},
				method: "GET",
				success: function(response){
					var closest = $('#po').closest(".form-group");
					if(response == "length_error")
					{
						closest.addClass(" has-error");
						closest.find("#customVlLn").show();
					}
					else if(response == "regex_error")
					{
						closest.addClass(" has-error");
						closest.find("#customVlSp").show();
					}
					else if(response == "error")
					{
						closest.addClass(" has-error");
						closest.find("#customVlEr").show();
					}
					else if(response == "all_space")
					{
						closest.addClass(" has-error");
						closest.find("#customVlAlSp").show();
					}
		    	}
		    });
		});
    },
    
    
    validatePO : function(){
		if( ACC.browserDetect.isAndroid() ){
			ACC.cart.validatePOinAndroid();
		}
		else{
			ACC.cart.validatePOinOthers();
		}
    },
    
    validatePOinAndroid: function(){
			$("#hiddenPO").val( $("#po").val() );
			$(document).on("keyup", '#po', function () {
	    		var el = $(this);
	    		var hiddenPo = $("#hiddenPO").val();
	    		var closest = el.closest(".form-group");
				ACC.cart.hidePoErrText(closest);
	    		if( el.val().length > 0 ){
	    			if(! /^[0-9a-zA-Z\s]+$/.test(el.val()) ){
	    				el.val( hiddenPo );
	    				closest.addClass(" has-error");
						closest.find("#customVlSp").show();
	    			}else{
	    				$("#hiddenPO").val( el.val() );
	    			}
	    		}
    	});
    },
    
    validatePOinOthers: function(){
	    	var allowKeyCode = [8, 46, 37, 39];
			$('#po').on("keypress", function(evt) { 
				var closest = $('#po').closest(".form-group");
				ACC.cart.hidePoErrText(closest);
				    var key = evt.which || evt.keyCode;
				    var char = String.fromCharCode(evt.charCode);
				    if ( !(/^[a-z0-9\s]+$/i.test(char)) ) {
				    	if( (! evt.shiftKey ) && $.inArray(key, allowKeyCode) > -1 && !(/^[\.\'\%]+$/i.test(char)) ){
				    	return true;
				    }
					  closest.addClass(" has-error");
					  closest.find("#customVlSp").show();
				      evt.returnValue = false; 
				      return false;
				   } 
			});
    },
    
    hidePoErrText: function(el){
    	el.removeClass(" has-error");
    	el.find("#customVlSp").hide();
    	el.find("#customVlLn").hide();
    	el.find("#customVlEr").hide();
    	el.find("#customVlAlSp").hide();
    },
    
    
    checkItemsInCart : function (value){
		if(typeof value!=="undefined")
		{
			var cartCount = $('.mini-cart-count').find('.nav-items-total').text();
			$('.quickOrder').css('pointer-events','none');
			if(parseInt(cartCount,10) > 0)
			{
				// modal no longer needed  $('#expOrdModal').modal();
				ACC.cart.expressCheckout(false,true);
			}
			else{
				ACC.cart.expressCheckout(true,false);
			}	
		}
    },
    
    
    expressCheckout : function(discardFlag,mergeFlag){
    	ACC.track.trackExpressCheckout(ACC.CofNo);
    	$.ajax({
			url: ACC.config.encodedContextPath + "/cart/expressCheckout", 
			method: "POST",
			data : {"discardCart":discardFlag , "mergeCart":mergeFlag},
			complete: function(){
				window.location = ACC.config.encodedContextPath + '/cart?express=true';
	    	}
	    });
    },
    
    
    discardCart : function(){
    	$(document).on("click",'.discardCartButtonForExpOrd', function (e){
    		e.preventDefault();
    		ACC.cart.expressCheckout(true,false);
    	})
    },
    
    
    
    mergeExpressCart : function(){
    	$(document).on("click",'.mergeCartButtonForExpOrd', function (e){
    		e.preventDefault();
    		ACC.cart.expressCheckout(false,true);
    	})
    },

    
    
    checkCartEntriesForExpOrder : function(){
    	$(document).on("click",'.placeOrderBtn', function (){
    		ACC.cart.checkItemsInCart('Check');
    	})
    },
    
    
    reorder : function(){
    	$('.re-order').on("click", function(){
    		ACC.cart.checkCartItemsForReorder();
    	});
    },
    
    
    checkCartItemsForReorder : function(){
    	var cartCount = $('.mini-cart-count').find('.nav-items-total').text();
		if(parseInt(cartCount,10) > 0)
		{
			$('#reorderModal').modal();
		}
		else{
			window.location = $('#reOrderUrlVal').val();
		}
    },
    
    
    discardReorder : function(){
    	$('.discardReorderBtn').on("click", function(){
    		window.location=$('#reOrderUrlVal').val()+"&discardCart=Y";
    	});
    },
    
    getColorBoxWidth: function(el){
		var x = el.width();
		return x > ACC.cartitem.wx ? ACC.cartitem.wx : x;
	},
	getColorBoxHeight: function(el){
		var y = el.height();
		return y > ACC.cartitem.wy ? ACC.cartitem.wy : y;
	},
	showColorboxInOverlay: function(el){
		var z = el.height();
		var bch = $(".bodyContainer").height();
    	var wst = $(window).scrollTop();
    	var scrollTo;
    	if( bch > z ){
    		if( (bch - wst) >  z ){
    			// check entire popup can be displayed within overlay from current screen position
    			scrollTo = wst;
    		}else{
    			// adjust screen position so that entire popup can be displayed within overlay
    			scrollTo = wst - (wst + z - bch) - 50;
    		}
    	}else{ 
    		// increase the body height so that entire popup can be displayed within overlay
    		// and starting point of colorbox is within screen
    		$('body').css({"min-height": (z+100)});
    		scrollTo = 50;
    	}
    	
    	$('body, html').animate({
			scrollTop: scrollTo
		}, 800, function(){
			$("#colorbox").css({"top": scrollTo});
		});
	},

	showUndeliveredAndEmptyReturnPopup: function(data){
		var $modal = $("#emptyReturnBYCModal");
		
		var title = $(data).find(".modalTitle").text();
    	$modal.find(".modal-title").text(title);
    	$modal.find(".modal-body").html(data);
		
		$modal.modal("show");
		$modal.on('shown.bs.modal', function () {
        	ACC.cart.enableDisableAddtoCart();         	
        	$(document).on("keyup", '.emptyReturnModal .js-quantity-input', function () {
        		ACC.cart.enableDisableAddtoCart();
        	});
        	
        	$modal.find(".js-first-focus").focus();
		    ACC.global.modalAccessibility( $modal, $modal.find(".close"),  $modal.find(".js-last-focus"));
		});
		$modal.on('hidden.bs.modal', function () {
			ACC.cart.closeEmptyReturnModal();
		});
	},
	
	closeEmptyReturnModal: function(){
    	if( typeof( $('body').attr("style") ) !== "undefined" ){
    		$('body').css({"min-height": "auto"});
    	}
	},
	
   addToCartUndeliveredAndEmptyReturnItems:function(){
    	
    	$(document).on('click', '#addToCartUndeliveredAndEmptyReturnItems', function(){
    		ACC.cart.addToCartMultipleItems(JSON.stringify(ACC.cart.undeliveredAndEmptyReturnItemsJSON));
    	});
    },

    addToCartMultipleItems:function(jsonString){
    	$.ajax({
            url: ACC.config.encodedContextPath + '/cart/add/multiple',
            method: "POST",
            data: {itemList:jsonString},
            success: function (data) {
            	var error=false;
            	var removabledivs=[];
            	var obj=JSON.parse(data);
            	 $.each(JSON.parse(obj.response), function (key, value) {
            	        if(value.status!="success"){
            	        	$(".errorMsg").removeClass("hide");
            	        	error=true;
            	        }else{
            	        	var divid='#undeliveredAndEmptyReturnEntry_'+value.productCode;
            	        	removabledivs.push(divid);
            	        }
            	    });
            	if(!error){
            		if($('#lastDeliveryDate').length>0){
            			var lastDeliveryDate=$('#lastDeliveryDate').val();
            			ACC.cart.updateLastDeliveryDate(lastDeliveryDate);
            		}
            		window.location.reload();
            	}else{
            		$.each(removabledivs,function(index,value){
            			$(value).remove();
            		});
            		ACC.colorbox.resize();
            	}
            }
        });
    },
    dismissPopupCartUndeliveredItems:function(){
    	$(document).on('click', '.js-donotAddToCart', function(){
    		$("#emptyReturnBYCModal").modal("hide");
    	});
    	
    },
    
    showOpenOrderModal: function() {
    	var openOrderEventComplete=false;
    	$.ajax({
            url: ACC.config.encodedContextPath + '/cart/showOpenOrderModal',
            method: "GET",
            success: function(rsp){
    			if (rsp ==='ShowPrompt'){
    				$('#openOrderModal').modal();
    				ACC.cart.openOrderModalDisplay();
    			} else {
    				openOrderEventComplete=true;
    			}
            },
            complete: function() {
            	if(openOrderEventComplete) {
            		ACC.cart.showUndeliveredAndEmptyReturnItems();
            	} else {
            		$(document).on('click', '.js-open-order-modal-close', function(){
                		ACC.cart.showUndeliveredAndEmptyReturnItems();
                	});
            	}
            }
        });
    },
    
    openOrderModalDisplay: function(){
    	$('#openOrderModal').on('shown.bs.modal', function () {
			  // do something...
			
			$('#openOrderModal').find(".js-first-focus").focus();
		    ACC.global.modalAccessibility( $('#openOrderModal'), $('#openOrderModal').find(".close"),  $('#openOrderModal').find(".js-open-order-modal-yes"));
		    ACC.global.closeModal($('#openOrderModal').find(".close"), false);
		});
    },
    
    enableDisableAddtoCart: function() {
    	var hasQty=false;
    	ACC.cart.undeliveredAndEmptyReturnItemsJSON={items:[]};
    	$('.undeliveredAndEmptyreturnItem').each(function(){
			var $div=$(this).find(".js-qty-input");
    		var qty=($div.find('input[name=undeliveredAndEmptyReturnQty]')).val();
    		var productCode=($div.find('input[name=undeliveredAndEmptyReturnPdtCode]')).val();
    		if(qty>0) {
    			hasQty = true;
    		}
    		ACC.cart.undeliveredAndEmptyReturnItemsJSON.items.push({
    			"productCode":productCode,
    			"qty":qty
    		});
    	});
    	if(!hasQty) {
    		$("#addToCartUndeliveredAndEmptyReturnItems").addClass("disabled");
    	} else {
    		$("#addToCartUndeliveredAndEmptyReturnItems").removeClass("disabled"); 
    	}
    },
    updateLastDeliveryDate : function(lastDeliveryDate){
	   	$.ajax({
				url: ACC.config.encodedContextPath + "/cart/updateLastDeliveryDate", 
				method: "POST",
				data : {"lastDeliveryDate":lastDeliveryDate},
	            error: function (jqXHR, textStatus, errorThrown) {
	                	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
	                }
		    });
	   }
    
};

ACC.cartitem = {

	_autoload: [
		"bindCartItem",
		["baseProductsAddToCart", $("#ajaxMinErrBaseProduct").length > 0 || $("#ajaxMinErrTopBrandProduct").length > 0],
		["minErrEnableAddToCart", $("#ajaxMinErrBaseProduct").length > 0 || $("#ajaxMinErrTopBrandProduct").length > 0],
		["toggleMinErrProducts", $("#minmErrorModal").length > 0],
		"validateQty",
		["cartPageQuantitySorting", ACC.pageName === "cartPage"]
	],
	submitTriggered: false,
	wy : $(window).height(),
	wx : $(window).width(),
	pageLoadFlag : true,
	dealItemsJSON : null,
	dealIsModified : false,
	
	cartPageQuantitySorting: function(){
		
		$(document).on('focusout', '.js-qty-selector-input',function(){
			$(this).closest('td').attr('data-order', $(this).val());
			ACC.datatable.cartDataTable.row($(this).closest('tr')).invalidate();
		});
		
	},
	removeCartItem: function($el){
		var entryNumber = $el.attr('id').split("_")
		var form = $('#updateCartForm' + entryNumber[1]);

		var productCode = form.find('input[name=productCode]').val();
		var initialCartQuantity = form.find('input[name=initialQuantity]');
		var cartQuantity = form.find('input[name=quantity]');
		
		ACC.track.trackRemoveFromCart(productCode, initialCartQuantity.val());

		cartQuantity.val(0);
		initialCartQuantity.val(0);
		form.submit();
	},
	
	confirmProductDelete: function( $el ){
		$("#confirmDeleteModal").modal("show");
		$('#confirmDeleteModal').on('shown.bs.modal', function () {
			// do something...
			var productCode = $el.closest("tr").find("input[name=productCode]").val();
			$('#confirmDeleteModal').find(".js-productcode").val(productCode);
			$('#confirmDeleteModal').find(".js-first-focus").focus();
		    ACC.global.modalAccessibility( $('#confirmDeleteModal'), $('#confirmDeleteModal').find(".js-no-delete-btn"),  $('#confirmDeleteModal').find(".js-last-focus"));
		});
	},
	
	bindConfirmDeleteProduct: function(){
		$(document).on("click", '.js-yes-delete-btn', function (){
			var productcode = $(this).closest(".modal-content").find(".js-productcode").val();
			var rowItem = $("input[name=productCode]").filter("[value="+productcode+"]").closest("tr");
			ACC.cartitem.removeCartItem( rowItem.find(".js-remove-entry-button") );
		});
		$(document).on("click", '.js-no-delete-btn', function (){
			$("#confirmDeleteModal").modal("hide");
		});
	},
	
	isDealProductRow: function($el){
		return $el.closest("tr").find(".js-deal-product").length;
	},
	
	bindCartItem: function (){
		ACC.cartitem.bindConfirmDeleteProduct();
		$(document).on("click", '.js-remove-entry-button', function (){
			if( ACC.cartitem.isDealProductRow( $(this) ) ){
				ACC.cartitem.confirmProductDelete( $(this) );
			}else{
				ACC.cartitem.removeCartItem($(this));
			}
		});
		
		ACC.cartitem.quantityKeyEvent();
		
		if( $('#po').length > 0 && $("#submitPoNumber").length > 0 ){
			$('#po').on("keyup", function(){
				$("#submitPoNumber").val( $(this).val() );
			});
		}
		
		$(document).on("click", ".js-recalculate-button", function (){
			var dateValue = $("#deliveryChk").find("#deliveryDate").val();
			if($("#deliveryDate_label").length > 0){
				$("#deliveryDate_label").remove();
			} 
			if( dateValue.length === 0 ){
				$( "#deliveryChk" ).validate().element("#deliveryDate" );
				ACC.cartitem.scrollTo($('#deliveryChk'));
				$("#deliveryChk").find("#deliveryDate").focus();
				return false;
			}
			$(".js-page-cartPage-quantity").find(".js-not-eligible").each(function(){
				if( $(this).closest("form").hasClass("has-error") ){
				ACC.cartitem.resetCartItem($(this));
				}
			});
			
			ACC.cartitem.updateCartForDeal();
		});				
				
				
		$(document).on("focus","#po",function(){		
			var closest = $('#po').closest(".form-group");		
			closest.find("#customVl").hide();		
			closest.find("#customVlSp").hide();	
			closest.find("#customVlLn").hide();	
			closest.find("#customVlEr").hide();
			closest.find("#customVlAlSp").hide();
		})
	},
	
	resetCartItem: function($el){
		var updatedCampQty = +$el.closest("form").find("[name=updatedCampQty]").val();
		$el.val( updatedCampQty );
		$el.closest("form").find("[name=initialQuantity]").val(updatedCampQty);
		ACC.campaign.displayCampaignOfferError($el, false);
	},
	
	quantityKeyEvent: function(){
		//Empty Return
		$(document).on("focus", '.js-quantity-input', function (){
			ACC.cartitem.focusForZero($(this));
		});
		$(document).on("focusout", '.js-quantity-input', function (){
			ACC.cartitem.focusOutForZero($(this));
		});
		$(".js-page-cartPage-quantity").on("blur", '.js-update-entry-quantity-input.js-not-eligible', function (){
			ACC.cartitem.resetCartItem($(this));
		});
	},
			
	quantityKeyDownEvent: function(elem, event){
		if(!ACC.cartitem.allowNumberOnly(event)){
			event.preventDefault();
				return false;
			}
		if( $(elem).val() < 0 ){
			$(elem).val(0);
			}
		return ACC.cartitem.handleKeyEvent(elem, event);
	},
	
	recalculatePrice: function(){
		var items = [];
		var productCode, initialQuantity, productPostPrice, cartCode, productName, cart;
		var qtyError=false;
		$('.js-update-entry-quantity-input').each(function(){
			var form = $(this).closest('form')
			productCode = form.find('input[name=productCode]').val();
			initialQuantity = $(this).val();
			if( initialQuantity.length == 0  ){
				initialQuantity = 0;
				qtyError=true;
			}
			productPostPrice = form.find('input[name=productPostPrice]').val();
			cartCode = form.find('input[name=cartCode]').val();
			productName = form.find('input[name=productName]').val();
			cart = {sku:productCode, quantity:initialQuantity, productPostPrice:productPostPrice, cartCode:cartCode,productName:productName};
			items.push(cart);
		});
		
		ACC.cartitem.showOutofStock();
		
		if( !qtyError){
			ACC.checkout.cartSpinnerDisplay(true);
			ACC.cartitem.reCalculate(items);
		}
		else if(qtyError){		
			ACC.cartitem.scrollTo($('.cartPageQuantityPopover').parent());		
		}		
	},

	handleKeyEvent: function (elementRef, event){
		if( window.location.href.indexOf("isExpressOrder=yes") >= 0 ){
			history.pushState(null, null, window.location.href.replace("isExpressOrder=yes", "isExpressOrder=no"));
		}
		if (event.which === 13 && !ACC.cartitem.submitTriggered){
			ACC.cartitem.submitTriggered = true;
			ACC.cartitem.handleUpdateQuantity(elementRef, event);
			// updated to prevent form submit on press enter in cart page. and Defect-1529
			return false;
		}
		else {
			// Ignore all key events once submit was triggered
			if (ACC.cartitem.submitTriggered){
				return false;
			}
		}

		return true;
	},

	showPopOver: function(newCartQuantity, form, elementRef){
		if( newCartQuantity.length === 0 ){		
			var msg = $('<div class="cartPageQuantityPopover popover fade bottom in" role="tooltip"><div class="arrow"></div><h3 class="popover-title">Error</h3><div class="popover-content">'+ ACC.cartProductEmptyText +'</div></div>');		
			form.addClass("has-error has-feedback");		
			if( $(elementRef).siblings(".popover").length == 0 ){		
				$(elementRef).after(msg);		
			}		
		}else{		
			if( ACC.cartitem.isDealProductRow( $(elementRef) ) ){
				if( $(elementRef).closest("td").find(".dealMessage").length ){
					$(elementRef).closest("td").find(".dealMessage").removeClass("hide");
				}else{
					$(elementRef).closest("td").prepend('<span class="dealMessage text-error">'+ ACC.dealProductModifyText +'</span>');
				}
				setTimeout(function () {
					$(elementRef).closest("td").find(".dealMessage").addClass("hide");
		    	}, parseInt(ACC.dealProductModifyTimeout));
			}else{
				form.removeClass("has-error has-feedback");		
				if( $(elementRef).siblings(".popover").length > 0 ){		
					$(elementRef).siblings(".popover").remove();		
				}	
			}
		}
	},
	
	handleUpdateQuantity: function (elementRef)	{
		$(elementRef).closest("td").find(".dealMessage").addClass("hide");
		var form = $(elementRef).closest('form');
		var newCartQuantity = $(elementRef).val();
		var initialCartQuantity = form.find('input[name=initialQuantity]').val();
		var productCode = form.find('input[name=productCode]').val();
		ACC.cartitem.showPopOver(newCartQuantity, form, elementRef);
			
		if(initialCartQuantity !== newCartQuantity){
			ACC.cartitem.showPriceOrder();
			ACC.cartitem.clearCartPrice();
			
			$('.safety-net-indicator').hide();
			form.find('input[name=initialQuantity]').val($(elementRef).val());
			ACC.track.trackUpdateCart(productCode, initialCartQuantity, newCartQuantity);
			
			var callAjax = true;
			
			if( form && form.hasClass("js-page-cartPage-quantity") ){
				callAjax = ACC.campaign.checkEligibility($(elementRef));
			}
			
			if( callAjax ){
				ACC.cartitem.safetyNetDisplay(productCode,newCartQuantity, "CART");
				ACC.cartitem.updateQuantityAjax($(elementRef), productCode, newCartQuantity);
			}
		}

	},
	
	closeAllDealPanel: function(){
		if( $(".js-deal-section").find("#showDeal").length > 0 ){
			var panelBody = $(".js-deal-section").find("#showDeal").data("target");
			$(panelBody).collapse('hide');
		}
	},
	
	updateQuantityAjax: function($el, productCode, newCartQuantity){
		ACC.cartitem.closeAllDealPanel();
		$.ajax({
			url: ACC.config.encodedContextPath + "/cart/updateQty", 
			data: {"productCode":productCode, "quantity":newCartQuantity},
			method: "GET",
			success: function(){
				$el.closest('form').find('input[name=updatedCampQty]').val(newCartQuantity);
					ACC.minicart.updateMiniCartDisplay();
	        		$('.minimumsContent').hide();
	        		$('.maximunContent').hide();
	        		$('#priceOrderError').hide();
	    	}
	    });
	},
	
	getPastSixOrders: function(prevOrdertable){
		var total = 0;
		var item = 0;
		prevOrdertable.find(".js-prev-order-qty").each(function(){
			var qty = +$(this).text();
			if( qty > 0 ){
				item += 1;
				total += qty;
			}
		});
		return {"total":total, "item":item};
	},
	
	safetyNetDisplay: function(productCode,newCartQuantity, callFrom) {
		var input = $(":hidden[name=productCode][value='"+productCode+"']").closest("form").find(".js-update-entry-quantity-input");
		var itemQty = +input.val();
		var prevOrdertable = $(":hidden[name=productCode][value='"+productCode+"']").closest("tr").find(".js-desktop-past-order-table");
		var totalOrderObj = ACC.cartitem.getPastSixOrders(prevOrdertable);
		var is_empty = input.hasClass("js-empty-return");
		var showModal = ACC.cartitem.showSafetyModal(totalOrderObj, itemQty, is_empty);
		
		if( showModal ){
			$("#safetyNetModal").modal();
			var tabIndex = input.data("tabindex");
			var parentRow = input.closest(".responsive-table-item");
			var nextTabIndex = +tabIndex - 2;
			var nextInput = parentRow.closest("tbody").find("input[data-tabindex="+nextTabIndex+"]");
			
			ACC.cartitem.safetyNetModalTabKey(input);
			
			ACC.cartitem.confirmSafetyNet(nextInput, callFrom);
			ACC.cartitem.updateSafetyNet(input);
		}
	},
	
	safetyNetModalTabKey: function(input){
		$('#safetyNetModal').on('shown.bs.modal', function () {
			// do something...
			$('#safetyNetModal').find(".js-first-focus").focus();
		    ACC.global.modalAccessibility( $('#safetyNetModal'), $('#safetyNetModal').find(".close"),  $('#safetyNetModal').find(".js-update-qty-seftyNet"));
		    ACC.global.closeModal($('#safetyNetModal').find(".close"), input);
		})
	},
	
	confirmSafetyNet: function(nextInput, callFrom){
		$("#safetyNetModal").on("click", ".js-confirm-seftyNet", function(){
			ACC.productDetail.pdpSpinnerDisplay(true);
			$("#safetyNetModal").modal('hide');
			if( callFrom === "CART" && nextInput.length ){
				nextInput.focus();
			}else{
				var addToCartForm = nextInput;
				addToCartForm.ajaxSubmit({
		    		success: ACC.product.displayAddToCartPopup
		    	}); 
		        // return false to prevent normal browser submit and page navigation 
		        return false;
			}
		})
	},
	
	updateSafetyNet: function(input){
		$("#safetyNetModal").on("click", ".js-update-qty-seftyNet", function(){
			$("#safetyNetModal").modal('hide');
			input.focus().select();
		});
		$('#safetyNetModal').on('hidden.bs.modal', function () {
			if( ACC.pageName === "productDetails" ){
				$("#safetyNetModal").off("click", ".js-confirm-seftyNet");
				$("#safetyNetModal").off("click", ".js-update-qty-seftyNet");
			}
		})
	},
	
	ajaxPaymentTerm: function( show ){
		var paymentTerm = $(".js-payment-term").val();
		if( paymentTerm.length && show ){
			$(".js-payment-term-msg").removeClass("display-none").find(".message").text(paymentTerm);
		}
		else{
			$(".js-payment-term-msg").addClass("display-none");
		}
	},
	
	reCalculate: function (items){
		var delvDate=$("#deliveryDate").val();
		//ajax call
		$.ajax({
			url: ACC.config.encodedContextPath + "/cart/calculate", 
			data: {carttotal:JSON.stringify(items), delvDate:delvDate, pageLoadFlag:ACC.cartitem.pageLoadFlag},
			method: "POST",
			dataType:"json",
			success: function(result){
				if(result.isReloadNeeded){		
					window.location.href=ACC.config.encodedContextPath + "/cart";		
				}else if(ACC.pageName === "cartPage"){
					ACC.cart.showOpenOrderModal();
				}
				ACC.cartitem.reCalculateAjaxSuccess(result);
		    	ACC.cartitem.showMinMaxError(result);
				if( !ACC.cartitem.pageLoadFlag && result.isCdaAvailable ){
					$("#complianceModal").modal("show");
				}
	    	},
	    	complete: function(){
	    		ACC.checkout.cartSpinnerDisplay(false);
	    		ACC.global.footerAlignment();
	    	}
	    });
	},
	
	getFreeSkuUpdatedQty: function(freeSkuUpdatedQty, code){
		var qty = 0;
		if( freeSkuUpdatedQty ){
			for (var key in freeSkuUpdatedQty) {
				if ( freeSkuUpdatedQty.hasOwnProperty(key) && code === key ) {
					qty = freeSkuUpdatedQty[key];
					break;
				}
			}
		}
		return qty;
	},
	
	setAjaxCartItemPrice: function(result){
    	var totalProduct = 0;
    	$.each(result.entries, function(index, value){
        	var pCode = value.product.code;
        	var pQty = value.quantity;
        	var itemIndex = $("#js-cartDataTable").find("tr[data-cartitemprodcode='"+pCode+"']").find(".js-cartitem-index").val();
        	
			$(".item-price_"+itemIndex).text(value.basePrice.formattedValue);
			$(".net-item-price_"+itemIndex).text(value.netPrice.formattedValue);
			$(".item-total_"+itemIndex).text(value.totalPrice.formattedValue);
			if( value.taxDepositTotal !== null ){
				$(".empty_item-total_"+itemIndex).text(value.taxDepositTotal.formattedValue);
			}
			$(".js-cart-unit-price_"+itemIndex).text(value.netPrice.formattedValue);
			if( value.itemDeposit !== null ){
				$(".js-cart-unit-price_empty_"+itemIndex).text('-'+value.itemDeposit.formattedValue);
			}
			if(value.safetyNetFlag === true){
    			$(".item-safetyNetFlag_"+itemIndex).show();
    		}
    			
			var frSkuQty = ACC.cartitem.getFreeSkuUpdatedQty(result.freeSkuUpdatedQty, pCode);
			if( frSkuQty > 0 ){
				totalProduct += frSkuQty;
			}else{
				totalProduct += pQty;
			}
        });
		
    	$(".nav-items-total").text(totalProduct);
	},
	
	reCalculateAjaxSuccess: function(result){
		
		result.isDealAvailable ? $(".js-deal-section").removeClass("display-none") : $(".js-deal-section").addClass("display-none");
		
		$(".js-totalprice").val(result.totalPrice.value);
    	$('.cart-totals .price-sub-total').text(result.subTotal.formattedValue);
    	$('.cart-totals .price-grand-total').text(result.totalPrice.formattedValue);
    	$('.cart-totals .price-tax').text(result.totalTax.formattedValue);
    	
    	ACC.cartitem.setAjaxCartItemPrice(result);
    	
    	if( result.freeSkuUpdatedQty ){
			var freeSkuUpdatedQtyObj = result.freeSkuUpdatedQty;
			for (var key in freeSkuUpdatedQtyObj) {
				if (freeSkuUpdatedQtyObj.hasOwnProperty(key)) {
				var row = $("#js-cartDataTable").find("tr[data-cartitemprodcode='"+key+"']");
					var updtQty = freeSkuUpdatedQtyObj[key];
					row.find(".js-update-entry-quantity-input").val( updtQty );
					row.find("[name='initialQuantity']").val( updtQty );
					row.find("[name='updatedCampQty']").val( updtQty );
				}
			}
		}
    	
    	
    	$('.cart-totals .price-sub-total').css('visibility','visible');
    	$('.cart-totals .price-grand-total').css('visibility','visible');
    	$('.cart-totals .price-tax').css('visibility','visible');
    	$('.item-list-item .item-price').css('visibility','visible');
    	$('.item-list-item .item-total').css('visibility','visible');
	        	
	},
	        	
	showMinMaxError: function(result){
    	if(result.b2bCustomerData.unit.isPriceError){
    		$('#priceOrderError').show();
    		ACC.cartitem.scrollTo($('#priceOrderError'));
    	}
    	ACC.cartitem.showSubmitOrder();
	},
	
	validatePoNumber: function(type){
		if( type === "check" ){
			if( $("#isPoRequired").length > 0 && $('#po').length > 0 ){
				var closest = $('#po').closest(".form-group");
				closest.find("#customVl").hide();
				closest.find("#customVlSp").hide();
				closest.find("#customVlLn").hide();
				closest.find("#customVlEr").hide();
				closest.find("#customVlAlSp").hide();
				if( closest.hasClass("has-error") ){
					closest.removeClass("has-error");
				}
				return ACC.cartitem.checkPoRequired(closest);
			}
			return true;
		}
	},
	
	checkPoRequired: function(closest){
		var isPoRequired = $("#isPoRequired").val();
		if( isPoRequired.length > 0 ){
			isPoRequired = isPoRequired.toLowerCase();
			if( isPoRequired === "y" ){
				var poValue = $('#po').val().trim();
				if( poValue.length === 0 ){
					closest.addClass(" has-error");
					closest.find("#customVl").show();
					return false;
				}
				if(poValue.length > 22){
					closest.addClass(" has-error");
					closest.find("#customVlLn").show();
					return false;
				}
				if(!(/^[a-z0-9\s]+$/i.test(poValue))) {		
					closest.addClass(" has-error");		
					closest.find("#customVlSp").show();		
					return false;		
				}
			}
		}
		return true;
	},
	
	showOutofStock: function(){
		if( $(".stock-content").length > 0 && $('#outofstockModal').length > 0 ){
			$('#outofstockModal').hide();
			if( $(".stock-content").find(".out-of-stock").length > 0 ){
				$('#outofstockModal').show();
			}
		}
	},
	showPriceOrder: function(){
		var element = $(".cart-actions").find(".js-continue-checkout-button");
		element.addClass("btn--recalculate js-recalculate-button")
		.removeClass("btn--continue-checkout js-continue-checkout-button")
		.removeAttr("data-checkout-url")
		.text($("#priceOrderText").text());
		
		$(".top-pricing-btn-ctnr").find(".js-recalculate-button").removeClass("disabled");
		ACC.cartitem.hideCommentPoEtc();
		ACC.cartitem.ajaxPaymentTerm(false);
	},
	showSubmitOrder: function(){
		$('.minimumsContent').hide();
		$('.maximunContent').hide();
		var elem = $(".cart-actions").find(".js-recalculate-button");
		elem.addClass("btn--continue-checkout js-continue-checkout-button")
		.removeClass("btn--recalculate js-recalculate-button")
		.data("checkoutUrl", $("#recalculateForm").attr("action"))
		.text($("#submitOrderText").text());
		
		if( ACC.cartitem.dealIsModified ){
			ACC.global.displaySpinner($(".commonSpinner"), true);
			elem.addClass("disabled");
		}
		
		$(".top-pricing-btn-ctnr").find(".js-recalculate-button").addClass("disabled");
		ACC.cartitem.showCommentPoEtc();
		ACC.cartitem.ajaxPaymentTerm(true);
	},
	scrollTo: function(el){
		if( !el || el.length <= 0 ){
			return false;
		}
		var top = el.offset().top - 20;
		$('body, html').animate({
			scrollTop: top
		}, 800);
	},

	allowNumberOnly: function(e){
    	
		var key = e.which || e.keyCode;
		if (ACC.cartitem.isCtrlAndEscapeKey(key, e) || ACC.cartitem.isNavigationKey(key) || ACC.cartitem.isNumericKeypad(key)) {
             // let it happen, don't do anything
             return true;
        }
        
        if( e.shiftKey === true ){
        	return false;
        }
        
        var charValue = String.fromCharCode(key)
            , valid = /^[0-9]+$/.test(charValue);

        if (!valid) {
        	return false;
        }
        return true;
	},
	
	isCtrlAndEscapeKey: function(key, e){
		// Allow: delete, backspace, tab, escape, enter, ctrl+A 
		return ($.inArray(key, [46, 8, 9, 27, 13]) !== -1 ||
        // Allow: Ctrl+A
       (key == 65 && e.ctrlKey === true));
	},
	
	isNavigationKey: function(key){
		// Allow: home, end, left, right, Up, Down
        return (key >= 35 && key <= 40);
	},
	
	isNumericKeypad: function(key){
		// Allow 0-9 from Numeric Keypad
        return (key >= 96 && key <= 105);
	},
	
	clearCartPrice : function(){
		$('.cart_page_item').text('');
		$('.cart-totals .price-sub-total').text('');
    	$('.cart-totals .price-grand-total').text('');
    	$('.cart-totals .price-tax').text('');
	},
	
	hideCommentPoEtc: function(){
		$(".js-cart-totals-display").find(".js-left-block").addClass("display-none");
		$(".js-cart-totals-display").find(".js-right-block").addClass("display-none");
		$(".js-cart-button").find(".js-faq-section").addClass("display-none");
	},
	showCommentPoEtc: function(){
		$(".js-cart-totals-display").find(".js-left-block").removeClass("display-none");
		$(".js-cart-totals-display").find(".js-right-block").removeClass("display-none").removeClass("pull-right");
		$(".js-cart-button").find(".js-faq-section").removeClass("display-none");
	},
	showTotalOnMin: function(){
		$(".js-cart-totals-display").find(".js-right-block").removeClass("display-none").addClass("pull-right");
	},
	
	showPageLoadLoader: function(){
		if( $("#cartPageLoader").length > 0 ){
			$("#cartPageLoader").addClass("show");
		}
	},
	hidePageLoadLoader : function(){
		if( $("#cartPageLoader").length > 0 ){
			$("#cartPageLoader").removeClass("show");
		}
	},
	
	getColorBoxWidth: function(el){
		var x = el.width();
		return x > ACC.cartitem.wx ? ACC.cartitem.wx : x;
	},
	getColorBoxHeight: function(el){
		var y = el.height();
		return y > ACC.cartitem.wy ? ACC.cartitem.wy : y;
	},
	showColorboxInOverlay: function(el){
		var z = el.height();
		var bch = $(".bodyContainer").height();
    	var wst = $(window).scrollTop();
    	var scrollTo;
    	if( bch > z ){
    		if( (bch - wst) >  z ){
    			// check entire popup can be displayed within overlay from current screen position
    			scrollTo = wst;
    		}else{
    			// adjust screen position so that entire popup can be displayed within overlay
    			scrollTo = wst - (wst + z - bch) - 50;
    		}
    	}else{ 
    		// increase the body height so that entire popup can be displayed within overlay
    		// and starting point of colorbox is within screen
    		$('body').css({"min-height": (z+100)});
    		scrollTo = 50;
    	}
    	
    	$('body, html').animate({
			scrollTop: scrollTo
		}, 800, function(){
			$("#colorbox").css({"top": scrollTo});
		});
	},
	
	enableAddToCart: function(el, bt){
		if( el.length ){
			var val = el.val();
			if(val > 0)
				bt.removeClass("disabled")
			else
				bt.addClass("disabled");
		}
	},
	
	validateQty: function(){
		ACC.cartitem.quantityKeyEventForIos();
        
        if( ACC.browserDetect.isAndroid() ){
        	ACC.cartitem.quantityKeyUpForAndroid();
        }else{
	        $(document).on("keyup", '.js-quantity-input', function () {
	        	ACC.productDetail.androidResetInitial($(this), "EMPTY_RETURN");
	        });
        }
	},
	
	quantityKeyEventForIos: function(){
		var keyEvent = ACC.browserDetect.isiOS() ? "keypress" : "keydown";
		var retunValue;
        $(document).on(keyEvent, '.js-quantity-input', function (e) {
        	if( ! ACC.common.allowMaxLength($(this), e) ){
        		return false;
        	}else{
        	var charCode = (e.which) ? e.which : e.keyCode;
        	if( keyEvent === "keypress" ){
	        		retunValue = ($.inArray(charCode, [48, 49, 50, 51, 52, 53, 54, 55, 56, 57]) !== -1) ? true : false;
	            }else{
	            	retunValue = ACC.cartitem.allowNumberOnly(e);
        		}
            }
        	return retunValue;
        });
	},
	
	quantityKeyUpForAndroid: function(){
		$(document).on("keyup", '.js-quantity-input', function () {
    		var el = $(this);
    		if( el.val().length > 0 ){
    			if(! /^[0-9]+$/.test(el.val()) ){
    				var qty = el.val().replace(/[^0-9]/g, "");
    				el.val( qty );
    			}else{
    				// Do nothing
    			}
    		}
        });
	},
	
	focusForZero: function($el){
		if( $el.val() === "0" ){
			$el.val("");
		}
	},
	focusOutForZero: function($el){
		if( $el.val() === "" ){
			$el.val(0);
			if( $el.closest("form").length > 0 && $el.closest("form").filter(".has-error.has-feedback").length > 0 ){
				$el.closest("form").removeClass("has-error has-feedback");
			}
		}
	},
	
	showMinMaxErrorModal: function(result){
		// Render the Base Products using the template
		$(".js-error-box").addClass("display-none");
		var baseproducts = {"baseBrandProducts" : result.b2bCustomerData.unit.baseBrandProducts};
	    $("#ajaxMinErrBaseProduct").empty();
	    if(result.b2bCustomerData.unit.baseBrandProducts.length>0){
	    	$("#minErrBaseProTemplate").tmpl(baseproducts).appendTo("#ajaxMinErrBaseProduct");
	    }else{
	    	$("#ajaxMinErrBaseProduct").closest(".baseProduct").addClass("hide");
	    }
		

		var topBrands = {"baseBrandProducts" : result.b2bCustomerData.unit.top3BrandProduct};
		$("#ajaxMinErrTopBrandProduct").empty();
		if(result.b2bCustomerData.unit.top3BrandProduct.length>0){
			$("#minErrBaseProTemplate").tmpl(topBrands).appendTo("#ajaxMinErrTopBrandProduct");
		}else{
			$("#ajaxMinErrTopBrandProduct").closest(".baseProduct").addClass("hide");
		}
		
		
		$('#minmErrorModal').modal({
			  keyboard: false,
			  backdrop: "static",
			  show:true
		});
		$('#minmErrorModal').on('shown.bs.modal', function () {
			  // do something...
			var config = ACC.carousel.carouselConfig.default;
			config.itemsCustom = [[0, 1.5], [740, 3]],
			$(".js-owl-base-product").owlCarousel(config);
			
			$('#minmErrorModal').find(".js-first-focus").focus();
		    ACC.global.modalAccessibility( $('#minmErrorModal'), $('#minmErrorModal').find(".close"),  $('#minmErrorModal').find(".js-minimum-error-modal-continue"));
		    ACC.global.closeModal($('#minmErrorModal').find(".close"), $(".js-recalculate-button"));
		});
		
	},
	
	baseProductsAddToCart: function(){
		$("#ajaxMinErrBaseProduct, #ajaxMinErrTopBrandProduct").on("click", ".js-addToCartButton", function(){
			var productList ={items:[]};
			$(this).closest(".baseProduct").find(".owl-item").each(function(){
				var input = $(this).find(".js-qty-selector-input").val();
				var code = $(this).find(".productCode").val();
				
				var cart = {qty:input, productCode:code};
				
				if(input>0){
					productList.items.push(cart);	
				}
			})
			ACC.cartitem.ajaxBaseProductsAddToCart(productList, $(this));
		});
		$("#minmErrorModal").on("click",".js-minimum-error-modal-continue, .close", function(){
			if( $(".js-acitivityFlag").val() === "updated" ){
				window.location = window.location.href;
			}else{
				$("#minmErrorModal").modal("hide");
			}
		});
	},
	
	ajaxBaseProductsAddToCart: function (items, $el){
		//ajax call
		$.ajax({
			url: ACC.config.encodedContextPath + "/cart/add/multiple", 
			data: {itemList:JSON.stringify(items)},
			method: "POST",
			dataType:"json",
			success: function(data){
				
           	 $.each(JSON.parse(data.response), function (key, value) {
           	        if(value.status==="success"){
           	        	$el.closest(".js-cart-button").siblings(".js-success-box").removeClass("display-none");
           	        	$(".js-acitivityFlag").val("updated");
           	        }else{
           	        	$el.closest(".js-cart-button").siblings(".js-error-box").removeClass("display-none");
           	        }
           	    });
			},
			error: function(){
				$el.closest(".js-cart-button").siblings(".js-error-box").removeClass("display-none");
			},
			complete: function(){
				// Do Code
			}
		})
	},
	
	minErrEnableAddToCart: function(){
		$("#ajaxMinErrBaseProduct, #ajaxMinErrTopBrandProduct").on("keyup", ".js-qty-selector-input", function(){
			var count = 0;
			$(this).closest(".baseProduct").find(".owl-item").each(function(){
				var input = $(this).find(".js-qty-selector-input").val();
				count += parseInt(input);
			})
			if( count > 0 ){
				$(this).closest(".baseProduct").find(".js-addToCartButton").removeAttr("disabled");
			}else{
				$(this).closest(".baseProduct").find(".js-addToCartButton").attr("disabled", "disabled");
			}
		})
	},
	
	toggleMinErrProducts: function(){
		$(".list-header").on("click", ".arrow", function(){
			if( $(this).hasClass("up") ){
				$(this).removeClass("up").addClass("down");
				$(this).closest(".list-header").siblings(".product-container").slideUp();
			}else { // Has Plus
				$(this).addClass("up").removeClass("down");
				$(this).closest(".list-header").siblings(".product-container").slideDown();
			}
		})
		ACC.global.bindCLickOnEnter(".list-header", ".arrow");
	},
	
	doNotCall: function(){
		ACC.cartitem.showEmptyReturnModal();
	},
	
	showSafetyModal: function(totalOrderObj, itemQty, is_empty){
		var showModal = false;
		var thresholdPercent = +$(".js-threshold-percentage").val();
		var thresholdQuantity = +$(".js-threshold-quantity").val();
		var avg, orderQty;
		
		if( totalOrderObj.item > 0 && !is_empty){
			avg = totalOrderObj.total / totalOrderObj.item;
			orderQty = (avg * thresholdPercent) / 100;
			// for empty tank check only itemQty > thresholdQuantity
			
			if( itemQty > orderQty && itemQty > thresholdQuantity ){
				//show modal
				showModal = true;
			}
		}else if(itemQty > thresholdQuantity){
			showModal = true;
		}
		return showModal;
	},
	updateCartForDeal: function(){
		ACC.cartitem.dealItemsJSON={items:[]};
		$(".js-deal-quantity").each(function(){
			var quantity = $(this).val();
			if( parseInt(quantity) > 0 ){
				var productCode = $(this).closest("form").find(".js-product-code").val();
				var cart = {"productCode":productCode,"quantity":quantity};
				ACC.cartitem.dealItemsJSON.items.push(cart);
			}
		});
		$(".js-cart-applicable-product, .js-cart-campaign-free-gift").each(function(){
			var quantity = $(this).val();
			if( parseInt(quantity) > 0 ){
				var productCode = $(this).closest("form").find(".productCode").val();
				var cart = {"productCode":productCode,"quantity":quantity};
				ACC.cartitem.dealItemsJSON.items.push(cart);
			}
		});
		if( ACC.cartitem.dealItemsJSON.items.length > 0 ){
			ACC.cartitem.updateCartForDealAjax(JSON.stringify(ACC.cartitem.dealItemsJSON));
		}else{
			ACC.cartitem.pageLoadFlag = false;
			ACC.cartitem.recalculatePrice();
		}
	},
	
	updateCartForDealAjax: function(items){
		var dealEnabled = $(".js-deal-section").find(".js-getDeal").hasClass("disabled") ? "false" : "true";
		$.ajax({
			url: ACC.config.encodedContextPath + "/cart/updateQtyDeals", 
			data: {itemList:items, dealEnabled:dealEnabled},
			method: "POST",
			success: function(){
				ACC.cartitem.dealIsModified = true;
				window.location = window.location.href;
			}
		})
	}
};


$(document).ready(function(){
	setTimeout(function(){
		ACC.cartitem.hidePageLoadLoader();
	}, 1000);
});
$(window).on("load", function(){		
	ACC.cartitem.hidePageLoadLoader();		
	if( $(".js-recalculate-button").length > 0 ){
		$(".js-recalculate-button").removeClass("disabled");
		ACC.cartitem.recalculatePrice();
	}
});

ACC.checkout = {

	_autoload: [
		"bindCheckO",
		"bindForms",
		"bindSavedPayments",
		"bindMiniCart",
		["modifyOrder", $(".js-modify-order-button").length > 0],
		["discardModifyOrder", $("#discard-cart-modify-order").length > 0],
		["mergeModifyOrder", $("#merge-cart-modify-order").length > 0],
		["cancelConfirmOrder", $("#cancel-order-confirm").length > 0],
		"continueCheckout",
		["newOrderBtns", $(".js-newOrderDiscardBtn, .js-newOrderContBtn").length > 0],
		["refreshOrderAndCampaigns", ACC.pageName === 'cancelOrderConfirmationPage'],
		["cartPageScrollTop", $(".page-cartPage.pageLabel-cart").length > 0]
	],

	lastScrollTop:0,
	direction:"down",
	
	bindForms:function(){

		$(document).on("click","#addressSubmit",function(e){
			e.preventDefault();
			$('#addressForm').submit();	
		})
		
		$(document).on("click","#deliveryMethodSubmit",function(e){
			e.preventDefault();
			$('#selectDeliveryMethodForm').submit();	
		})

	},

	bindSavedPayments:function(){
		$(document).on("click",".js-saved-payments",function(e){
			e.preventDefault();

			var title = $("#savedpaymentstitle").html();

			$.colorbox({
				href: "#savedpaymentsbody",
				inline:true,
				maxWidth:"100%",
				opacity:0.7,
				//width:"320px",
				title: title,
				close:'<span class="glyphicon glyphicon-remove"></span>',
				onComplete: function(){
					//complete function 
				}
			});
		});
	},
	
	bindMiniCart: function(){ 
        $(document).on("click",".js-mini-cart-close-button", function(e){
            e.preventDefault();
            ACC.colorbox.close();
        });
	},
	
	modifyOrder: function(){
		$('.js-modify-order-button').click(function (e){
			e.preventDefault();
			var code = $(this).data("code");
			var siebelId = $(this).data("siebelid");
			$("#cancelOrderSpinner").removeClass("display-none");
			$.ajax({
        		url: ACC.config.encodedContextPath + "/modify-order",
        		data: {"code":code,"siebelId":siebelId},
        		method: "GET",
        		success: function(rsp){
        			if (rsp ==='ShowPrompt'){
            			$("#cancelOrderSpinner").addClass("display-none");
        				$('#modifyOrderModal').modal();
        				$('#modify-order-code').val(code);
        				$('#modify-order-siebelId').val(siebelId);
        			} else if (rsp ==='CutoffDateError'){
            			$("#cancelOrderSpinner").addClass("display-none");
        				$('#modifyOrderErrorModal').modal();
        				$('#modifyorderException').hide();
        				$('#modifyorderCutoffErr').show();
        			} else if (rsp ==='ModifyError'){
            			$("#cancelOrderSpinner").addClass("display-none");
        				$('#modifyOrderErrorModal').modal();
        				$('#modifyorderCutoffErr').hide();
        				$('#modifyorderException').show();
        			} else if (rsp ==='Success'){
        				window.location = ACC.config.encodedContextPath + '/cart';
        			}
        		}        				
            });
		});
	},
	
	discardModifyOrder: function(){
		$('#discard-cart-modify-order').click(function (e){
			e.preventDefault();
			var code = $('#modify-order-code').val();
			var siebelId = $('#modify-order-siebelId').val();
			$.ajax({
        		url: ACC.config.encodedContextPath + "/modify-order/discard-cart",
        		data: {"code":code,"siebelId":siebelId},
        		method: "GET",
        		success: function(rsp){
        			if (rsp ==='Success'){
        				window.location = ACC.config.encodedContextPath + '/cart';
        			} else if (rsp ==='ModifyError'){
        				$('#modifyOrderErrorModal').modal();
        				$('#modifyorderCutoffErr').hide();
        				$('#modifyorderException').show();
        			}
        		}   				
            });
		});
	},
	
	mergeModifyOrder: function(){
		$('#merge-cart-modify-order').click(function (e){
			e.preventDefault();
			var code = $('#modify-order-code').val();
			var siebelId = $('#modify-order-siebelId').val();
			$.ajax({
        		url: ACC.config.encodedContextPath + "/modify-order/merge-cart",
        		data: {"code":code,"siebelId":siebelId},
        		method: "GET",
        		success: function(rsp){
        			if (rsp ==='Success'){
        				window.location = ACC.config.encodedContextPath + '/cart';
        			} else if (rsp ==='ModifyError'){
        				$('#modifyOrderErrorModal').modal();
        				$('#modifyorderCutoffErr').hide();
        				$('#modifyorderException').show();
        			}
        		}   				
            });
		});
	},
	
	cancelConfirmOrder: function(){
		$(document).on("click", "#cancel-order-confirm", function (e){
			e.preventDefault();
			var siebelId = $('#cancel-order-siebelId').val();
			$("#cancelOrderSpinner").removeClass("display-none");
			$.ajax({
        		url: ACC.config.encodedContextPath + "/cancel-order",
        		data: {"siebelId":siebelId},
        		method: "GET",
        		success: function(result){
        			if (result==='CutoffDateError') {
            			$("#cancelOrderSpinner").addClass("display-none");
						$('#cancelOrderErrorModal').modal();
        				$('#cancelorderException').hide();
        				$('#cancelorderCutoffErr').show();
					} else if(result==='CancelError'){
	        			$("#cancelOrderSpinner").addClass("display-none");
						$('#cancelOrderErrorModal').modal();
        				$('#cancelorderCutoffErr').hide();
        				$('#cancelorderException').show();
					} else if (result ==='CancelSuccess'){
        				window.location='/checkout/cancelOrderConfirmation/'+siebelId;
        			}
        		}
            });
		});
	},
	
	validateCartDateAndQuantity: function(){
		if($('#deliveryDate').length>0){
			$( "#deliveryChk" ).validate();
			$( "#deliveryChk" ).validate().element("#deliveryDate" );
			if($( "#deliveryDate" ).valid() === false){
				$(window).scrollTop($('#deliveryDate').offset().top-40);
				ACC.checkout.cartSpinnerDisplay(false);
				return false;
			}	
			 
		}
		
		$('.js-update-entry-quantity-input').each(function(){
		var form = $(this).closest('form')
			var initialQuantity = form.find('input[name=initialQuantity]').val();
			if( initialQuantity.length == 0  ){
				ACC.cartitem.scrollTo($('.cartPageQuantityPopover').parent());
				return false;
			}
		});
		return true;
	},
	
	checkCartMinimum: function( $this ){
		ACC.checkout.cartSpinnerDisplay(true);
		var total = +$(".js-totalprice").val();
		var checkNeeded = total > 0 ? "true" : "false";
		if( total > 0 ){
			$.ajax({
				url: ACC.config.encodedContextPath + "/cart/checkMinimums",
				method: "GET",
				data: {isMinimumCheckNeeded:checkNeeded},
				success: function(result){
					ACC.checkout.cartSpinnerDisplay(false);
					if(result.b2bCustomerData.unit.isMinimumsValid === false){
			        	ACC.cartitem.showMinMaxErrorModal(result);
			        	$('#minimum_modal_totalprice').text(result.b2bCustomerData.unit.orderValueMinimum.formattedValue);
			        	$('#minimum_modal_combo').text(result.b2bCustomerData.unit.comboMinimum);
			    	}else{
			    		ACC.checkout.continueSubmitOrder( $this );
			    	}
				}
			})
		}else{
			ACC.checkout.continueSubmitOrder( $this );
		}
		
	},
	
	continueSubmitOrder: function($this){
		ACC.checkout.cartSpinnerDisplay(true);
		
		$.ajax({
    		url: ACC.config.encodedContextPath + "/modify-order/validate-submit",
    		method: "GET",
    		success: function(rsp){
    			if (rsp ==='ShowPrompt'){
    				ACC.checkout.cartSpinnerDisplay(false);
    				$("#newOrder").modal({backdrop: "static"});
    			} else if (rsp ==='Success'){
    				ACC.checkout.validateCheckout( $this );
    			} 
    		}        				
        });
	},
	
	continueCheckout: function(){
		$(document).on("click", ".js-continue-checkout-button:not(.js-disable-submit-order)", function (){
			var $this = this;
			ACC.checkout.checkCartMinimum( $this );
		});
	},
	
	newOrderBtns:function(){
		$(document).on('click', '.js-newOrderDiscardBtn', function(){
			$.ajax({
				url: ACC.config.encodedContextPath + "/modify-order/discard-currentcart",
	    		method: "GET",
	    		success: function(){
	    			$("#newOrder").modal("hide");
	    			window.location = window.location.href;
	        	}
			});
		});
		$(document).on('click', '.js-newOrderContBtn', function(){
			$.ajax({
				url: ACC.config.encodedContextPath + "/modify-order/confirm-neworder",
	    		method: "GET",
	    		success: function(){
	    			$("#newOrder").modal("hide");
	    			window.location = window.location.href;
	        	}
			});
		});
	},
	
	submitCalculateForm: function($this, checkoutUrl){
		var flow = $('#selectAltCheckoutFlow').attr('value');
		if ( flow === undefined || flow === ''){
			if( $("#recalculateForm") && $("#recalculateForm").length > 0 ){
				
				//one-click submit -- disallow multiple clicks
				if ($this.getAttribute('clicked') == '1') {
				    return false; 
				} else { 
					$this.setAttribute('clicked', '1'); 
				    $("#recalculateForm").submit();
				}
				
			}else{
				window.location = checkoutUrl;
			}
		}
		else{
			// Fix multistep-pci flow
			if ('multistep-pci' === flow){
				flow = 'multistep';
			}
			var pci = $('#selectPciOption').attr('value');

			// Build up the redirect URL
			var redirectUrl = checkoutUrl + '/select-flow?flow=' + flow + '&pci=' + pci;
			window.location = redirectUrl;
		}
	},
	
	bindCheckO: function ()	{
		// Alternative checkout flows options
		$('.doFlowSelectedChange').change(function (){
			if ('multistep-pci' === $('#selectAltCheckoutFlow').attr('value')){
				$('#selectPciOption').css('display', '');
			}
			else{
				$('#selectPciOption').css('display', 'none');

			}
		});

		$('.js-continue-shopping-button').click(function (){
			var checkoutUrl = $(this).data("continueShoppingUrl");
			window.location = checkoutUrl;
		});

		
		$('.expressCheckoutButton').click(function(){
			document.getElementById("expressCheckoutCheckbox").checked = true;
		});
		
		$('.js-order-detail-button').click(function (){
			var orderdetailUrl = $(this).data("back-to-orderdetail");
			window.location = orderdetailUrl;
		});
		
		$(document).on("click", ".js-cancelOrder-button:not(.js-disable-cancel-order)", function (e){
			e.preventDefault();
			var siebelId = $(".js-cancelOrder-button").data("siebelid");
			$('#cancelOrderModal').modal();
			$('#cancel-order-siebelId').val(siebelId);
		});	

		$(document).on("input",".confirmGuestEmail,.guestEmail",function(){
			  
			  var orginalEmail = $(".guestEmail").val();
			  var confirmationEmail = $(".confirmGuestEmail").val();
			  
			  if(orginalEmail === confirmationEmail){
			    $(".guestCheckoutBtn").removeAttr("disabled");
			  }else{
			     $(".guestCheckoutBtn").attr("disabled","disabled");
			  }
		});
		
		

	},
	cartSpinnerDisplay: function(display){
		if( $("#priceOrderSpinner").length > 0 ){
			if( display ){
				$("#priceOrderSpinner").removeClass("display-none");
			}else{
				$("#priceOrderSpinner").addClass("display-none");
			}
		}
	},
	
	validateCheckout:function( elem ){
		ACC.cart.ajaxCommentUpdate($("#commentTitle").val(), $("#orderCommentTextId").val());
		
		var checkoutUrl = $(elem).data("checkoutUrl");
		//date validation
		if( ! ACC.checkout.validateCartDateAndQuantity() ){
			return false;
		}
		
		if (typeof ACC.cartitem.validatePoNumber === 'function' && ! ACC.cartitem.validatePoNumber("check")){
			ACC.checkout.cartSpinnerDisplay(false);
			ACC.cartitem.scrollTo($('#po').parent());
			return false;
		}
		
		var cartEntriesError = ACC.pickupinstore.validatePickupinStoreCartEntires();
		if (!cartEntriesError){
			var expressCheckoutObject = $('.express-checkout-checkbox');
			if(expressCheckoutObject.is(":checked")){
				window.location = expressCheckoutObject.data("expressCheckoutUrl");
			}
			else{
				return ACC.checkout.submitCalculateForm(elem, checkoutUrl);
			}
		}
		ACC.checkout.cartSpinnerDisplay(false);
		return false;
	},
	
	refreshOrderAndCampaigns: function(){
		var timeout = +$('.js-campaign-order-refresh-timeout').val();
		if(!timeout) {
			timeout = 2000;
		}
		setTimeout( function() {
			$.ajax({
				url: ACC.config.encodedContextPath + "/cof/refreshOpenOrder",
	    		method: "GET",
	    		success: function(rsp){
	    			if (rsp ==='Success'){
	    				$('.js-review-modify-link').removeClass("hide");
	    			}
	        	}
			});
			
			$.ajax({
				url: ACC.config.encodedContextPath + "/cof/refreshCampaigns",
	    		method: "GET"
			})
		}, timeout);
	},
	
	backToTopForDesktop: function($el){
		var st = $el.scrollTop();
    	
    	var browser = ACC.browserDetect.returnIE(ACC.browserDetect.ua);
		if( browser ){
			if ($el.scrollTop() >= 25 && (st < ACC.checkout.lastScrollTop || (st === ACC.checkout.lastScrollTop && ACC.checkout.direction === "up") )) {        // If page is scrolled more than 50px
	    		ACC.checkout.direction = "up";
	    		$('#return-to-top').show();    // Fade in the arrow
		    } else {
		    	ACC.checkout.direction = "down";
		    	$('#return-to-top').hide();   // Else fade out the arrow
		    }
		}else{
			if ($el.scrollTop() >= 25 && st < ACC.checkout.lastScrollTop) {        // If page is scrolled more than 50px
		    	$('#return-to-top').show();    // Fade in the arrow
		    } else {
		        $('#return-to-top').hide();   // Else fade out the arrow
		    }
		}
    	
	    ACC.checkout.lastScrollTop = st;
	},
	
	displayBackToTop: function(){
		var st;
		if( ACC.browserDetect.isAndroid() ){
	    	st = window.scrollY;
	    	if (window.scrollY >= 25 && (st < ACC.checkout.lastScrollTop || (st === ACC.checkout.lastScrollTop && ACC.checkout.direction === "up") )) {        // If page is scrolled more than 50px
	    		ACC.checkout.direction = "up";
	    		$('#return-to-top').show();    // Fade in the arrow
		    } else {
		    	ACC.checkout.direction = "down";
		    	$('#return-to-top').hide();   // Else fade out the arrow
		    }
		    ACC.checkout.lastScrollTop = window.scrollY;
	    }else{
	    	ACC.checkout.backToTopForDesktop($(this));
	    }
	},
	
	showBackToTop: function(){
		var st = $(window).scrollTop();
		
		if (st >= 100 && st < ACC.checkout.lastScrollTop) {
			$('#return-to-top').show();
	    }else{
	    	$('#return-to-top').hide();
	    }
		ACC.checkout.lastScrollTop = st;
	},
	
	cartPageScrollTop: function() {
		$('#return-to-top').click(function() {      // When arrow is clicked
		    $('body,html').animate({
		        scrollTop : 0                       // Scroll to top of body
		    }, 500);
		});
	}
};


ACC.checkoutaddress = {

	spinner: $("<img src='" + ACC.config.commonResourcePath + "/images/spinner.gif' />"),
	addressID: '',

	showAddressBook: function ()
	{
		$(document).on("click", "#viewAddressBook", function ()
		{
			var data = $("#savedAddressListHolder").html();
			$.colorbox({

				height: false,
				html: data,
				onComplete: function ()
				{

					$(this).colorbox.resize();
				}
			});

		})
	},

	showRemoveAddressConfirmation: function ()
	{
		$(document).on("click", ".removeAddressButton", function ()
		{
			var addressId = $(this).data("addressId");
			$.colorbox({
				inline: true,
				height: false,
				href: "#popup_confirm_address_removal_" + addressId,
				onComplete: function ()
				{

					$(this).colorbox.resize();
				}
			});

		})
	}
}

// Address Verification
$(document).ready(function ()
{
	with (ACC.checkoutaddress)
	{

		showAddressBook();
		showRemoveAddressConfirmation();
	}
});



ACC.checkoutsteps = {

	_autoload: [
		"permeateLinks"
	],
			
	permeateLinks: function() {
	
		$(document).on("click",".js-checkout-step",function(e){
			e.preventDefault();
			window.location=$(this).closest("a").attr("href")
		})		
	}


};
ACC.cms = {
	loadComponent: function(id, type, target, onSuccess, onError) {
		var self = this;
		if(id) {
			$.ajax({
				url: ACC.config.contextPath +  '/cms/component?componentUid=' + id,
				cache: false,
				type: 'GET',
				success: function (result) {
					var reprocess = result.indexOf('js-responsive-image') > -1;
					self.insertHtml(result, target, reprocess);
					if(onSuccess) {
						onSuccess(result, id, type, target);
					}
				},
				error: function (result) {
					if(onError) {
						onError(result, id, type, target);
					}
				}
			});
		}
	},
	
	insertHtml: function(html, target, reprocess) {
		if(target) {
			$(target).html(html);
			if(reprocess) {
				ACC.global.reprocessImages();
			}
		}
	}
}
//Makes Color Box Responsive
var cboxOptions = {
	width: '95%',
	height: '95%',
	maxWidth: '960px',
	maxHeight: '960px',
}

$('.cbox-link').colorbox(cboxOptions);

$(window).resize(function(){

    if(!$('#colorbox').hasClass('variantSelectMobile')){
        $.colorbox.resize({
            width: window.innerWidth > parseInt(cboxOptions.maxWidth) ? cboxOptions.maxWidth : cboxOptions.width,
        });
    }
});


ACC.colorbox = {
	config: {
		maxWidth:"100%",
		opacity:0.7,
		width:"auto",
		transition:"none",
		close:'<span class="glyphicon glyphicon-remove"></span>',
		title:'<div class="headline"><span class="headline-text">{title}</span></div>',
		onComplete: function() {
			$.colorbox.resize();
			ACC.common.refreshScreenReaderBuffer();
		},
		onClosed: function() {
			ACC.common.refreshScreenReaderBuffer();
		}
	},

	open: function(title,conf){
		var config = $.extend({},ACC.colorbox.config,conf);
		config.title = config.title.replace(/{title}/g,title);
		return $.colorbox(config);
	},

	resize: function(){
		$.colorbox.resize();
	},

	close: function(){
		$.colorbox.close();
	}
};

/* Added for Accessibility */
$(document).bind('cbox_complete', function(){
	$('#cboxClose').attr("aria-label", "Close");
});

ACC.common = {
	_autoload: [
    	"initPageEvents",
    	["initNotification", $(".js-notification-icon").length > 0],
    	"callOnLoad"
     ],
	currentCurrency: "USD",
	processingMessage: $("<img src='" + ACC.config.commonResourcePath + "/images/spinner.gif'/>"),

	days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],

	blockFormAndShowProcessingMessage: function (submitButton){
		var form = submitButton.parents('form:first');
		form.block({ message: ACC.common.processingMessage });
	},

	refreshScreenReaderBuffer: function (){
		// changes a value in a hidden form field in order
		// to trigger a buffer update in a screen reader
		$('#accesibility_refreshScreenReaderBufferField').attr('value', new Date().getTime());
	},

	checkAuthenticationStatusBeforeAction: function (actionCallback){
		$.ajax({
			url: ACC.config.authenticationStatusUrl,
			statusCode: {
				401: function () {
					location.href = ACC.config.loginUrl;
				}
			},
			success: function (data) {
				if (data == "authenticated") {
					actionCallback();
				}
			}
		});
	},
	
	logEvent: function(str){
		if( $(".debug").length ){
    		$(".debug").append($("<span></span>").addClass("event hide").text(str));
    	}
	},
	logConsole: function(str){
		if( $(".debug").length ){
    		$(".debug").append($("<span></span>").addClass("hide").text(str));
    	}
	},
	logAjaxCompleteConsole: function(str){
		if( $(".debug").length ){
			$(".debug").append( $(".debug").children().clone().text(str));
    	}
	},
	formatedProductName: function(str){
		var trimmedName = $.trim(str).toLowerCase();
		var FORMATED_NAME_TEXT = "...";
		if( trimmedName.length > 32 ){
			return trimmedName.substr(0, 29) + FORMATED_NAME_TEXT;
		}
		return trimmedName;
	},
	initPageEvents: function(){
		$(document).on("click", '.js-qty-selector .js-qty-selector-minus', function () {
	        ACC.productDetail.checkQtySelector(this, "minus");
	        $(this).closest(".js-qty-selector").find(".js-qty-selector-input").keyup();
	    })
	
	    $(document).on("click", '.js-qty-selector .js-qty-selector-plus', function () {
	        ACC.productDetail.checkQtySelector(this, "plus");
	        $(this).closest(".js-qty-selector").find(".js-qty-selector-input").keyup();
	    })
	
	    var keyEvent = ACC.browserDetect.isiOS() ? "keypress" : "keydown";
	    var allow = true;
	    $(document).on(keyEvent, '.js-qty-selector .js-qty-selector-input', function (e) {
	    	if( $(this).hasClass("js-update-entry-quantity-input") ){
	    		ACC.cartitem.quantityKeyDownEvent(this, e);
	    	}
	    	if( ! ACC.common.allowMaxLength($(this), e) ){
        		return false;
        	}
	    	var charCode = (e.which) ? e.which : e.keyCode;
	    	
	    	if( keyEvent === "keypress" ){
	    		if($.inArray(charCode, [48, 49, 50, 51, 52, 53, 54, 55, 56, 57]) !== -1){
	    			return true;
	    		}
	    		allow = false;
	    		return false;
	        }else{
	        	return allow = ACC.cartitem.allowNumberOnly(e);
	        }
	    })
	
	    $(document).on("keyup", '.js-qty-selector .js-qty-selector-input', function (e) {
	    	ACC.common.callKeyUpMethod(this, e);
	    	
	    	ACC.common.resetToInitialValue($(this));
			ACC.common.showGetPrice();
	    	if(allow){
	            ACC.productDetail.checkQtySelector(this, "input");
	            ACC.productDetail.updateQtyValue(this, $(this).val());
	    	}
	    	
	    })
	    
	    $(document).on("focusout", '.js-qty-selector .js-qty-selector-input', function () {
	        ACC.productDetail.checkQtySelector(this, "focusout");
	        ACC.productDetail.updateQtyValue(this, $(this).val());
	        
	        ACC.cartitem.focusOutForZero( $(this) );
	    })
	    
	    $(document).on("focus", '.js-qty-selector-input', function (){
			ACC.cartitem.focusForZero($(this));
		});
	    ACC.common.displayHomepageErrorModal();
	    ACC.common.updateGaGoal("gaGoal");
	    ACC.common.updateGaGoal("gaProductGoal");
	},
	
	displayHomepageErrorModal: function(){
		if( $("#homepageErrorModal").length > 0 ){
			$("#homepageErrorModal").modal("show");
			setTimeout(function(){
				$("#homepageErrorModal").modal("hide");
			}, parseInt(ACC.homePageErrorModalTimer));
		}
	},
	
	callKeyUpMethod: function( elem, e ){
		if( $(elem).hasClass("js-minerror-input") ){
    		$(elem).closest(".product-container").find(".message-box").addClass("display-none");
    	}else if( $(elem).hasClass("js-cart-campaign-offer") ){
    		ACC.campaign.checkMinimum($(elem));
    	}else if( $(elem).hasClass("js-cart-campaign-free-gift") ){
    		ACC.campaign.checkFreeGift($(elem));
    	}else if( $(elem).hasClass("js-update-entry-quantity-input") ){
    		ACC.cartitem.handleUpdateQuantity(elem, e);
    	}else if( $(elem).hasClass("js-autoship-modal") ){
    		ACC.campaignExtend.checkAutoShipModal($(elem));
    	}else if( $(elem).hasClass("js-donotforget-input") ){		
    		ACC.cartitem.enableAddToCart($(elem), $(elem).closest(".item").find(".js-add-to-cart"));		
    	}else if( $(elem).hasClass("js-compliance-list-product") ){
    		ACC.campaign.enableComplianceAddToCart($(elem));
    	}else if( $(elem).hasClass("js-campaign-detail") ){
    		ACC.campaignExtend.checkCampaignDetail($(elem));
    	}else if( $(elem).hasClass("js-deal-quantity") ){
    		ACC.campaignExtend.checkCampaignDeal( $(elem) );
    	}else if( $(elem).hasClass("js-cart-campaign-discount") ){
    		ACC.campaignExtend.checkDiscountCampaign( $(elem) );
    	}
	},
	
	resetToInitialValue: function($this){
		var page = (ACC.pageName === "cartPage") ? "CART" : "PDP";
		ACC.productDetail.androidResetInitial($this, page);
	},
	
	allowMaxLength: function($el, e){
		var key = e.which || e.keyCode;
		if( typeof($el.attr("maxlength")) === "undefined" ){
			$el.attr("maxlength", parseInt(ACC.quantityMaxLength));
		}
		if( $el.val().length > parseInt(ACC.quantityMaxLength) ){
			return ACC.cartitem.isCtrlAndEscapeKey(key) || ACC.cartitem.isNavigationKey(key) ? true : false;
		}
		return true;
	},
	
	showGetPrice: function(){
		if( ACC.pageName === "productDetails" ){
			var prevVal = +$("#addToCartForm").find(".js-qty-selector-input").val();
			var curVal = +$("#pdpQtyForm").find(".js-qty-selector-input").val();
			ACC.productDetail.hideGetPriceButton();
			if( curVal >= 0 && prevVal != curVal ){
        		ACC.productDetail.showGetPriceButton();
        	}
		}
	},
	initNotification: function(){
		$(".js-notification-icon").find("a").attr("aria-label", "Click Alert Icon to display Alert and Notification List.");
	},
	
	validateCdaOnLoad: function(firstElem){
		if( firstElem.length > 0 ){
			ACC.campaign.enableComplianceAddToCart( firstElem );
			//If everything satisfy "Add to cart" will be enabled on page load 
			var minGroupRequired = +$(".js-compliance-list").find(".js-min-group").val();
			var groupCompliant = $(".js-compliance-list").find(".js-subgroup[data-compliant = true]").length;
			//If parent group is not compliant check for other group
			if( groupCompliant < minGroupRequired ){
				ACC.campaign.checkAllComplianceGroup();
				
				groupCompliant = $(".js-compliance-list").find(".js-subgroup[data-compliant = true]").length;
				if( groupCompliant >= minGroupRequired ){
	    			$(".js-compliance-list").find(".js-addtocart").removeClass("disabled").attr("aria-disabled", false);
		    	}else{
		    		var visibleGroup = $(".js-compliance-list").find(".js-subgroup:visible").length;
		    		$(".js-compliance-list").find(".js-error-msg").removeClass("display-none").append("<div>"+ACC.ComplianceMinGrError+"</div>").find(".minGroupRequired").text(visibleGroup);
		    	}
			}
		}
	},
    
    addHeightInLoginPage: function(){
    	if( ACC.pageName==="SecureCustomerPortalSecuredLoginPage" && $(window).height() > $("body").height() ){
    		$("body").css({"height":$(window).height()});
    	}
	},
	
	createMessage: function(type, message, boxclass, alertclass, msgAttr, hasArrow){
		var icon ;
		switch (type) {
		case "info":
			icon = 'fa fa-info-circle';
			break;
		case "warning":
			icon = 'fa fa-exclamation-triangle';
			break;
		case "success":
			icon = 'fa fa-check-circle';
			break;
		default:
			icon = 'fa fa-exclamation-circle';
			break;
		}/*danger*/
		var ariaHidden =  (boxclass.indexOf("hide") >= 0 || boxclass.indexOf("display-none") >= 0) ? "true" : "false";
		
		var html = '<div class="message-box '+boxclass+'" aria-hidden="'+ariaHidden+'">'+
			( hasArrow ? '<div class="arrow"></div>' : "" )+
			'<div class="'+alertclass+' alert alert-'+type+'">'+
				'<span class="'+icon+'" aria-hidden="true"></span>'+
				'<span class="js-message" '+msgAttr+'>'+message+'</span>'+
			'</div>'+
		'</div>';
		return html;
	},
	
	//* query = location.search; Returns Object*/
    splitParamsFromUrl: function(query){
        var tokens = [];
        query = query.slice(1);//* remove the first character, which will be the '?' */
        query = query.split('&');
        query.forEach(function (value) {
            var token = value.split('=');   
            var key = decodeURIComponent(token[0]);     
            var data = token[1];
            tokens[key] = data;
        });
        return tokens;
    },
    
    isRemoveKey: function(key){
		// Allow: delete, backspace
        return (key === 8 || key === 46);
	},
	
	//get storage Variable
	getStorageVariable: function(name){
		return (typeof(Storage) !== "undefined") ? localStorage.getItem(name) : false;
	},
	
	//Remove storage
	removeStorageVariable: function(name){
		if( ACC.common.getStorageVariable(name) ){
			localStorage.removeItem(name);
		}
	},
	
	//get session storage Variable
	getSessionStorageVariable: function(name){
		return (typeof(Storage) !== "undefined") ? sessionStorage.getItem(name) : false;
	},
	
	//Remove session storage
	removeSessionStorageVariable: function(name){
		if( ACC.common.getSessionStorageVariable(name) ){
			sessionStorage.removeItem(name);
		}
	},
	
    //create gaGoal local storage
    createGaGoal: function(name){
    	ACC.common.removeStorageVariable(name);
    	if (typeof(Storage) !== "undefined") {
    		localStorage.setItem(name, ACC.pageName);
    	}
    },
    
    updateGaGoal: function(name){
    	var gaGoal = ACC.common.getStorageVariable(name);
    	if( gaGoal ){
			var gaGoalList = gaGoal.split(" - ");
			if( gaGoalList[gaGoalList.length - 1] !== ACC.pageName ){
				localStorage.setItem(name, gaGoal+" - "+ACC.pageName);
			}
		}
    },
    
    callOnLoad: function(){
    	if( ACC.AnonymousCustomer === "true" ){
    		ACC.common.removeStorageVariable("gaGoal");
    		ACC.common.removeStorageVariable("gaProductGoal");
    		
    		ACC.common.removeStorageVariable("DataTables_js-cartDataTable");
    	}
    }
};





/* Extend jquery with a postJSON method */
jQuery.extend({
	postJSON: function (url, data, callback){
		return jQuery.post(url, data, callback, "json");
	}
});

// add a CSRF request token to POST ajax request if its not available
$.ajaxPrefilter(function (options, originalOptions, jqXHR){
	// Modify options, control originalOptions, store jqXHR, etc
	if (options.type === "post" || options.type === "POST")	{
		var noData = (typeof options.data === "undefined");
		if (noData)		{
			options.data = "CSRFToken=" + ACC.config.CSRFToken;
		}
		else		{
			var patt1 = /application\/json/i;
			if (options.data instanceof window.FormData){
				options.data.append("CSRFToken", ACC.config.CSRFToken);
			}
			// if its a json post, then append CSRF to the header. 
			else if (patt1.test(options.contentType)){
				jqXHR.setRequestHeader('CSRFToken', ACC.config.CSRFToken);
			}
			else if (options.data.indexOf("CSRFToken") === -1){
				options.data = options.data + "&" + "CSRFToken=" + ACC.config.CSRFToken;
			}
		}
		
	}
});

$(document).ready(function(){
	if( ACC.debug ){
		$("body").prepend($("<div></div>").addClass("debug hide"));
	}
});

$(window).load(function(){
	ACC.common.addHeightInLoginPage();
	if( ACC.pageName === "cdaCampaignPage" ){
		//Very first element of page
		var firstElem = $(".js-compliance-list").find(".js-qty-selector-input:eq(0)");
		//Try to find out first element which has qty in cart
		$(".js-compliance-list").find(".js-in-cart").each(function(){
			var qty = parseInt($(this).text());
			if( qty > 0 ){
				firstElem = $(this).closest("tr").find(".js-qty-selector-input");
				return false;
			}
		})
		
		ACC.common.validateCdaOnLoad(firstElem);
	}
	
	if( $("[id^=collapse_discount_]").length > 0 ){
		$("[id^=collapse_discount_]").each(function(){
			var $firstElem = $(this).find(".js-cart-campaign-discount").eq(0);
			ACC.campaignExtend.checkDiscountCampaign( $firstElem );
		})
	}
	ACC.global.footerAlignment();
});

$(window).resize(function(){
	if( ACC.pageName === "searchViewAll" ){
		ACC.search.resetFilterButton();
		ACC.search.setindex();
		ACC.search.shFilters("resize");
	}
});

$(window).scroll(function(){
	if( ACC.pageName === "cartPage" ){
		ACC.checkout.showBackToTop();
	}
});

ACC.forgottenpassword = {

	_autoload: [
		"bindLink"
	],
	
	bindLink: function() {
		/* Forgot password modal change from colorbox */
		$(".loginDD, .devicelogin").on("click",".js-password-forgotten",function(e){
			e.preventDefault();
			var url = ACC.config.encodedContextPath + "/login/pw/request";
			$.ajax({
		           url: url,
		           method: "GET",
		           success: function(data)
		           {
		        	   $("#forgotPasswordModal .modal-body").html(data);
		        	   $('#forgotPasswordModal .modal-body #validEmail').remove();
		        	   $('#forgotPasswordModal').modal("show");
		        	   $("#forgotPasswordModal .js-first-focus").focus();
		        	   
		        	   $('form#pepsicoForgottenPwdForm').ajaxForm({
							success: function(data)	{
								if ($(data).closest('#validEmail').length){
									
									if ($('#validEmail').length === 0){
										$("#forgotPasswordModal .modal-body .forgotten-password").replaceWith(data);
									}
								}
								else{
									$("#pepsicoForgottenPwdForm .control-group").replaceWith($(data).find('.control-group'));
									var errorMsg = $("#pepsicoForgottenPwdForm .control-group .help-block");
									
									errorMsg.siblings("input").attr("aria-describedby",errorMsg.find("span").attr("id"));
									errorMsg.siblings("input").focus();
								}
							}
						});
		           }
	         });
		})
	}

};
ACC.global = {
    _autoload: [
        "bindToggleOffcanvas",
        "bindToggleXsSearch",
        "bindHoverIntentMainNavigation",
        "initImager",
        "backToHome",
        "footerAlignment",
        "closeSubNav",
        "bindCLickOnEnter"
    ],

    passwordStrength: function () {
        $('.password-strength').pstrength({ verdicts: [ACC.pwdStrengthTooShortPwd,
		                                   		    ACC.pwdStrengthVeryWeak,
		                                			ACC.pwdStrengthWeak,
		                                			ACC.pwdStrengthMedium,
		                                			ACC.pwdStrengthStrong,
		                                			ACC.pwdStrengthVeryStrong],
		                                			minCharText: ACC.pwdStrengthMinCharText });
    },

    bindToggleOffcanvas: function () {
    	
    	if( ACC.browserDetect.isMobile() ){
    		$('.js-enquire-offcanvas-navigation').find('a:not(.js-enquire-sub-close), button').attr('tabindex','-1');
    	}
    	$(document).on("click", ".js-toggle-sm-navigation", function () {
        	if( ACC.browserDetect.isMobile() ){
        		if( $(this).hasClass("js-hamburger-icon") ){
        			$("footer").removeClass("fixed");
        		}else{
        			ACC.global.footerAlignment();
        		}
        	}
        	ACC.global.toggleClassState($("#main"), "offcanvas");
            ACC.global.toggleClassState($("html"), "offcanvas");
            ACC.global.toggleClassState($("body"), "offcanvas");
            if($("body").hasClass('asmOverflow')){
            	ACC.global.toggleClassState($(".bodyContainer"),"hide");
            }
            ACC.global.resetXsSearch();
            
            
            
            var mob_menu = $('.js-enquire-offcanvas-navigation');
            var hamburger_icon = $('.js-toggle-sm-navigation');
            if($("#main").hasClass( "offcanvas" )) {
            	ACC.global.setAria("expanded", hamburger_icon, true);
            	mob_menu.find('a, button').removeAttr('tabindex');
            	mob_menu.removeAttr('aria-hidden');
            	$('.close-nav .js-toggle-sm-navigation').focus();
            }
            else {
            	ACC.global.setAria("expanded", hamburger_icon, false);
            	mob_menu.find('a').attr('tabindex','-1');
            	if( $( window ).width() < parseInt(screenMd) ) {
            		mob_menu.attr('aria-hidden',true);
            	}
            	$('.mobile__nav__row--btn-menu.js-toggle-sm-navigation').focus();
            }
            	
        });
        
        ACC.global.mobileNavKeyStroke();
    },
    
    mobileNavKeyStroke: function(){
        $( ".js-toggle-sm-navigation" ).keydown(function(e) {
        	e.stopPropagation();
            switch (e.which) {
                case 32:
                {   
                	// space
                	e.preventDefault();
                	$(this).click();
                	break;
                }
                case 13:
                {   
                	// enter
                	e.preventDefault();
                	$(this).click();
                	break;
                }
                default:
                    return;
            }
        });
    },

    bindToggleXsSearch: function () {
        
    	$(document).on("click", ".js-toggle-xs-search", function () {
            ACC.global.toggleClassState($(".site-search"), "active");
            ACC.global.toggleClassState($(".js-mainHeader .navigation--middle"), "search-open");
            $(".js-site-search-input").focus();
        });
        
        $( ".site-search" ).keydown(function(e) {
        	e.stopPropagation();
            if (e.which === 27) {
                	// ESC
                	e.preventDefault();
                	$('.js-toggle-xs-search').click().focus();
            }else{
                    return;
            }
        });
        
        
    },

    resetXsSearch: function () {
        $('.site-search').removeClass('active');
        $(".js-mainHeader .navigation--middle").removeClass("search-open");
    },

    toggleClassState: function ($e, c) {
        $e.hasClass(c) ? $e.removeClass(c) : $e.addClass(c);
        return $e.hasClass(c);
    },
    
    bindHoverIntentMainNavigation: function () {

        enquire.register("screen and (min-width:" + screenMdMin + ")", {
    	//enquire.register("screen and (min-width:" + screenSmMin + ")", {

            match: function () {
                // on screens larger or equal screenMdMin (1024px) calculate position for .sub-navigation
            	$(".js-enquire-has-sub").click(function () {
                	ACC.global.addPositionOnLoad($(this));
                });
            	
            	$(document).on("blur",".js-enquire-has-sub .sub__navigation .yCmsComponent:last-of-type a",function(){
            		$(this).closest( ".js-enquire-has-sub" ).removeClass("show-sub");
            	});
            },

            unmatch: function () {
                // on screens smaller than screenMdMin (1024px) remove inline styles from .sub-navigation and remove hoverIntent
                $(".js_sub__navigation").removeAttr("style");
                $(".js-enquire-has-sub").hoverIntent(function () {
                    // unbinding hover
                });
            }

        });
    },

    initImager: function (elems) {
        elems = elems || '.js-responsive-image';
        this.imgr = new Imager(elems);
    },

    reprocessImages: function (elems) {
        elems = elems || '.js-responsive-image';
        if (this.imgr == undefined) {
            this.initImager(elems);
        } else {
            this.imgr.checkImagesNeedReplacing($(elems));
        }
    },

    // usage: ACC.global.addGoogleMapsApi("callback function"); // callback function name like "ACC.global.myfunction"
    addGoogleMapsApi: function (callback) {
        if (callback != undefined && $(".js-googleMapsApi").length == 0) {
            $('head').append('<script class="js-googleMapsApi" type="text/javascript" src="//maps.googleapis.com/maps/api/js?key=' + ACC.config.googleApiKey + '&sensor=false&callback=' + callback + '"></script>');
        } else if (callback != undefined) {
            eval(callback + "()");
        }
    },

    backToHome: function () {
        $(".backToHome").on("click", function () {
            var sUrl = ACC.config.encodedContextPath;
            window.location = sUrl;
        });
    },
    footerAlignment: function(){
    	var bodyHeight = $('body').height();
    	if($('footer').hasClass('fixed')) 
    		bodyHeight +=  $('footer').height();
    	if(bodyHeight < $(window).height()){
    	    $('footer').addClass('fixed');
    	}else{
    		$('footer').removeClass('fixed');
    	}
    		
    },
    addPositionOnLoad: function(el){
    	var $this = el,
	        itemWidth = $this.width();
	    var $subNav = $this.children('.js_sub__navigation'),
	        subNavWidth = $subNav.outerWidth();
	    var $mainNav = $('.js_navigation--bottom'),
	        mainNavWidth = $mainNav.width();
	
	
	    // get the left position for sub-navigation to be centered under each <li>
	    var leftPos = $this.position().left + itemWidth / 2 - subNavWidth / 2;
	    // get the top position for sub-navigation. this is usually the height of the <li> unless there is more than one row of <li>
	    var topPos = $this.position().top + $this.height();
	
	    if (leftPos > 0 && leftPos + subNavWidth < mainNavWidth) {
	        // .sub-navigation is within bounds of the .main-navigation
	        $subNav.css({
	            "left": leftPos,
	            "top": topPos,
	            "right": "auto"
	        });
	    } else if (leftPos < 0) {
	        // .suv-navigation can't be centered under the <li> because it would exceed the .main-navigation on the left side
	        $subNav.css({
	            "left": 0,
	            "top": topPos,
	            "right": "auto"
	        });
	    } else if (leftPos + subNavWidth > mainNavWidth) {
	        // .suv-navigation can't be centered under the <li> because it would exceed the .main-navigation on the right side
	        $subNav.css({
	            "right": 0,
	            "top": topPos,
	            "left": "auto"
	        });
	    }
    },
    
    closeSubNav: function(){
    	$(document).on("click", function(e){ 
    	    if ($(e.target).closest(".js_sub__navigation").length === 0) {
	        	$('.js_sub__navigation').removeAttr("style").closest(".js-enquire-has-sub").removeClass("show-sub");
	        }
    	});
    },
    
    bindCLickOnEnter: function(parent, $selector){
    	$(parent).on('keydown', $selector, function (e) {
    		  if (e.which === 13) {
    		    this.click();
    }
    	});
    },
    
    modalTabKey: function(which, e, target, $close, $modal, $last){
    	if (which === 9 && e.shiftKey) { // SHIFT + TAB
    	    // shift+tab from "X" (close) button to the "Cancel" button
    	    if (target === $close[0] || target === $modal[0]) {
    	      e.preventDefault();
    	      $last.focus();
    	    }
    	  } else if (which === 9) { // TAB
    	    // tab from "Cancel/Last" button to "X" (close) button
    	    if (target === $last[0]) {
    	      e.preventDefault();
    	      $close.focus();
    	    }
    	  } else if (which === 27) { // ESCAPE
    	    // click the cancel button which hides the modal and focuses it's trigger
    		$close.click();
    	  }
    },
    
    modalAccessibility: function($modal, $close, $lastElem){
    	// target => source
    	// keyboard events on the modal itself
    	$modal.on('keydown', function (e) {
    	  var which = e.which;
    	  var target = e.target;
    	  var $last = $lastElem;
    	  if( $modal.hasClass("autoShipModal") && $(".js-submit-explain:visible").length > 0 ){
			  $last = $(".js-submit-explain:visible");
    	  }
    	  ACC.global.modalTabKey(which, e, target, $close, $modal, $last);
    	});
    },
    
    closeModal: function($close, $trigger){
    	// when cancel is clicked, hide the modal and focus it's trigger
    	$close.on('click', function () {
    	  if($trigger){
    		$trigger.eq(0).focus();
    	  }
    	});
    },
    
    cBoxAccessibility: function(){
    	// target => source
    	// keyboard events on the colorbox itself
    	$('#colorbox').on('keydown', function (e) {
    	  var which = e.which;
    	  var target = e.target;

    	  if (which === 9 && e.shiftKey) { // SHIFT + TAB
    	    // shift+tab from "X" (close) button then focus last button
    	    if (target ===  $('#colorbox').find("#cboxClose")[0] || target === $('#colorbox')[0]) {
    	      e.preventDefault();
    	      $('#colorbox').find(".js-last-focus").focus();
    	    }else if (target === $('#colorbox').find(".js-first-focus")[0]) {
    	      e.preventDefault();
    	      $('#colorbox').find("#cboxClose").focus();
    }
    	  } else if (which === 9) { // TAB
    	    // tab from "X" (close) button then highlight first tabindex
    	    if (target === $('#colorbox').find("#cboxClose")[0]) {
    	      e.preventDefault();
    	      $('#colorbox').find(".js-first-focus").focus();
    	    }
    	  } else if (which === 27) { // ESCAPE
    	    // click the cancel button which hides the colorbox and focuses it's trigger
    		  $('#colorbox').find("#cboxClose").click();
    	  }
    	});
    },
    
    setAria: function($attr, $el, $value){
    	if( $el.length > 0 ){
    		$el.attr("aria-"+$attr, $value);
    	}
    },
    displaySpinner: function($el, display){
		if( $el.length > 0 ){
			if( display ){
				$el.removeClass("display-none");
			}else{
				$el.addClass("display-none");
			}
		}
	},
	
	getDomain: function() {
	    var hostName = window.location.hostname;
	    var domain = hostName;
	    
	    if (hostName != null) {
	        var parts = hostName.split('.').reverse();
	        
	        if (parts != null && parts.length > 1) {
	            domain = parts[1] + '.' + parts[0];
	        }
	    }
	    
	    return domain;
	},
	
	//set expires for 1 year like new Date(new Date().getTime() + 365 * 24 * 60 * 60 * 1000);
	//escape() set in bootstrap
	setCookie: function(name,value,expires,path,domain,secure){
		document.cookie = name + "=" + escape (value) +
	    ((expires) ? "; expires=" + expires.toGMTString() : "") +
	    ((path) ? "; path=" + path : "") +
	    ((domain) ? "; domain=" + domain : "") +
	    ((secure) ? "; secure" : "");
	},
	
	// no need to use unescape() as $.cookie() does it internally
	getCookie: function(name){
		return $.cookie(name);
	},
	
	// set expire with the past time to delete cookie
	deleteCookie: function (name, path, domain) {
		if(ACC.global.getCookie(name)){
			document.cookie = name + "=" +
		    ((path) ? "; path=" + path : "") +
		    ((domain) ? "; domain=" + domain : "") +
		    "; expires=Thu, 01-Jan-70 00:00:01 GMT";
		}
	}
};
ACC.hopdebug = {

	bindAll: function ()
	{
		this.bindShowDebugMode();
	},

	bindShowDebugMode: function ()
	{
		var debugModeEnabled = $('#hopDebugMode').data("hopDebugMode");
		
		if (!debugModeEnabled && !$('#showDebugPage').attr('value'))
		{
			$('#hostedOrderPagePostForm').submit();
		}
	}
};


$(document).ready(function ()
{
	ACC.hopdebug.bindAll();
});
ACC.imagegallery = {

	_autoload: [
		"bindImageGallery"
	],

	bindImageGallery: function (){

		$(".js-gallery").each(function(){
			var $image = $(this).find(".js-gallery-image");
			var $carousel = $(this).find(".js-gallery-carousel")
			var imageTimeout;

			
			$image.owlCarousel({
				singleItem : true,
				pagination:true,
				navigation:true,
				lazyLoad:true,
				navigationText : ["<span class='glyphicon glyphicon-chevron-left'></span>", "<span class='glyphicon glyphicon-chevron-right'></span>"],
				afterAction : function(){
					ACC.imagegallery.syncPosition($image,$carousel,this.currentItem)
					$image.data("zoomEnable",true)				
				},
				startDragging: function(){
					
					$image.data("zoomEnable",false)
				},
				afterLazyLoad:function(e){

					var b = $image.data("owlCarousel") || {}
					if(!b.currentItem){
						b.currentItem = 0
					}
	
					var $e=$($image.find("img.lazyOwl")[b.currentItem]);
					//startZoom($e.parent())
				}
			});


			$carousel.owlCarousel({
				navigation:true,
				navigationText : ["<span class='glyphicon glyphicon-chevron-left'></span>", "<span class='glyphicon glyphicon-chevron-right'></span>"],
				pagination:false,
				items:2,
				itemsDesktop : [5000,7], 
				itemsDesktopSmall : [1200,5], 
				itemsTablet: [768,4], 
				itemsMobile : [480,3], 
				lazyLoad:true,
				afterAction : function(){
					// override
				},
			});


			$carousel.on("click","a.item",function(e){
				e.preventDefault();
				$image.trigger("owl.goTo",$(this).parent(".owl-item").data("owlItem"));
			})



			function startZoom(e){
			


				$(e).zoom({
					url: $(e).find("img.lazyOwl").data("zoomImage"),
					//touch: true,
					//on: "grab",
					touchduration:300,

					onZoomIn:function(){
					// override
					},

					onZoomOut:function(){
						var owl = $image.data('owlCarousel');
						owl.dragging(true)
						$image.data("zoomEnable",true)
					},

					zoomEnableCallBack:function(){
						var bool = $image.data("zoomEnable")

						var owl = $image.data('owlCarousel');
						if(bool==false){
							owl.dragging(true)
						}
						else{

						 	owl.dragging(false)
						}
						return bool;
					}
				});
			}
		})
	},


	syncPosition: function($image,$carousel,currentItem){
		$carousel.trigger("owl.goTo",currentItem);
	}
};

ACC.langcurrency = {

	_autoload: [
		"bindLangCurrencySelector"
	],

	bindLangCurrencySelector: function (){

		$('#lang-selector').change(function(){
			$('#lang-form').submit();
		});

		$('#currency-selector').change(function(){
			$('#currency-form').submit();
		});
	}
};
ACC.minicart = {

	_autoload: [
	],

    updateMiniCartDisplay: function(){
        var miniCartRefreshUrl = $(".js-mini-cart-link").data("miniCartRefreshUrl");
        $.ajax({
            url: miniCartRefreshUrl,
            cache: false,
            type: 'GET',
            success: function(jsonData){
            	if(typeof(jsonData.miniCartPrice) !== "undefined" && jsonData.miniCartPrice.length > 0){
            	var span = $('<span/>');
            	var span2 = $('<span/>'); 
            	span2.addClass("sr-only");
            	span2.text("items in cart");
            	span.addClass("nav-items-total");
            	span.text(jsonData.miniCartCount);
            	$(".js-mini-cart-link .js-mini-cart-count").empty().append(span).append(span2);
                $(".js-mini-cart-link .js-mini-cart-price").text(jsonData.miniCartPrice);
            	}
            }
        });
    }

};

var oDoc = document;

ACC.navigation = {

    _autoload: [
        "offcanvasNavigation",
        "myAccountNavigation",
        "orderToolsNavigation",
        "populateCofList",
        "changeCof",
        "navigationMenu",
        "logout",
        "init"
    ],
    
    showEquipmentWarningMsg: false,
    
    init: function(){
    	ACC.navigation.checkServicesLinkClicked();
    },
    
    offcanvasNavigation: function(){

        enquire.register("screen and (max-width:"+screenSmMax+")", {

            match : function() {
            	// L1 Menu Click, L2 Open
                $(document).on("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub:not(.hideDownArrow) .js_nav__link--drill__down",function(e){
                    e.preventDefault();
                    $(".js-userAccount-Links").hide();
                    $(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").addClass("active");
                    $(".js-enquire-offcanvas-navigation .js-enquire-has-sub").removeClass("active");
                    $(this).parent(".js-enquire-has-sub").addClass("active");
                    $(this).parent(".js-enquire-has-sub").find(".submenuContainer").removeAttr("style");
                    
                    $(".submenuContainer, .js-enquire-subchild-close, .js-back-to-home").addClass("display-none");
                    if( window.screen.width < parseInt(screenSmMax) ){
                    	$(this).parent(".js-enquire-has-sub").prevAll().addClass("display-none");
                    }
                    $(this).parent(".js-enquire-has-sub").find(".js-enquire-sub-close").removeClass("display-none");
                    $(this).parent(".js-enquire-has-sub").find(".sub-navigation-section").removeClass("display-none");
                    $(".sub__navigation").find(".title").show();
                });

                // L2 Back Menu Click, L1 Open
                $(document).on("click",".js-enquire-offcanvas-navigation .js-enquire-sub-close",function(e){
                	$(".js-enquire-has-sub").removeClass("show-sub active");
                	ACC.navigation.closeSecondLevelMenu(e, $(this));
                });
                
                // L2 Menu Click, L3 Open
                $(document).on("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub .js_subnav__link--drill__down",function(e){
                	ACC.navigation.openThirdLevelMenu($(this), e);
                });
                
                // L3 Back Menu Click, L2 Open
                $(document).on("click",".js-enquire-offcanvas-navigation .js-enquire-subchild-close",function(e){
                	ACC.navigation.closeThirdLevelMenu(e, $(this));
                });
                
                // L3 Menu anchor link Click
                $(document).on("click", ".sub-navigation-list a", function(){
                	window.location = $(this).attr("href");
                });
                
                $(document).on("click",".js-enquire-offcanvas-navigation .js-back-to-home",function(e){
                	ACC.navigation.closeThirdLevelMenu(e, $(this));
                	ACC.navigation.closeSecondLevelMenu(e, $(this));
                	$(".js-enquire-has-sub").removeClass("show-sub active");
                });
            },

            unmatch : function() {
            	$(".js-enquire-has-sub").removeClass("show-sub active");
            	ACC.navigation.unmatchTabletNavMenu();
            }
        });

    },
    
    closeSecondLevelMenu: function(e, $this){
    	e.preventDefault();
        $(".js-userAccount-Links").show();
        $(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").removeClass("active");
        $(".js-enquire-offcanvas-navigation .js-enquire-has-sub").removeClass("active");
        $this.closest(".js-enquire-has-sub").prevAll().removeClass("display-none");
    },
    
    closeThirdLevelMenu: function(e, $this){
    	ACC.common.logEvent(e.target.className);
    	$this.closest(".subNav").children("li").removeClass("display-none");
    	$(".js-enquire-offcanvas-navigation .js-enquire-has-sub .js-enquire-sub-close").removeClass("display-none");
    	$this.closest(".js-level2-menu").find(".js-enquire-subchild-close, .js-back-to-home").addClass("display-none");
    	$(".js-enquire-offcanvas-navigation .js-enquire-has-sub").find(".title").show();
    	$this.closest(".js-level2-menu").find(".submenuContainer").hide();
    },
    
    openThirdLevelMenu: function($el, e){
    	if( ! $el.closest(".sub-navigation-section").hasClass("static-link") ){
        	e.preventDefault();
        	ACC.navigation.openThirdLevelMenuByLink($el);
        }
    },
            
    openThirdLevelMenuByLink: function($el){
        	$el.closest(".subNav").children("li").addClass("display-none");
        	$el.closest(".sub-navigation-section").removeClass("display-none");
        	
            $(".js-enquire-offcanvas-navigation .js-enquire-sub-close").addClass("display-none");
            $el.closest(".sub__navigation").find(".title").hide();
        $el.closest(".sub-navigation-section").find(".js-enquire-subchild-close, .js-back-to-home").removeClass("display-none");
            $el.closest(".sub-navigation-section").children(".submenuContainer").css({"display":"block", "width":"100%", "position":"relative"});
            
            $el.closest(".sub-navigation-section").find(".sub-navigation-list").removeAttr("style");
    },
    
    unmatchTabletNavMenu: function(){
            	$(".subNav").children(".sub-navigation-section").removeClass("display-none");
            	$(document).off("mouseover",".subNav .sub-navigation-section");
            	
                $(".js-userAccount-Links").show();
                $(".js-enquire-offcanvas-navigation ul.js-offcanvas-links").removeClass("active");
                $(".js-enquire-offcanvas-navigation .js-enquire-has-sub").removeClass("active").removeClass("display-none");

                $(document).off("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub > a");
                $(document).off("click",".js-enquire-offcanvas-navigation .js-enquire-sub-close");
                
                $(".sub__navigation").find(".title").show();
                $(".sub__navigation").find(".submenuContainer").removeAttr("style");
                
                ACC.navigation.closeHamburgerMenu();

        $(document).off("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub .js_subnav__link--drill__down");
        $(document).off("click",".js-enquire-offcanvas-navigation .js-enquire-has-sub .js_nav__link--drill__down");
    },
    
    closeHamburgerMenu: function(){
    	if( $("#main").hasClass("offcanvas") ){
        	$("#main").removeClass("offcanvas");
        }
        if( $("html").hasClass("offcanvas") ){
        	$("html").removeClass("offcanvas");
        }
        if( $("body").hasClass("offcanvas") ){
        	$("body").removeClass("offcanvas");
        }
    },
    
    myAccountNavigation: function(){
    	// override by custom.acc.navigation.js
    },

    orderToolsNavigation: function(){
        $('.js-nav-order-tools').on('click', function(){
        	ACC.updatenavigation.toggleArrow($(this));
        	ACC.updatenavigation.toggleActiveClass($(this),"js-nav-order-tools--active");
        	var cofLink = $(this).find('a:first');
    		var currValue = cofLink.attr('aria-expanded');
    	    if(currValue == 'true'){
    	      currValue = 'false';
    	    }else{
    	      currValue = 'true';
    	    }
    	    cofLink.attr('aria-expanded', currValue);
        });
    },
    
    
    populateCofList: function(){
    	if(ACC.AnonymousCustomer == "false"){
    		$.ajax({
	    		url: ACC.config.encodedContextPath + "/cof", 
	    		dataType: "json",
	    		method: "GET",
	    		success: function(result, textStatus, jqXHR ){
	    			if( typeof(result) === "object" && result.hasOwnProperty("cofData") ){
	    				ACC.navigation.renderCofList(result);
	    			}
	    			ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
	            },
	            error: function( jqXHR, textStatus, errorThrown){
	            	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
	            },
	            complete: function(jqXHR, textStatus){
	            	ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
	            }
	    	});
    	}
    },
    
    renderCofList: function(result){
    	if( typeof(result.cofData) !== "undefined" &&  result.cofData.length > 0 ){
			$(".cof-ul-list").empty().append(result.cofData);
			var node=$(".cof-ul-list").find("div.true").children("a");
			$(".cof-ul-list").find("div.true").remove();
			var selectedNode = $(".cof-ul-list").closest(".myCof").find(".cof-list");
			selectedNode.html(node.html());
			if( node.find(".blue-text").text().length === 0 ){
				selectedNode.css({"margin-top":"20px"});
			}
			if( $(".cof-ul-list").find("div").length === 0 ){
				$(".cof-ul-list").closest(".myCof").addClass("hide");
			}
			/* Set COF in Mobile */
			if( $(".userGroup").find(".userName").length > 0 && node.length > 0 ){
				$(".userGroup").find(".userName").html(node.html());
			}
			/*For Mobile*/
			if( $(".faqLinksContainer").length > 0 ){
				$(".faqLinksContainer").find(".blue-text").removeClass("hidden-xs");
			}
			if ($(result.cofData).hasClass("false")) {
				$(".js-nav-order-tools").removeClass("hide");
			}
		} else {
			$(".cof-ul-list").parent("div").addClass("hide");
		}
    },
    
    changeCof: function(){
    	var clientId;
        $('.cof-ul-list').on('click','div', function(e){
        	e.preventDefault();
        	ACC.navigation.closeHamburgerMenu();
        	clientId=$(this).data("cof");
        	ACC.CofId = clientId;
        	$("#cofToggle").show();
        	var cartCount = $('.mini-cart-count').find('.nav-items-total').text();
    		if(parseInt(cartCount,10) > 0)	
    		{
    			$("#cofToggle").hide('fast', function(){
    				ACC.CofModal = true;
    				$('#cofModal').modal();
    				ACC.navigation.openCofModalDisplay();
    			});
    		} else {
    			ACC.navigation.changeCofAjax(clientId);
    		}
        });
        
        $('#discardCartforCof').on('click', function(){
			$('#cofModal').modal('hide');
        	$("#cofToggle").show();
        	ACC.navigation.changeCofAjax(clientId);
		});
    },
    
    openCofModalDisplay: function(){
    	$('#cofModal').on('shown.bs.modal', function () {
	    	$('#cofModal').find(".js-first-focus").focus();
		    ACC.global.modalAccessibility( $('#cofModal'), $('#cofModal').find(".close"),  $('#cofModal').find(".js-last-focus"));
		    ACC.global.closeModal($('#cofModal').find(".close"), false);
    	})
    },
    
    changeCofAjax: function(clientId) {
    	// remove session storage 1
    	ACC.CofId = clientId;
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/cof/selectedCof",
    		data: {"clientId":clientId},
    		method: "GET",
    		success: function(rsp, textStatus, jqXHR){
    			if (rsp ==='Error'){
    				$("#cofToggle").hide();
    				$('#cofToggleErrorModal').modal();
    				$('#cofToggleException').show();
    			} else {
    				ACC.navigation.changeCofAjaxSuccess();
    			}
    			ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
            },
            error: function( jqXHR, textStatus, errorThrown){
            	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
            },
            complete: function(jqXHR, textStatus){
            	ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
            }
    	});    	
    },
    
    changeCofAjaxSuccess: function(){
    	ACC.global.deleteCookie("_ga", "/", ACC.global.getDomain());
    	ACC.global.deleteCookie("_gid", "/", ACC.global.getDomain());
    	
    	ACC.common.removeStorageVariable("DataTables_js-cartDataTable");
    	
    	var path = window.location.pathname;
		var href=window.location.href;
		ACC.common.createGaGoal("gaGoal");
		ACC.common.createGaGoal("gaProductGoal");
		var directToHome = path.indexOf('/checkout/orderConfirmation/')!= -1 || path.indexOf('/checkout/cancelOrderConfirmation/')!= -1 || path.indexOf('/pesticket/getTicket')!= -1
		if(path && directToHome) {
			//redirect to home page
			window.location = ACC.config.encodedContextPath;
		}
		else if(path && path.indexOf('/my-account/order/')!= -1) {
			//redirect to order history page
			window.location = ACC.config.encodedContextPath + '/my-account/orders';
		} 
		else if(href && (href.indexOf('/cart?isExpressOrder=yes')!= -1) || href.indexOf('/cart/discard')!= -1){
			window.location = ACC.config.encodedContextPath + '/cart';
		}
		else {
			//reload current page
			window.location = window.location.href;
		} 
    },
    
    changeCofAfterSaveCart: function(clientId){    	
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/cof/clearCartChangeCof",
    		data: {"clientId":clientId},
    		method: "GET",
    		success: function(rsp, textStatus, jqXHR){
    			if (rsp ==='Error'){
    				$("#cofToggle").hide();
    				$('#cofToggleErrorModal').modal();
    				$('#cofToggleException').show();
    			} else {
	    			var path = window.location.pathname;
	                var href=window.location.href;
	                ACC.common.createGaGoal("gaGoal");
	        		ACC.common.createGaGoal("gaProductGoal");
	                if(href && href.indexOf('/cart?isExpressOrder=yes')!= -1){
	                    window.location = ACC.config.encodedContextPath + '/cart';
	                }
	                else if(path && path.indexOf('/my-account/order/')!= -1) {
						//redirect to order history page
						window.location = ACC.config.encodedContextPath + '/my-account/orders';
					}
	                else {
	                    //reload current page
	                    window.location = window.location.href;
	                }                
	                ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
    			}
            },
            error: function( jqXHR, textStatus, errorThrown){
            	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
            },
            complete: function(jqXHR, textStatus){
            	ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
            }
    	});    	
    },
    
    removeBorderOnHover: function($el){
    	var submenu = $el.find(".js_sub__navigation");
    	if( submenu.length > 0 &&  submenu.find(".sub-navigation-section").length === 0 ){
    		enquire.register("screen and (min-width:"+screenMdMin+")", {
            	match : function() {
            		if( ! $el.hasClass("hideDownArrow") ){
            			$el.addClass("hideDownArrow");
            		}
            	},
            	unmatch : function() {
            		if( $el.hasClass("hideDownArrow") ){
            			$el.removeClass("hideDownArrow");
            		}
            	}
    		});
    	}
    },
    
    navigationTopMenuAjaxSuccess: function(data, $this, categoryLink){
    	var linkName=$this.find('.js_nav__link--drill__down').find($('a')).attr("data-title");
    	if(data!=''){
    		if( data.indexOf("template-pages-LoginPageTemplate") >= 0 ){
    			window.location = ACC.config.encodedContextPath + '/login';
    			return false;
    		}else if( data.indexOf("<!DOCTYPE html>") >= 0 ){
    			return false;
    		}
    		$this.append(data);
    		ACC.navigation.removeBorderOnHover($this);
    		$this.find(".js-enquire-sub-close").attr("aria-label", ACC.backTo+" "+linkName);
    		
    		var subNavigationSection = $("<li></li>");
    		subNavigationSection.attr("class", "sub-navigation-section col-md-12 static-link");
    		var subNavDown = $("<div></div>");
    		subNavDown.attr("class", "js_subnav__link--drill__down");
    		var titleLink = $("<a></a>");
    		titleLink.attr("class", "title");
    		titleLink.attr("href", ACC.config.encodedContextPath+categoryLink);
    		titleLink.text("All "+ linkName );
    		subNavDown.append(titleLink);
    		
    		subNavigationSection.append(subNavDown);
    		
    		var parentLink = subNavigationSection.clone();
    		parentLink.addClass("js-level-1-menu hidden-md hidden-lg");
    		parentLink.find("a").attr("href", "javascript:void(0);").addClass("js-back-to-level-1 back-to-parent highlight").text(linkName);
    		
    		// Create Submenu of Static Link
    		var submenuContainer = $("<div></div>").addClass("submenuContainer col-md-push-12 display-none");
    		submenuContainer.append( $("<ul></ul>").addClass("sub-navigation-list col-md-12").append( $("<li></li>").addClass("nav__link--secondary col-md-4") ) );
    		
    		var subNavContainer = $this.find('.js_sub__navigation').find('.subNav');
    		
    		subNavContainer.prepend(parentLink ,subNavigationSection);
    	
    		enquire.register("screen and (min-width:"+screenMdMin+")", {

                match : function() {
                	if( subNavigationSection.find(".submenuContainer").length === 0 ){
                		subNavigationSection.append(submenuContainer);
                		var subMenuLink = subNavigationSection.find(".js_subnav__link--drill__down").find("a").clone();
                		subNavigationSection.find(".js_subnav__link--drill__down").find("a").attr("href", "javascript:void(0);");
                		subNavigationSection.find(".submenuContainer li").append( $(subMenuLink).removeClass("title") );
                	}else{
                		subNavigationSection.find(".js_subnav__link--drill__down").find("a").attr("href", "javascript:void(0);");
                	}
            		ACC.navigation.highlight2ndMenu($this);
                },
                unmatch : function() {
                	var link = subNavigationSection.find(".submenuContainer li").find("a").attr("href");
                	subNavigationSection.find(".js_subnav__link--drill__down").find("a").attr("href", link);
                }
    		});
    		
    		
    	}else{
    		$this.removeClass(".nav__links--primary-has__sub .js-enquire-has-sub");
    	}
    },
    
    showSubNavArea: function($this){
    		enquire.register("screen and (min-width:"+screenMdMin+")", {
            	match : function() {
            		ACC.updatenavigation.closeOtherNav();
            		$(".js-enquire-has-sub").not($this).removeClass("show-sub active");
            		$this.toggleClass("active show-sub");
            	},
            	unmatch : function() {
            		$(".js-enquire-has-sub").removeClass("active show-sub");
            	}
        });
    },
    
    addAllLink: function($el){
    	var allowedTopLink = ["TipsLink"];
    	var linkUid = $el.data("linkUid");
    	if( $.inArray(linkUid, allowedTopLink) !== -1 ){
    		var link = $el.closest(".js-enquire-has-sub").find(".js_nav__link--drill__down").find("a");
    		var linkText = "All "+link.text();
    		var linkUrl = link.attr("href");
    		
    		var backLink = $el.closest(".js-enquire-has-sub").find(".js_sub__navigation").find(".js-enquire-sub-close");
    		
    		var linkNode = $("<span></span>").addClass("yCmsComponent static")
    		.append($("<a></a>").attr("href", linkUrl)
    				.attr("data-title", linkText)
    				.attr("tabindex", "-1")
    				.text(linkText));
    		if( ! backLink.next().next().hasClass("static") ){
    			backLink.next().after(linkNode);
            		}
            	}
    },
    
    navigationTopMenu: function(){
    	var isHovered=false;
    	
    	$(document).on("click",".js-enquire-has-sub",function(e){
    		e.preventDefault();
    		var $this = $(this);
    		
    		if( $this.hasClass("hideDownArrow") ){
    			window.location = $this.find(".js_nav__link a").attr("href");
    		}
    		
    		ACC.navigation.addAllLink($this);
    		ACC.navigation.showSubNavArea($this);
    		$this.find(".sub-navigation-section").removeClass("selectedMenu");
    		if(isHovered){
    			return false;
    		}
    		
    	    if( $this.find(".js_sub__navigation").length > 0 ){
    	    	if( window.screen.width > parseInt(screenSmMax) ){
    	    	ACC.navigation.highlight2ndMenu($this);
    	    	}
    	    	ACC.navigation.triggerLinkEvent(e);
    	    	return false;
    	    }
    	    
    	    isHovered=true;
    	    
    		var categoryLink=$(this).find('.categoryLink').val();
    	    var categoryCode;
    	    
    	    if(categoryLink.indexOf('/c/')>-1){
    	    	categoryCode=categoryLink.substring(categoryLink.indexOf('/c/')+3);
    	    }
    	    $.ajax({
                url: ACC.config.encodedContextPath + '/navigation',
                method: "GET",
                data:{categoryCode:categoryCode},
                success: function (data, textStatus, jqXHR) {
                	ACC.navigation.navigationTopMenuAjaxSuccess(data, $this, categoryLink);
                	ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
                },
                error: function( jqXHR, textStatus, errorThrown){
                	var subNavBackLink = $("<div></div>").addClass("sub__navigation js_sub__navigation col-md-12")
                	.append($("<a></a>")
                			.addClass("sm-back js-enquire-sub-close hidden-md hidden-lg")
                			.attr("aria-label", ACC.backToRoot)
                			.attr("href", "#").text(ACC.menuText));
                	$this.append(subNavBackLink);
                	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
	            },
	            
	            complete: function(jqXHR, textStatus){
	            	isHovered=false;
	            	ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
	            }

            });
    	    
    	});
    },
    
    buildLinkHtml: function(value){
    	var listItem = $("<li></li>");
    	listItem.attr("class", "js-level3-menu nav__link--secondary col-md-4");
    	var link = $("<a/>");
    	link.attr({"href":(value ? ACC.config.encodedContextPath+value.url : "javascript:void(0);"), "class":"js-second-level-link"});
    	link.text( value ? value.name : "" );
    	listItem.append(link);
    	return listItem;
    },
    
    navigationChildMenuAjaxSuccess: function(data, $this, $subNav){
    	if( typeof(data) !== "object" || ! data.hasOwnProperty("submenuItems") ){
    		return false;
    	}
    	var unorderedList = $("<ul></ul>");
    	unorderedList.attr("class", "sub-navigation-list");
    	if(data.submenuItems.length > 0){
        	var firstItem = ACC.navigation.buildLinkHtml(false);
        	firstItem.addClass("hidden-md hidden-lg");
        	firstItem.find("a").addClass("js-back-to-level-2 back-to-parent highlight").text($subNav.text());
        	
        	var parentLink = ACC.navigation.buildLinkHtml(false);
        	parentLink.addClass("js-back hidden-md hidden-lg");
        	parentLink.find("a").addClass("js-back-to-level-1 back-to-parent js-enquire-subchild-close").text( $this.siblings(".js-level-1-menu").text() );
        	
        	unorderedList.append(parentLink, firstItem);
    	}
        $.each(data.submenuItems, function (key, value) {
        	var listItem = ACC.navigation.buildLinkHtml(value);
        	unorderedList.append(listItem);
       	});
        
    	var backLink = $("<a></a>");
    	backLink.attr("class", "sm-back js-back-to-home hidden-md hidden-lg display-none");//js-back-to-home
    	backLink.attr({"aria-label": ACC.backToRoot, "href":"javascript:void(0)"});
    	backLink.text(ACC.menuText);
    	
    	var submenuContainer = $("<div></div>");
    	submenuContainer.attr("class", "submenuContainer col-md-push-12 display-none");
    	submenuContainer.append(unorderedList);
    	
    	$this.prepend(backLink).append(submenuContainer);
    	
    	enquire.register("screen and (max-width:"+screenSmMax+")", {
    		match : function() {
            //open L3 navigation
			ACC.navigation.openThirdLevelMenuByLink($subNav);
        
            // L3 Back Menu Click, L2 Open
			$(document).on("touchend", ".js-back-to-home", function(e){
            	ACC.navigation.closeThirdLevelMenu(e, $(this));
            	ACC.navigation.closeSecondLevelMenu(e, $(this));
            	$(".js-enquire-has-sub").removeClass("show-sub active");
            	return false;
        	});
            
    		},
    		unmatch: function(){
    			ACC.navigation.unmatchTabletNavMenu();
    		}
    	})    
    	enquire.register("screen and (min-width:"+screenMdMin+")", {
    		match : function() {
    			// Do nothing
    		},
    		unmatch: function(){
    			$(".js-enquire-has-sub").removeClass("show-sub");
    		}
    	})
    },
    
    navigationChildMenu: function(){
    	var isHovered=false;
    	$(document).on("click",".js-getBrands",function(e){
    		e.stopPropagation();
    		if(isHovered){
    			return false;
    		}
    	    var $this = $(this);
    	    var length = $this.find(".sub-navigation-list").length;
    	    if( length > 0 ){
    	    	return false;
    	    }
    	    isHovered=true;
    	    
    	    var $subNav = $this.children(".js_subnav__link--drill__down");
    	    
    	    var categoryCode=$this.find('.navItemCode').val();
    	    var rootCategory=$this.closest('.js-enquire-has-sub').find(".categoryLink").val();
    	    var rootCategoryCode;
     	   if(rootCategory.indexOf('/c/')>-1){
     		  rootCategoryCode=rootCategory.substring(rootCategory.indexOf('/c/')+3);
     	    }
     	  
    	    $.ajax({
                url: ACC.config.encodedContextPath + '/navigation/getBrands',
                method: "GET",
                
                data:{categoryCode:categoryCode,root:rootCategoryCode},
                success: function (data, textStatus, jqXHR) {
                	ACC.navigation.navigationChildMenuAjaxSuccess(data, $this, $subNav);
                	
	                ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
	            },
	            error: function( jqXHR, textStatus, errorThrown){
	            	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
	            },
	            complete: function(jqXHR, textStatus){
	            	isHovered=false;
	            	ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
	            }

            });
    	});
    },
    
    navigationMenu: function(){
    	ACC.navigation.navigationTopMenu();
    	
    	$(document).on("click",".sub-navigation-section",function(e){
    		e.stopPropagation();
    		$(this).siblings().each(function(){
    			$(this).removeClass('selectedMenu');
    			$(this).children(".submenuContainer").removeAttr("style");
    			
    			// Remove active class from the 2nd menu on hover of siblings
    			if( $(this).children(".title").hasClass("active") ){
        			$(this).children(".title").removeClass("active");
        		}
    		});
    		$(this).addClass('selectedMenu');
    		// Add parent link
			var backToLevel1 = $(this).find(".sub-navigation-list").find(".js-back-to-level-1");
			if( backToLevel1.length > 0 ){
				backToLevel1.text( $(this).siblings(".js-level-1-menu").text() );
			}
    	});
    	
    	ACC.navigation.triggerClickOnEnter();
    	ACC.navigation.navigationChildMenu();
    	
    	ACC.navigation.manageEquipmentServiceMenu();
    },
    
    triggerClickOnEnter: function(){
    	$(document).on('keyup','.sub-navigation-section', function(event){
		  if(event.keyCode == 13){
		    if( window.screen.width < parseInt(screenSmMax) ){
		    	ACC.navigation.openThirdLevelMenu($(this), event);
		    }else{
		    	$(this).click();
		    }
		  }
		});
      	$(document).on('keyup','.js-getBrands', function(event){
  		  if(event.keyCode == 13){
  		    $(this).click();
  		  }
  		});
      	$(document).on("click",".js-second-level-link",function(){
      		window.location = $(this).attr("href");
      	});
    },
    
    triggerLinkEvent: function(e){
    	if( $(e.target).is("a") && $(e.target).closest(".js_sub__navigation").length > 0){
    		var href = $(e.target).attr("href");
    		if( href && href != "#" && href.toLowerCase() !== "javascript:void(0)" ){
    			window.location = href;
    		}
    	}
    },
    
    getServicesLinkStorage: function(){
    	var ServicesLinkClicked = false;
    	if (typeof(Storage) !== "undefined") {
			ServicesLinkClicked = localStorage.getItem('ServicesLinkMenuClicked');
    	}
    	return ServicesLinkClicked;
    },
    
    manageServicesLinkStorage: function(value, remove){
    	if (typeof(Storage) !== "undefined") {
    		if( remove ){
    			var ServicesLinkClicked = ACC.navigation.getServicesLinkStorage();
        		if( ServicesLinkClicked ){
        			localStorage.removeItem('ServicesLinkMenuClicked');
        		}
    		}else{
    			localStorage.setItem('ServicesLinkMenuClicked', value);
    		}
    	}
    },
    
    displayEquipmentWarning: function(show){
    	if( $("#loginForm").find(".js-equipment-warning-msg").length > 0 ){
			if( show ){
				$("#loginForm").find(".js-equipment-warning-msg").removeClass("hide").attr("aria-hidden", false);
			}else{
				$("#loginForm").find(".js-equipment-warning-msg").addClass("hide").attr("aria-hidden", true);
				ACC.navigation.manageServicesLinkStorage(null, true);
			}
		}
    },
    
    manageEquipmentServiceMenu: function(){
    	var allSubMenu = $(".js-enquire-has-sub").filter("[data-link-uid='ServicesLink']").find(".js_sub__navigation").find("a").not(".js-enquire-sub-close");
    	allSubMenu.on("click", function(e){
    		if( ACC.AnonymousCustomer === "true" ){
    			e.preventDefault();
    			e.stopPropagation();
    			ACC.navigation.manageServicesLinkStorage($(this).attr("href"), false);
    			if( ACC.browserDetect.isMobile() || $(window).width() <= parseInt(screenSmMax) ){
    				$(".js-toggle-sm-navigation").click();
    			}
    			ACC.navigation.showEquipmentWarningMsg = true;
    			ACC.home.displyLoginOverlay();
    		}
    	});
    },
    
    highlight2ndMenu: function($this){
    	var subNavContainer = $this.find('.js_sub__navigation').find('.subNav');
		if( subNavContainer.children("li").length > 2 ){
			subNavContainer.children(":eq(1)").addClass("selectedMenu");
			subNavContainer.children(":eq(1)").children(".submenuContainer").css({"display":"block"});
		}
    },
    
    logout:function(){
    	$('.js-logout').click(function(e){
    		e.preventDefault();
    		ACC.global.deleteCookie("_ga", "/", ACC.global.getDomain());
        	ACC.global.deleteCookie("_gid", "/", ACC.global.getDomain());
    		
    		sessionStorage.removeItem("deliveryTimeStorage");
    		// Remove 1
    		window.location.href=$(this).attr('href');
    	});
    },
    doNotCall: function(){
    	// Remove 1
    	sessionStorage.removeItem('undeliveredItemsShown');
    },
    
    ServicesLinkEvent: function(result){
    	var pageReloaded = false;
    	var ServicesLinkClicked = ACC.navigation.getServicesLinkStorage();
		if( ServicesLinkClicked && result.indexOf("ACC.pesEnabledUser") > -1 ){
			ACC.navigation.manageServicesLinkStorage(null, true);
			pageReloaded = true;
			window.location = ServicesLinkClicked;
		}
		return pageReloaded;
    },
    
    checkServicesLinkClicked: function(){
    	var ServicesLinkClicked = ACC.navigation.getServicesLinkStorage();
    	if( ServicesLinkClicked && $(".js-equipmentServiceWarningModal").length > 0 && ACC.AnonymousCustomer === "false" ){
    		ACC.navigation.manageServicesLinkStorage(null, true);
    		$(".js-equipmentServiceWarningModal").modal("show");
    	}
    }
};
ACC.order = {

	_autoload: [
	    "backToOrderHistory",
	    "bindMultidProduct"
	],

	backToOrderHistory: function(){
		$(".orderBackBtn > button").on("click", function(){
			var sUrl = $(this).data("backToOrders");
			window.location = sUrl;
		});
	},
	
	bindMultidProduct: function ()
	{
		// link to display the multi-d grid in read-only mode
		$(document).on("click",'.js-show-multiD-grid-in-order', function (event){
			ACC.multidgrid.populateAndShowGrid(this, event, true);
			return false;
		});

		// link to display the multi-d grid in read-only mode
		$(document).on("click",'.showMultiDGridInOrderOverlay', function (event){
			ACC.multidgrid.populateAndShowGridOverlay(this, event);
		});

	}
};
ACC.paginationsort = {

	downUpKeysPressed: false,

	bindAll: function ()
	{
		this.bindPaginationSort();
	},
	bindPaginationSort: function ()
	{
		with (ACC.paginationsort)
		{
			bindSortForm($('#sortForm1'));
			bindSortForm($('#sortForm2'));
		}
	},
	bindSortForm: function (sortForm)
	{
//  browser.msie has been removed from jQuery as of version 1.9. Modernizr is recommended as a replacement
//	issue created
//		if ($.browser.msie)
//		{
// 			this.sortFormIEFix($(sortForm).children('select'), $(sortForm).children('select').val());
//		}

		sortForm.change(function ()
		{
//			if (!$.browser.msie)
//			{
//				this.submit();
//			}
//			else
//			{
				if (!ACC.paginationsort.downUpPressed)
				{
					this.submit();
				}
				ACC.paginationsort.downUpPressed = false;
//			}
		});
	},
	sortFormIEFix: function (sortOptions, selectedOption)
	{
		sortOptions.keydown(function (e)
		{
			// Pressed up or down keys
			if (e.keyCode === 38 || e.keyCode === 40)
			{
				ACC.paginationsort.downUpPressed = true;
			}
			// Pressed enter
			else if (e.keyCode === 13 && selectedOption !== $(this).val())
			{
				$(this).parent().submit();
			}
			// Any other key
			else
			{
				ACC.paginationsort.downUpPressed = false;
			}
		});
	}
};

$(document).ready(function ()
{
	//Will not work in Order History Page
	ACC.paginationsort.bindAll();
});

ACC.payment = {
		
		activateSavedPaymentButton: function(){

			$(document).on("click",".js-saved-payments",function(e){
				e.preventDefault();
				
				var title = $("#savedpaymentstitle").html();
				
				$.colorbox({
					href: "#savedpaymentsbody",
					inline:true,
					maxWidth:"100%",
					opacity:0.7,
					width:"320px",
					title: title,
					close:'<span class="glyphicon glyphicon-remove"></span>',
					onComplete: function(){
						//override
					}
				});
			})
		},
		bindPaymentCardTypeSelect: function ()
		{
			ACC.payment.filterCardInformationDisplayed();
			$("#card_cardType").change(function ()
			{
				var cardType = $(this).val();
				if (cardType == '024')
				{
					$('#startDate, #issueNum').show();
				}
				else
				{
					$('#startDate, #issueNum').hide();
				}
			});
		},
		filterCardInformationDisplayed: function ()
		{
			var cardType = $('#card_cardType').val();
			if (cardType == '024')
			{
				$('#startDate, #issueNum').show();
			}
			else
			{
				$('#startDate, #issueNum').hide();
			}
		}
}

$(document).ready(function () {
	with (ACC.payment) {
		activateSavedPaymentButton();
		bindPaymentCardTypeSelect();
	}
});
	
	
	

ACC.paymentDetails = {
	_autoload: [
		"showRemovePaymentDetailsConfirmation"
	],
	
	showRemovePaymentDetailsConfirmation: function ()
	{
		$(document).on("click", ".removePaymentDetailsButton", function ()
		{
			var paymentId = $(this).data("paymentId");
			var popupTitle = $(this).data("popupTitle");

			ACC.colorbox.open(popupTitle,{
				inline: true,
				href: "#popup_confirm_payment_removal_" + paymentId,
				onComplete: function ()
				{
					$(this).colorbox.resize();
				}
			});

		})
	}
}
ACC.pickupinstore = {

	_autoload: [
		"bindClickPickupInStoreButton",
		"bindPickupButton",
		"bindPickupClose",
		"bindPickupInStoreSearch"
	],

	storeId:"",

	unbindPickupPaginationResults:function ()
	{
		$(document).off("click","#colorbox .js-pickup-store-pager-prev")
		$(document).off("click","#colorbox .js-pickup-store-pager-next")
	},

	bindPickupPaginationResults:function ()
	{
		var listHeight=  $("#colorbox .js-pickup-store-list").height();
		var $listitems= $("#colorbox .js-pickup-store-list > li");
		var listItemHeight = $listitems.height();
		var displayCount = 5;
		var totalCount= $listitems.length;
		var curPos=0
		var pageEndPos = (((totalCount/displayCount)-1) * (displayCount*listItemHeight)) * -1;


		$("#colorbox .js-pickup-store-pager-item-all").html(totalCount);

		$("#colorbox .store-navigation-pager").show();



		checkPosition()

		$(document).on("click","#colorbox .js-pickup-store-pager-prev",function(e){
			e.preventDefault();
			$listitems.css("transform","translateY("+(curPos+listHeight)+"px)")
			curPos = curPos+listHeight;
			checkPosition("prev");
		})

		$(document).on("click","#colorbox .js-pickup-store-pager-next",function(e){
			e.preventDefault();
			$listitems.css("transform","translateY("+(curPos-listHeight)+"px)")
			curPos = curPos-listHeight;
			checkPosition("next");
		})

		function checkPosition(){

			var curPage = Math.ceil((curPos/(displayCount*listItemHeight))*-1)+1;
			$("#colorbox .js-pickup-store-pager-item-from").html(curPage*displayCount-4);

			var tocount = (curPage*displayCount > totalCount)? totalCount :curPage*displayCount;

			if(curPage*displayCount-4 == 1){
				$("#colorbox .js-pickup-store-pager-prev").hide()
			}else{
				$("#colorbox .js-pickup-store-pager-prev").show()
			}

			if(curPage*displayCount >= totalCount){
				$("#colorbox .js-pickup-store-pager-next").hide()
			}else{
				$("#colorbox .js-pickup-store-pager-next").show()
			}


			$("#colorbox .js-pickup-store-pager-item-to").html(tocount);
		}
	},



	bindPickupInStoreQuantity:function(){
		$('.pdpPickupQtyPlus').click(function(e){
			e.preventDefault();

			var inputQty = $('.js-add-pickup-cart #pdpPickupAddtoCartInput');
			var currentVal = parseInt(inputQty.val());
			var maxVal = inputQty.data('max');

			if (!isNaN(currentVal) && currentVal < maxVal) {
				inputQty.val(currentVal + 1);
				inputQty.change();
			}
		});

		$('.pdpPickupQtyMinus').click(function(e){
			e.preventDefault();
			var inputQty = $('.js-add-pickup-cart #pdpPickupAddtoCartInput');
			var currentVal = parseInt(inputQty.val());
			var minVal = inputQty.data('min');

			if (!isNaN(currentVal) && currentVal > minVal) {
				inputQty.val(currentVal - 1);
				inputQty.change();
			}
		});

		$("body").on("keyup", ".js-add-pickup-cart #pdpPickupAddtoCartInput", function(event) {
			var input = $(event.target);
			input.val(this.value.match(/[0-9]*/));
			var value = input.val();
		});
	},

	bindPickupInStoreSearch: function ()
	{
		$(document).on('click', '#pickupstore_location_search_button', function (e)
		{
			ACC.pickupinstore.locationSearchSubmit($('#locationForSearch').val(), $('#atCartPage').val(), $('#entryNumber').val(), $(this).parents('form').attr('action'));
			return false;
		});

		$(document).on('keypress', '#locationForSearch', function (e)
		{
			if (e.keyCode === 13)
			{
				e.preventDefault();
				ACC.pickupinstore.locationSearchSubmit($('#locationForSearch').val(), $('#atCartPage').val(), $('input.entryNumber').val(), $(this).parents('form').attr('action'));
				return false;
			}
		});
	},

	bindPickupHereInStoreButtonClick: function ()
	{
		$(document).on('click','.pickup_add_to_bag_instore_button', function (e){
			$(this).prev('.hiddenPickupQty').val($('#pickupQty').val());
		});

		$(document).on('click','.pickup_here_instore_button', function (e){
			$(this).prev('.hiddenPickupQty').val($('#pickupQty').val());
			ACC.colorbox.close();
		});
	},

	locationSearchSubmit: function (location, cartPage, entryNumber, productCode, latitude, longitude)
	{
		$("#colorbox .js-add-to-cart-for-pickup-popup, #colorbox .js-qty-selector-minus, #colorbox .js-qty-selector-input, #colorbox .js-qty-selector-plus").attr("disabled","disabled");

		$.ajax({
			url: productCode,
			data: {locationQuery: location, cartPage: cartPage, entryNumber: entryNumber, latitude: latitude, longitude: longitude},
			type: "post",
			success: function (response)
			{
				ACC.pickupinstore.refreshPickupInStoreColumn(response);
			}
		});
	},

	createListItemHtml: function (data,id){

		var item="";
		item+='<li class="pickup-store-list-entry">';
		item+='<input type="radio" name="storeNamePost" value="'+data.displayName+'" id="pickup-entry-'+id+'" class="js-pickup-store-input" data-id="'+id+'">';
		item+='<label for="pickup-entry-'+id+'" class="js-select-store-label">';
		item+='<span class="pickup-store-info">';
		item+='<span class="pickup-store-list-entry-name">'+data.displayName+'</span>';
		item+='<span class="pickup-store-list-entry-address">'+data.line1+' '+data.line2+'</span>';
		item+='<span class="pickup-store-list-entry-city">'+data.town+'</span>';
		item+='</span>';
		item+='<span class="store-availability">';
		item+='<span class="available">'+data.formattedDistance+'<br>'+data.stockPickup+'</span>';
		item+='</span>';
		item+='</label>';
		item+='</li>';

		return item;
	},

	refreshPickupInStoreColumn: function (data){
		data = $.parseJSON(data);
		var listitems = "";

		$("#colorbox .js-pickup-component").data("data",data);

		for(i = 0;i < data["data"].length;i++){
			listitems += ACC.pickupinstore.createListItemHtml(data["data"][i],i)
		}

		$('#colorbox .js-pickup-store-list').html(listitems);
		ACC.pickupinstore.unbindPickupPaginationResults()
		ACC.pickupinstore.bindPickupPaginationResults()

		// select the first store
		var firstInput= $("#colorbox .js-pickup-store-input")[0];
		$(firstInput).click();


		$("#colorbox .js-add-to-cart-for-pickup-popup, #colorbox .js-qty-selector-minus, #colorbox .js-qty-selector-input, #colorbox .js-qty-selector-plus").removeAttr("disabled");


	},

	bindClickPickupInStoreButton :function()
	{


		$(document).on("click",".js-pickup-in-store-button",function(e){
			e.preventDefault();
			var ele = $(this);
			var productId = "pickupModal_" + $(this).attr('id');
			var cartItemProductPostfix = '';
			var productIdNUM = $(this).attr('id');
			productIdNUM = productIdNUM.split("_");
			productIdNUM = productIdNUM[1];

			if (productId !== null)
			{
				cartItemProductPostfix = '_' + productId;
			}

			var boxContent =  $("#popup_store_pickup_form > #pickupModal").clone();
			var titleHeader = $('#pickupTitle > .pickup-header').html();


			ACC.colorbox.open(titleHeader,{
				html:boxContent,
				width:"960px",
				onComplete: function(){

					$("#colorbox .js-add-to-cart-for-pickup-popup, #colorbox .js-qty-selector-minus, #colorbox .js-qty-selector-input, #colorbox .js-qty-selector-plus").attr("disabled","disabled");


					boxContent.show();
					ACC.pickupinstore.pickupStorePager();
					var tabs = $("#colorbox .js-pickup-tabs").accessibleTabs({
						tabhead:'.tabhead',
						tabbody: '.tabbody',
						fx:'show',
						fxspeed: 0,
						currentClass: 'active',
						autoAnchor:true,
						cssClassAvailable:true
					});

					$("#colorbox #pickupModal *").each(function ()
					{
						if($(this).attr("data-id")!= undefined)
						{
							$(this).attr("id", $(this).attr("data-id"));
							$(this).removeAttr("data-id");
						}
					});

					$("#colorbox input#locationForSearch").focus();

					// set a unique id
					$("#colorbox #pickupModal").attr("id", productId);

					// insert the product image
					$("#colorbox #" + productId + " .thumb").html(ele.data("img"));

					// insert the product cart details
					$("#colorbox #" + productId + " .js-pickup-product-price").html(ele.data("productcart"));


					var variants=ele.data("productcartVariants");
					var variantsOut="";

					$.each(variants,function(key,value){

						variantsOut += "<span>"+value+"</span>";

					})

					$("#colorbox #" + productId + " .js-pickup-product-variants").html(variantsOut);


					// insert the product name
					$("#colorbox  #" + productId + " .js-pickup-product-info").html(ele.data("productname"))

					// insert the form action
					$("#colorbox #" + productId + " form.searchPOSForm").attr("action", ele.data("actionurl"));

					// set a unique id for the form
					$("#colorbox #" + productId + " form.searchPOSForm").attr("id", "pickup_in_store_search_form_product_" + productIdNUM);

					// set the quantity, if the quantity is undefined set the quantity to the data-value defined in the jsp
					$("#colorbox #" + productId + " #pdpPickupAddtoCartInput").attr("value", ($('#pdpPickupAddtoCartInput').val() !== undefined ? $('#pdpPickupAddtoCartInput').val() : ele.data("value")));
					// set the entry Number
					$("#colorbox #" + productId + " input#entryNumber").attr("value", ele.data("entrynumber"));
					// set the cartPage bolean
					$("#colorbox #" + productId + " input#atCartPage").attr("value", ele.data("cartpage"));

					
					if(navigator.geolocation){
						navigator.geolocation.getCurrentPosition(
							function (position){
								ACC.pickupinstore.locationSearchSubmit('', $('#atCartPage').val(),  ele.data("entrynumber"), ele.data("actionurl"),position.coords.latitude, position.coords.longitude);
							},
							function (error){
									console.log("An error occurred... The error code and message are: " + error.code + "/" + error.message);
							}
						);
					}
					
					ACC.product.bindToAddToCartStorePickUpForm();

					
				}

			});

		})
	},

	pickupStorePager:function()
	{
		$(document).on("change","#colorbox .js-pickup-store-input",function(e){
			e.preventDefault();


			$("#colorbox .js-pickup-tabs li.first a").click();

			var storeData=$("#colorbox .js-pickup-component").data("data");
			storeData=storeData["data"];

			var storeId=$(this).data("id");

			var $ele = $("#colorbox .display-details");


			$.each(storeData[storeId],function(key,value){
				if(key=="url"){
					if(value!=""){
						$ele.find(".js-store-image").html('<img src="'+value+'" alt="" />');
					}else{
						$ele.find(".js-store-image").html('');
					}
				}else if(key=="productcode"){
					$ele.find(".js-store-productcode").val(value);
				}
				else if(key=="openings"){
					if(value!=""){
						var $oele = $ele.find(".js-store-"+key);
						var openings = "";
						$.each(value,function(key2,value2){
							openings += "<dt>"+key2+"</dt>";
							openings += "<dd>"+value2+"</dd>";
						});

						$oele.html(openings);

					}else{
						$ele.find(".js-store-"+key).html('');
					}

				}
				else if(key=="specialOpenings"){}
				else{
					if(value!=""){
						$ele.find(".js-store-"+key).html(value);
					}else{
						$ele.find(".js-store-"+key).html('');
					}
				}

			})





			$(document).one("click", "#colorbox .js-pickup-map-tab",function(){
				ACC.pickupinstore.storeId = storeData[storeId];
				ACC.global.addGoogleMapsApi("ACC.pickupinstore.drawMap");
			})

			
			

			var e=$("#colorbox .pickup-store-list-entry input:checked");


			$("#add_to_cart_storepickup_form .js-store-id").attr("id",e.attr("id"))
			$("#add_to_cart_storepickup_form .js-store-id").attr("name",e.attr("name"))
			$("#add_to_cart_storepickup_form .js-store-id").val(e.val())

			if(storeData[storeId]["stockLevel"] > 0 || storeData[storeId]["stockLevel"] == "")
			{
				var input = $("#add_to_cart_storepickup_form .js-qty-selector-input");
				input.data("max",storeData[storeId]["stockLevel"]); 
				ACC.productDetail.checkQtySelector(input, "reset");
				$("#add_to_cart_storepickup_form").show()
				
			} else{
				$("#add_to_cart_storepickup_form").hide()
			}


		})

		$(document).on("click",".js-select-store-label",function(e){
			$("#colorbox .js-pickup-component").addClass("show-store");
			$("#colorbox #cboxTitle .headline-inner").addClass('hidden-xs hidden-sm');
			$("#colorbox #cboxTitle .back-to-storelist").removeClass('hidden-xs hidden-sm');
		})

		$(document).on("click",".js-back-to-storelist",function(e){
			$("#colorbox .js-pickup-component").removeClass("show-store");
			$("#colorbox #cboxTitle .headline-inner").removeClass('hidden-xs hidden-sm');
			$("#colorbox #cboxTitle .back-to-storelist").addClass('hidden-xs hidden-sm');
		})

	},


	bindPickupButton : function(){
		$(document).on("click",".js-pickup-button",function(e){
			e.preventDefault();
			$e = $(this).parent().nextAll(".js-inline-layer")
			$e.addClass("open")

			//$e.height($e.height())
			var h= $e.height()
			$e.removeClass("open")

			$e.animate({
				height: h
			})
		})
	},


	bindPickupClose : function(){
		$(document).on("click",".js-close-inline-layer",function(e){
			e.preventDefault();
			$e = $(this).parents(".js-inline-layer")

			$e.animate({
				height: 0
			})
		})
	},
	
	checkIfPointOfServiceIsEmpty: function (cartEntryDeliveryModeForm)
	{
		return (!cartEntryDeliveryModeForm.find('.pointOfServiceName').text().trim().length);
	},
	
	validatePickupinStoreCartEntires: function ()
	{
		var validationErrors = false;
		$("form.cartEntryShippingModeForm").each(function ()
		{
			var formid = "#" + $(this).attr('id');
			if ($(formid + ' input[value=pickUp][checked]').length && ACC.pickupinstore.checkIfPointOfServiceIsEmpty($(this)))
			{
				$(this).addClass("shipError");
				validationErrors = true;
			}
		});

		if (validationErrors)
		{
			$('div#noStoreSelected').show().focus();
			$(window).scrollTop(0);
		}
		return validationErrors;
	},

	
	drawMap: function(){

		storeInformation = ACC.pickupinstore.storeId;

		if($("#colorbox .js-map-canvas").length > 0)
		{			


			$("#colorbox .js-map-canvas").attr("id","pickup-map")
			var centerPoint = new google.maps.LatLng(storeInformation["storeLatitude"], storeInformation["storeLongitude"]);
			
			var mapOptions = {
				zoom: 13,
				zoomControl: true,
				panControl: true,
				streetViewControl: false,
				mapTypeId: google.maps.MapTypeId.ROADMAP,
				center: centerPoint
			}
			
			var map = new google.maps.Map(document.getElementById("pickup-map"), mapOptions);
			
			var marker = new google.maps.Marker({
				position: new google.maps.LatLng(storeInformation["storeLatitude"], storeInformation["storeLongitude"]),
				map: map,
				title: storeInformation["name"],
				icon: "https://maps.google.com/mapfiles/marker" + 'A' + ".png"
			});
			var infowindow = new google.maps.InfoWindow({
				content: storeInformation["name"],
				disableAutoPan: true
			});
			google.maps.event.addListener(marker, 'click', function (){
				infowindow.open(map, marker);
			});
		}
		
	}

};
ACC.product = {

    _autoload: [
        "bindToAddToCartForm",
        "enableStorePickupButton",
        "enableVariantSelectors",
        "bindFacets",
        ["checkWhatsNewCookie", ACC.pageName === "productDetails"]
    ],
    
    closeOpenFacet: function(){
    	$(document).click(function(){
    		$(".js-facet").removeClass("active");
        });
    	
    	$(document).on("click", ".js-product-facet .js-facet .collapseFilter", function (e) {
            e.stopPropagation();
    	});
    	
    	$('.js-product-facet .js-facet ').keyup(function (e) {
    		 var key = e.which;
    		 if(key === 13 || key ===32)  // the enter and space key code
    		 {
    		    $(this).click();
    		    return false;  
    		 }
    	}); 
    	
    	ACC.product.plpFacetLabelKeyup();
    },
    
    plpFacetLabelKeyup: function(){
    	$('.js-product-facet .facet__list__label').keyup(function (e) {
	   		 var key = e.which;
	   		 if(key === 13 || key ===32)  // the enter and space key code
	   		 {
	   		    $(this).click();
	   		    return false;  
	   		 }
	   	});
    },
    
    toggleFacets: function(){
    	$(document).on("click", ".js-product-facet .js-facet", function (e) {
            e.preventDefault();
            e.stopPropagation();
            if(!$(this).hasClass("active")){
            	$(".js-facet").removeClass("active");
            	ACC.global.setAria("expanded", $(".js-facet .js-facet-name"), false);
            	$(this).addClass("active");
            	ACC.global.setAria("expanded", $(this).find(".js-facet-name"), true);
            }
            else {
            	$(this).toggleClass("active");
            	ACC.global.setAria("expanded", $(this).find(".js-facet-name"), false);
            }
            
            if ($(this).parents('#colorbox').length)
            	$.colorbox.resize();
        });
    	
        $(document).on("click", ".js-show-facets", function (e) {
            e.preventDefault();
            var selectRefinementsTitle = $(this).data("selectRefinementsTitle");
            ACC.colorbox.open(selectRefinementsTitle, {
                href: ".js-product-facet",
                inline: true,
                width: "480px"
            });
        });
    },

    bindFacets: function () {
    	
    	$(".js-facet .js-facet-name").attr('tabindex', 0).attr('aria-expanded', false).attr("role", "combobox");
    	$(".facet__list__label").attr('tabindex', 0);
    	$(".facet__list__checkbox").attr('tabindex', -1);

    	ACC.product.closeOpenFacet();
    	
    	ACC.product.toggleFacets();
    	
        enquire.register("screen and (min-width:" + screenSmMax + ")", function () {
            $("#cboxClose").click();
        });
    },


    enableAddToCartButton: function () {
        $('.js-enable-btn').each(function () {
            if (!($(this).hasClass('outOfStock') || $(this).hasClass('out-of-stock'))) {
                $(this).removeAttr("disabled");
            }
        });
    },

    enableVariantSelectors: function () {
        $('.variant-select').removeAttr("disabled");
    },

    bindToAddToCartForm: function () {
    	var addToCartForm = $('.add_to_cart_form');
        ACC.validateForm.validatePdpAddToCartForm($('.js-pdpQtyForm'));
        addToCartForm.ajaxForm({
        	beforeSubmit: function(){
        		var qtyField = addToCartForm.find(".js-qty-selector-input");
        		var productCode = addToCartForm.find("[name=productCodePost]");
        		var allow = false;
        		if( qtyField.length > 0 ){
	        		allow = true;
        			if( ACC.browserDetect.isAndroid() ){
        				allow = $('.js-pdpQtyForm').valid();
	        		}
	        		
        			var qty = qtyField.val();
        			if ( allow && qty.length > 0 && parseInt(qty) > 0 ){
	        			if( ACC.product.safetyNetDisplay(productCode.val(),qty, "PDP")){
	        				$("#safetyNetModal").modal();
	        				ACC.cartitem.confirmSafetyNet(addToCartForm, "PDP");
	    					ACC.cartitem.updateSafetyNet($('.js-pdpQtyForm').find(".js-qty-selector-input"));
	    					allow = false;
	        			}
	        		}else{
	        			allow = false;
	        		}
        		}
        		return allow;
        	},
        	success: ACC.product.displayAddToCartPopup
        });
    },

    bindToAddToCartStorePickUpForm: function () {
        var addToCartStorePickUpForm = $('#colorbox #add_to_cart_storepickup_form');
        addToCartStorePickUpForm.ajaxForm({success: ACC.product.displayAddToCartPopup});
    },

    enableStorePickupButton: function () {
        $('.js-pickup-in-store-button').removeAttr("disabled");
    },

    displayAddToCartPopup: function (cartResult, statusText, xhr, formElement) {
        $('#addToCartLayer').remove();

        if (typeof ACC.minicart.updateMiniCartDisplay == 'function') {
            ACC.minicart.updateMiniCartDisplay();
        }
        var titleHeader = $('#addToCartTitle').html();

        var productCode = $('[name=productCodePost]', formElement).val();
        var quantityField = $('[name=qty]', formElement).val();

        var quantity = 1;
        if (quantityField != undefined) {
            quantity = quantityField;
        }

        var cartAnalyticsData = cartResult.cartAnalyticsData;
        
        var productType = "";
        if( formElement.find("[name=isMhc]").length > 0 ){
        	productType = ACC.mustHaveCarousel;
        }else{
        	if( formElement.find("[name=isWnc]").length > 0 && formElement.find("[name=isWnc]").val() === "true" ){
        		productType = ACC.whatsNewCarousel;
        	}
        }
        
        var productSku = "";
        if( formElement.find("[name=productSku]").length > 0 ){
        	productSku = formElement.find("[name=productSku]").val();
        }
        
        var cartData = {
            "cartCode": cartAnalyticsData.cartCode,
            "productCode": productCode, 
            "quantity": quantity,
            "productSku": productSku,
            "productPrice": cartAnalyticsData.productPostPrice,
            "productName": cartAnalyticsData.productName,
            "type": productType
        };
        ACC.track.trackAddToCart(productCode, quantity, cartData);
        
        if( formElement.closest(".do-not-forget").length ){
			window.location.href = ACC.config.encodedContextPath + "/cart";
		}else{
			ACC.colorbox.open(titleHeader, {
	            html: cartResult.addToCartLayer,
	            width: "460px",
	            onComplete: function(){
	            	ACC.productDetail.pdpSpinnerDisplay(false);
	            }
	        });
		}
    },
    
    safetyNetDisplay: function(productCode,newCartQuantity, callFrom) {
		var safetyNetReturn;
		$.ajax({
			url: ACC.config.encodedContextPath + "/cart/safetyNet", 
			data: {"productCode":productCode, "productQuantity": +newCartQuantity},
			method: "GET",
			async: false,
			success: function(flg){
				safetyNetReturn = flg;
	    	}
	    });
		if( callFrom === "PDP" ){
			return safetyNetReturn;
		}
	},
	
	checkWhatsNewCookie: function(){
		$("[name=isWnc]").val("false");
		var pgnmVal = localStorage.getItem('pgnm');
		if( pgnmVal === "wnc" ){
			$("[name=isWnc]").val("true");
			localStorage.removeItem('pgnm');
		}
	}
};

$(document).ready(function () {
    ACC.product.enableAddToCartButton();
});

ACC.productDetail = {

    _autoload: [
        "initPageEvents",
        "bindVariantOptions",
        ["bindProductPrice", $(".js-pdp-price-button").length > 0],
        ["showProductOffer", $(".js-pdp-product-offer").length > 0],
        ["showProductListOffers", $(".js-plp-product-code").length > 0],
        "callArticleDetailLoad"
    ],
    mode:null,
    
    bindProductPrice: function(){
    	ACC.productDetail.callProductPrice();
    	$(".js-pdp-price-button").on("click", function(){
    		ACC.productDetail.callProductPrice();
    	})
    },
    
    callProductPrice: function(){
		ACC.productDetail.getProductPrice();
		ACC.productDetail.pdpSpinnerDisplay(true);
    },
    
    getProductPrice : function(){
		var qty = $("#pdpAddtoCartInput").val();
		var pCode = $(".js-product-code").val();
		var isEmpty = $(".js-is-empty-return").val();
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/p/productPrice",
    		method: "POST",
    		data: {"productCode": pCode,"quantity":qty,"isEmptyReturn":isEmpty},
    		dataType: "json",
    		success: function(data, textStatus, jqXHR){
    			$(".js-pdp-price-error").addClass("display-none");
    			if( typeof(data.isPriceError) !== "undefined" && data.isPriceError !== null && data.isPriceError ){
    				//show error
    				$(".js-pdp-price-error").removeClass("display-none");
    				$('body, html').animate({
    					scrollTop: $(".js-pdp-price-error").offset().top
    				}, 500);
    			}
    			else if( typeof(data.productPrice) !== "undefined" && data.productPrice !== null ){
    				// display price
    				if(isEmpty === "true"){
    					$(".js-unit-price").removeClass("display-none").find(".price").text("-"+data.productPrice.formattedValue);
    				}else {
    					$(".js-unit-price").removeClass("display-none").find(".price").text(data.productPrice.formattedValue);
    				}
    				ACC.productDetail.hideGetPriceButton();
    			}
    			
    			if( $(".debug").length ){
    				$(".debug").append($("<span></span>").addClass("hide").text("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]"));
    			}
    		},
    		error: function(jqXHR, textStatus, errorThrown){
    			if( $(".debug").length ){
            		$(".debug").append($("<span></span>").addClass("hide").text("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]"));
            	}
    		},
    		complete: function(jqXHR, textStatus){
    			ACC.productDetail.pdpSpinnerDisplay(false);
    			if( $(".debug").length ){
            		$(".debug").append( $(".debug").children().clone().text("Response completed. Details [" + textStatus + "]"));
            	}
    		}
		});
    },
    
    showGetPriceButton: function(){
    	$(".js-pdp-price-error, .js-unit-price").addClass("display-none");
    	$(".js-pdp-price-button").removeClass("display-none");
    },
    hideGetPriceButton: function(){
    	// hide price button
    	$(".js-pdp-price-button").addClass("display-none");
    },
    checkQtySelector: function (self, mode) {
        var input = $(self).parents(".js-qty-selector").find(".js-qty-selector-input");
        var inputVal = parseInt(input.val());
        var max = input.data("max");
        var minusBtn = $(self).parents(".js-qty-selector").find(".js-qty-selector-minus");
        var plusBtn = $(self).parents(".js-qty-selector").find(".js-qty-selector-plus");

        $(self).parents(".js-qty-selector").find(".btn").removeAttr("disabled");

        if (mode == "minus") {
        	ACC.productDetail.clickMinusButton(inputVal, self, minusBtn);
        } else if (mode == "reset") {
            ACC.productDetail.updateQtyValue(self, 0)
        } else if (mode == "plus") {
        	ACC.productDetail.clickPlusButton(+ACC.maxProductQuantity, self, inputVal, plusBtn);
        } else if (mode == "input") {
        	ACC.productDetail.inputQtySelector(inputVal, minusBtn, max, self, plusBtn);
        } else if (mode == "focusout" && isNaN(inputVal)) {
        	ACC.productDetail.focusoutQtySelector(self, minusBtn);
        }

    },
    
    focusoutQtySelector: function(self, minusBtn){
    	ACC.productDetail.updateQtyValue(self, 0);
        minusBtn.attr("disabled", "disabled");
        if( $(self).siblings(".popover").length > 0 ){
			$(self).siblings(".popover").remove();
		}
    },
    
    clickMinusButton: function(inputVal, self, minusBtn){
        if (inputVal != 0) {
        	ACC.productDetail.mode = "minus";
            ACC.productDetail.updateQtyValue(self, inputVal - 1)
            if (inputVal - 1 == 0) {
                minusBtn.attr("disabled", "disabled")
            }
        } else {
            minusBtn.attr("disabled", "disabled")
        }
    },

    clickPlusButton: function(max, self, inputVal, plusBtn){
    	if(max == "FORCE_IN_STOCK") {
    		ACC.productDetail.mode = "plus";
    		ACC.productDetail.updateQtyValue(self, inputVal + 1)
    	} else if (inputVal < max) {
    		ACC.productDetail.mode = "plus";
            ACC.productDetail.updateQtyValue(self, inputVal + 1)
            if (inputVal + 1 == max) {
                plusBtn.attr("disabled", "disabled")
            }
        } else {
            plusBtn.attr("disabled", "disabled")
        }
    },
    
    inputQtySelector: function(inputVal, minusBtn, max, self, plusBtn){
    	ACC.productDetail.mode = "input";
        if (inputVal == 0) {
            minusBtn.attr("disabled", "disabled")
        } else if(max == "FORCE_IN_STOCK" && inputVal >= 0) {
        	ACC.productDetail.updateQtyValue(self, inputVal)
        } else if (inputVal == max) {
            plusBtn.attr("disabled", "disabled")
        } else if (inputVal < 0) {
            ACC.productDetail.updateQtyValue(self, 0)
            minusBtn.attr("disabled", "disabled")
        } else if (inputVal > max) {
            ACC.productDetail.updateQtyValue(self, max)
            plusBtn.attr("disabled", "disabled")
        }
    },

    updateQtyValue: function (self, value) {
        var input = $(self).parents(".js-qty-selector").find(".js-qty-selector-input");
        var addtocartQty = $(self).parents(".addtocart-component").find(".js-addToCartForm").find(".js-qty-selector-input");
        if( ACC.productDetail.mode != null && (ACC.productDetail.mode == "minus" || ACC.productDetail.mode == "plus" )){
        input.val(value);
        	ACC.productDetail.mode = null;
        }
        addtocartQty.val(value);
    }, 

    initPageEvents: function () {
        // Moved to acc.common.js
        $("#Size").change(function () {
            changeOnVariantOptionSelection($("#Size option:selected"));
        });

        $("#variant").change(function () {
            changeOnVariantOptionSelection($("#variant option:selected"));
        });

        $(".selectPriority").change(function () {
            window.location.href = $(this[this.selectedIndex]).val();
        });

        function changeOnVariantOptionSelection(optionSelected) {
            window.location.href = optionSelected.attr('value');
        }
        
        $(".js-pdp-logintobuy,.js-BecomePepsicoPartner-BannerComponent").on("click", function(){
    		window.location.href = ACC.config.encodedContextPath + "/partner/leadgeneration";
    	});
        
    },

    bindVariantOptions: function () {
        ACC.productDetail.bindCurrentStyle();
        ACC.productDetail.bindCurrentSize();
        ACC.productDetail.bindCurrentType();
    },

    bindCurrentStyle: function () {
        var currentStyle = $("#currentStyleValue").data("styleValue");
        var styleSpan = $(".styleName");
        if (currentStyle != null) {
            styleSpan.text(": " + currentStyle);
        }
    },

    bindCurrentSize: function () {
        var currentSize = $("#currentSizeValue").data("sizeValue");
        var sizeSpan = $(".sizeName");
        if (currentSize != null) {
            sizeSpan.text(": " + currentSize);
        }
    },

    bindCurrentType: function () {
        var currentSize = $("#currentTypeValue").data("typeValue");
        var sizeSpan = $(".typeName");
        if (currentSize != null) {
            sizeSpan.text(": " + currentSize);
        }
    },
   
	androidResetInitial: function(el, source){
		if( ACC.browserDetect.isAndroid() && (el.val().length > 0) && (! /^[0-9]+$/.test(el.val()) ) ){
    		var sourceEl;
			switch (source) {
			case "PDP":
				sourceEl = el.closest(".addtocart-component").find(".js-addToCartForm").find(".js-qty-selector-input");
				break;
			case "CART":
				sourceEl = el.closest('form').find('input[name=initialQuantity]');
				break;
			default:
				sourceEl = el;
				break;
			}
			el.val( sourceEl.val() ) ;
        }
	},
	
	pdpSpinnerDisplay: function(display){
		if( $("#pdpPriceOrderSpinner").length > 0 ){
			if( display ){
				$("#pdpPriceOrderSpinner").removeClass("display-none");
			}else{
				$("#pdpPriceOrderSpinner").addClass("display-none");
			}
		}
	},
	
	showProductOffer : function(){
		var pCode = $(".js-product-code").val();
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/p/productOffer",
    		method: "POST",
    		data: {"productCode": pCode},
    		dataType: "json",
    		success: function(data) {
    			var offerIds = data.offerIds;
    			if( offerIds && offerIds.length > 0 ){
    				// display offer link
    				var offers = offerIds.join('|');
    				$('.js-pdp-product-offer').find('a').each(function() {
    					var offerLink = ACC.config.encodedContextPath + "/campaigns?selected=" + offers;
    					$(this).attr('href', offerLink);
    				});
    				$('.js-pdp-product-offer').removeClass("display-none");
    			}
    		}
		});
    },
    
    showProductListOffers : function(){
		var productCodes = $('.js-plp-product-code').map(function() { return this.value; }).get();
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/p/productsOffers",
    		method: "POST",
    		data: {"productCodes": productCodes},
    		dataType: "json",
    		traditional: true,
    		success: function(data) {
    			if( typeof(data) !== "undefined" && data.length > 0 ) {
    				data.forEach( function (offerData) {
	    				var productId = offerData.productId;
	    				var offerIds = offerData.offerIds;
	        			if( offerIds && offerIds.length > 0 ){
	        				// display offer link
	        				var offers = offerIds.join('|');
	        				$('.js-plp-offer-'+productId).find('a').each(function() {
	        					var offerLink = ACC.config.encodedContextPath + "/campaigns?selected=" + offers;
	        					$(this).attr('href', offerLink);
	        				});
	        				$('.js-plp-offer-'+productId).removeClass("display-none");
	        			}
					});
    			}
    		}
		});
    },
    
    setImageInDescription: function(urlList){
    	$.each(urlList, function( index, item ) {
	    	var $image = $("<img/>").on("load",function(){
	    		if((window.self !== window.top)) {
	    			window.top.ACC.equipmentservice.resizeIframe();
	    		}
	    	}).attr({"src":item.url});
	    	var $el = $(document).find("span[data-code='"+item.code+"']");
	    	if( $el && $el.length ){
	    		$image.attr("alt", $el.data("title"));
	    		if($el.data("width")){
	    			$image.attr("width",$el.data("width"));
	    		}
	    		if( $el.data("height") ){
	    			$image.attr("height", $el.data("height"));
	    		}
	    		if( $el.data("align") ){
	    			$image.attr("align", $el.data("align"));
	    		}
	    		$el.html($image);
	    	}
    	});
    },
    
    fetchImagesFromAjax: function(imagesJSON){
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/media/images",
    		method: "POST",
    		data: {"codeList": JSON.stringify(imagesJSON)},
    		success: function(data) {
    			if( typeof(data) !== "undefined" && data.length > 0 ) {
    				data = JSON.parse(data);
    				if( data.hasOwnProperty("urlList") && data.urlList.length > 0 ){
    					ACC.productDetail.setImageInDescription(data.urlList);
    				}
    			}
    		},
    		complete:function(){
    			if((window.self !== window.top)) {
	    			window.top.ACC.global.displaySpinner($("#commonSpinner"), false);
	    		}
    		}
		});
    },
    
    getImagesFromAjax: function(){
    	var imagesJSON={items:[]};
    	$(document).find(".js-get-image-from-ajax").each(function(){
    		var code = $(this).data("code");
    		imagesJSON.items.push(code);
    	});
    	if( imagesJSON.items.length > 0 ){
    		if((window.self !== window.top)) {
    			window.top.ACC.global.displaySpinner($("#commonSpinner"), true);
    		}
    		ACC.productDetail.fetchImagesFromAjax(imagesJSON);
    	}
    },
    
    callArticleDetailLoad: function(){
    	ACC.productDetail.getImagesFromAjax();
    }
};

ACC.quickview = {

	_autoload: [
		"bindToUiCarouselLink",
	],
		
		
	initQuickviewLightbox:function(){
		ACC.product.enableAddToCartButton();
		ACC.product.bindToAddToCartForm();
		ACC.product.enableStorePickupButton();
	},
		
	refreshScreenReaderBuffer: function ()
	{
		// changes a value in a hidden form field in order
		// to trigger a buffer update in a screen reader
		$('#accesibility_refreshScreenReaderBufferField').attr('value', new Date().getTime());
	},
	


	bindToUiCarouselLink: function ()
	{
		var titleHeader = $('#quickViewTitle').html();
		$(".js-owl-carousel-reference .js-reference-item").colorbox({
			close:'<span class="glyphicon glyphicon-remove"></span>',
			title: titleHeader,
			maxWidth:"100%",
			onComplete: function ()
			{
				ACC.quickview.refreshScreenReaderBuffer();
				ACC.quickview.initQuickviewLightbox();
				ACC.ratingstars.bindRatingStars($(".quick-view-stars"));
			},

			onClosed: function ()
			{
				ACC.quickview.refreshScreenReaderBuffer();
			}
		});
	}
	
};
ACC.ratingstars = {

	_autoload: [
		["bindRatingStars", $(".js-ratingCalc").length > 0],
		["bindRatingStarsSet", $(".js-ratingCalcSet").length > 0],
		["bindPopupRatingStars", $(".js-popupRatingCalc").length > 0],
		["bindPopupRatingStarsSet", $(".js-popupRatingCalcSet").length > 0]
	],

	
	round: function(value,step){
		step || (step = 1.0);
	    var inv = 1.0 / step;
	    return Math.round(value * inv) / inv;
	},
	
	bindRatingStars: function(){

		$e = $(".js-ratingCalc");

		$e.each(function(){
			var ratingData = $(this).data("rating");
			ratingData.rating = ACC.ratingstars.round(ratingData.rating, 0.5); 
			var $ratingIcon = $(this).find(".js-ratingIcon");
			var $clonelh;

			for (var i = 1; i <= ratingData.total; i++) {
				var $clone = $ratingIcon.clone().removeClass("js-ratingIcon");
				
				// adds the active class to the stars that are less than or equal than the current rating
			
				if(i <= ratingData.rating){
					$clone.addClass("active")
				}

				// divides the icons for the half rating points
				if((i-0.5) == ratingData.rating){
					$clone.addClass("active fh")
					$clonelh = $ratingIcon.clone().removeClass("js-ratingIcon");
					$clonelh.addClass("lh")
				}
				

				// inert the rating icons in the dom
				$clone.insertBefore($ratingIcon);
				if($clonelh){
					$clonelh.insertBefore($ratingIcon);
					$clonelh=null
				}
			}
			// delete the template icon
			$ratingIcon.remove()
		})
	},
	bindRatingStarsSet: function(){

		$e = $(".js-ratingCalcSet");


		$e.on("mouseenter",".js-rationIconSet",function(e){
			e.preventDefault();
			$(this).parent().children().removeClass("active")
			var cindex =  $(this).index()+1;
			var $i = $(this).parent().children(".js-rationIconSet:lt("+cindex+")")
			$i.addClass("active")
		})


		$(document).on("mouseleave",".js-ratingCalcSet",function(e){
			e.preventDefault();

			$(this).find(".js-rationIconSet").removeClass("active")
			var rating = $(".js-ratingSetInput").val();
			var $i = $(this).find(".js-rationIconSet:lt("+rating*2+")")
			$i.addClass("active")
		})

		$e.on("click",".js-rationIconSet",function(e){
			e.preventDefault();
			$e1= $(".js-ratingCalcSet");
			var ratingData = $e1.data("rating");
			var cindex =  $(this).index()+1;
			ratingData.rating = cindex/2;
			$(".js-ratingSetInput").val(ratingData.rating);
			$(".submitData").prop('disabled',false);
		})

		$e.each(function(){
			var ratingData = $(this).data("rating");
			var $ratingIcon = $(this).find(".js-ratingIcon");
			var $clonelh;

			for (var i = 1; i <= ratingData.total; i++) {
				var $clone = $ratingIcon.clone().removeClass("js-ratingIcon");
				
				// divides the icons for the half rating points
				$clone.addClass("fh")
				$clonelh = $ratingIcon.clone().removeClass("js-ratingIcon");
				$clonelh.addClass("lh")
				
			
				// inert the rating icons in the dom
				$clone.insertBefore($ratingIcon);
				if($clonelh){
					$clonelh.insertBefore($ratingIcon);
					$clonelh=null
				}
			}
			// delete the template icon
			$ratingIcon.remove()
		})
	},
	
	bindPopupRatingStars: function(){

		$e = $(".js-popupRatingCalc");

		$e.each(function(){
			var ratingData = $(this).data("rating");
			var $ratingIcon = $(this).find(".js-ratingIcon");
			var $clonelh;

			for (var i = 1; i <= ratingData.total; i++) {
				var $clone = $ratingIcon.clone().removeClass("js-ratingIcon");
				
				// adds the active class to the stars that are less than or equal than the current rating
				if(i <= ratingData.rating){
					$clone.addClass("active")
				}

				// divides the icons for the half rating points
				if(i-0.5 == ratingData.rating){
					$clone.addClass("active fh")
					$clonelh = $ratingIcon.clone().removeClass("ratingIcon");
					$clonelh.addClass("lh")
				}
				

				// inert the rating icons in the dom
				$clone.insertBefore($ratingIcon);
				if($clonelh){
					$clonelh.insertBefore($ratingIcon);
					$clonelh=null
				}
			}
			// delete the template icon
			$ratingIcon.remove()
		})
	},
	
	bindPopupRatingStarsSet: function(){

		$e = $(".js-popupRatingCalcSet");


		$e.on("mouseenter",".js-rationIconSet",function(e){
			e.preventDefault();
			$(this).parent().children().removeClass("active")
			var cindex =  $(this).index()+1;
			var $i = $(this).parent().children(".js-rationIconSet:lt("+cindex+")")
			$i.addClass("active")
		})


		$(document).on("mouseleave",".js-popupRatingCalcSet",function(e){
			e.preventDefault();

			$(this).find(".js-rationIconSet").removeClass("active")
			var rating = $(".js-popupRatingSetInput").val();
			var $i = $(this).find(".js-rationIconSet:lt("+rating*2+")")
			$i.addClass("active")
		})

		$e.on("click",".js-rationIconSet",function(e){
			e.preventDefault();
			$e1= $(".js-popupRatingCalcSet");
			var ratingData = $e1.data("rating");
			var cindex =  $(this).index()+1;
			ratingData.rating = cindex/2;
			$(".js-popupRatingSetInput").val(ratingData.rating);
			$(".popupSubmitData").prop('disabled',false);
		})

		$e.each(function(){
			var ratingData = $(this).data("rating");
			var $ratingIcon = $(this).find(".js-ratingIcon");
			var $clonelh;

			for (var i = 1; i <= ratingData.total; i++) {
				var $clone = $ratingIcon.clone().removeClass("js-ratingIcon");
				
				// divides the icons for the half rating points
				$clone.addClass("fh")
				$clonelh = $ratingIcon.clone().removeClass("js-ratingIcon");
				$clonelh.addClass("lh")
				
			
				// inert the rating icons in the dom
				$clone.insertBefore($ratingIcon);
				if($clonelh){
					$clonelh.insertBefore($ratingIcon);
					$clonelh=null
				}
			}
			// delete the template icon
			$ratingIcon.remove()
		})
	}

};
ACC.refinements = {

	_autoload: [
		["bindMoreLessToggles", $(".js-facet-form").length != 0],
		["bindMoreStoresToggles", $(".js-facet-form").length != 0],
		["bindSearch", $(".js-facet-form").length != 0],
	],


	coords:{},
	storeSearchData:{},


	init:function(){
		navigator.geolocation.getCurrentPosition(
			function (position){
				ACC.refinements.coords = position.coords;
			},
			function (error)
			{
				console.log("An error occurred... The error code and message are: " + error.code + "/" + error.message);
			}
		);

	},


	bindSearch:function(){

		$(document).on("submit",'#user_location_form', function(e){
			e.preventDefault()
			var q = $(".js-shop-stores-facet .js-shop-store-search-input").val();
			 if(q.length>0){
				 ACC.refinements.getInitStoreData(q);				
			 }
		})


		$(document).on("click",'#findStoresNearMeAjax', function(e){
			e.preventDefault()
			ACC.refinements.getInitStoreData(null,ACC.refinements.coords.latitude,ACC.refinements.coords.longitude);
		})


	},


	getInitStoreData: function(q,latitude,longitude){
		$(".alert").remove();
		var data ={
			"q":"" ,
			"page":"0"
		}

		if(q != null){
			data.q = q;
		}
		

		if(latitude != null){
			data.latitude = latitude;
		}

		if(longitude != null){
			data.longitude = longitude;
		}

		ACC.refinements.storeSearchData = data;
		ACC.refinements.getStoreData();
	},


	getStoreData: function(){
		var url= $(".js-facet-form").data("url");
		$.ajax({
			url: url,
			data: ACC.refinements.storeSearchData,
			type: "get",
			success: function (){
				window.location.reload();
			}
		});
	},
	
	bindMoreLessToggles: function (){

		$(document).on("click",".js-shop-stores-facet .js-facet-change-link",function(e){
			e.preventDefault();
			$(".js-shop-stores-facet .js-facet-container").hide();
			$(".js-shop-stores-facet .js-facet-form").show();
		})


		$(document).on("change",".js-product-facet .js-facet-checkbox",function(){
			$(this).parents("form").submit();
		})
		
		$(document).on("click",".js-product-facet .js-more-facet-values-link",function(e){
			e.preventDefault();
			$(this).parents(".js-facet").find(".js-facet-top-values").hide();
			$(this).parents(".js-facet").find(".js-facet-list-hidden").show();

			$(this).parents(".js-facet").find(".js-more-facet-values").hide();
			$(this).parents(".js-facet").find(".js-less-facet-values").show();
		})

		$(document).on("click",".js-product-facet .js-less-facet-values-link",function(e){
			e.preventDefault();
			$(this).parents(".js-facet").find(".js-facet-top-values").show();
			$(this).parents(".js-facet").find(".js-facet-list-hidden").hide();

			$(this).parents(".js-facet").find(".js-more-facet-values").show();
			$(this).parents(".js-facet").find(".js-less-facet-values").hide();
		})

	},
	
	bindMoreStoresToggles: function ()
	{
		$(document).on("click",".js-shop-stores-facet .js-more-stores-facet-values",function(e){
			e.preventDefault();
			$(".js-shop-stores-facet ul.js-facet-list li.hidden").slice(0, 5).removeClass('hidden').first().find('.js-facet-checkbox').focus();
			if($(".js-shop-stores-facet ul.js-facet-list li.hidden").length==0){
				$(".js-shop-stores-facet .js-more-stores-facet-values").hide()
			}
		})
		
	}
};

ACC.silentorderpost = {

	spinner: $("<img src='" + ACC.config.commonResourcePath + "/images/spinner.gif' />"),

	bindUseDeliveryAddress: function ()
	{
		$('#useDeliveryAddress').on('change', function ()
		{
			if ($('#useDeliveryAddress').is(":checked"))
			{
				var options = {'countryIsoCode': $('#useDeliveryAddressData').data('countryisocode'), 'useDeliveryAddress': true};
				ACC.silentorderpost.enableAddressForm();
				ACC.silentorderpost.displayCreditCardAddressForm(options, ACC.silentorderpost.useDeliveryAddressSelected);
				ACC.silentorderpost.disableAddressForm();
			}
			else
			{
				ACC.silentorderpost.clearAddressForm();
				ACC.silentorderpost.enableAddressForm();
			}
		});

		if ($('#useDeliveryAddress').is(":checked"))
		{
			var options = {'countryIsoCode': $('#useDeliveryAddressData').data('countryisocode'), 'useDeliveryAddress': true};
			ACC.silentorderpost.enableAddressForm();
			ACC.silentorderpost.displayCreditCardAddressForm(options, ACC.silentorderpost.useDeliveryAddressSelected);
			ACC.silentorderpost.disableAddressForm();
		}
	},

	bindSubmitSilentOrderPostForm: function ()
	{
		$('.submit_silentOrderPostForm').click(function ()
		{
			ACC.common.blockFormAndShowProcessingMessage($(this));
			$('.billingAddressForm').filter(":hidden").remove();
			ACC.silentorderpost.enableAddressForm();
			$('#silentOrderPostForm').submit();
		});
	},

	bindCycleFocusEvent: function ()
	{
		$('#lastInTheForm').blur(function ()
		{
			$('#silentOrderPostForm [tabindex$="10"]').focus();
		})
	},

	isEmpty: function (obj)
	{
		if (typeof obj == 'undefined' || obj === null || obj === '') {
			return true;
		}
		return false;
	},

	disableAddressForm: function ()
	{
		$('input[id^="address\\."]').prop('disabled', true);
		$('select[id^="address\\."]').prop('disabled', true);
	},

	enableAddressForm: function ()
	{
		$('input[id^="address\\."]').prop('disabled', false);
		$('select[id^="address\\."]').prop('disabled', false);
	},

	clearAddressForm: function ()
	{
		$('input[id^="address\\."]').val("");
		$('select[id^="address\\."]').val("");
	},

	useDeliveryAddressSelected: function ()
	{
		if ($('#useDeliveryAddress').is(":checked"))
		{
			$('#address\\.country').val($('#useDeliveryAddressData').data('countryisocode'));
			ACC.silentorderpost.disableAddressForm();
		}
		else
		{
			ACC.silentorderpost.clearAddressForm();
			ACC.silentorderpost.enableAddressForm();
		}
	},
	
	

	bindCreditCardAddressForm: function ()
	{
		$('#billingCountrySelector :input').on("change", function ()
		{
			var countrySelection = $(this).val();
			var options = {
				'countryIsoCode': countrySelection,
				'useDeliveryAddress': false
			};
			ACC.silentorderpost.displayCreditCardAddressForm(options);
		})
	},

	displayCreditCardAddressForm: function (options, callback)
	{
		$.ajax({ 
			url: ACC.config.encodedContextPath + '/checkout/multi/sop/billingaddressform',
			async: true,
			data: options,
			dataType: "html",
			beforeSend: function ()
			{
				$('#billingAddressForm').html(ACC.silentorderpost.spinner);
			}
		}).done(function (data)
				{
					$("#billingAddressForm").html(data);
					if (typeof callback == 'function')
					{
						callback.call();
					}
				});
	}
}

$(document).ready(function ()
{
	with (ACC.silentorderpost)
	{
		bindUseDeliveryAddress()
		bindSubmitSilentOrderPostForm();
		bindCreditCardAddressForm();
	}

	// check the checkbox
	$("#useDeliveryAddress").click();
});

ACC.tabs = {

	_autoload: [
		["bindTabs", $(".js-tabs").length > 0],
		["initializeLoginPopup", $(".login-popup-div").length > 0],
		"hideReviewBtn",
		"determineToDisplayReviews",
		"determineToDisplayRecipeReviews",
		"reloadPage"
		
	],

	bindTabs: function(){

		var $e = $(".js-tabs");
		 var tabs = $e.accessibleTabs({
			tabhead:'.tabhead',
			tabbody: '.tabbody', 
			fx:'show', 
			fxspeed: 0,
			currentClass: 'active', 
			autoAnchor:true
		});
		 ACC.global.footerAlignment() 
		
			
		$e.on("click",".tabhead",function(e){
			e.preventDefault();

			if($(this).hasClass("active")){
				$(this).removeClass("active");
				$(this).find('a').attr('aria-expanded', false);
			}else{
				$(this).parents(".js-tabs").children(".tabs-list").find("a[href="+"#"+$(this).attr("id")+"]").click();

				var offset = $(this).position().top;
				$("body,html").scrollTop(offset)
			}
			
		});
		
		$e.on("click","#tabreview",function(e){
			e.preventDefault();
			ACC.tabs.showReviewsAction("reviews");
		});
		
		$e.on("click",".all-reviews-btn",function(e){
			e.preventDefault();
			ACC.tabs.showReviewsAction("allreviews");
			ACC.tabs.hideReviewBtn(".all-reviews-btn");
			ACC.tabs.showReviewBtn(".less-reviews-btn");
		});
		
		$e.on("click",".less-reviews-btn",function(e){
			e.preventDefault();
			ACC.tabs.showReviewsAction("reviews");
			ACC.tabs.hideReviewBtn(".less-reviews-btn");
			ACC.tabs.showReviewBtn(".all-reviews-btn");
		});
		
		$(document).on("click", '.js-writeReviewTab', function(e){
			e.preventDefault();
			tabs.showAccessibleTabSelector($(this).attr("href"));
			$(".js-review-write").show();
			$('#reviewForm input[name=headline]').focus();
		});
		
		$(document).on("click",".js-review-write-toggle",function(e){
			e.preventDefault();
			if($(".js-review-write:visible").length<1){
				$(".js-review-write").show();

			}else{
				$(".js-review-write").hide();
			}		
		});

		$(document).on("click",".js-openTab",function(){
            tabs.showAccessibleTabSelector($(this).attr("href")); 
		});
	
	},
	
	initializeLoginPopup: function(){
		$(document).ready(function(){
			$('.login-popup-div').click(function(event){
				event.preventDefault();
				event.stopPropagation();
			});
		})
	},
	
	showReviewsAction : function(s) {
		if (s == "allreviews") {
			var loadedReviewCount = $("#loadedReviewCount").val();
			if (loadedReviewCount != undefined)
				loadedReviewCount = parseInt(loadedReviewCount) + 4;
			var url = $("#reviews").data("allreviews") + loadedReviewCount;
			$.get(url, function(result) {
				$('#reviews').html(result);
				if ($(".js-ratingCalc").length > 0) {
					ACC.ratingstars.bindRatingStars();
					ACC.tabs.showingAllReviews();
				}
			});
		} else{
			if( $("#reviews").length > 0 && $("#reviews").data(s) !== "" ){
			$.get($("#reviews").data(s), function(result) {
				$('#reviews').html(result);
				if ($(".js-ratingCalc").length > 0) {
					ACC.ratingstars.bindRatingStars();
					ACC.tabs.showingAllReviews();
				}
			});
			}
		}
	},
	
	hideReviewBtn: function (btnClass){

		btnClass = (btnClass == undefined)? ".less-reviews-btn" : btnClass;
		$(btnClass).hide();
		 $('.articleComments #reviewComment').on("keyup", ACC.tabs.enableaction);
		
	},
	
	showReviewBtn: function (btnClass){
		$(btnClass).show();

	},
	
	showingAllReviews: function()
	{
		var isShowingAllReviews = $("#showingAllReviews").data("showingallreviews");
		if(isShowingAllReviews){
			ACC.tabs.hideReviewBtn(".all-reviews-btn");
		}
	},
	
	determineToDisplayReviews: function ()
	{
		if(location.hash == "#tabreview"){
			ACC.tabs.showReviewsAction('reviews');
		}
	},
	
	
	submitBannerLoginForm : function() {
			
			var j_username = $("#j_username").val();
			var j_password = $("#j_password").val();
			$.ajax({
					type : "POST",
					url : $("#loginForm").attr('action'),
					data : {
						j_username : j_username,
						j_password : j_password
					},
					async : false,
					success : function(result) {
						var $response = $(result);
						var loginErrorFound = $response.find('#loginError').val();
						if (loginErrorFound){
							$("#banner-error").show();
							setTimeout(function(){
								$('.login-popup-div').addClass('js-nav-order-tools--active');
							})
						}
						else {
							location.reload();
						}
					},
			});
		},
		
		submitNewsletter : function() {
			var url = $("#dismissUrl").val();
			$.ajax({
					type : "GET",
					url : url,
					success : function(result) {
						$("#sticky-subscribe").css("display","none");
						var $response = $(result);
					},
			});
		},
		
		determineToDisplayRecipeReviews : function() {
			ACC.tabs.showReviewsAction('reviews');
		},

		enableGuestPopupComment : function(e){
			$("#guest-rating-submit-btn").css('display','none');
			$("#guest-popup-review-comment").css('display','block');
		},
		
		submitLoginForm : function(getAdhocLoginUserUrl) {
			var adhocLoginRequested = true;
			var popupReviewRequested = $('#popupReviewRequested').val();
			var guestReplyLoginRequested = $('#guestReplyLoginRequested').val();
			var j_username = $("#p_username").val();
			var j_password = $("#p_password").val();
			$.ajax({
					type : "POST",
					url : $("#loginForm").attr('action'),
					data : {
						adhocLoginRequested : adhocLoginRequested,
						j_username : j_username,
						j_password : j_password,
					},
					async : false,
					success : function(result) {
						var $response = $(result);
						var loginErrorFound = $response.find('#loginError').val();
						if (loginErrorFound)
							$('#adhoclogin-invalid-credentials').removeAttr('hidden');
						else {
							ACC.tabs.populateUserName(j_username, j_password, getAdhocLoginUserUrl);
							$("#review-login").modal('hide');
							if(guestReplyLoginRequested == 'true'){
								ACC.tabs.submitReply($('#replyingReviewId').val());							
							}else{
								if(popupReviewRequested == 'true'){
									$("#closeReviewLoginForPopup").click();
								}
								else{
									ACC.tabs.submitReview('before-login-review');
								}
							}
						}
					},
					error : function(request, status, error) {
					}
			});
		},
		
		populateUserName : function(username, password, getAdhocLoginUserUrl) {
			$.ajax({
					type : "POST",
					url : getAdhocLoginUserUrl,
					data : {
						j_username : username,
						j_password : password,
					},
					async : false,
					success : function(result) {
						$("#review-popup-guest-label").html(result.userName);
					},
					error : function(request, status, error) {
					}
			});
		},
		
		validateEmailFormatThenProcess : function(){
			var emailPattern = new RegExp("\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}\\b");
			var valid = emailPattern.test($("#guestemail").val());
			if(valid){
				$("#hiddentEmailSubmit").click();
			}
			else{
				$('#invalid-email-format').removeAttr('hidden');
			}
		},
		
		validateEmailVerificationCode : function() {
			var popupReviewRequested = $('#popupReviewRequested').val();
			var guestReplyLoginRequested = $('#guestReplyLoginRequested').val();
			$('#no-token-entered-error').attr("hidden", true);
			$('#invalid-token-error').attr("hidden", true);
			$.ajax({
				type : "POST",
				url : $("#guestEmailVerification").attr('action'),
				data : {
					verificationCode : $("#verificationCode").val(),
					processCode : $('#guestUserEmailEventProcessCode').val(),
				},
				success : function(result) {
					if(result == 'true'){
						$('#review-guest-verify').modal('hide');
						if(guestReplyLoginRequested == 'true'){
							ACC.tabs.submitReply($('#replyingReviewId').val());	
						}else{
							if(popupReviewRequested == 'true'){
								$("#closeReviewLoginForPopup").click();
							}
							else{
								$("#review-login").modal('hide');
								ACC.tabs.submitReview('before-login-review');
							}
						}
					}else{
						if(result == 'false')
							$('#invalid-token-error').removeAttr('hidden');
						else
							$('#no-token-entered-error').removeAttr('hidden');
						$("#verificationCode").val('')
					}
				},
				error : function(request, status, error) {
				}
		});
		},
		
		submitReview : function(message) {
			var comment;
			var rating;
			var action;
			if(message == 'before-login-review' || message == 'after-login-review' || message == 'guest-review'){
				comment = $('#reviewComment').val();
				rating = $('#reviewRating').val();
				action = $("#reviewForm").attr('action');
			}
			else if(message == 'popup-review'){
				comment = $('#popupReviewComment').val();
				rating = $('#popupReviewRating').val();
				action = $("#reviewForm").attr('action');
				$("#review-popup-rating").modal('hide');
			}
			$.ajax({
				type : "POST",
				url : action,
				data : {
					rating : rating,
					comment : comment,
				},
				success : function(result) {
					$("#showReviewSuccess").click();
				},
				error : function(request, status, error) {
				}
		});
		},
		
		submitReply : function(reviewId) {
			var comment = $('#reply_'+reviewId).val();
			var action = $("#replyOnReviewForm").attr('action')+reviewId;
			$.ajax({
				type : "POST",
				url : action,
				data : {
					comment : comment,
				},
				success : function(result) {
					$("#showReplySuccess").click();
				},
				error : function(request, status, error) {
				}
		});
		},
		reloadPage : function(){
			$('#review-success').on('hidden.bs.modal', function () {
				location.reload();
			})
			$('#reply-success').on('hidden.bs.modal', function () {
				location.reload();
			})
			 
		},
		
		
		enableaction: function () {
			
		    if( $('#reviewComment').val().length > 0) {
		        $('#after-login-review').prop("disabled", false);
		    } else {
		        $('#after-login-review').prop("disabled", true);
		    }   
		}

};

ACC.termsandconditions = {

	bindTermsAndConditionsLink: function() {
		$(document).on("click",".termsAndConditionsLink",function(e) {
			e.preventDefault();
			$.colorbox({
				maxWidth:"100%",
				maxHeight:"80%",
				width:"870px",
				scrolling:true,
				href: $(this).attr("href"),
				close:'<span class="glyphicon glyphicon-remove"></span>',
				title:'<div class="headline"><span class="headline-text">Terms and Conditions</span></div>',
				onComplete: function() {
					ACC.common.refreshScreenReaderBuffer();
				},
				onClosed: function() {
					ACC.common.refreshScreenReaderBuffer();
				}
			});
		});
	}
}

$(function(){
	with(ACC.termsandconditions) {
		bindTermsAndConditionsLink();
	}
});

ACC.track = {
	
	_autoload: [
        "trackGaGoal",
        "trackProductGaGoal"
    ],
		
	trackAddToCart: function (productCode, quantity, cartData){
		window.mediator.publish('trackAddToCart',{
			productCode: productCode,
			quantity: quantity,
			cartData: cartData
		});
		
		if( cartData.type !== "" ){
			window.mediator.publish('trackAddToCartWncMhc',{
				type: cartData.type,
				productSku: cartData.productSku,
				quantity: parseInt(quantity),
				cof: ACC.CofNo
			});
		}
	},
	trackRemoveFromCart: function(productCode, initialCartQuantity){
		window.mediator.publish('trackRemoveFromCart',{
			productCode: productCode,
			initialCartQuantity: initialCartQuantity
		});
	},

	trackUpdateCart: function(productCode, initialCartQuantity, newCartQuantity){
		window.mediator.publish('trackUpdateCart',{
			productCode: productCode,
			initialCartQuantity: initialCartQuantity,
			newCartQuantity: newCartQuantity
		});
	},
	
	trackSubmitSurveyForm: function(feedback, surveycode, cof, time){
		window.mediator.publish('trackSubmitSurveyForm',{
			feedback: feedback,
			surveycode: surveycode,
			cof: cof,
			time: time
		});
	},
	
	trackCampaignViews: function(campaignName, accepted, promo, pageName,campaignType)
	{
		window.mediator.publish('trackCampaignViews',{
			campaignName: campaignName,
			accepted: accepted,
			promo: promo,
			pageName: pageName,
			campaignType: campaignType
		});
	},
	
	trackProductViews: function(type, productId, productIndex, cofNumber, emailId){
		window.mediator.publish('trackProductViews',{
			type: type,
			productId: productId,
			productIndex: productIndex,
			cofNumber: cofNumber,
			emailId: emailId
		});
	},
	
	trackHomeCarouselVariant: function(carouselVar, carouselRole){
		window.mediator.publish('trackHomeCarouselVariant',{
			carouselVar: carouselVar,
			carouselRole: carouselRole
		});
	},
	
	trackLeadGenerationViews: function(formAction){
		window.mediator.publish('trackLeadGenerationViews',{
			formAction: formAction
		});
	},
	
	trackExpressCheckout: function(cof){
		window.mediator.publish('trackAddToExpressCart',{
			cof: cof
		});
	},
	trackCarouselBannerClick: function(bannerName, bannerId){
		window.mediator.publish('trackCarouselBannerClick',{
			bannerName: bannerName,
			bannerId: bannerId
		});
	},
	trackRegistrationInGA: function(currentDate){
		window.mediator.publish('trackRegistrationInGA',{
			currentDate: currentDate
		});
	},
	trackLoginSuccessInGA: function(cof, uid, firstLoginDt, registrationDt){
		window.mediator.publish('trackLoginSuccessInGA',{
			cof: cof,
			uid: uid,
			firstLoginDt: firstLoginDt,
			registrationDt: registrationDt
		});
	},
	trackLoginSuccessWithCusIdInGA: function(cof, custId, loginDt){
		window.mediator.publish('trackLoginSuccessWithCusIdInGA',{
			cof: cof,
			custId: custId,
			loginDt: loginDt
		});
	},
	trackGoalInGA: function(cof, pages){
		window.mediator.publish('trackGoalInGA',{
			cof: cof,
			pages: pages
		});
	},
	trackGaGoal: function(){
		if (typeof(Storage) !== "undefined") {
    		var gaGoal = localStorage.getItem('gaGoal');
    		if( gaGoal ){
    			if( ACC.pageName === "orderConfirmationPage" ){
    			ACC.track.trackGoalInGA(ACC.CofNo, gaGoal);
    			localStorage.removeItem('gaGoal');
    			}else if( ACC.pageName === "cartPage" && $("#orderingPath").length > 0 ){
    				$("#orderingPath").val(gaGoal);
    			}
    		}else if( ACC.AnonymousCustomer === "false" && ACC.pageName !== "orderConfirmationPage" ){
    			ACC.common.createGaGoal("gaGoal");
    		}
		}
	},
	
	trackProductGaGoal: function(){
		if (typeof(Storage) !== "undefined") {
    		var gaProductGoal = localStorage.getItem('gaProductGoal');
    		if( gaProductGoal ){
    			if( ACC.pageName === "productDetails" && $(".js-productOrderingPath").length > 0 ){
    				localStorage.removeItem('gaProductGoal');
        			$(".js-productOrderingPath").val(gaProductGoal);
    			}
    		}else if( ACC.AnonymousCustomer === "false"  ){
    			ACC.common.createGaGoal("gaProductGoal");
    		}
		}
	},
	trackTroubleShootingInGA: function(eqType, eqSubType, serviceNeed, troubleShootingStep, metric){
		window.mediator.publish('trackTroubleShootingInGA',{
			eqType: eqType,
			eqSubType: eqSubType,
			serviceNeed: serviceNeed,
			troubleShootingStep: troubleShootingStep,
			metric: metric
		});
	},
	
	trackServiceNeed: function(text, cof){
		window.mediator.publish('trackServiceNeed',{
			text: text,
			cof: cof
		});
	},
	trackCustomerInquiry: function(type){
		window.mediator.publish('trackCustomerInquiry',{
			type: type
		});
	}
};

ACC.storefinder = {

	_autoload: [
		["init", $(".js-store-finder").length != 0],
		["bindStoreChange", $(".js-store-finder").length != 0],
		["bindSearch", $(".js-store-finder").length != 0],
		"bindPagination"
	],
	
	storeData:"",
	storeId:"",
	coords:{},
	storeSearchData:{},

	createListItemHtml: function (data,id){

		var item="";
		item+='<li class="list__entry">';
		item+='<input type="radio" name="storeNamePost" value="'+data.displayName+'" id="store-filder-entry-'+id+'" class="js-store-finder-input" data-id="'+id+'">';
		item+='<label for="store-filder-entry-'+id+'" class="js-select-store-label">';
		item+='<span class="entry__info">';
		item+='<span class="entry__name">'+data.displayName+'</span>';
		item+='<span class="entry__address">'+data.line1+' '+data.line2+'</span>';
		item+='<span class="entry__city">'+data.town+'</span>';
		item+='</span>';
		item+='<span class="entry__distance">';
		item+='<span>'+data.formattedDistance+'</span>';
		item+='</span>';
		item+='</label>';
		item+='</li>';
		return item;
	},

	refreshNavigation: function (){
		var listitems = "";
		data = ACC.storefinder.storeData
		
		if(data){
			for(i = 0;i < data["data"].length;i++){
				listitems += ACC.storefinder.createListItemHtml(data["data"][i],i)
			}
	
			$(".js-store-finder-navigation-list").html(listitems);
	
			// select the first store
			var firstInput= $(".js-store-finder-input")[0];
			$(firstInput).click();
		}


		var page = ACC.storefinder.storeSearchData.page;
		$(".js-store-finder-pager-item-from").html(page*10+1);

		var to = ((page*10+10)>ACC.storefinder.storeData.total)? ACC.storefinder.storeData.total : page*10+10 ;
		$(".js-store-finder-pager-item-to").html(to);
		$(".js-store-finder-pager-item-all").html(ACC.storefinder.storeData.total);
		$(".js-store-finder").removeClass("show-store");

	},


	bindPagination:function ()
	{


		
		$(document).on("click",".js-store-finder-details-back",function(e){
			e.preventDefault();
			
			$(".js-store-finder").removeClass("show-store");
			
		})
		



		$(document).on("click",".js-store-finder-pager-prev",function(e){
			e.preventDefault();
			var page = ACC.storefinder.storeSearchData.page;
			ACC.storefinder.getStoreData(page-1)
			checkStatus(page-1);
		})

		$(document).on("click",".js-store-finder-pager-next",function(e){
			e.preventDefault();
			var page = ACC.storefinder.storeSearchData.page;
			ACC.storefinder.getStoreData(page+1)
			checkStatus(page+1);
		})

		function checkStatus(page){
			if(page==0){
				$(".js-store-finder-pager-prev").attr("disabled","disabled")
			}else{
				$(".js-store-finder-pager-prev").removeAttr("disabled")
			}
			
			if(page == Math.floor(ACC.storefinder.storeData.total/10)){
				$(".js-store-finder-pager-next").attr("disabled","disabled")
			}else{
				$(".js-store-finder-pager-next").removeAttr("disabled")
			}
		}

	},


	bindStoreChange:function()
	{
		$(document).on("change",".js-store-finder-input",function(e){
			e.preventDefault();



			storeData=ACC.storefinder.storeData["data"];

			var storeId=$(this).data("id");

			var $ele = $(".js-store-finder-details");
			


			$.each(storeData[storeId],function(key,value){
				if(key=="image"){
					if(value!=""){
						$ele.find(".js-store-image").html('<img src="'+value+'" alt="" />');
					}else{
						$ele.find(".js-store-image").html('');
					}
				}else if(key=="productcode"){
					$ele.find(".js-store-productcode").val(value);
				}
				else if(key=="openings"){
					if(value!=""){
						var $oele = $ele.find(".js-store-"+key);
						var openings = "";
						$.each(value,function(key2,value2){
							openings += "<dt>"+key2+"</dt>";
							openings += "<dd>"+value2+"</dd>";
						});

						$oele.html(openings);

					}else{
						$ele.find(".js-store-"+key).html('');
					}

				}
				else if(key=="specialOpenings"){}
				else if(key=="features"){
					var features="";
					$.each(value,function(key2,value2){
						features += "<li>"+value2+"</li>";
					});

					$ele.find(".js-store-"+key).html(features);

				}
				else{
					if(value!=""){
						$ele.find(".js-store-"+key).html(value);
					}else{
						$ele.find(".js-store-"+key).html('');
					}
				}

			})


			ACC.storefinder.storeId = storeData[storeId];
			ACC.storefinder.initGoogleMap();

		})

		$(document).on("click",".js-select-store-label",function(e){
			$(".js-store-finder").addClass("show-store")
		})

		$(document).on("click",".js-back-to-storelist",function(e){
			$(".js-store-finder").removeClass("show-store")
		})

	},



	initGoogleMap:function(){

		if($(".js-store-finder-map").length > 0){
			ACC.global.addGoogleMapsApi("ACC.storefinder.loadGoogleMap");
		}
	},
 
	loadGoogleMap: function(){

		storeInformation = ACC.storefinder.storeId;

		if($(".js-store-finder-map").length > 0)
		{			
			$(".js-store-finder-map").attr("id","store-finder-map")
			var centerPoint = new google.maps.LatLng(storeInformation["latitude"], storeInformation["longitude"]);
			
			var mapOptions = {
				zoom: 13,
				zoomControl: true,
				panControl: true,
				streetViewControl: false,
				mapTypeId: google.maps.MapTypeId.ROADMAP,
				center: centerPoint
			}
			
			var map = new google.maps.Map(document.getElementById("store-finder-map"), mapOptions);
			
			var marker = new google.maps.Marker({
				position: new google.maps.LatLng(storeInformation["latitude"], storeInformation["longitude"]),
				map: map,
				title: storeInformation["name"],
				icon: "https://maps.google.com/mapfiles/marker" + 'A' + ".png"
			});
			var infowindow = new google.maps.InfoWindow({
				content: storeInformation["name"],
				disableAutoPan: true
			});
			google.maps.event.addListener(marker, 'click', function (){
				infowindow.open(map, marker);
			});
		}
		
	},


	bindSearch:function(){

		$(document).on("submit",'#storeFinderForm', function(e){
			e.preventDefault()
			var q = $(".js-store-finder-search-input").val();

			if(q.length>0){
				ACC.storefinder.getInitStoreData(q);
			}else{
				if($(".js-storefinder-alert").length<1){
					var emptySearchMessage = $(".btn-primary").data("searchEmpty")
					$(".js-store-finder").hide();
					$("#storeFinder").before('<div class="js-storefinder-alert alert alert-danger alert-dismissable" ><button class="close" type="button" data-dismiss="alert" aria-hidden="true"></button>' + emptySearchMessage + '</div>');
				}
			}
		})


		$(".js-store-finder").hide();
		$(document).on("click",'#findStoresNearMe', function(e){
			e.preventDefault()
			ACC.storefinder.getInitStoreData(null,ACC.storefinder.coords.latitude,ACC.storefinder.coords.longitude);
		})


	},


	getStoreData: function(page){
		ACC.storefinder.storeSearchData.page = page;
		url= $(".js-store-finder").data("url");
		$.ajax({
			url: url,
			data: ACC.storefinder.storeSearchData,
			type: "get",
			success: function (response){
				ACC.storefinder.storeData = $.parseJSON(response);
				ACC.storefinder.refreshNavigation();
				if(ACC.storefinder.storeData.total < 10){
					$(".js-store-finder-pager-next").attr("disabled","disabled");
				}
			}
		});
	},

	getInitStoreData: function(q,latitude,longitude){
		$(".alert").remove();
		data ={
			"q":"" ,
			"page":0
		}
		if(q != null){
			data.q = q;
		}

		if(latitude != null){
			data.latitude = latitude;
		}

		if(longitude != null){
			data.longitude = longitude;
		}

		ACC.storefinder.storeSearchData = data;
		ACC.storefinder.getStoreData(data.page);
		$(".js-store-finder").show();
		$(".js-store-finder-pager-prev").attr("disabled","disabled")
		$(".js-store-finder-pager-next").removeAttr("disabled")
	},

	init:function(){
		$("#findStoresNearMe").attr("disabled","disabled");
		if(navigator.geolocation){
			navigator.geolocation.getCurrentPosition(
				function (position){
					ACC.storefinder.coords = position.coords;
					$('#findStoresNearMe').removeAttr("disabled");
				},
				function (error)
				{
					console.log("An error occurred... The error code and message are: " + error.code + "/" + error.message);
				}
			);
		}
	}
};
ACC.futurelink = {
	
	_autoload: [
			"bindFutureStockLink"
		],

	bindFutureStockLink: function() {
		$(document).on("click",".futureStockLink", function(e) {
			e.preventDefault();
			var url = $(this).attr("href");
			var title = $(this).attr("title");

			ACC.colorbox.open(title,{
				href: url,
				maxWidth:"100%",
				width:"320px",
				height:"320px",
				initialWidth :"320px"
			});
		})
	}
};
ACC.productorderform = {

    _autoload: [
        "headerActions",
        "coreTableActions",
        "addToCartOrderGridForm"
    ],

    $addToCartOrderForm: $("#AddToCartOrderForm"),
    $addToCartBtn: $('#addToCartBtn'),
    $omsErrorMessageContainer: $("#globalMessages"),
    $emptySkuQuantityInputs: $(".sku-quantity[value]"),
    $nonEmptySkuQuantityInputs: $(".sku-quantity[value]"),
    $totalGridValues: $("[data-grid-total-id]"),

    // Templates
    $futureTooltipTemplate: $("#future-stock-template"),
    $futureTooltipErrorTemplate: $("#future-tooltip-error-template"),
    $omsErrorMessageTemplate: $("#oms-error-message-template"),
    $variantSummaryTemplate: $("#variant-summary"),
    selectedVariantData: 'selected-variant',
    selectedVariants: [],
    quantityTotal: 0,
    scrollTopPos: 0,

    headerActions: function () {
        ACC.productorderform.bindProductDetailToggle($(".product-details-toggle"));
    },

    coreTableActions: function () {
        ACC.productorderform.coreTableScrollActions(ACC.productorderform.$addToCartOrderForm);
        ACC.productorderform.bindUpdateFutureStockButton(".update_future_stock_button");
        ACC.productorderform.bindHideFutureStockInfo(".hide_future_stock_info");
        ACC.productorderform.bindVariantSelect($(".variant-select-btn"),'AddToCartOrderForm');
        ACC.productorderform.cancelVariantModal(".closeVariantModal");
        var skuQuantityClass = '.sku-quantity';
        var skuVariantQuantityClass = '#cboxContent .sku-quantity';

        var quantityBefore = 0;
        var quantityAfter = 0;


        ACC.productorderform.$addToCartOrderForm.on('click', skuQuantityClass, function (event) {
            $(this).select();
        });

        ACC.productorderform.$addToCartOrderForm.on('focusin', skuQuantityClass, function (event) {
            quantityBefore = jQuery.trim(this.value);

            //reset
            $(this).parents('tr').next('.variant-summary').remove();
            if($(this).parents('table').data(ACC.productorderform.selectedVariantData)){
                ACC.productorderform.selectedVariants = $(this).parents('table').data(ACC.productorderform.selectedVariantData);
            } else {
                ACC.productorderform.selectedVariants = [];
            }

            if (quantityBefore == "") {
                quantityBefore = 0;
                this.value = 0;
            }
        });


        $(skuQuantityClass).on('blur', function (event) {
            var indexPattern = "[0-9]+";
            var currentIndex = parseInt($(this).attr("id").match(indexPattern));
            var totalPrice = 0;
            var _this = this;
            var currentPrice = $("input[id='productPrice[" + currentIndex + "]']").val();
            this.value = ACC.productorderform.filterSkuEntry(this.value);
            var $currentTotalItems = $('.js-total-items-count');
            var currentTotalItemsValue = $currentTotalItems.html();
            var currentTotalPrice = $('.js-total-price-value').val();
            var $gridGroup = $(this).parents('.orderForm_grid_group');

            if (isNaN(jQuery.trim(this.value))) {
                this.value = 0;
            }

            quantityAfter = jQuery.trim(this.value);
            if (quantityAfter == "") {
                quantityAfter = 0;
                this.value = 0;
            }

            //If order forms advanced search enabled
            if(ACC.orderform) {
                if(sessionStorage.totalItems !== undefined && sessionStorage.totalPriceVal !== undefined) {
                    currentTotalItemsValue = sessionStorage.totalItems;
                    currentTotalPrice = sessionStorage.totalPriceVal;
                }

                if (quantityBefore == 0) {
                    $currentTotalItems.html(parseInt(currentTotalItemsValue) + parseInt(quantityAfter));
                    totalPrice = parseFloat(currentTotalPrice) + parseFloat(currentPrice) * parseInt(quantityAfter);
                } else {
                    $currentTotalItems.html(parseInt(currentTotalItemsValue) + (parseInt(quantityAfter) - parseInt(quantityBefore)));
                    totalPrice = parseFloat(currentTotalPrice) + parseFloat(currentPrice) * (parseInt(quantityAfter) - parseInt(quantityBefore));
                }

                sessionStorage.totalPrice = ACC.productorderform.formatTotalsCurrency(totalPrice);
                sessionStorage.totalItems = $currentTotalItems.html() ;
                sessionStorage.totalPriceVal = totalPrice;

                ACC.orderform.addToSkuQtyInput(_this);

            } else if($gridGroup && $gridGroup.length >0) {
                var $closestQuantityValue = $gridGroup.find('#quantityValue');
                var $closestAvgPriceValue = $gridGroup.find('#avgPriceValue');
                var $closestSubtotalValue = $gridGroup.find('#subtotalValue');
                var currentQuantityValue = $closestQuantityValue.val();
                var currentSubtotalValue = $closestSubtotalValue.val();

                if (quantityBefore == 0) {
                    $closestQuantityValue.val(parseInt(currentQuantityValue) + parseInt(quantityAfter));
                    $closestSubtotalValue.val(parseFloat(currentSubtotalValue) + parseFloat(currentPrice) * parseInt(quantityAfter));

                    $currentTotalItems.html(parseInt(currentTotalItemsValue) + parseInt(quantityAfter));
                    totalPrice = parseFloat(currentTotalPrice) + parseFloat(currentPrice) * parseInt(quantityAfter);
                } else {
                    $closestQuantityValue.val(parseInt(currentQuantityValue) + (parseInt(quantityAfter) - parseInt(quantityBefore)));
                    $closestSubtotalValue.val(parseFloat(currentSubtotalValue) + parseFloat(currentPrice) * (parseInt(quantityAfter) - parseInt(quantityBefore)));

                    $currentTotalItems.html(parseInt(currentTotalItemsValue) + (parseInt(quantityAfter) - parseInt(quantityBefore)));
                    totalPrice = parseFloat(currentTotalPrice) + parseFloat(currentPrice) * (parseInt(quantityAfter) - parseInt(quantityBefore));
                }

                ACC.productorderform.enableBeforeUnloadEvent(quantityAfter,$currentTotalItems.text());

                // if there are no items to add, disable addToCartBtn, otherwise, enable it
                if ($currentTotalItems.length != 0 && $currentTotalItems.text() == 0) {
                    ACC.productorderform.$addToCartBtn.attr('disabled', 'disabled');
                    $(window).off('beforeunload', ACC.productorderform.beforeUnloadHandler);
                } else {
                    ACC.productorderform.$addToCartBtn.removeAttr('disabled');
                }

                if (parseInt($closestQuantityValue.val()) > 0) {
                    $closestAvgPriceValue.val(parseFloat($closestSubtotalValue.val()) / parseInt($closestQuantityValue.val()));
                } else {
                    $closestAvgPriceValue.val(0);
                }
            }

            if($gridGroup && $gridGroup.length >0)
            {
                var gridLevelTotalPrice = "";
                var $gridTotalValue = $gridGroup.find("[data-grid-total-id=" + 'total_value_' + currentIndex + "]");

                if (quantityAfter > 0) {
                    gridLevelTotalPrice =ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice) * parseInt(quantityAfter));
                }
                $gridTotalValue.html(gridLevelTotalPrice);
                ACC.productorderform.updateSelectedVariantGridTotal(this,quantityBefore,false,false);
            }

            $('.js-total-price').html(ACC.productorderform.formatTotalsCurrency(totalPrice));
            $('.js-total-price-value').val(totalPrice);
        });

        // MOBILE
        $('body').on('focusin', skuVariantQuantityClass, function () {
            quantityBefore = jQuery.trim(this.value);

            var currentVariantId = $(this).data('variant-id');
            var currentBaseInput = $("#AddToCartOrderForm, #cartOrderGridForm").find("[data-variant-id='" + currentVariantId + "']");
            currentBaseInput.trigger('focusin');

            currentBaseInput.parents('table').find('.variant-summary').remove();
            if(currentBaseInput.parents('table').data(ACC.productorderform.selectedVariantData)){
                ACC.productorderform.selectedVariants = currentBaseInput.parents('table').data(ACC.productorderform.selectedVariantData);
            } else {
                ACC.productorderform.selectedVariants = [];
            }

            if (quantityBefore == "") {
                quantityBefore = 0;
                this.value = 0;
            }
        });

        $('body').on('blur', skuVariantQuantityClass, function () {
            var priceSibling = $(this).siblings('.price');
            var totalSibling = $(this).siblings('.data-grid-total');
            var currentVariantId = $(this).data('variant-id');
            var currentBaseInput = $("#AddToCartOrderForm, #cartOrderGridForm").find("[data-variant-id='" + currentVariantId + "']");
            this.value = ACC.productorderform.filterSkuEntry(this.value);

            // no text allowed || no negative number allowed || no empty string
            if (isNaN(jQuery.trim(this.value)) || this.value < 0 || this.value == "") {
                this.value = 0;
            }

            // set current value also to hidden input field (baseTable), because its the base of all further interaction
            currentBaseInput.val(this.value);
            currentBaseInput.trigger('blur');
            ACC.productorderform.updateVariantTotal(priceSibling, this.value, totalSibling);

            // if there are no items to add, disable addToCartBtn, otherwise, enable it
            if (this.value > 0 && this.value != quantityBefore) {
                currentBaseInput.parents('table').addClass('selected');
                currentBaseInput.trigger('change');
            } else {
                if (ACC.productorderform.selectedVariants.length === 0) {
                    currentBaseInput.parents('table').removeClass('selected');
                }
            }
        });
    },

    // MOBILE
    updateSelectedVariantGridTotal: function(_this,quantityBefore,isFillQty,resetSummary){
        var priceSibling = $(_this).siblings('.price');
        var propSibling = $(_this).siblings('.variant-prop');
        var currentSkuId = $(_this).next('.td_stock').data('sku-id');
        var currentBaseTotal = $(_this).siblings('.data-grid-total');

        if(isFillQty) {
            ACC.productorderform.selectedVariants = [];
        }

         if (_this.value != quantityBefore) {
            var newVariant = true;
            ACC.productorderform.selectedVariants.forEach(function(item, index) {
                if(item.id === currentSkuId){
                    newVariant = false;
                    if(_this.value === '0' || _this.value === 0){
                        ACC.productorderform.selectedVariants.splice(index, 1);
                    } else {
                        ACC.productorderform.selectedVariants[index].quantity = _this.value;
                        ACC.productorderform.selectedVariants[index].total = ACC.productorderform.updateVariantTotal(priceSibling, _this.value, currentBaseTotal);
                    }
                }
            });

            if(newVariant && _this.value > 0){
                // update variantData
                ACC.productorderform.selectedVariants.push({
                    id: currentSkuId,
                    size: propSibling.data('variant-prop'),
                    quantity: _this.value,
                    total: ACC.productorderform.updateVariantTotal(priceSibling, _this.value,  currentBaseTotal)
                });
            }
        }

        if(resetSummary){
            $(_this).parents('table').find('.variant-summary').remove();
        }

        ACC.productorderform.showSelectedVariant($(_this).parents('table'));

        if (_this.value > 0 && _this.value != quantityBefore) {
            $(_this).parents('table').addClass('selected');
        } else {
            if (ACC.productorderform.selectedVariants.length === 0) {
                $(_this).parents('table').removeClass('selected').find('.variant-summary').remove();
            }
        }

    },

    updateVariantTotal: function (priceSibling, quantity, totalElement) {
        var variantTotal = parseFloat(priceSibling.data('variant-price')) * parseInt(quantity);
        // set total in modal and baseVariant
        totalElement.html(ACC.productorderform.formatTotalsCurrency(variantTotal));

        return ACC.productorderform.formatTotalsCurrency(variantTotal);
    },

    bindUpdateFutureStockButton: function (updateFutureStockButton) {
        $('body').on('click', updateFutureStockButton,function (event) {
            event.preventDefault();

            var $gridContainer = $(this).parents('.orderForm_grid_group').find(".product-grid-container");
            var $skus = jQuery.map($gridContainer.find("input[type='hidden'].sku"), function (o) {
                return o.value
            });
            var skusId = $(this).data('skusId');
            var futureStockUrl = $(this).data('skusFutureStockUrl');
            var postData = {skus: $skus, productCode: skusId};
            var hideFutureStockInfo =  $(this).parent().find(".hide_future_stock_info");
            var showFutureStockLink = $(this);

            $.ajax({
                url: futureStockUrl,
                type: 'POST',
                data: postData,
                traditional: true,
                dataType: 'json',
                success: function (data) {
                    ACC.productorderform.updateFuture($gridContainer, $skus, data, skusId, showFutureStockLink , hideFutureStockInfo);
                },
                error: function (xht, textStatus, ex) {
                    alert("Failed to get delivery modes. Error details [" + xht + ", " + textStatus + ", " + ex + "]");
                }
            });
        });
    },

    bindHideFutureStockInfo: function (hideFutureStockInfoLink) {
        $('body').on('click', hideFutureStockInfoLink, function (event) {
            event.preventDefault();
            var gridContainer = $(this).parent().parent().find(".product-grid-container");
            var updateFutureStockInfo =  $(this).parent().find(".update_future_stock_button");
            updateFutureStockInfo.show();
            $(this).hide();
            var cell = gridContainer.find("[data-sku-id]");
            cell.children(".future_stock, .out-of-stock").remove();
        });
    },

    updateFuture: function (gridContainer, skus, freshData, callerId, showFutureStockInfoLink ,hideFutureStockInfo) {
        // clear prior error messages
        ACC.productorderform.$omsErrorMessageContainer.find("div").remove();

        function isEmpty(obj) {
            return (Object.keys(obj).length <= 0);
        }

        if (freshData !== null && typeof freshData['basket.page.viewFuture.unavailable'] !== 'undefined') {
            // future stock service is not available
            $.tmpl(ACC.productorderform.$omsErrorMessageTemplate, {
                errorMessage: freshData['basket.page.viewFuture.unavailable']
            }).appendTo(ACC.productorderform.$omsErrorMessageContainer);
        }
        else {
            if(!isEmpty(freshData)) {
                showFutureStockInfoLink.hide();
                hideFutureStockInfo.css( "display", "block");
                $.each(skus, function (index, skuId) {
                    var stocks = freshData[skuId];

                    var cell = gridContainer.find("[data-sku-id='" + skuId + "']");
                    var isCurrentlyInStock = cell[0].attributes['class'].nodeValue.indexOf("in-stock") != -1;
                    var futureStockPresent = typeof stocks !== 'undefined' && stocks !== null && stocks[0] !== null && typeof stocks[0] !== 'undefined';

                    cell.children(".future_stock, .out-of-stock").remove(); // remove previous tool tips

                    if (futureStockPresent) {
                        // we have stock for this product
                        if (!isCurrentlyInStock) {
                            cell.addClass("future-stock");
                        }

                        // render template and append to cell
                        $.tmpl(ACC.productorderform.$futureTooltipTemplate, {
                            formattedDate: stocks[0].formattedDate,
                            availabilities: stocks
                        }).appendTo(cell);

                    } else {
                        // no future stock for this product
                        if (!isCurrentlyInStock) {
                            cell[0].attributes['class'].nodeValue = "td_stock out-of-stock";
                        }
                    }
                });
            }

        }
    },

    toJSON: function (gridForm, skipZeroQuantity) {
        var skus = gridForm.find("input.sku").map(function (index, element) {
                return element.value
            }),
            skuQuantities = gridForm.find("input.sku-quantity").map(function (index, element) {
                return parseInt(element.value)
            }),
            skusAsJSON = [];

        for (var i = 0; i < skus.length; i++) {
            if (!(skipZeroQuantity && skuQuantities[i] === 0)) {
                skusAsJSON.push({"product": {"code": skus[i]}, "quantity": skuQuantities[i]});
            }
        }

        return JSON.stringify({"cartEntries": skusAsJSON});
    },

    formatTotalsCurrency: function (amount) {
        return Currency.formatMoney(Number(amount).toFixed(2), Currency.money_format[ACC.common.currentCurrency]);
    },

    cleanValues: function () {
        if ($(".orderForm_grid_group").length !== 0) {
            var formattedTotal = ACC.productorderform.formatTotalsCurrency('0.00');

            $('.js-total-price').html(formattedTotal);
            $('#quantity, .js-total-items-count').html(0);
            $('#quantityValue, #avgPriceValue, #subtotalValue, .js-total-price-value').val(0);
            ACC.productorderform.$emptySkuQuantityInputs.val(0);
            ACC.productorderform.$totalGridValues.html("");
        }
    },

    calculateGrid: function () {
        ACC.productorderform.$nonEmptySkuQuantityInputs.trigger('focusout');
    },

    bindProductDetailToggle: function (productDetailToggle) {
        productDetailToggle.on("click", function (event) {
            event.preventDefault();

            $(this).parents('.product-details').toggleClass('open');
        });
    },

    showSelectedVariant: function (currentVariant) {
        // render template and append to table
        $.tmpl(ACC.productorderform.$variantSummaryTemplate, {
            variants: ACC.productorderform.selectedVariants
        }).appendTo(currentVariant);
        // save selectedVariantData
        $('.variant-summary .variant-property').html($('.variant-detail').data('variant-property'));
        currentVariant.data(ACC.productorderform.selectedVariantData, ACC.productorderform.selectedVariants);
        currentVariant.removeClass('currentVariant');
    },

    bindVariantSelect: function (variantSelectBtn,parentId) {
        variantSelectBtn.on("click", function (event) {
            event.preventDefault();
            var currentVariant = $(this).parents('table');

            // reset
            if(currentVariant.data(ACC.productorderform.selectedVariantData)){
                ACC.productorderform.selectedVariants = currentVariant.data(ACC.productorderform.selectedVariantData);
            } else {
                ACC.productorderform.selectedVariants = [];
            }

            var titleHeader = variantSelectBtn.html();
            var tableWrap = $('#'+parentId).clone().empty().attr('id', parentId+'Variant');

            currentVariant.addClass('currentVariant');
            var popupContent = $(this).parents('.orderForm_grid_group').clone();
            currentVariant.removeClass('currentVariant');
            $(popupContent).find('.currentVariant').siblings().remove();
            tableWrap.html(popupContent);
            tableWrap.find('.hidden-xs').removeClass('hidden-xs');
            tableWrap.find('.hide').removeClass('hide');
            scrollTopPos = $('body').scrollTop();
            $('body').scrollTop(0);

            ACC.colorbox.open(titleHeader, {
                html: tableWrap,
                width:"100%",
                reposition: false,
                className: 'variantSelectMobile',
                onCleanup : function() {
                    if(ACC.productorderform.$addToCartOrderForm.find('.selected').length > 0) {
                        ACC.productorderform.$addToCartBtn.removeAttr('disabled');
                    } else {
                        ACC.productorderform.$addToCartBtn.attr('disabled', 'disabled');
                    }
                    $('body').scrollTop(scrollTopPos);
                }
            });
        });
    },

    cancelVariantModal: function (closeVariantModal) {
        $('body').on('click', closeVariantModal, function (event) {
            event.preventDefault();
            ACC.colorbox.close();
        });
    },

    resetSelectedVariant: function () {
        // Reset all the selectedVariant data
        ACC.productorderform.selectedVariants = [];
        $('.product-grid-container table').removeData(ACC.productorderform.selectedVariantData)
            .removeClass('selected')
            .removeClass('currentVariant');
    },

    addToCartOrderGridForm: function addToCartOrderGridForm() {
        // Prevent accidentally submitting the form by hitting the Enter key.
        $("#AddToCartOrderForm").keypress(
            function(event){
                if (event.which == '13') {
                event.preventDefault();
            }
        });

        ACC.productorderform.$addToCartBtn.click(function () {
            ACC.productorderform.$addToCartBtn.attr('disabled', 'disabled');

            $.ajax({
                url:  ACC.productorderform.$addToCartOrderForm.attr("action"),
                type: 'POST',
                dataType: 'json',
                contentType: 'application/json',
                data: ACC.productorderform.toJSON( ACC.productorderform.$addToCartOrderForm, true),
                async: false,
                success: function (response) {
                    $(window).off('beforeunload', ACC.productorderform.beforeUnloadHandler);
                    ACC.product.displayAddToCartPopup(response);
                    ACC.productorderform.cleanValues();
                    ACC.productorderform.resetSelectedVariant();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    // log the error to the console
                    console.log("The following error occured: " + textStatus, errorThrown);
                }
            });
        });
    },

    beforeUnloadHandler: function() {
        return  ACC.productorderform.$addToCartOrderForm.attr('data-grid-confirm-message');
    },

    enableBeforeUnloadEvent: function(quantityAfter,currentTotalItems) {
        if(!ACC.orderform)
        {
            if(quantityAfter > 0 &&  currentTotalItems > 0)
            {
                $(window).off('beforeunload', ACC.productorderform.beforeUnloadHandler)
                    .on('beforeunload', ACC.productorderform.beforeUnloadHandler);
            }
        }
    },

    filterSkuEntry: function(quantityInput){
        var filteredQty = 0;
        if (/\D/g.test(quantityInput)) {
            // Filter non-digits from input value.
            filteredQty = quantityInput.replace(/\D/g, '');
        }
        else
        {
            filteredQty = quantityInput;
        }
        return filteredQty;
    },

    // Order form scroll
    coreTableScrollActions: function ($scrollContent) {
        if ($scrollContent.hasClass('visible')) {
            ACC.productorderform.orderGridScroll($scrollContent);
            var scrollRight = $scrollContent.parent().find('.order-form-scroll.right'),
                scrollLeft = $scrollContent.parent().find('.order-form-scroll.left'),
                scrollUp = $scrollContent.parent().find('.order-form-scroll.up'),
                scrollDown = $scrollContent.parent().find('.order-form-scroll.down');
            var widthReference = $scrollContent.find('.widthReference').outerWidth(),
                heightReference = $scrollContent.find('.product-grid-container table').eq(0).height() /2;// devided by 2 otherwise no nice behaviour
            var maxWidth = 0,
                maxHeight = 0;
            var widthDiff = 0,
                heightDiff = 0;

            $scrollContent.find('.product-grid-container table').each(function(){
                if($(this).outerWidth() > maxWidth){
                    maxWidth = $(this).outerWidth();
                }
            });
            $scrollContent.find('.orderForm_grid_group').each(function(){
                maxHeight += $(this).height();
            });

            widthDiff = maxWidth - $scrollContent.outerWidth();//scroll-offset
            heightDiff = maxHeight - $scrollContent.height() + 14;//scroll-offset

            $scrollContent.scroll(function(){
                if($(this).scrollLeft() > 0) {
                    scrollLeft.show();
                } else {
                    scrollLeft.hide();
                }

                if($(this).scrollLeft() >= widthDiff) {
                    scrollRight.hide();
                } else {
                    scrollRight.show();
                }

                if($(this).scrollTop() > 0) {
                    scrollUp.show();
                } else {
                    scrollUp.hide();
                }

                if($(this).scrollTop() >= heightDiff) {
                    scrollDown.hide();
                } else {
                    scrollDown.show();
                }

                $scrollContent.find('.update-future-stock').css('margin-right', -$(this).scrollLeft());
            });

            $scrollContent.parent().find('.order-form-scroll').click(function () {
                var pos = { left: $scrollContent.scrollLeft(),
                    top: $scrollContent.scrollTop() };

                if($(this).hasClass('right')) {
                    $scrollContent.scrollLeft(pos.left + widthReference);
                }
                else if($(this).hasClass('left')) {
                    $scrollContent.scrollLeft(pos.left - widthReference);
                }
                else if($(this).hasClass('up')) {
                    $scrollContent.scrollTop(pos.top - heightReference);
                }
                else {
                    $scrollContent.scrollTop(pos.top + heightReference);
                }
            });
        }
    },

    orderGridScroll: function (scrollContent) {
        var showRight = false;
        var calcHeight = 0;
        var maxWidth = $(scrollContent).find('.orderForm_grid_group').innerWidth();
        var maxHeight = $(scrollContent).innerHeight() - 18;

        $(scrollContent).find('.product-grid-container table').each(function () {
            if ($(this).width() > maxWidth) {
                showRight = true;
            }
            calcHeight += $(this).height();
        });

        if (showRight) {
            $(scrollContent).parent().find('.order-form-scroll.right').show();
        }

        if (calcHeight > maxHeight) {
            $(scrollContent).parent().find('.order-form-scroll.down').show();
        }
    },

    calculateVariantTotal:function(_this,quantityToAdd){
        var $gridGroup = _this.parents('.orderForm_grid_group');
        var indexPattern = "[0-9]+";
        var currentIndex = parseInt(_this.attr("id").match(indexPattern));
        var currentPrice = $("input[id='productPrice[" + currentIndex + "]']").val();
        var $gridTotalValue = $gridGroup.find("[data-grid-total-id=" + 'total_value_' + currentIndex + "]");
        if(quantityToAdd > 0)
            $gridTotalValue.html(ACC.productorderform.formatTotalsCurrency(parseFloat(currentPrice) * parseInt(quantityToAdd)));
    }
};

ACC.savedcarts = {

    _autoload: [
        ["bindRestoreSavedCartClick", $(".js-restore-saved-cart").length != 0],
        ["bindDeleteSavedCartLink", $('.js-delete-saved-cart').length != 0],
        ["bindDeleteConfirmLink", $('.js-savedcart_delete_confirm').length != 0],
        ["bindSaveCartForm", $(".js-save-cart-link").length != 0 || $(".js-update-saved-cart").length != 0],
        ["bindUpdateUploadingSavedCarts", $(".js-uploading-saved-carts-update").length != 0],
        "resizeColorBox"
    ],
    
    $savedCartEnabled: false,
    
    $savedCartRestoreBtn: {},
    $currentCartName: {},
    saveCart: false,
	modifyOrder: false,
	savedcartmodal: null,
    bindRestoreSavedCartClick: function () {
    	
        $(".js-restore-saved-cart").click(function (event) {
        	  
            event.preventDefault();
            var popupTitle = $(this).data('restore-popup-title');
            var cartId = $(this).data('savedcart-id');
            var url = ACC.config.encodedContextPath +'/my-account/saved-carts/'+cartId+'/restore';
            var $this = $(".js-restore-saved-cart");
             
            ACC.savedcarts.$savedCartEnabled = true;
            $.ajax({
            	url: url,
            	method: "GET",
            	async: false,
            	success: function(data){
            		ACC.colorbox.open(popupTitle, {
                        html: data,
                        width: 500,
                        onComplete: function () {
                            ACC.common.refreshScreenReaderBuffer();
                            ACC.savedcarts.bindRestoreModalHandlers();
                            ACC.savedcarts.bindPostRestoreSavedCartLink();
                            ACC.savedcarts.resizeColorBox("#popup_confirm_savedcart_restore");
                        },
                        onClosed: function () {
                            ACC.common.refreshScreenReaderBuffer();
                            
                        }
                    });
            	},
            	error: function(){
            		
            	},
            	complete: function(){
            		
            	}
            });
        });
    },

    bindRestoreModalHandlers: function () {

        ACC.savedcarts.$savedCartRestoreBtn= $('.js-save-cart-restore-btn');
        ACC.savedcarts.$currentCartName= $('.js-current-cart-name');

        $(".js-prevent-save-active-cart").on('change', function (event) {
            if($(this).prop('checked') === true){
                ACC.savedcarts.$currentCartName.attr('disabled', 'disabled');
                ACC.savedcarts.$savedCartRestoreBtn.removeAttr('disabled');
            } else {
                ACC.savedcarts.$currentCartName.removeAttr('disabled');
                var inputVal = ACC.savedcarts.$currentCartName.val();
                if (inputVal == "" && inputVal.length === 0) {
                    ACC.savedcarts.$savedCartRestoreBtn.attr('disabled', 'disabled');
                }
            }
        });

        ACC.savedcarts.$currentCartName.on('focus', function (event) {
            $('.js-restore-current-cart-form').removeClass('has-error');
            $('.js-restore-error-container').html('');
        });

        ACC.savedcarts.$currentCartName.on('blur', function (event) {
            if (this.value == "" && this.value.length === 0) {
                ACC.savedcarts.$savedCartRestoreBtn.attr('disabled', 'disabled');
            } else {
                ACC.savedcarts.$savedCartRestoreBtn.removeAttr('disabled');
            }
        });
    },

    bindPostRestoreSavedCartLink: function () {
    	var keepRestoredCart = false;
        var preventSaveActiveCart = false;
        var mergeWithActiveCart = false;

        $(document).on("click", '.js-keep-restored-cart', function () {
            keepRestoredCart = $(this).prop('checked');
        });

        $(document).on("click", '.js-prevent-save-active-cart', function () {
            preventSaveActiveCart = $(this).prop('checked');
            $('.js-merge-with-active-cart').prop('checked', false);
        });
        
        $(document).on("click", '.js-merge-with-active-cart', function () {
        	mergeWithActiveCart = $(this).prop('checked');
        	$('.js-prevent-save-active-cart').prop('checked', true);
        	ACC.savedcarts.$currentCartName.attr('disabled', 'disabled');
            ACC.savedcarts.$savedCartRestoreBtn.removeAttr('disabled');
        });

        $(document).on("click", '.js-save-cart-restore-btn', function (event) {
        	if( ACC.savedcarts.$savedCartEnabled === false ){
        		return false;
        	}
        	ACC.savedcarts.$savedCartEnabled = false;
            event.preventDefault();
            if( !$(this).hasClass("disabled") ){
            	$(this).addClass("disabled");
            }
            var cartName = $('#activeCartName').val();
            var url = $(this).data('restore-url');
            
            if(mergeWithActiveCart) { //restore with merge cart
            	url = url + '-merge'; //no need to save current cart
            	preventSaveActiveCart = true;
            }
            
            var postData = {preventSaveActiveCart: preventSaveActiveCart, keepRestoredCart: keepRestoredCart, cartName: cartName};
            
            $.ajax({
            	url: url,
            	method: "POST",
            	data: postData,
            	async: false
            }).done(function (result, data, status) {
                if (result == "200") {
                    var url = ACC.config.encodedContextPath + "/cart"
                    window.location.replace(url);
                } else {
                    var errorMsg = status.responseText.slice(1, -1);
                    $('.js-restore-current-cart-form').addClass('has-error');
                    $('.js-restore-error-container').html(errorMsg);
                    $('.js-savedcart_restore_confirm_modal').colorbox.resize();
                }
            }).always(function() {
            	if( $(".js-save-cart-restore-btn").hasClass("disabled") ){
                	$(".js-save-cart-restore-btn").removeClass("disabled");
                }
            });
            	
            
        });

        $(document).on("click", '.js-cancel-restore-btn', function (event) {
            ACC.colorbox.close();
        });
    },

    bindDeleteSavedCartLink: function () {
        $(document).on("click", '.js-delete-saved-cart', function (event) {
            event.preventDefault();
            var cartId = $(this).data('savedcart-id');
            var popupTitle = $(this).data('delete-popup-title');

            ACC.colorbox.open(popupTitle, {
                inline: true,
                className: "js-savedcart_delete_confirm_modal",
                href: "#popup_confirm_savedcart_delete_" + cartId,
                width: '500px',
                onComplete: function () {
                    //remove default colorbox resize;
                	ACC.savedcarts.resizeColorBox("#popup_confirm_savedcart_delete_" + cartId);
                }
            });
        });
    },

    bindDeleteConfirmLink: function () {
        $(document).on("click", '.js-savedcart_delete_confirm', function (event) {
            event.preventDefault();
            var cartId = $(this).data('savedcart-id');
            var url = ACC.config.encodedContextPath + '/my-account/saved-carts/' + cartId + '/delete';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (response) {
                    ACC.colorbox.close();
                    var url = ACC.config.encodedContextPath + "/my-account/saved-carts"
                    window.location.replace(url);
                }
            });
        });

        $(document).on("click", '.js-savedcart_delete_confirm_cancel', function (event) {
            ACC.colorbox.close();
        });
    },
    
    /* Overwritten by custom.savedcarts.js */
    bindSaveCartForm: function (){
		var form = $('#saveCartForm');
		var saveCart = false;

        var showSaveCartFormCallback = function () {
            var title = $('#saveCart').data("saveCartTitle");
            
            ACC.colorbox.open(title, {
                href: "#saveCart",
                inline: true,
                width: "620px",
                onOpen: function () {
                    if ($('#saveCartName').val()) {
                        ACC.savedcarts.disableSaveCartButton(false);
                    }
                },
                onComplete: function () {
                    $(this).colorbox.resize();
                    saveCart = false;
                },
                onClosed: function () {

                    if (saveCart) {
                        form.submit();
                    }
                    document.getElementById("saveCartForm").reset();
                    ACC.savedcarts.disableSaveCartButton(true);
                }
            });
        };

        $(document).on("click",".js-save-cart-link, .js-update-saved-cart",function(e){
            e.preventDefault();
            ACC.common.checkAuthenticationStatusBeforeAction(showSaveCartFormCallback);
		});
		
		$(document).on("click",'#saveCart #cancelSaveCartButton', function (e) {
			e.preventDefault();
			$.colorbox.close();
		});
		
		$('#saveCartName').keyup(function() {
			
			// enable the save cart button
			$('#saveCart #saveCartButton').prop('disabled', this.value.trim() == "" ? true : false);  	
			// limit the text length 
			var maxchars = 255;
			
			var tlength = $(this).val().length;
			$(this).val($(this).val().substring(0, maxchars));
			var tlength = $(this).val().length;
			remain = maxchars - parseInt(tlength);
			$('#saveCartName').text(remain);
		});
		
		$(document).on("click",'#saveCart #saveCartButton', function (e) {
			e.preventDefault();
			saveCart = true;
			$.colorbox.close();
		});
	},
	
	disableSaveCartButton: function(value) {
		$('#saveCart #saveCartButton').prop('disabled', value);
	},
	

	bindUpdateUploadingSavedCarts : function() {
		var cartIdRowMapping = $(".js-uploading-saved-carts-update").data("idRowMapping");
		var refresh = $(".js-uploading-saved-carts-update").data("refreshCart");
		if (cartIdRowMapping && refresh) {
			var interval = $(".js-uploading-saved-carts-update").data("refreshInterval");
			var arrCartIdAndRow = cartIdRowMapping.split(',');
			var mapCartRow = new Object();
			var cartCodes = [];
			for (i = 0; i < arrCartIdAndRow.length; i++) {
				var arrValue = arrCartIdAndRow[i].split(":");
				if (arrValue != "") {
					mapCartRow[arrValue[0]] = arrValue[1];
					cartCodes.push(arrValue[0]);
				}
			}

			if (cartCodes.length > 0) {
				setTimeout(function() {ACC.savedcarts.refreshWorker(cartCodes, mapCartRow, interval)}, interval);
			}	
		}
	},
	

	refreshWorker : function(cartCodes, mapCartRow, interval) {
		$.ajax({
			dataType : "json",
			url : ACC.config.encodedContextPath	+ '/my-account/saved-carts/uploadingCarts',
			data : {
				cartCodes : cartCodes
			},
			type : "GET",
			traditional : true,
			success : function(data) {
				if (data != undefined) {
					var hidden = "hidden";
					var rowId = "#row-";
					for (i = 0; i < data.length; i++) {
						var cart = data[i];

						var index = $.inArray(cart.code, cartCodes);
						if (index > -1) {
							cartCodes.splice(index, 1)
						}	
						var rowIdIndex = mapCartRow[cart.code]; 
						if (rowIdIndex != undefined) {
							var rowSelector = rowId + rowIdIndex;
							$(rowSelector + " .js-saved-cart-name").removeClass("not-active");
							$(rowSelector + " .js-saved-cart-date").removeClass("hidden");
							$(rowSelector + " .js-file-importing").remove();
							$(rowSelector + " .js-saved-cart-description").text(cart.description);
							var numberOfItems = cart.entries.length;
							$(rowSelector + " .js-saved-cart-number-of-items").text(numberOfItems);
							$(rowSelector + " .js-saved-cart-total").text(cart.totalPrice.formattedValue);
							if (numberOfItems > 0) {
								$(rowSelector + " .js-restore-saved-cart").removeClass(hidden);
							}
							$(rowSelector + " .js-delete-saved-cart").removeClass(hidden);
						}
					}
				};
				
				if (cartCodes.length > 0) {
					setTimeout(function() {ACC.savedcarts.refreshWorker(cartCodes, mapCartRow, interval)}, interval);
				}
			}
		})
	},
	
	resizeColorBox: function($cbox){
		if ($("#colorbox").css("display") == "block" && $("#colorbox").find($cbox).length > 0) {  
			$($cbox).colorbox.resize();
			
			$('body, html').animate({
				scrollTop: 50
			}, 60);
			
			setTimeout(function(){
				$("#cboxLoadedContent").css({width:"auto"});
				$("#cboxContent").css({height:"auto"});
			}, 90);
			
			setTimeout(function(){
				$("#colorbox").css({top:"100px"});
            }, 120);
		}
	}
}

ACC.multidgrid = {

	populateAndShowGridOverlay: function(element, event)
	{
		event.preventDefault();

		var itemIndex = $(element).data("index");
		var gridEntries = $('#grid' + itemIndex);

		var strSubEntries = gridEntries.data("sub-entries");
		var productName = gridEntries.data("product-name");
		var arrSubEntries= strSubEntries.split(',');
		var firstVariantCode = arrSubEntries[0].split(':')[0];

		var targetUrl = gridEntries.data("target-url") + '?productCode=' + firstVariantCode;

		ACC.colorbox.open(productName,{
			href:   targetUrl,
			className: 'read-only-grid',
			close:'<span class="glyphicon glyphicon-remove"></span>',
			width: window.innerWidth > parseInt(cboxOptions.maxWidth) ? cboxOptions.maxWidth : cboxOptions.width,
			height: window.innerHeight > parseInt(cboxOptions.maxHeight) ? cboxOptions.maxHeight : cboxOptions.height,
			onComplete: function() {

				$('body').addClass('offcanvas');
				var oH = $('#cboxLoadedContent').height();
				$('#cboxLoadedContent').height((oH - $('#cboxTitle').height()) +'px');

			},

			onClosed: function() {
				$('body').removeClass('offcanvas');
			}

		});
	},
	
	populateAndShowGrid: function(element, event, readOnly)
	{
		var itemIndex = $(element).data("index");
		var grid = $("#ajaxGrid" + itemIndex);
		var gridEntries = $('#grid' + itemIndex);
		
		$(element).toggleClass('open');
		
		if (!grid.is(":hidden")) {
        	grid.slideUp();
        	return;
        }

		if(grid.html() != "") {
			grid.slideToggle("slow");
			return;
		}

		var strSubEntries = gridEntries.data("sub-entries");
		var arrSubEntries= strSubEntries.split(',');
		var firstVariantCode = arrSubEntries[0].split(':')[0];

		var targetUrl = gridEntries.data("target-url");

		var method = "GET";
		$.ajax({
			url: targetUrl,
			data: {productCode: firstVariantCode},
			type: method,
			success: function(data)
			{
				grid.html(data);
				grid.slideDown("slow");
			},
			error: function(jqXHR, textStatus, errorThrown)
			{
				if( $(".debug").length ){
            		$(".debug").append($("<span></span>").addClass("hide").text("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]"));
            	}
			}

		});
	}
};
var ACC = ACC || {}; // make sure ACC is available

if ($("#quickOrder").length > 0) {
    ACC.quickorder = {
        _autoload: [
            "bindClearQuickOrderRow",
            "bindAddSkuInputRow",
            "bindResetFormBtn",
            "bindAddToCartClick"
        ],

        $quickOrderContainer: $('.js-quick-order-container'),
        $quickOrderMinRows: Number($('.js-quick-order-container').data('quickOrderMinRows')),
        $quickOrderMaxRows: Number($('.js-quick-order-container').data('quickOrderMaxRows')),
        $productExistsInFormMsg: $('.js-quick-order-container').data('productExistsInFormMsg'),
        $quickOrderLeavePageMsg: $('#quickOrder').data('gridConfirmMessage'),
        $hiddenSkuInput: 'input.js-hidden-sku-field',
        $addToCartBtn: $('#js-add-to-cart-quick-order-btn-top, #js-add-to-cart-quick-order-btn-bottom'),
        $resetFormBtn: $('#js-reset-quick-order-form-btn-top, #js-reset-quick-order-form-btn-bottom'),
        $productInfoContainer: '.js-product-info',
        $skuInputField: '.js-sku-input-field',
        $qtyInputField: '.js-quick-order-qty',
        $jsLiContainer: 'li.js-li-container',
        $removeQuickOrderRowBtn: '.js-remove-quick-order-row',
        $skuValidationContainer: '.js-sku-validation-container',
        $qtyValidationContainer: '.js-qty-validation-container',
        $productItemTotal: '.js-quick-order-item-total',
        $classHasError: 'has-error',

        bindResetFormBtn: function () {
            ACC.quickorder.$resetFormBtn.on("click", ACC.quickorder.clearForm);
        },

        bindAddToCartClick: function () {
            ACC.quickorder.$addToCartBtn.on("click", ACC.quickorder.addToCart);
        },

        bindAddSkuInputRow: function () {
            $(ACC.quickorder.$skuInputField).on("focusin", ACC.quickorder.addInputRow).on("focusout", ACC.quickorder.handleFocusOutOnSkuInput);
        },

        bindClearQuickOrderRow: function () {
            $(ACC.quickorder.$removeQuickOrderRowBtn).on("mousedown", ACC.quickorder.clearQuickOrderRow);
        },

        addToCart: function () {
            $.ajax({
                url: ACC.quickorder.$quickOrderContainer.data('quickOrderAddToCartUrl'),
                type: 'POST',
                dataType: 'json',
                contentType: 'application/json',
                data: ACC.quickorder.getJSONDataForAddToCart(),
                async: false,
                success: function (response) {
                    ACC.quickorder.handleAddToCartSuccess(response);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    // log the error to the console
                    console.log("The following error occurred: " + textStatus, errorThrown);
                }
            });
        },

        handleAddToCartSuccess: function (response) {
            if ($(response.quickOrderErrorData).size() > 0) {
                ACC.quickorder.disableBeforeUnloadEvent();
            }
            var lookup = {};
            response.quickOrderErrorData.forEach(function (el) {
                lookup[el.sku] = el.errorMsg;
            });

            $(ACC.quickorder.$qtyInputField).each(function () {
                var parentLi = ACC.quickorder.getCurrentParentLi(this);
                var sku = ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuInputField).val();
                var errorMsg = lookup[sku];

                if (errorMsg) {
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuValidationContainer).text(errorMsg);
                }
                else {
                	ACC.quickorder.findElement(parentLi, ACC.quickorder.$removeQuickOrderRowBtn).trigger("mousedown");
                }
            });

            ACC.quickorder.handleBeforeUnloadEvent();
            ACC.product.displayAddToCartPopup(response);
        },

        getJSONDataForAddToCart: function () {
            var skusAsJSON = [];
            $(ACC.quickorder.$qtyInputField).each(function () {
                var qty = Number($(this).val());
                if (qty > 0) {
                    var sku = jQuery.trim(ACC.quickorder.findElementInCurrentParentLi(this, ACC.quickorder.$skuInputField).val());
                    skusAsJSON.push({"product": {"code": sku}, "quantity": qty});
                }
            });
            return JSON.stringify({"cartEntries": skusAsJSON});
        },

        handleFocusOutOnSkuInput: function (event) {
            ACC.quickorder.handleGetProduct(event);
            ACC.quickorder.handleBeforeUnloadEvent();
        },

        handleFocusOutOnQtyInput: function (event) {
            ACC.quickorder.validateAndUpdateItemTotal(event);
            ACC.quickorder.enableDisableAddToCartBtn();
        },

        clearForm: function () {
        	window.location.reload();
        },

        validateAndUpdateItemTotal: function (event) {
            var parentLi = ACC.quickorder.getCurrentParentLi(event.target);
            var qtyValue = jQuery.trim(ACC.productorderform.filterSkuEntry($(event.target).val()));
            if (isNaN(qtyValue) || qtyValue == "") {
                qtyValue = 0;
                $(event.target).removeClass(ACC.quickorder.$classHasError);
                ACC.quickorder.findElement(parentLi, ACC.quickorder.$qtyValidationContainer).text('');
                $(event.target).val(0);
            }
            else {
                qtyValue = Number(qtyValue);
                $(event.target).val(qtyValue);
                var maxQty = jQuery.trim(ACC.quickorder.findElement(parentLi, ACC.quickorder.$qtyInputField).data('maxProductQty'));
                var stockLevelStatus = jQuery.trim(ACC.quickorder.findElement(parentLi, ACC.quickorder.$qtyInputField).data('stockLevelStatus'));
                maxQty = ($.isEmptyObject(maxQty) && stockLevelStatus == "inStock") ? "FORCE_IN_STOCK" : Number(maxQty);
                if (!isNaN(maxQty) && qtyValue > maxQty) {
                    $(event.target).addClass(ACC.quickorder.$classHasError);
                    var qtyValidationContainer = ACC.quickorder.findElement(parentLi, ACC.quickorder.$qtyValidationContainer);
                    qtyValidationContainer.text(qtyValidationContainer.data('maxProductQtyMsg'));
                    qtyValue = maxQty;
                    $(event.target).val(maxQty);
                }
                else {
                    $(event.target).removeClass(ACC.quickorder.$classHasError);
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$qtyValidationContainer).text('');
                }
            }

            if (qtyValue > 0) {
                var itemPrice = parseFloat(ACC.quickorder.findElement(parentLi, '.js-product-price').data('productPrice'));
                ACC.quickorder.findElement(parentLi, ACC.quickorder.$productItemTotal)
                    .text(ACC.productorderform.formatTotalsCurrency(itemPrice * qtyValue));
            }
            else {
                ACC.quickorder.findElement(parentLi, ACC.quickorder.$productItemTotal).text('');
            }
        },

        clearQuickOrderRow: function () {
            var quickOrderMinRows = ACC.quickorder.$quickOrderMinRows;
            var parentLi = ACC.quickorder.getCurrentParentLi(this);
            if ($('.js-ul-container li.js-li-container').length > quickOrderMinRows) {
                parentLi.remove();
            }
            else {
                ACC.quickorder.findElement(parentLi, ACC.quickorder.$productInfoContainer).remove();
                ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuValidationContainer).text('');
                ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuInputField).val('');
                ACC.quickorder.findElement(parentLi, ACC.quickorder.$hiddenSkuInput).val('');
            }
            ACC.quickorder.enableDisableAddToCartBtn();
            ACC.quickorder.handleBeforeUnloadEvent();
        },

        addInputRow: function (event) {

            if ($('.js-quick-order-container li.js-li-container:last-child').find(ACC.quickorder.$skuInputField).is($(event.target)) &&
                $(ACC.quickorder.$jsLiContainer).length < ACC.quickorder.$quickOrderMaxRows) {
                var liClone = $('.js-quick-order-container li.js-li-container:first').clone();
                ACC.quickorder.findElement(liClone, ACC.quickorder.$productInfoContainer).remove();
                ACC.quickorder.findElement(liClone, ACC.quickorder.$skuValidationContainer).text('');
                ACC.quickorder.findElement(liClone, ACC.quickorder.$hiddenSkuInput).val('');
                var currentSkuInputField = ACC.quickorder.findElement(liClone, ACC.quickorder.$skuInputField);
                currentSkuInputField.val('');
                currentSkuInputField.focusin(ACC.quickorder.addInputRow).focusout(ACC.quickorder.handleFocusOutOnSkuInput);
                ACC.quickorder.findElement(liClone, ACC.quickorder.$removeQuickOrderRowBtn).click(ACC.quickorder.clearQuickOrderRow);
                $('.js-ul-container').append(liClone);
            }
        },

        handleGetProduct: function (event) {
            var parentLi = ACC.quickorder.getCurrentParentLi(event.target);
            var productCode = $.trim(event.target.value);
            $(event.target).val(productCode);
            if (!ACC.quickorder.isCurrentSkuSameAsPrevious(parentLi, productCode)) {
                if (productCode.length > 0) {
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$productInfoContainer).remove();

                    if (ACC.quickorder.isDuplicateSku(event.target, productCode)) {
                        ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuValidationContainer).text(ACC.quickorder.$productExistsInFormMsg);
                    }
                    else {
                        ACC.quickorder.getAndDisplayProductInfo(event, parentLi, productCode);
                    }
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$hiddenSkuInput).val(productCode);
                }
                else {
                    $(event.target).removeClass(ACC.quickorder.$classHasError);
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuValidationContainer).text('');
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$productInfoContainer).remove();
                }
            }
        },

        isCurrentSkuSameAsPrevious: function (parentLi, productCode) {
            return ACC.quickorder.findElement(parentLi, ACC.quickorder.$hiddenSkuInput).val() == productCode;
        },

        isDuplicateSku: function (currentInput, productCode) {
            var exists = false;
            $(ACC.quickorder.$skuInputField).each(function () {
                if ($(this).val() == productCode && !$(this).is($(currentInput))) {
                    exists = true;
                    return false
                }
            });
            return exists;
        },

        getAndDisplayProductInfo: function (event, parentLi, productCode) {
            var url = ACC.config.encodedContextPath + '/quickOrder/productInfo?code=' + productCode;
            $.getJSON(url, function (result) {
                if (result.errorMsg != null && result.errorMsg.length > 0) {
                    $(event.target).addClass(ACC.quickorder.$classHasError);
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuValidationContainer).text(result.errorMsg);
                }
                else {
                    $(event.target).removeClass(ACC.quickorder.$classHasError);
                    ACC.quickorder.findElement(parentLi, ACC.quickorder.$skuValidationContainer).text('');
                    $('#quickOrderRowTemplate').tmpl(result.productData).insertAfter(ACC.quickorder.findElement(parentLi, '.js-sku-container'));
                    var qtyInputField = ACC.quickorder.findElement(parentLi, ACC.quickorder.$qtyInputField);
                    qtyInputField.focusout(ACC.quickorder.handleFocusOutOnQtyInput);
                    var stockLevelStatus = result.productData.stock.stockLevelStatus.code;
                    if (stockLevelStatus == "outOfStock") {
                        qtyInputField.val(0);
                        qtyInputField.prop('disabled', true);
                    }
                    else {
                    	qtyInputField.focus().select();
                    }
                    ACC.quickorder.enableDisableAddToCartBtn();
                }
            });
        },

        handleBeforeUnloadEvent: function () {
            if (ACC.quickorder.isAnySkuPresent()) {
                ACC.quickorder.disableBeforeUnloadEvent();
                ACC.quickorder.enableBeforeUnloadEvent();
            }
            else {
                ACC.quickorder.disableBeforeUnloadEvent();
            }
        },

        disableBeforeUnloadEvent: function () {
            $(window).off('beforeunload', ACC.quickorder.beforeUnloadHandler);
        },

        enableBeforeUnloadEvent: function () {
            $(window).on('beforeunload', ACC.quickorder.beforeUnloadHandler);
        },

        beforeUnloadHandler: function () {
            return ACC.quickorder.$quickOrderLeavePageMsg;
        },

        enableDisableAddToCartBtn: function () {
            var addToCartButtonEnabled = ACC.quickorder.shouldAddToCartBeEnabled();

            // if there are no items to add, disable addToCartBtn, otherwise, enable it
            if (addToCartButtonEnabled) {
                ACC.quickorder.$addToCartBtn.removeAttr('disabled');
            } else {
                ACC.quickorder.$addToCartBtn.attr('disabled', 'disabled');
            }
        },

        shouldAddToCartBeEnabled: function () {
            var sum = 0;
            var enable = false;
            $(ACC.quickorder.$qtyInputField).each(function () {
                var str = this.value.trim();  // .trim() may need a shim
                if (str) {   // don't send blank values to `parseInt`
                    sum += parseInt(str, 10);
                }
                if (sum >= 1) {
                    enable = true;
                    return false;
                }
            });
            return enable;
        },

        isAnySkuPresent: function () {
            var present = false;
            $(ACC.quickorder.$skuInputField).each(function () {
                var str = jQuery.trim(this.value);  // .trim() may need a shim
                if (str) {
                    present = true;
                    return false;
                }
            });
            return present;
        },

        getCurrentParentLi: function (currentElement) {
            return $(currentElement).closest(ACC.quickorder.$jsLiContainer);
        },

        findElement: function (currentElement, toFind) {
            return $(currentElement).find(toFind);
        },

        findElementInCurrentParentLi: function (currentElement, toFind) {
            return $(currentElement).closest(ACC.quickorder.$jsLiContainer).find(toFind);
        }
    };
}
ACC.datatable = {

    _autoload: [
        ["bindTable", $("table.display").length > 0],
        ["bindOrderHistoryTable", ACC.pageName === "orders"],
        ["bindManageUsersTable", $('.js-manage-users-table').length > 0],
        "generatePrevOrderRow",
        "changeOrderStatusFilter",
        "getDeliveryTime",
    ],

    cartDataTable: null,
    bindTable: function(){
    	$.fn.dataTable.ext.order['dom-text'] = function  ( settings, col ){
    	    return this.api().column( col, {order:'index'} ).nodes().map( function ( td ) {
    	        return $(td).text();
    	    });
    	}  
    	
    	ACC.datatable.cartDataTable = $('#js-cartDataTable').DataTable( {
    		searching: true,
    		autoWidth: false,
    		order: [[ 12, 'asc' ]],
    		columnDefs: [{"targets": [0, 2, 3, 6, 10, 11],"orderable": false},{"targets": [2, 3, 11],"visible": false}],
    		"columns": [null, null, null, null, null, null, null, null, null, { "orderDataType": "dom-text", type: 'string' }, null, null, null ],
    		lengthChange: false,
    		paging: false,
    		info: false,
			stateSave: true,
			stateSaveParams: function (settings, data) {
				var dtstate = JSON.parse( localStorage.getItem( 'DataTables_' + settings.sInstance ) );
				if(dtstate != null){
					data.viewoption = dtstate.viewoption;
                }
			},
			stateSaveCallback: function(settings,data) {
				localStorage.setItem( 'DataTables_' + settings.sInstance, JSON.stringify(data) )
			},
			stateLoadCallback: function(settings) {
			    return JSON.parse( localStorage.getItem( 'DataTables_' + settings.sInstance ) )
			},
			drawCallback: function( settings ) {
    			ACC.datatable.cartDrawCallBack(settings);
    			ACC.datatable.moveEmptyReturn();
    			ACC.datatable.recentlyAdded();
    		},
    		initComplete: function (settings) {
    			/* Building option tags from column data and setting selected option from local storage */
    			ACC.datatable.populateFiltersDropdown(settings, this);
            }
	    } );
    	
    	enquire.register("screen and (max-width:"+screenSmMax+")", {
            match : function() {
            	$('#js-cartDataTable').children("tfoot").children(".emptyreturnRow").css({"border-bottom-width":0});
            },
                
            unmatch : function() {
            	// Only for Desktop
            	$('#js-cartDataTable').children("tfoot").children("tr").removeAttr("style");
            }
    	});
    	
    	ACC.datatable.displayPreviewText();
    	ACC.global.bindCLickOnEnter( document, ".js-preview-text" );
    	ACC.datatable.tabPrevOrderTr();
    	if ( $.fn.DataTable.isDataTable( '#js-cartDataTable' ) ) {
	    	ACC.datatable.bindpkgsizefilter();
	    	ACC.datatable.bindbrandfilter();
	    	ACC.datatable.bindcartTablesort();
	    	ACC.datatable.bindcartTableviewoptions();
    	}
    },
    
    populatePackageSize: function(elem, pkgfilters){
    	elem.api().column(4).every( function () {
                    var column = this;
                    var select = $('#js-cartDataTable-pkgSize-filter');
                    var pkgoptions;
                    column.data().unique().sort().each( function ( d ) {
                    	if(d != ""){
                    		if(pkgfilters.indexOf(d) != -1){
	                    		pkgoptions+= '<option value="'+d+'" selected="selected">'+d+'</option>';
	                    	}
	                    	else{
	                    		pkgoptions+= '<option value="'+d+'">'+d+'</option>';
	                    	}
                    	}
                    });
                    select.html( pkgoptions );
                });
    },
                
    populateBrandFilter: function(elem, brandfilters){
    	elem.api().column(5).every( function () {
                    var column = this;
                    var select = $('#js-cartDataTable-brand-filter');
                    var brandoptions;
                    column.data().unique().sort().each( function ( d ) {
                    	if(d != ""){	
	                    	if(brandfilters.indexOf(d) != -1){
	                    		brandoptions+= '<option value="'+d+'" selected="selected">'+d+'</option>';
	                    	}
	                    	else{
	                    		brandoptions+= '<option value="'+d+'">'+d+'</option>';
	                    	}
                    	}
                    });
                    select.html( brandoptions );
                });
    },
    
    populateFiltersDropdown: function(settings, elem){
    	var dtstate = JSON.parse( localStorage.getItem( 'DataTables_' + settings.sInstance ) );
		var brandfilters = dtstate.columns[5].search.search.split("|");
        var pkgfilters = dtstate.columns[4].search.search.split("|");
        
        ACC.datatable.populatePackageSize(elem, pkgfilters);
        
        ACC.datatable.populateBrandFilter(elem, brandfilters);
                
                /* Setting view option */
        if(dtstate.hasOwnProperty("viewoption")){
                	ACC.datatable.setviewoptionbutton(dtstate.viewoption);
                }
            },

    displayPreviewText: function(){
    	$(document).on("click", ".js-preview-text", function(){
    		var $this = $(this);
    		
    		// do not call on preview text click only
    		ACC.campaign.updateAriaExpanded($this);
    		if( !$this.closest("tr").hasClass("prev-order-tr") ){
    			ACC.datatable.tabPrevOrderTrAddIndex( !$this.closest("tr").hasClass("active"), $this.closest("tr").next(".prev-order-tr").find(".js-desktop-past-order-table") );
    		if( !$this.closest("tr").hasClass("active") ){
    			$this.closest("tr").addClass("active");
        		}else{
    			$this.closest("tr").removeClass("active");
    		}
    		}else{
    			ACC.datatable.tabPrevOrderTrAddIndex( !$this.closest("tr").prev("tr").hasClass("active"), $this.closest("tr").find(".js-mobile-past-order-table") );
    			if( !$this.closest("tr").prev("tr").hasClass("active") ){
        			$this.closest("tr").prev("tr").addClass("active");
        		}else{
        			$this.closest("tr").prev("tr").removeClass("active");
    		}
    		}
    	});
    },
    
    bindpkgsizefilter: function(){
    	$('#js-cartDataTable-pkgSize-filter').multipleSelect({
    		placeholder: "PACKAGE SIZE",
    		selectAll: false,
    		//filter: true, /* uncomment to enable search within pkg filter dropdown */
    		width: "100%",
            maxHeight: 500,
    		onClick: function() {
    			var val = $('#js-cartDataTable-pkgSize-filter').multipleSelect('getSelects').join("|");
                var table = $('#js-cartDataTable').dataTable();
                table.api().column( 4 )
                	.search( val, true, false )
                	.draw();
    		}
        });
    },
    
    bindbrandfilter: function(){
    	$('#js-cartDataTable-brand-filter').multipleSelect({
    		placeholder: "BRANDS",
    		selectAll: false,
    		//filter: true, /* uncomment to enable search within brand filter dropdown */
    		width: "100%",
            maxHeight: 500,
    		onClick: function() {
    			var val = $('#js-cartDataTable-brand-filter').multipleSelect('getSelects').join("|");
                var table = $('#js-cartDataTable').dataTable();
                table.api().column( 5 )
                	.search( val, true, false )
                	.draw();
            }
        });
    },
    
    bindcartTablesort: function(){
    	
    	ACC.datatable.setcartDataTablesortby();
    	$('#js-cartDataTable').on('order.dt',function(){
    		ACC.datatable.setcartDataTablesortby();
    	});
    	
    	$('#js-cartDataTable-sortby').change(function(){
    		var val = $(this).val().split("-");
    		var col = val[0];
    		var sortorder = val[1];
    		var table = $('#js-cartDataTable').DataTable();
    		table.order([col,sortorder]).draw();
    	});
    },
    
    setcartDataTablesortby: function(){
    	var dataTable = $('#js-cartDataTable').dataTable();
    	var sortedcol = dataTable.fnSettings().aaSorting[0][0];
    	var sortdir = dataTable.fnSettings().aaSorting[0][1];
    	$('#js-cartDataTable-sortby').val(sortedcol+"-"+sortdir);
    },
    
    bindcartTableviewoptions: function(){
	    var table = $('#js-cartDataTable').DataTable();
	    $('.standard-view').click(function(){
	    	table.on( 'stateSaveParams.dt', function (e, settings, data) {
		    	data.viewoption = "standard";
		    });
	    	table.columns( [ 0, 6 ] ).visible( true, false );
	    	table.columns( [ 2, 3, 11] ).visible( false, false );
		    table.columns.adjust().draw(); // adjust column sizing and redraw
		    ACC.datatable.setviewoptionbutton("standard");
		});
	    $('.condensed-view').click(function(){
	    	table.on( 'stateSaveParams.dt', function (e, settings, data) {
		    	data.viewoption = "condensed";
		    });
	    	table.columns( [ 2, 3, 11 ] ).visible( true, false );
	    	table.columns( [ 0, 6 ] ).visible( false, false );
		    table.columns.adjust().draw(); // adjust column sizing and redraw
		    ACC.datatable.setviewoptionbutton("condensed");
	    });
	    $('.condensed-view,.standard-view').on("keydown", function(e){
	    	var code = e.keyCode || e.which;
			if (!e.shiftKey && code === 13) { 
				$(this).click();
	        }
    	});
	    
    },
    
    setviewoptionbutton: function(viewoption){
    	if(viewoption == "standard"){
    		$('.standard-view').addClass("active").attr("aria-selected",true);
	    	$('.condensed-view').removeClass("active").attr("aria-selected",false);
	    	$('#js-cartDataTable').removeClass("condensed").addClass("standard");
    	}
    	else if(viewoption == "condensed"){
    		$('.condensed-view').addClass("active").attr("aria-selected",true);
	    	$('.standard-view').removeClass("active").attr("aria-selected",false);
	    	$('#js-cartDataTable').removeClass("standard").addClass("condensed");
    	}
    },
    
    bindOrderHistoryTable: function(){
    	var oTable = $('#accountOrderHistoryDataTable').dataTable({
	    	"searching": true,
	    	"lengthChange": false,
	    	"columnDefs": [ {"targets": [ 2, 4, 5, 6],"orderable": false}  ],
	    	order: [[ 0, 'desc' ]]
    	});
    	
    	$("#accountOrderHistoryDataTable_filter").hide();
    	
        $("#accountOrderHistoryDataTable_length").hide();

	    $('.account-orderhistory-pagination select').on('change', function () {
	        
	    	var sortField = $(this).val();
	    	if( sortField >= 0 ){
	    		var state = $('#accountOrderHistoryDataTable thead th:eq('+(sortField )+')').attr('aria-sort');
	    		var sort = "desc";
	    		if( typeof(state) !== "undefined" && state == "descending" ){
	    				sort = "asc";
	    		}
	    		oTable.fnSort([ [sortField,sort]] );
	    	}
	    } );
	    
	    oTable.fnSort([ [$('#commentTitle').val(), "desc"]] );
	    
	    ACC.datatable.filterByOrderStatus( $('#orderHistoryFilter').val() );
	    
	    $('select#orderHistoryFilter').on('change', function() {
	    	ACC.datatable.filterByOrderStatus( $(this).val() );
	    });
	    
    },
    
    bindManageUsersTable: function(){
    	var oTable = $('.js-manage-users-table').dataTable({
	    	"searching": false,
	    	"lengthChange": false,
	    	"columnDefs": [ {"targets": [3],"orderable": false}  ],
	    	"language": {
	    		"info": "Showing _START_ - _END_ of _TOTAL_ users"
	        },
	    	order: [[ 0, 'asc' ]]
    	});
	    
	    $('.account-orderhistory-pagination select').on('change', function () {
	    	var sortField = $(this).val();
	    	if( sortField >= 0 ){
	    		var state = $('.js-manage-users-table thead th:eq('+(sortField )+')').attr('aria-sort');
	    		var sort = "asc";
	    		if( typeof(state) !== "undefined" && state == "ascending" ){
	    			sort = "desc";
	    		}
	    		oTable.fnSort([ [sortField,sort]] );
	    	}
	    });
	    
	    oTable.fnSort([ [$('#manage-users-sort').val(), "asc"]] );
    },
    
    filterByOrderStatus: function(status){
    	if(status === 'Choose_Status' || !status) {
	    		status = "";
	    	}
	    	$("#accountOrderHistoryDataTable_filter").find(":input[type=search]").val(status).keyup();
    },
    
    expressOrderModal: function(){  
	    // Modal on Reorder
	    $('#expOrdModal').on('show.bs.modal', function(e) {
	    	var postfix = $(this).find(".js-saveCart").data("postfix");
	        var orderid = $(e.relatedTarget).data('orderid');
	        $(e.currentTarget).find('input[name="orderid"]').removeAttr("disabled").val(orderid);
	        
        	if( $("#saveCartForm-"+postfix).length > 0 && $("#saveCartForm-"+postfix).find("input[name=orderid]").length > 0 ){
        		$("#saveCartForm-"+postfix).find("input[name=orderid]").removeAttr("disabled").val(orderid);
        	}
	    });
	    $('#expOrdModal').on('hide.bs.modal', function(e) {
	    	var postfix = $(this).find(".js-saveCart").data("postfix");
	        $(e.currentTarget).find('input[name="orderid"]').attr("disabled", "disabled").val("");
	        if( $("#saveCartForm-"+postfix).length > 0 && $("#saveCartForm-"+postfix).find("input[name=orderid]").length > 0 ){
        		$("#saveCartForm-"+postfix).find("input[name=orderid]").attr("disabled", "disabled").val("");
        	}
	    });
	    
    },
    
    generatePrevOrderRow: function(el){
    	if( typeof(el) === "undefined" ){
    		return false;
    	}
    	var $this = el;
    	var prevOrderContainer = $("<tr></tr>").addClass("prev-order-tr").append($("<td></td>").attr("colspan", 8));
		if( $this.siblings(".prev-order-container").length > 0 ){
			if( !$this.closest("tr").hasClass("prev-order-tr") ){
				if( $this.closest("tr").next(".prev-order-tr").length == 0 ){
					prevOrderContainer.find("td").append($this.siblings(".prev-order-container").html());
					$this.closest("tr").after(prevOrderContainer);
				}
			}else{
				if( !$this.closest("tr").prev("tr").hasClass("active") ){
					// Only for Mobile Devices
				}
			}
		}
    },
    
    changeOrderStatusFilter: function() {
    	var href=window.location.href;
    	if(href && href.indexOf('/my-account/orders?open-status')!=-1) {
    		$('#orderHistoryFilter').val('Open').attr("selected", "selected");
    		$('#orderHistoryFilter').trigger('change');
    	}
    },
    
    moveEmptyReturn: function (){
		$('#js-cartDataTable').find("tfoot").html($('#js-cartDataTable tbody').find(".emptyreturnRow").clone());
		$('#js-cartDataTable tbody').find(".emptyreturnRow").remove();
	},
	
	recentlyAdded: function(){
		var lastRow = $("#js-cartDataTable").children("tbody").children(".highlightedRow").last();
		var newRow = $("<tr></tr>").addClass("recentlyAdded").append($("<td></td>").attr("colspan", 8).text(ACC.cartRecentlyAddedProd));
		if( lastRow.next("tr").hasClass("prev-order-tr") ){
			lastRow.next(".prev-order-tr").after(newRow);
		}else{
			lastRow.after(newRow);
		}
	},
	
	cartDrawCallBack: function( settings ) {
		$('#js-cartDataTable').children("tbody, tfoot").children("tr").each(function(){
    		ACC.datatable.generatePrevOrderRow($(this).find(".prev-order-td").children(".js-preview-text"));
    	});
		settings.sInstance;
		//rearrange tabindex
		$('#js-cartDataTable').children(' tbody').children('tr').each(function(i){
			$('#js-cartDataTable').children(' tbody').children('tr').eq(i).find('.js-qty-selector-input').attr('data-tabindex',-i-1);
		});
    },
    
    doNotCall: function(){
    	// do not call on preview text click only
    	ACC.datatable.generatePrevOrderRow($this);
    },
    
    existInDeliveryTimeStorage: function(order){
    	var deliveryTime = sessionStorage.getItem("deliveryTimeStorage");
    	var returnValue = false;
    	if( deliveryTime !== null && deliveryTime.length > 0 ){
    		deliveryTime = JSON.parse(deliveryTime);
    		for (var int = 0; int < deliveryTime.length; int++) {
				if( deliveryTime[int].order === order ){
					returnValue = deliveryTime[int];
					break;
				}
			}
    	}
    	return returnValue;
    },
    
    setDeliveryTimeTextStorage: function(order, timeText){
    	var deliveryTime = sessionStorage.getItem("deliveryTimeStorage");
    	if( deliveryTime !== null && deliveryTime.length > 0 ){
    		deliveryTime = JSON.parse(deliveryTime);
    		for (var int = 0; int < deliveryTime.length; int++) {
				if( deliveryTime[int].order === order ){
					deliveryTime[int].text = timeText
					break;
				}
			}
    		sessionStorage.setItem('deliveryTimeStorage', JSON.stringify(deliveryTime));
    	}
    },
    
    getDeliveryTime:function(){
        $(document).on("mouseover touchend", ".formattedDate", function() {
        	$("#accountOrderHistoryDataTable").find(".delivery-time").addClass("display-none").text("");
        	$("#accountOrderHistoryDataTable").find(".js-formattedDate").removeClass("active");
        	var orderId = $(this).closest("tr").data("orderId");
        	
        	var deliveryTime = sessionStorage.getItem("deliveryTimeStorage");
			if( deliveryTime === null ){
				deliveryTime = [];
			}else{
				deliveryTime = JSON.parse(deliveryTime);
			}
			
        	var deliveryTimeObj = ACC.datatable.existInDeliveryTimeStorage(orderId);
        	var $this = $(this);
        	if( !deliveryTimeObj ){
        		deliveryTime.push({"order": orderId, "text":""});
        		sessionStorage.setItem('deliveryTimeStorage', JSON.stringify(deliveryTime));
        		var original_order_delivery_date = $this.find(".js-original-order-delivery-date").val();
        		$this.parent().append('<img class="hide1" alt="'+ACC.ajaxLoaderAltText+'" src="/_ui/responsive/common/images/spinner.gif">');
        		$.ajax({
	        		
	    			url: ACC.config.encodedContextPath + "/my-account/gettime",
	    			 datatype: "json",
	    			data: {"orderId":orderId, "orderHistoryDeliveryDate":original_order_delivery_date},	    			
	    			success: function(result) {
	    				
	    				if(result=="error" || result == ""){
	    					var errordelTime= ACC.deliveryWindowNotAvailableMsg;
	    					$this.addClass("active").find(".delivery-time").removeClass("display-none").text(errordelTime);
	    					ACC.datatable.setDeliveryTimeTextStorage(orderId, errordelTime);
	    				}
	    				else{
	    				 var date_text =result;
	    				 var dates = date_text.split(","); 
	    			     var date1 = dates[0];
	    			     var date2 = dates[1];
	    				 var delTime1 =ACC.cutOffTime.convertUTCtoLocalTime(date1, 'hh:mm A z');
	    				 var delTime2 =ACC.cutOffTime.convertUTCtoLocalTime(date2, 'hh:mm A');
	    				 var delTime=ACC.ajaxDeliveryText+" "+delTime2+" - "+delTime1;
	    				 $this.addClass("active").find(".delivery-time").removeClass("display-none").text(delTime);
	    				 ACC.datatable.setDeliveryTimeTextStorage(orderId, delTime);
	    				}
	    			},
	    			complete: function(){
	    				$this.siblings(".hide1").remove();
	    				ACC.datatable.removeDeliveryTimeText($this);
	    			}
	    			
	    		});
        	}else{
        		// Fetch text from storage
        		if( deliveryTimeObj.text.length > 0 ){
	        		$this.siblings(".hide1").remove();
	        		$this.find(".delivery-time").removeClass("display-none").text( deliveryTimeObj.text );
        		}
        	}
        });
    },
    
    removeDeliveryTimeText: function($el){
    	setTimeout(function () {
    		$el.removeClass("active").find(".delivery-time").addClass("display-none").text("");
    	}, 1000);
    },
    
    tabPrevOrderTrAddIndex: function( addTabIndex, $parent ){
    	if( $parent.hasClass("js-desktop-past-order-table") ){
    		var start = $parent.find(".js-header");
    		var last = $parent.find(".js-last-col-past-order");
    		if(addTabIndex){
    			start.attr("tabindex", 0);
    			start.nextUntil(".js-last-col-past-order").attr("tabindex", 0);
    			last.attr("tabindex", 0);
    		}else{
    			start.removeAttr("tabindex", 0);
    			start.nextUntil(".js-last-col-past-order").removeAttr("tabindex", 0);
    			last.removeAttr("tabindex", 0);
    		}
    	}else if( $parent.hasClass("js-mobile-past-order-table") ){
    		if(addTabIndex){
    			$parent.children("div").attr("tabindex", 0);
    		}else{
    			$parent.children("div").removeAttr("tabindex", 0);
    		}
    	}
    },
        	
    tabPrevOrderTr: function(){
    	// target => source
    	// keyboard events on the colorbox itself
    	$('.js-preview-text').on('keydown', function (e) {
    	  var which = e.which;

    	  if (which === 9 && !e.shiftKey && $(this).closest("tr").hasClass("active")) { // TAB
    		  // tab from "X" (close) button then highlight first tabindex
    	      e.preventDefault();
    	      $(this).closest("tr").next(".prev-order-tr").find(".js-desktop-past-order-table").find(".js-header").focus();
    	  } 
        });

    	$(".js-last-col-past-order").on('keydown', function (e) {
    	  var which = e.which;

    	  if (which === 9 && !e.shiftKey) { // TAB
    		  // tab from "X" (close) button then highlight first tabindex
    	      e.preventDefault();
    	      $(this).closest(".prev-order-tr").prev(".responsive-table-item").find(".js-qty-selector-input").focus();
    	      $(this).closest(".prev-order-tr").prev(".responsive-table-item").find(".js-preview-text:visible").click();
    }
    	});
    	$(".prev-order-tr").on('keydown', function (e) {
    		var which = e.which;
    		if (which === 27) { // ESCAPE
      		  // click the cancel button which hides the colorbox and focuses it's trigger
      		  $(this).closest(".prev-order-tr").prev(".responsive-table-item").removeClass("active");
      		  $(this).closest(".prev-order-tr").prev(".responsive-table-item").find(".js-preview-text").focus();
      	  }
    	});
    }
}
ACC.savedcarts.saveCartModifyOrder = function (){
	var postfix = ACC.savedcarts.savedcartmodal;
	$.ajax({
		url: ACC.config.encodedContextPath + "/cart/save",
		data: $("#saveCartForm-"+postfix).serialize(),
		method: "POST",                        		
		success: function(){
			var code = $('#modify-order-code').val();
			var siebelId = $('#modify-order-siebelId').val();
			$.ajax({
        		url: ACC.config.encodedContextPath + "/modify-order/save-cart",
        		data: {"code":code,"siebelId":siebelId},
        		method: "GET",
        		success: function(rsp){
        			if (rsp ==='Success'){
        				window.location = ACC.config.encodedContextPath + '/cart';
        			} else if (rsp ==='ModifyError'){
        				$('#modifyOrderErrorModal').modal();
        				$('#modifyorderCutoffErr').hide();
        				$('#modifyorderException').show();
        			}
        		}   				
            });
        }
	});
}
ACC.savedcarts.saveCartCOFToggle = function (){
	$("#cofToggle").show();
	var postfix = ACC.savedcarts.savedcartmodal;
	$.ajax({
		url: ACC.config.encodedContextPath + "/cart/save",
		data: $("#saveCartForm-"+postfix).serialize(),
		method: "POST",                        		
		success: function(){
			$("#cofToggle").show();
			ACC.navigation.changeCofAfterSaveCart(ACC.CofId);
        },
        error: function() {
        	$("#cofToggle").hide();
        }
	});
}

ACC.savedcarts.showSaveCartFormCallback = function () {
	var postfix = ACC.savedcarts.savedcartmodal;
	var form = $('#saveCartForm-'+postfix);
	var title = $('.js-saveCart').data("saveCartTitle");
    if(ACC.CofModal) {
    	$('#cofModal').modal('hide');
    }
    ACC.colorbox.open(title, {
        href: "#saveCart-"+postfix,
        inline: true,
        width: "620px",
        onOpen: function () {
            if ($('#saveCartName-'+postfix).val()) {
                ACC.savedcarts.disableSaveCartButton(false);
            }
        },
        onComplete: function () {
        	ACC.savedcarts.resizeColorBox("#saveCart-"+postfix);
        	ACC.savedcarts.saveCart = false;
        },
        onClosed: function () {

            if (ACC.savedcarts.saveCart) {
            	if(ACC.CofModal) { // for COF Toggle
            		ACC.savedcarts.saveCartCOFToggle();
        			ACC.CofModal = false;
        		} else if(ACC.savedcarts.modifyOrder) { // for Modify Order
        			ACC.savedcarts.saveCartModifyOrder();
        			ACC.savedcarts.modifyOrder = false;
        		} else { 
            		// for other scenarios

    				ACC.common.removeStorageVariable("DataTables_js-cartDataTable");
    	        	
                    form.submit();
                }
            }
            document.getElementById("saveCartForm-"+postfix).reset();
            ACC.savedcarts.disableSaveCartButton(true);
        }
    });
};

ACC.savedcarts.bindSaveCartForm = function (){

        ACC.savedcarts.saveCartClick();
		
		$(document).on("click",'.js-saveCart .js-saveCartButton', function (e) {
			ACC.validateForm.validateSavecart($(this).parents(".js-saveCartForm"));

			if($(this).parents(".js-saveCartForm").valid()){
				e.preventDefault();
				
				ACC.savedcarts.saveCart = true;
				$.colorbox.close();	
			}
		});
		
		$(document).on("click","#save-cart-modify-order", function(e){
            e.preventDefault();
            ACC.savedcarts.modifyOrder=true;
            $('#modifyOrderModal').modal('hide');
            ACC.savedcarts.savedcartmodal = "modifyOrder";
            ACC.common.checkAuthenticationStatusBeforeAction(ACC.savedcarts.showSaveCartFormCallback);
		});
		
		ACC.savedcarts.saveCartReorder();
}

ACC.savedcarts.saveCartReorder = function (){
	$(document).on("click", '.js-reorder-save-cart-link', function (e){
		e.preventDefault();
		ACC.savedcarts.savedcartmodal = "orderDetail";
		 var modal = $("#saveCart-"+ACC.savedcarts.savedcartmodal) ;
		 modal.find("#saveCartName").val("");
		 modal.find("#saveCartDescription").val("");
		 modal.find("#saveCartForm").attr("action","/cart/save?isReorder=yes&orderId="+$('#siebelOrderid').val());
         if( $('#reorderModal').length > 0 && $('#reorderModal').hasClass('in') ) {
            	$('#reorderModal').modal('hide');
            }
         
         ACC.common.checkAuthenticationStatusBeforeAction(ACC.savedcarts.showSaveCartFormCallback);
     	
	});
	
	$('.js-saveCartName').keyup(function() {
		// enable the save cart button
		$('.js-saveCart .js-saveCartButton').prop('disabled', this.value.trim() == "" ? true : false);  	
	});
	
	$(document).on("click", '.cart-reorder-link', function(){
		var orderId=$(this).data('orderid');
		$('#reorderModal').find('#discardCartForm').find('#orderid').val(orderId);
		var reorderSaveCartAction="/cart/save?isReorder=yes&orderId="+orderId;
		$(".js-saveCartForm").attr("action",reorderSaveCartAction);
	});
	
	$(window).resize(function(){
		ACC.savedcarts.resizeColorBox(".js-saveCart");
	});
}

ACC.savedcarts.saveCartClick = function (){
	$(document).on("click",".js-save-cart-link",function(e){
        e.preventDefault();
        ACC.savedcarts.savedcartmodal = typeof($(this).data("postfix")) !== "undefined" ? $(this).data("postfix") : "savedCartDetail";
        var modal = $("#saveCart-"+ACC.savedcarts.savedcartmodal) ;
        modal.find("#saveCartForm").attr("action","/cart/save");
        modal.find("#saveCartName").val("");
        modal.find("#saveCartDescription").val("");
        if( $('#expOrdModal').length > 0 && $('#expOrdModal').hasClass('in') ) {
        	$('#expOrdModal').modal('hide');
        }
        
        ACC.common.checkAuthenticationStatusBeforeAction(ACC.savedcarts.showSaveCartFormCallback);
	});
    
    $(document).on("click",".js-save-cart-link-cartPage",function(e){
        e.preventDefault();
        ACC.savedcarts.savedcartmodal = "expressOrder";
        var modal = $("#saveCart-"+ACC.savedcarts.savedcartmodal) ;
        modal.find("#saveCartForm").attr("action","/cart/save");
        modal.find("#saveCartName").val("");
        modal.find("#saveCartDescription").val("");
        
        ACC.common.checkAuthenticationStatusBeforeAction(ACC.savedcarts.showSaveCartFormCallback);
	});
    
    $(document).on("click",".js-update-saved-cart",function(e){
        e.preventDefault();
        ACC.savedcarts.savedcartmodal = "savedCartDetail";
        var modal = $("#saveCart-"+ACC.savedcarts.savedcartmodal) ;
        var cartCode=$("#cartCode").val();
        modal.find("#saveCartForm").attr("action", ACC.config.encodedContextPath + "/my-account/saved-carts/"+cartCode+"/edit");
        modal.find("#saveCartForm").attr("method","post");
        modal.find("#saveCartName").val($("#cartNameHidden").val());
        modal.find("#saveCartDescription").val($("#cartDescHidden").val());
        
        ACC.common.checkAuthenticationStatusBeforeAction(ACC.savedcarts.showSaveCartFormCallback);
	});     
	
	$(document).on("click",'.js-saveCart .js-cancelSaveCartButton', function (e) {
		e.preventDefault();
		$.colorbox.close();
	});
}
ACC.notification = {

    _autoload: [
          //[As alert and Activities are out of scope so commenting the code to avoid unnecessary calls]
        //"acknowledgeNotification",
        //"loadNotifications",
       // "alertActivityCollapse"
    ],
	
    alertActivityCollapse: function(){
    	$('#activitiesCollapse').on('show.bs.collapse', function () {
    		$('#activitiesToggle').find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
    		});
    	$('#activitiesCollapse').on('hide.bs.collapse', function () {
    		$('#activitiesToggle').find('.glyphicon').removeClass('glyphicon-minus').addClass('glyphicon-plus');
		});
    	$('#alertsCollapse').on('show.bs.collapse', function () {
  		  $('#alertsToggle').find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
  		});
	  	$('#alertsCollapse').on('hide.bs.collapse', function () {
	  		$('#alertsToggle').find('.glyphicon').removeClass('glyphicon-minus').addClass('glyphicon-plus');
		});
    },
    formatDate: function (date) {
    	  var monthNames = [
    	    "Jan","Feb", "Mar", "Apr",
    	    "May", "Jun", "Jul","Aug", 
    	    "Sep", "Oct", "Nov", "Dec"
    	  ];
    	  var day = date.getDate();
    	  var monthIndex = date.getMonth();
    	  var year = date.getFullYear();

    	  return day + ' ' + monthNames[monthIndex] + ' ' + year;
    	},
    acknowledgeNotification: function(){
    	$(document).on('click','.js-acknowledge', function(){
    		var actId = $(this).data('activityId');
    		var ackBy = $('.js-current-user-name').html() ? $('.js-current-user-name').html().trim() : $('.js-current-user-name-dropdown').html().trim();
    		var ackDate = ACC.notification.formatDate(new Date());
    		var ackActivities = [];
    		var activity = {activityId:actId, comment:'', activityCallContact:ackBy};
    		ackActivities.push(activity);
    		var isPopup = $(this).data('isPopup') ? true : false ;
    		var that = $(this);
    		if(!that.hasClass('acknowledged')){
    			$.ajax({
            		url: ACC.config.encodedContextPath + "/ackactivity",    		
            		method: "POST", 
            		dataType:"json",
            		data: {ackActivities:JSON.stringify(ackActivities)},
            		success: function(){ 
        				if( isPopup === false){
            				var index = that.parents('tr').index();
            				var row = $('#activitiesCollapse').find('table').find('tbody').find('tr').eq(index);
            				row.find('.js-activity-ack-date').html(ackDate);
            				row.find('.js-ack-by').html(ackBy);
            				that.addClass('acknowledged');
            			}else{
            				ACC.notification.removeCarouselItem(actId);
            			}
            			var totalNotification = $('li[class*=js-activity_]').length + $('li[class*=js-alert_]').length;
            			$('.notification-number').text(totalNotification);
            			
            			
            		}
        		});
    			
    		}
    		
    	});
    },
    removeCarouselItem: function(activityid){
    	var indexToRemove = $("#js-activityModal .js-owl-notification").find('[data-activityid="' + activityid + '"]').parent('.owl-item').index();
    	$("#js-activityModal").find(".owl-carousel").trigger('remove.owl.carousel', [indexToRemove]).trigger('refresh.owl.carousel');
    	$(".js-activity.list").find('li[data-activityid="' + activityid + '"]').remove();
    	
    	if($("#js-activityModal .js-owl-notification").find('.owl-item').length <= 0){
    		$("#js-activityModal").modal("hide");
    		var html =  '<li class="activity">'+
						'<div class="row">'+
						'<div class="col-xs-12">'+	
						'<div><b>You do not have any pending activities</b></div>'+		
						'</div>'+
						'</div>'+
						'</li>';
    		$(".js-activity.list").append(html);
    	}
    },
    loadNotifications: function(){
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/alertandactivities",    		
    		method: "GET", 
    		dataType: "html",
    		success: function(data){
    			var notifications = $(data).eq(0);
    			var activities = notifications.find('.activityListItems').html();
    			var alerts = notifications.find('.alertListItems').html();
    			var alertCarouselItems = notifications.find('.alertCarouselItems').html();
    			var activityCarouselItems = notifications.find('.activityCarouselItems').html();
    			var totalNotification = notifications.find('.totalNotification').html();
    			
    			if(parseInt(totalNotification) > 0){
    				$('.notification-number').html(totalNotification).removeClass('hide');
        			$('.notificationLoading').hide();
        			$('.js-activity').append(activities);
        			$('.js-alert').append(alerts);
        			$('#js-alertModal').find('.js-owl-notification').append(alertCarouselItems);
        			$('#js-activityModal').find('.js-owl-notification').append(activityCarouselItems);
        			$(".js-owl-notification").owlCarousel({
        				navigation:true,
        				pagination:false,
        				singleItem : true
        			});
        			//carousel alert
        			$('.js-alert').find('.alert').each(function(i){
    	   				 $(document).on('click','.js-alert_'+i, function(){
    	   					 var alertid = $(this).data('alertid');
    	   					 var index = $("#js-alertModal .js-owl-notification").find('[data-alertid="' + alertid + '"]').parent('.owl-item').index();
    	   					 $('#js-alertModal').modal('show');
    	   					$("#js-alertModal").find(".js-owl-notification").trigger('owl.jumpTo', index);
    	   				 });
    	   			});
        			//carousel activity
        			$('.js-activity').find('.activity').each(function(i){
    	   				 $(document).on('click','.js-activity_'+i, function(){
    	   					 var activityid = $(this).data('activityid');
    	   					 var index = $("#js-activityModal .js-owl-notification").find('[data-activityid  ="' + activityid + '"]').parent('.owl-item').index();
    	   					 $('#js-activityModal').modal('show');
    	   					 $('#js-activityModal').find(".js-owl-notification").trigger('owl.jumpTo', index);
    	   				 });
    	   			});
    			}
    		},
    		error: function(){
    			$('.js-notificaton-sub-menu').addClass('hide');     
    		}
    	});
    }
};

ACC.faq = {
	
	_autoload: [
		["bindLink", $(".faq").find("[data-toggle=collapse]").length >0],
		["clickLink", $('.faq-left').find('ul').find('li').size()>0 ],
		"backToTop"
	],
	
	bindLink: function(){
		$('p.collapse').on('show.bs.collapse', function () {
			  // do something
			$(this).siblings(".q").addClass("in");
		});
		$('p.collapse').on('hide.bs.collapse', function () {
			  // do something
			$(this).siblings(".q").removeClass("in");
		});
	},
	
	clickLink : function(){
		var url=$('.faq-left').find('ul').first().find('li:nth-child(1) a').attr('href');
		$('.faq-left').find('ul').first().find('li:nth-child(1)').addClass('selected');
		var value=url.substr(url.indexOf('#')+1);	//value=my-account and such
		$('#'+value).parent().css('display','block');
		ACC.global.footerAlignment();
		
		$('.faq-left .js-faq-cms-links').find('ul').find('li a').click(function(){
			var href=$(this).attr('href');
			var hrefVal=href.substr(url.indexOf('#')+1);	//value=my-account and such
			$('.faq-right').find('.content').css('display','none');
			$('#'+hrefVal).parent().css('display','block');
			
			//selected link on left
			var selectedLi = $(this).parent();
			$('.faq-left').find("li").removeClass('selected');
			selectedLi.parent().find("li").removeClass("selected");
			selectedLi.addClass("selected");
			ACC.global.footerAlignment();
		})
	},
	
	backToTop : function(){
		// scroll body to 0px on click
		$(".faq a[href='#00']").click(function (e) {
			e.preventDefault();
			var top = $(".faq .textpage-faqs:visible").offset().top;
			$('body, html').animate({
				scrollTop: top
			}, 800);
			return false;
		});
		
		$(".faq .subItem a").click(function (e) {
			e.preventDefault();
			var hash = $(this).attr("href");
			hash = hash.replace("#", "");
			var top = $(".faq .textpage-faqs:visible a[name='"+hash+"']").offset().top;
			$('body, html').animate({
				scrollTop: top
			}, 800);
			return false;
		});
	}

};




ACC.specialRequest = {
	
	_autoload: [
		"init"
	],
	
	
	init : function(){
		
		///request table///
		
		
	}
};
ACC.deliverySchedule = {
	
	_autoload: [
		"init"
	],
	
	
	init : function(){
		
		$('#rescheduleReason').change(function(){
			
			if($(this).val() === '1'){
				$('.js-multipleDays').addClass('hide');
				$('.js-lessDelivery').addClass('hide');
				$('.js-currentDayClosed').removeClass('hide');
			}else if($(this).val() === '2'){
				$('.js-currentDayClosed').addClass('hide');
				$('.js-lessDelivery').addClass('hide');
				$('.js-multipleDays').removeClass('hide');
			}else if($(this).val() === '3'){
				$('.js-currentDayClosed').addClass('hide');
				$('.js-multipleDays').addClass('hide');
				$('.js-lessDelivery').removeClass('hide');
			}else{
				$('.js-currentDayClosed').addClass('hide');
				$('.js-multipleDays').addClass('hide');
				$('.js-lessDelivery').addClass('hide');
			}
		});
		
		$('#deliveryDateUpdateModal').on('shown.bs.modal', function () {
			$('#deliveryDateUpdateModal').find(".js-first-focus").focus();
			ACC.global.modalAccessibility( $('#deliveryDateUpdateModal'), $('#deliveryDateUpdateModal').find(".close"),  $('#deliveryDateUpdateModal').find(".js-last-focus"));
		});
		
		$("#deliveryDateUpdateModal").on('hidden.bs.modal', function () {
			$('.js-rescheduleDay')[0].reset();
			$('.js-currentDayClosed').addClass('hide');
			$('.js-multipleDays').addClass('hide');
			$('.js-lessDelivery').addClass('hide');
		});

		$('.js-updateDeliverySchedule').on('click', function(){
			$('.js-rescheduleDay').submit();
		});
		
		$('.js-upd-delivery-schedule').on('click', function(){
			$('#deliveryDateUpdateModal').modal();
		});
		
	},
	popupFormSubmit: function(form){
		$.ajax({
            type: "POST",
            url: $(form).attr('action'),
            data: $(form).serialize(),
            success: function (resp) {
            	if(resp === 'success'){
            		var reason = $('#rescheduleReason').val();
					$('.js-rescheduleDay')[0].reset();
					$('#rescheduleReason').val(reason);
					$('.ajaxSuccessMsg').removeClass('hide');
					$('.ajaxSuccessMsg').attr('aria-hidden',false);
				}
            }
        });
	}
	
	

};




/**
 * Captcha Script
 */
ACC.callCaptcha = {
	_autoload: [
		["init", $("#txtCaptcha").length > 0 && $("#CaptchaDiv").length > 0 && $("#CaptchaInput").length > 0]
	],
	checkform: function(){
		var why = "";
		$("#captchaError").html('');
		var inputValue = $("#CaptchaInput").val();
	    if(inputValue === ""){
	        why += $("#captchaError").data("empty");
	    }
	    if(inputValue !== ""){
	        if(ACC.callCaptcha.validCaptcha() === false){
	            why += $("#captchaError").data("mismatch");
	        }else{
	        	// do nothing
	        }
	    }
	    if(why !== ""){
	    	$("#captchaError").html(why);
	        return false;
	    }
	    return true;
	},
	// Validate input against the generated number
	validCaptcha: function(){
		var str1 = ACC.callCaptcha.removeSpaces($("#txtCaptcha").val());
	    var str2 = ACC.callCaptcha.removeSpaces($("#CaptchaInput").val());
	    return str1 === str2;
	},
	// Remove the spaces from the entered and generated code
	removeSpaces: function(string){
		return string.split(' ').join('');
	},
	init: function(){
		var a = Math.ceil(Math.random() * 9)+ '';
		var b = Math.ceil(Math.random() * 9)+ '';
		var c = Math.ceil(Math.random() * 9)+ '';
		var d = Math.ceil(Math.random() * 9)+ '';
		var e = Math.ceil(Math.random() * 9)+ '';

		var code = a + b + c + d + e;
		$("#txtCaptcha").val(code);
		$("#CaptchaDiv").text(code);
	}
}

ACC.contactform = {
	
	_autoload: [
		["bindForm", $("#contactUsForm").length >0],
		"enableSubmitButton"
	],
	
	spinner: $("<img src='" + ACC.config.commonResourcePath + "/images/spinner.gif' />"),
	
	email_pattern: /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,
	ph_pattern_ext: /^(\d{3})(-)(\d{3})(-)(\d{4})\s(x)(\d{1,})+$/,
	ph_pattern: /^(\d{3})(-)(\d{3})(-)(\d{4,})+$/,
	
	email_length: 255,
	
	bindForm: function(){
		$('#selectedSubject').val($('#j_subject :selected').text());
		$('#emailId').val($('#j_subject :selected').val());
		
		$("#j_telephone").on("keydown", function(event) {
			ACC.profile.preventNonNumberEntry(event);
		});
		$("#j_telephone").on("keyup", function() {
			var ph = $(this).val().replace(/[,()\ x-]/g, "");
			if( ph.length > 10 ){
				$(this).val(ph.replace(/^(\d{3})(\d{3})(\d{4})(\d{1,})+$/, "$1-$2-$3 x$4"));
			}else{
				$(this).val(ph.replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
			}
		});
		
		$(document).on("click", '#submitForm', ACC.contactform.submitForm);
	},
	
	submitForm: function(){
		$('#selectedSubject').val($('#j_subject :selected').text());
		$('#emailId').val($('#j_subject :selected').val());
		var encodedMessage=encodeURIComponent($("#j_message").val());
		$("#j_message").val(encodedMessage);
		var encodedName=encodeURIComponent($("#j_name").val());
		$("#j_name").val(encodedName);
		var encodedAddress=encodeURIComponent($("#j_address").val());
		$("#j_address").val(encodedAddress);
		
		
		var options = {
			type: 'POST',
			beforeSubmit: ACC.contactform.beforeSubmit,
			success: ACC.contactform.success,
			error: ACC.contactform.error,
			complete: ACC.contactform.complete
		};
		
		$('#contactUsForm').ajaxForm(options);
		
	},
	
	beforeSubmit: function(arr){
		$('.contactus').block({ message: ACC.contactform.spinner });
		var hasNoError = ACC.contactform.validate(arr);
		if( !hasNoError ){
			contactUsForm.elements.j_message.value = decodeURIComponent(contactUsForm.elements.j_message.value);
			contactUsForm.elements.j_name.value = decodeURIComponent(contactUsForm.elements.j_name.value);
			contactUsForm.elements.j_address.value = decodeURIComponent(contactUsForm.elements.j_address.value);
		}
		return hasNoError;
	},

	success: function(data){
		if(data=="success"){
			$('#contactResultModal').find('.modal-body').find('p').html(ACC.contactUsSuccessMsg);
		}
		else{
			$('#contactResultModal').find('.modal-body').find('p').html(ACC.contactUsFormErrorMsg);
		}
		$('#contactResultModal').modal('show');
		ACC.callCaptcha.init();
	},

	error: function(){
		$('#contactResultModal').find('.modal-body').find('p').html(ACC.contactUsErrorMsg);
		$('#contactResultModal').modal('show');
	},

	complete: function(){
		$('.contactus').unblock();
		$('#contactUsForm').resetForm();
	},
	
	validEmail: function(email){
		var pattern = ACC.contactform.email_pattern;
		return pattern.test( email );
	},
	
	validNo :  function(no){
		var pattern;
		if( no.length > 12 ){
			pattern = ACC.contactform.ph_pattern_ext;
			return pattern.test( no );
		}else{
			pattern = ACC.contactform.ph_pattern;
			return pattern.test( no );
		}
	},
	
	isValidated: function(formArr){
		var hasError = false;
		var toFocus = true;
		if( formArr.length ){
			for( var field in formArr ){
				if( !$.trim(formArr[field].value).length ){
					hasError = true;
					var elem = $("[name="+formArr[field].name+"]"),
					label = elem.closest(".form-group").find("label");
					$("#error_"+formArr[field].name).removeClass("hide").attr("aria-hidden", false).text($("#pleaseEnter").text()+" "+label.text());
					toFocus ? $(elem).focus(): '';
					toFocus = false;
				}
			}
		}
		return hasError;
	},
	
	validate: function(formArr){
		// jqForm is a jQuery object which wraps the form DOM element 
	    // 
	    // To validate, we can access the DOM elements directly and return true 
		$('#contactUsForm').find("[id^=error_]").addClass("hide").attr("aria-hidden", true).text("");
		
		var hasError = ACC.contactform.isValidated(formArr);
		
		
		
		if(!hasError){
			
			hasError = ACC.contactform.inputHasError() || ACC.contactform.emailHasError();
			
			if(typeof($("#j_message").val())!='undefined' && $("#j_message").val().length>1000)	{
				hasError = true;
				$("#error_j_message").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsMessageMaxLenError);
			}
		}
		
	    if (hasError) { 
	    	$('.contactus').unblock();
	        return false; 
	    }
	    
	    return true;
	},
	
	hasContactPhoneError: function(){
		var returnError = false;
		var phoneNo=$('#contactUsForm input[name=j_telephone]').fieldValue()[0];
		if(typeof phoneNo !== 'undefined' && phoneNo.length<10)	{
			returnError = true;
			$('#contactUsForm input[name=j_telephone]').focus();
			$("#error_j_telephone").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsPhoneError);
		}
		
		if(typeof phoneNo !== 'undefined' && !ACC.contactform.validNo( phoneNo )){
			returnError = true;
			$('#contactUsForm input[name=j_telephone]').focus();
			$("#error_j_telephone").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsPhoneError);
		}
		return returnError;
	},
	
	inputHasError: function(){
		var returnError = false;
		
		if($("#loggedIn").val()=='false' && !ACC.callCaptcha.checkform()){
			returnError = true;
			$("#error_CaptchaInput").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsCaptchaError);
		}
		if($("#j_cof").length > 0 && $("#j_cof").val().toUpperCase().indexOf("NULL") != -1){
			$("#error_j_cof").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsCofError);
			returnError = true;
		}
		if($("#j_name").val().toUpperCase().indexOf("NULL") != -1){
			$("#error_j_name").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsNameError);
			returnError = true;
		}
		if($("#j_address").val().toUpperCase().indexOf("NULL") != -1){
			returnError = true;
			$("#error_j_address").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsAddressError);
		}
		if(	ACC.contactform.hasContactPhoneError() ){
			returnError = true;
		}
		
		return returnError;
	},
	
	emailHasError: function(){
		var hasError = false;
		var email = $('#contactUsForm input[name=j_email]').fieldValue()[0];
		if( !ACC.contactform.validEmail( email ) ){
			$('.contactus').unblock();
			$("#error_j_email").removeClass("hide").attr("aria-hidden", false).text($("#pleaseEnter").text()+" "+ACC.validEmailText);
	        //Comment return false; 
			hasError = true;
		}else if( email.length > ACC.contactform.email_length ){
			$('.contactus').unblock();
			$("#error_j_email").removeClass("hide").attr("aria-hidden", false).text(ACC.contactUsEmailLengthError);
	        //Comment return false;
			hasError = true;
		}
		return hasError;
	},
	
	enableSubmitButton: function(){
		$(window).load(function(){
			$("#submitForm, #cancelSubmit").removeAttr("disabled");
		});
	}
};

ACC.cutOffTime = {
	_autoload: [ 
		["init", $(".dayText").length > 0 ],
		"convertBestCallDateTimezone",
		"convertSavedCartDateTimezone",
		"convertOrderDetailsDateTimezone"
	],
	d2:null,
	d3:null,
	nextNextDeliveryDate:null,
	cutOffDateTimeExpire:false,
	mins:0,
	days:0,
	hours:0,
	secs : 0,
	init: function(){
		var dateExist = false;
		if( typeof( CutOffDateAndTime1) !== "undefined" && CutOffDateAndTime1.length > 0 ){
			dateExist = true;
		}
		if( typeof(CutOffDateAndTime) !== "undefined" && CutOffDateAndTime.length > 0 ){
			dateExist = true;
		}
		if( dateExist ){
			ACC.cutOffTime.convertDeliveryTimezone();
		}
	},
	
	displayDeliveryOn: function( dateText ){
		if( $("#deliveryOnId").length > 0 ){
			$("#deliveryOnId").text( dateText );
		}
	},
	
	getJsSupprtDate: function(date, format, displayDeliveryOn){
		var returnDate;
		//objDate.toLocaleString().split(" ")[0] for full month
		switch (format) {
		case ACC.cutOffDateFormat:
			returnDate = new Date( parseInt(date.substr(6, 4)), (parseInt(date.substr(0, 2))-1), parseInt(date.substr(3, 2)), parseInt(date.substr(11, 2)), parseInt(date.substr(14, 2)), 0 );
			if(displayDeliveryOn){
				ACC.cutOffTime.displayDeliveryOn( returnDate.toString().split(" ")[1] + " " + parseInt(date.substr(3, 2)) );
			}
			break;
		case ACC.nextDeliveryDateFormat:
			returnDate = new Date( parseInt(date.substr(6, 4)), (parseInt(date.substr(0, 2))-1), parseInt(date.substr(3, 2)), 0, 0, 0 );
			if(displayDeliveryOn){
				ACC.cutOffTime.displayDeliveryOn( returnDate.toString().split(" ")[1] + " " + parseInt(date.substr(3, 2)) );
			}
			break;
		default:
			//YYYY/MM/DD HH:MM:SS
			returnDate = new Date( parseInt(date.substr(0, 4)), (parseInt(date.substr(5, 2))-1), parseInt(date.substr(8, 2)), parseInt(date.substr(11, 2)), parseInt(date.substr(14, 2)), parseInt(date.substr(17, 2)) );
			if(displayDeliveryOn){
				ACC.cutOffTime.displayDeliveryOn( returnDate.toString().split(" ")[1] + " " + parseInt(date.substr(8, 2)) );
			}
			break;
		}
		return returnDate;
	},
	
	
	convertDeliveryTimezone: function() {
		var cutoffDate = $('#deliveryCutOffDt').val();
		var formattedCutoffDate = ACC.cutOffTime.convertUTCtoLocalTime(cutoffDate, 'ddd M/D/YYYY h:mm A z');
		$('.dayText').html(formattedCutoffDate);
		var deliveryDate = $('#deliveryOnId').text();
		var formattedDelvDate = ACC.cutOffTime.convertUTCtoLocalTime(deliveryDate, 'ddd M/D/YYYY');
		if($('#deliveryOnId').length > 0) {
			$('#deliveryOnId').text(formattedDelvDate);
			$('.deliveryTextContainer').removeClass('hide');
		}
		if($('#nextDeliveryOnId').length > 0) {
			$('#nextDeliveryOnId').text(formattedDelvDate);
			$('#nextDeliveryOnId').removeClass('hide');
		}
		if($('.businessInfoDelDate').length > 0) {
			var businessInfoDelDate = ACC.cutOffTime.convertUTCtoLocalTime(deliveryDate, 'ddd');
			$('.businessInfoDelDate').text(businessInfoDelDate ? businessInfoDelDate.toUpperCase() : businessInfoDelDate);
			$('.businessInfoDelDate').removeClass('hide');
		}
		if($('.businessInfoCutOffDate').length > 0) {
			var businessInfoCutOffDate = ACC.cutOffTime.convertUTCtoLocalTime(cutoffDate, 'h:mm A z on ddd');
			businessInfoCutOffDate = businessInfoCutOffDate ? businessInfoCutOffDate.toUpperCase() : businessInfoCutOffDate;
			$('.businessInfoCutOffDate').text(businessInfoCutOffDate.replace('ON', 'on'));
			$('.businessInfoCutOffDate').removeClass('hide');
		}
	},
	
	convertUTCtoLocalTime: function(vDate, format) {
		moment.suppressDeprecationWarnings = true;
		if(vDate) {
			var localTz;
			if(typeof(Intl) !== "undefined") {
				localTz = Intl.DateTimeFormat().resolvedOptions().timeZone; //get local TimeZone
			}
			if(!localTz && typeof(jstz) !== "undefined") {
				localTz = jstz.determine().name(); //if not available, try jsTZ API (for IE11 and old browsers)
			}
			if(!localTz) {
				localTz = "America/New_York"; //if still not available, set EST as default local TimeZone
			}
			vDate = moment.tz(vDate, localTz).format(format); //format date based on local TimeZone
			if($('#clientTimeZone').length > 0) {
				$('#clientTimeZone').val(localTz);
			}
		}
		return vDate;
	},
	
	convertToLocalTimeArray: function(dateArray, format) {
		var convertedDates = [];
		if(dateArray) {
			for (var j = 0; j < dateArray.length; j++) {
				convertedDates.push(ACC.cutOffTime.convertUTCtoLocalTime(dateArray[j], format));
			}
		}
		return convertedDates;
	},
	
	convertBestCallDateTimezone: function() {
		if($('#bestCallTime').length > 0 && $('#bestCallTimeCustTime').length > 0) {
			var callTime = $('#bestCallTimeCustTime').val();
			var formattedCallTime = ACC.cutOffTime.convertUTCtoLocalTime(callTime, 'h:mm A');
			$('#bestCallTime').val(formattedCallTime ? formattedCallTime.toUpperCase() : formattedCallTime);
		}
	},
	
	convertOrderDetailsDateTimezone: function() {
		if($('#orderdetails_deliverydate').length > 0) {
			var deliveryDate = $('#orderdetails_deliverydate').text();
			deliveryDate = ACC.cutOffTime.convertUTCtoLocalTime(deliveryDate, 'ddd M/D/YYYY');
			$('#orderdetails_deliverydate').text(deliveryDate);
			$('#orderdetails_deliverydate').removeClass('hide');
		}
		if($('#orderdetails_placeddate').length > 0) {
			var placedDate = $('#orderdetails_placeddate').text();
			placedDate = ACC.cutOffTime.convertUTCtoLocalTime(placedDate, 'ddd M/D/YYYY hh:mm A z');
			$('#orderdetails_placeddate').text(placedDate);
			$('#orderdetails_placeddate').removeClass('hide');
		}
	},
	convertSavedCartDateTimezone: function() {
		$(".js-saved-cart-date").each(function() {
			var savedCartDate = $(this).text();
			savedCartDate = ACC.cutOffTime.convertUTCtoLocalTime(savedCartDate, 'ddd MM/DD/YYYY hh:mm A z');
			$(this).text(savedCartDate);
			$(this).removeClass('hide');
		});
		if($('#saved-cart-date').length > 0) {
			var savedCartDate = $('#saved-cart-date').text();
			savedCartDate = ACC.cutOffTime.convertUTCtoLocalTime(savedCartDate, 'ddd MM/DD/YYYY hh:mm A z');
			$('#saved-cart-date').text(savedCartDate);
			$('#saved-cart-date').removeClass('hide');
		}
	},
	doNotCall: function(){
		// assign d3
		ACC.cutOffTime.d3 = ACC.cutOffTime.getJsSupprtDate(cutOffDateAndTimeLocal1, ACC.cutOffDateFormat, false);
		// assign d2
		ACC.cutOffTime.d2 = ACC.cutOffTime.getJsSupprtDate(cutOffDateAndTimeLocal, ACC.cutOffDateFormat, false);
	},
	
	convertLocaltoUTC: function(lDate, frmt) {
		return moment.utc(lDate).format(frmt);
	}
}

//################################################################
//#### Custom Tooltip 
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.toolTip={
	_autoload: [   		
	    		"bindTooltip"
	    	],
	bindTooltip : function () {
		$('.toolltip').tooltip({
			position: { my: "left+15 center", at: "right center" },
			classes: {
			    "ui-tooltip": "messageHelper"
			  }
		});
		$('.passwordTooltip').tooltip({
			position: { my: "left+15 bottom+20", at: "right top" },
			classes: {
			    "ui-tooltip": "messageHelper"
			  },
			content: function(){
				return $(this).data( "content" );
			}  
		});
		$('.productTooltip').tooltip({
			position: { my: "left+10 center", at: "left bottom+5" },
			classes: {
			    "ui-tooltip": "messageHelper"
			  }
		});
		$('.carouselTooltip').tooltip({
			position: { my: "left+10 center", at: "left bottom+15" },
			classes: {
			    "ui-tooltip": "messageHelper"
			  }
		});
		ACC.toolTip.showToolTipOnCustomerName();
    },
    showToolTipOnCustomerName: function(){
    	$('.js-tooltip').tooltip({
			"content": function(){
				var description = $(this).siblings("span").html();
				return description;
			}
		});
    }    	
};

ACC.deliveryDate = {

	_autoload: [
        ["datePicker",  typeof(ACC.eligibleDate) !== "undefined"]
	],

	flag:'false',
	dateFormat: ACC.datepickerFormat,
	eligibleDate : ACC.cutOffTime ? ACC.cutOffTime.convertToLocalTimeArray(ACC.eligibleDate, 'MM/DD/YYYY') : ACC.eligibleDate,
	eligibleStdDateTime : ACC.eligibleDate,
	eligibleDateTime : ACC.eligibleDate,
	eligibleCutoffDateTime: ACC.eligibleCutOffDate,
	enableAlertFlag: 'false',
	curDate:'',
	datePicker: function ()	{
		if ($('#flag').length >= 1 ){
            ACC.deliveryDate.flag = $('#flag').val().toLowerCase();
		}
		ACC.deliveryDate.convertDefaultDateTimeZone();
	    
		$( "#deliveryDate" ).datepicker({
	      showOn: "button",
	      dateFormat: ACC.deliveryDate.dateFormat,
	      buttonText: "",
	      defaultDate: ACC.deliveryDate.eligibleDate[0],
	      beforeShowDay: ACC.deliveryDate.available,
		  beforeShow: function (input, inst) {
			  ACC.common.logConsole(inst.selectedDay);
			  ACC.deliveryDate.populateOffScheduleDates(input);
			  ACC.deliveryDate.alertUser(input);
			  ACC.deliveryDate.curDate = $('#deliveryDate').val();
			  $("#calStatus").text("calender expanded");
			  setTimeout(function(){
				  $("#deliveryDate").attr({"aria-hidden":"true"});
			  }, 500);
		  },
          onChangeMonthYear : function(year, month, inst){
        	  ACC.common.logConsole(inst.selectedYear);
        	  ACC.deliveryDate.alertUser(this);
		 },
	     onSelect:  function(dateText, inst) { 
	    	 if( $(".exceedsCutOff").length > 0 ){
	    		 $(".exceedsCutOff").addClass("display-none");
	    	 }
	    	 ACC.deliveryDate.onSelectDatePicker(dateText, inst);
	    	 ACC.cartitem.showPriceOrder();
	    	 if(ACC.deliveryDate.curDate !== $('#deliveryDate').val()){
	    		 ACC.cartitem.showPriceOrder();
	    	 }
	       },
	       onClose: function(){
	    	   $("#deliveryDate").attr({"aria-hidden": "false"});
	    	   $("#calStatus").text("calender Collapsed");
	       }
	    });
		
		$(".ui-datepicker-trigger").attr({"aria-label":"calendar icon", "aria-expanded":"false"});
		 ACC.deliveryDate.accessibility($("#deliveryDate"));
	},
	
	onSelectDatePicker: function(dateText, inst) { 
	   	  ACC.common.logConsole(inst.selectedDay); 
		  var dateAsString = dateText; //the first parameter of this function
	      var cutoffDate;
	      for (var j = 0; j < ACC.deliveryDate.eligibleDate.length; j++) {
			if(ACC.deliveryDate.eligibleDate[j] == dateAsString) {
				dateAsString = ACC.deliveryDate.eligibleDateTime[j];
				cutoffDate = ACC.deliveryDate.eligibleCutoffDateTime[j];
				if($("#submitDeliveryDate") && $("#submitDeliveryDate").length > 0 && dateAsString.length > 0){
			    	  $("#submitDeliveryDate").val(dateAsString);
			    }
				if($("#submitCutOffDate") && $("#submitCutOffDate").length > 0){
			    	  $("#submitCutOffDate").val(cutoffDate);
			    }
				break;
			}
		  }
	      
	      $('#deliveryDate').val(ACC.cutOffTime.convertUTCtoLocalTime(dateAsString, 'M/D/YYYY').toUpperCase());
	      $( "#deliveryChk" ).validate().element("#deliveryDate" );
	      
	      ACC.deliveryDate.setDates(dateAsString,cutoffDate);
	      if($("#deliveryDate_label").length > 0){
			$("#deliveryDate_label").remove();
	      }
	   },
	   
	   
    setDates : function(dateAsString,cutoffDate){
	   	$.ajax({
				url: ACC.config.encodedContextPath + "/cart/setDates", 
				method: "POST",
				data : {"deliveryDate":dateAsString , "cutoffDate":cutoffDate}
		    });
	   },
	
	available : function(date) {
		var dateFormat = ACC.deliveryDate.getDateFormat(date);
		var stdDateTime = ACC.deliveryDate.eligibleStdDateTime ? ACC.deliveryDate.eligibleStdDateTime[0] : "";
		if ($.inArray(dateFormat, ACC.deliveryDate.eligibleDate) !== -1) {
			var highlightClass = (stdDateTime && stdDateTime.indexOf(dateFormat) !== -1 ) ? "highlight" : "";
            return [true, highlightClass,"Available"];
		} else {
			if(ACC.deliveryDate.enableAlertFlag === 'true') {
				return [true,"notAvailable","Unavailable"];
			} else {
				return [false];
			}
		}   
	},
	
	getDateFormat : function(date){
		var dt = ACC.deliveryDate.getFormattedDate(date);
		
		var month = ACC.deliveryDate.getFormattedMonth(date);
			
		var monthString =  date.toLocaleString("en-us", { month: "long" });	
		//formats:
		var yyyymmdd =       (date.getFullYear() + "-" + month + "-" + dt);
		var ddmmyyyy =       (dt + "-" + month + "-" + date.getFullYear());
		var mmddyyyy =       (month + "-" + dt + "-" + date.getFullYear());
		
		var yyyymmdd_slash = (date.getFullYear() + "/" + month + "/" + dt);
		var ddmmyyyy_slash = (dt + "/" + month + "/" + date.getFullYear());
		var mmddyyyy_slash = (month + "/" + dt + "/" + date.getFullYear());
		var MMddyyyy_string = (monthString + " " + dt + ", " + date.getFullYear());
		
		var dateFormat;
		
		if(ACC.deliveryDate.dateFormat === 'yy-mm-dd'){
			dateFormat = yyyymmdd;
		}else if(ACC.deliveryDate.dateFormat === 'dd-mm-yy'){
			dateFormat = ddmmyyyy;
		}else if(ACC.deliveryDate.dateFormat === 'mm-dd-yy'){
			dateFormat = mmddyyyy;
		}else if(ACC.deliveryDate.dateFormat === 'yy/mm/dd'){
			dateFormat = yyyymmdd_slash;
		}else if(ACC.deliveryDate.dateFormat === 'dd/mm/yy'){
			dateFormat = ddmmyyyy_slash;
		}else if(ACC.deliveryDate.dateFormat === 'MM dd, yy'){
			dateFormat = MMddyyyy_string;		
		}else{
			dateFormat = mmddyyyy_slash;
		}
		return dateFormat;
	},
	
	getFormattedDate: function(date){
		var dt = date.getDate();
		return dt < 10 ? "0"+dt : dt;
	},
	
	getFormattedMonth: function(date){
		var month = (date.getMonth()+1);
		return month < 10 ? "0"+month : month;
	},
	
	alertUser: function(input){
		setTimeout(function() {
		   $('.notAvailable').on('click', function(){
				if(ACC.deliveryDate.flag === 'true'){
					$('#messageNotAllowedCalendar').modal();
					$(input).val("");
				}else
				    $(input).val("");
		   });
		 }, 0);
	},
	
	repositionCalendar: function(){
		var c_offset = $('#ui-datepicker-div').offset();
		var d_offset = $('.datepickerInput').offset();
		if( c_offset.top < d_offset.top ){
			$('#ui-datepicker-div').css({top:5 + d_offset.top + $('.datepickerInput').outerHeight(true)});
		}
	},
	
	populateOffScheduleDates: function(input) {
		$("#offschedule_errormsg").addClass("hide");
		$("#deliveryDate").addClass("date-loading");
		$(".ui-datepicker-trigger").attr("disabled","disabled");
		ACC.deliveryDate.enableAlertFlag = 'false';
    	$.ajax({
    		url: ACC.config.encodedContextPath + "/cart/fetchOffScheduleDates",
    		method: "GET",
    		success: function(rsp) {
    			if(rsp && rsp == 'Error') {
    				$("#offschedule_errormsg").removeClass("hide");
    				ACC.deliveryDate.repositionCalendar();
    			}
    			else if (rsp) {
    				var dates = $.parseJSON(rsp);
    				ACC.deliveryDate.eligibleDateTime = ACC.eligibleDate.slice();
    				ACC.deliveryDate.eligibleCutoffDateTime = ACC.eligibleCutOffDate.slice();
    				$.each(dates.deliveryDateList, function(i, obj) {
    					ACC.deliveryDate.eligibleDateTime.push(obj.deliveryDate);
    					ACC.deliveryDate.eligibleCutoffDateTime.push(obj.cutOffDate);
    				});
    				ACC.deliveryDate.eligibleDate = ACC.cutOffTime ? ACC.cutOffTime.convertToLocalTimeArray(ACC.deliveryDate.eligibleDateTime, 'MM/DD/YYYY') : ACC.eligibleDate.slice();
    			}
    		},
    		error: function() {
    			$("#offschedule_errormsg").removeClass("hide");
    			ACC.deliveryDate.repositionCalendar();
    		},
    		complete: function() {
    			$("#deliveryDate").removeClass("date-loading");
    			$(".ui-datepicker-trigger").removeAttr("disabled");
    			ACC.deliveryDate.enableAlertFlag = 'true';
    			$("#deliveryDate").datepicker("refresh");
    			ACC.deliveryDate.alertUser(input);
    		}
    	});
	},
	convertDefaultDateTimeZone: function() {
		if($('.datepickerInput').length > 0 && ACC.cutOffTime) {
			var deliveryDate = $('#deliveryDate').val();
			if(ACC.cutOffTime) {
				$('#deliveryDate').val(ACC.cutOffTime.convertUTCtoLocalTime(deliveryDate, 'M/D/YYYY').toUpperCase());
			} else {
				$('#deliveryDate').val(deliveryDate);
			}
			
			$('#submitDeliveryDate').val(deliveryDate);
			
			$('.datepickerInput').removeClass('hide');
		}
	},
	accessibility: function(ele) {
		ele.keydown(function(evt) {
				var arrKeys = evt.ctrlKey && evt.keyCode >= 36 && evt.keyCode <= 40;
			  if ( arrKeys || evt.keyCode == 33 || evt.keyCode == 34) {
			    var message = "You are now accessing " + $(".ui-state-hover").html() +
			      " " + $(".ui-datepicker-month").html() +
			      " " + $(".ui-datepicker-year").html();
			    ele.parent().find('#liveRegion').html(message);
			  }
			  evt.stopPropagation();
		});
	}
};

//################################################################
//#### Custom Tooltip 
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.validateForm={
	_autoload: [   		 
	    		"validateDeliveryDate",
	    		"validateLogin",
	    		"newRules",
	    		"telephoneRule",
	    		"specialcharRule",
	    		"zipcodeRule",
	    		"loginvalidateform",
	    		"triggerModal",
	    		"registervalidateform",
	    		"updateProfileFormValidation",
	    		"editProfileFormValidation",
	    		"addNewProfileFormValidation",
	    		"resetPasswordFormValidation",
	    		["profileValidationRules", $("#addNewProfileForm").length > 0 || $("#editProfileForm").length > 0 || $("#updateProfileForm").length > 0 ],
	    		["profileUniqueUserValidationRules", $("#addNewProfileForm").length > 0 || $("#editProfileForm").length > 0 || $("#updateProfileForm").length > 0],
	    		["businessformChangeValidation", $('#businessHoursForm').length > 0 || $('#businessInfoForm').length > 0 ],
	    		["businessInfoFormValidation", $('#businessHoursForm').length > 0 || $('#businessInfoForm').length > 0 ],
	    		"extendedFunctions"
	    	],
	    	profileUniqueEmailId: function(element){
	    		var allEmail = [];
    			var contactId = $(element).closest('form').find('[name="contactId"]').val();
    			var emailId = $(element).closest('form').find('[name="emailId"]').val();
    			$("[id^='emailAddress_']").each(function(){
    				if( ($(element).closest('form').attr("id") === "addNewProfileForm" && $(this).text() !== "" ) 
    						|| ($(this).text() !== "" && "emailAddress_" + contactId !== $(this).attr('id'))){
    					allEmail.push($(this).text().trim());
    				}
    			});
    			return ($.inArray( emailId, allEmail ) < 0)? true: false
	    	},
	    	profileValidationRules : function(){
	    		
	    		jQuery.validator.addMethod("phoneFormat", function(value, element) {
	    			// Updating validation logic return this.optional(element) || (/^(\d{3}\-)?(\(\d{3}\)) ?\d{3}\-\d{4,}$/g).test(value) 
	    			return this.optional(element) || (/^(\d{3})(-)(\d{3})(-)(\d{4,})+$/).test(value);
	    		},ACC.phoneFormatError);
	    		
	    		jQuery.validator.addMethod("uniqueEmailId", function(value, element) {
    				return ACC.validateForm.profileUniqueEmailId(element);
	    		},'Email already registered');
	    	},
	    	profileUniqueUserValidationRules: function(){
	    		jQuery.validator.addMethod("uniqueUser", function(value, element) {
	    			
	    			var formId = $(element).closest('form').attr('id');
	    			var originalBusinessNo = $(element).closest('form').find('.js-'+formId+'_business').val(),
		    			originalExNo = ($(element).closest('form').find('.js-'+formId+'_business_ext').val() === "")? $(element).closest('form').find('.js-'+formId+'_business_ext').val() : " x"+$(element).closest('form').find('.js-'+formId+'_business_ext').val(),
		    			originalJobTitle = $(element).closest('form').find('.js-'+formId+'_jobTitle').val().toLowerCase(),
		    			originalUserName = $(element).closest('form').find('.js-'+formId+'_businessName').val().trim().toLowerCase() + " "+ $(element).closest('form').find('.js-'+formId+'_lastName').val().trim().toLowerCase();
	    			
	    			var originalUser = originalBusinessNo+originalExNo+"_"+originalJobTitle+ "_"+ originalUserName;
	    			
	    			var	 businessNo = $(element).closest('form').find('[name="phoneNo"]').not('.js-'+formId+'_business').val(),
	    				 exNo = ($(element).closest('form').find('[name="phoneNoExtn"]').not('.js-'+formId+'_business_ext').val() === "")?$(element).closest('form').find('[name="phoneNoExtn"]').val() : " x"+$(element).closest('form').find('[name="phoneNoExtn"]').val(),
	    				 jobTitle = $(element).closest('form').find('[name="jobTitle"]').not('.js-'+formId+'_jobTitle').val().toLowerCase(),
	    				 user = $(element).closest('form').find('[name="firstName"]').not('.js-'+formId+'_businessName').val().trim().toLowerCase() + " " + $(element).closest('form').find('[name="lastName"]').not('.js-'+formId+'_lastName').val().trim().toLowerCase(),
	    				 //contactId = $(element).closest('form').find('[name="contactId"]').val().toLowerCase(),
	    				 users = [];
	    			var parentFormId = $(element).closest('form').attr("id"),
	    				excludeFormArr = ["updateProfileForm", "editProfileForm"];
	    			var currentUser = businessNo+exNo+"_"+jobTitle+ "_"+ user;
	    			var tableItems = $('.js-manageContactTable').find('tbody').find('.responsive-table-item');
	    			
	    			if(  $.inArray( parentFormId, excludeFormArr ) < 0){
	    				
	    				// add new form
		    			tableItems.each(function(){
		    				var ph = $(this).find("[id^='wrkPhone_']").text().trim();
		    				var userName = $(this).find("[id^='firstName_']").text().trim().toLowerCase()+ " " + $(this).find("[id^='lastName_']").text().trim().toLowerCase();
		    				var jobTitle = $(this).find("[id^='jobTitle_']").val().trim().toLowerCase();
		    					users.push(ph+"_"+jobTitle+ "_"+ userName);
		    			});
		    		
	    			}else{
	    				// not add new form
	    				tableItems.each(function(){
		    				var ph = $(this).find("[id^='wrkPhone_']").text().trim();
		    				var userName = $(this).find("[id^='firstName_']").text().trim().toLowerCase()+ " " + $(this).find("[id^='lastName_']").text().trim().toLowerCase();
		    				var jobTitle = $(this).find("[id^='jobTitle_']").val().trim().toLowerCase();
		    				var tableUser = ph+"_"+jobTitle+ "_"+ userName;
		    				if(tableUser !== originalUser){	
		    					users.push(ph+"_"+jobTitle+ "_"+ userName);
		    				}
		    			});
	    			}
	    			return ($.inArray( currentUser, users ) < 0)? true : false;
	    		},'User already exists');
	    	},
	    	newRules : function(){
	    		jQuery.validator.addMethod("lettersonly", function(value, element) {
	    			return this.optional(element) || /^[a-z]+$/i.test(value);
	    		}, "Letters only please");
	        	//creating new method for password
	    		jQuery.validator.addMethod("isNotsameAsUsername", function(value, element) {
	    				var username = $('#j_username').val();
	    				if(username.match(/.{3}/g) != null){
	    					var partsOfThreeLetters = username.match(/.{3}/g).concat(
	    							username.substr(1).match(/.{3}/g),
	    							username.substr(2).match(/.{3}/g) );
	    					return this.optional(element) || !(new RegExp(partsOfThreeLetters.join("|"), "i").test(value));
	    				}else{
	    					return this.optional(element) || true;
	    				}
	    				
	    		},'Password should not contain any part of the username');
	    		
	    		jQuery.validator.addMethod("alphanumeric", function(value, element) {
	    			// alphanumeric with capital /^([^0-9]*|[^A-Z]*|[^a-z]*|[a-zA-Z0-9])$/
	    			// alphanumeric /^([^0-9]*|[a-zA-Z0-9])$/
	    			return this.optional(element) || (/^.*(?=.)(?=.*\d)(?=.*[a-zA-Z]).*$/.test(value));
	    		},'Password should be alphanumeric');
	    	},
	    	telephoneRule:function(){
	    		jQuery.validator.addMethod("phoneMinLength", function(value, element) {
	    			var inputVal = value.replace(/-/gi,'');
	    			return this.optional(element) || ( inputVal.length >= parseInt(ACC.registerPhoneMin) );
	    		},ACC.phoneFormatError);
	    		jQuery.validator.addMethod("phoneMaxLength", function(value, element) {
	    			var inputVal = value.replace(/-/gi,'');
	    			return this.optional(element) || ( inputVal.length <= parseInt(ACC.registerPhoneMax) );
	    		},ACC.registerPhoneNoMinLength);
	    		jQuery.validator.addMethod("phoneDigit", function(value, element) {
	    			var inputVal = value.replace(/-/gi,'');
	    			return this.optional(element) || ( /^\d+$/.test(inputVal) );
	    		},ACC.registerPhoneDigitError);
	    	},
	    	specialcharRule : function(){	
	    		jQuery.validator.addMethod("alphanumericWithSpace", function(value, element) {
	    			// alphanumeric with capital /^([^0-9]*|[^A-Z]*|[^a-z]*|[a-zA-Z0-9])$/
	    			// alphanumeric /^([^0-9]*|[a-zA-Z0-9])$/
	    			return this.optional(element) || (/^[A-Za-z0-9 _]*[A-Za-z0-9][A-Za-z0-9 _]*$/.test(value));
	    		},'Password should be alphanumeric');
	    		
	    		jQuery.validator.addMethod("specialChar", function(value, element) {
	    			// specialChar /([^A-Za-z0-9])$/
	    			return this.optional(element) || !(/^[a-zA-Z0-9]*$/.test(value));
	    		},'Password should have atleast 1 special character');
	    		
	    		jQuery.validator.addMethod("capital", function(value, element) {
	    			// alphanumeric with capital /^([^0-9]*|[^A-Z]*|[^a-z]*|[a-zA-Z0-9])$/
	    			// specialChar /([^A-Za-z0-9])$/
	    			return this.optional(element) || (/^.*(?=.*[a-z])(?=.*[A-Z]).*$/.test(value));
	    		},'Password should have atleast 1 capital');
	    		
	    		jQuery.validator.addMethod("noBlank", function(value, element) {
	    			// alphanumeric with capital /^([^0-9]*|[^A-Z]*|[^a-z]*|[a-zA-Z0-9])$/
	    			// specialChar /([^A-Za-z0-9])$/
	    			return this.optional(element) || !(/\s/.test(value));
	    		},'Password should not have blank spaces');
	        }, 
	        zipcodeRule: function(){

	    		jQuery.validator.addMethod("test", function(value, element) {
	    			//pepsi var xyz = /^(.{0,7}|[^0-9]*|[^A-Z]*|[^a-z]*|[a-zA-Z0-9]*|[^\s]*\s.*)$/ ;
	    			return this.optional(element) || !(/^([^0-9]*|[^A-Z]*|[^a-z]*|[a-zA-Z0-9]*|[^\s]*\s.*)$/.test(value));
	    		},'Password should contain atleast 1 special character, alphanumeric, one capital and 1 small');
	    		
	    		jQuery.validator.addMethod("zipcode", function(value, element) {
	    			  return this.optional(element) || /^\d{5}(?:-\d{4})?$/.test(value);
	    			}, "Please provide a valid zipcode.");
	    		
	    		// /^(?!\s*$).+/
	        },
	        
	validateDeliveryDate : function () {
		//delivery date picker rules 
		$('#deliveryChk').validate({
			  rules: {
				  deliveryDate: "required"
			  },
			  messages: {
				  deliveryDate: ACC.deliveryDateErrorMsg //" Please select a date from the picker"
			  },
			  errorPlacement: function(error, element) {
				  $("#"+$(element).attr('id')+'_label').remove();
				  error.insertAfter($(element).closest("#deliveryChk"));
				  error.attr('id',$(element).attr('id')+'_label');
				  element.attr('aria-describedby',$(element).attr('id')+'_label');
			  },
			  errorElement: "em"
		});
    },
    
    validateSavecart : function(form){
	
    	form.validate({
	
			  rules: {
				  name: {
					  alphanumericWithSpace: true,
				    },
			  },
			  messages: {
				  name:{
					  alphanumericWithSpace: ACC.savedCartTitleErrorMsg,
				  }
			  },
			  errorPlacement: function(error, element) {
				  error.insertAfter(element);
				  error.attr('id',$(element).attr('id')+'_label');
				  element.attr('aria-describedby',$(element).attr('id')+'_label');
			  },
			  errorElement: "em"
		});
	
    },
    validateLogin : function () {
	
	$('#loginForm').validate({
		submitHandler: function(form) {
			ACC.validateForm.submitLoginForm(form);
		  },
		  errorPlacement : function(error, element) {
			  $('#j_password').val(decodeURIComponent($('#j_password').val()));
			  if(element.attr('type') != 'checkbox'){
				  error.insertAfter(element);
			   }else{
				   error.appendTo( element.closest(".js-error-wrapper") );
			   }
			  error.attr('id',$(element).attr('id')+'_label');
			  element.attr('aria-describedby',$(element).attr('id')+'_label');
		  },
		  highlight: function( element, errorClass, validClass ) {
			  ACC.validateForm.highlightError(element, errorClass, validClass);
			},
			unhighlight: function( element, errorClass, validClass ) {
				ACC.validateForm.removeError(element, errorClass, validClass);
			},
		  errorElement: "em",
			  rules: {
				    j_username: {
					   required: true,
					   leadgenemail: true
					},
				    j_password: {
				    	required: true
				    },
				    terms:{required: true}
			  },
			  messages: {
				  j_username: {
				      required: ACC.loginUsernameRequiredErrorMsg, //"Please enter the Email Id"
				      email: ACC.loginUsernameCorrectErrorMsg //"Please enter correct Email Id"
				    },
				  j_password:{
					  required: ACC.loginPasswordRequiredErrorMsg, //"Please enter the Password"
					  minlength: ACC.loginPasswordMinLengthErrorMsg, //'Password should have atleast 8 characters',
				      isNotsameAsUsername : ACC.loginPasswordNotUsernameErrorMsg, //'Password should not contain any part of the username',
				      alphanumeric: ACC.loginPasswordAlphanumericErrorMsg, //'Password should be alphanumeric',
				      specialChar : ACC.loginPasswordspecialCharErrorMsg, //'Password should have atleast 1 special character',
				      noBlank : ACC.loginPasswordNoBlankErrorMsg, //'Password should not have blank spaces',
				      capital:  ACC.loginPasswordCaseErrorMsg //'Password should have atleast 1 lowercase and 1 uppercase '
				      //test: 'Password should contain atleast 1 special character, alphanumeric, one capital and 1 small'
				  },
				  terms:{
					  required: "Please accept the Terms of Use"
				  }
			  }
			  
		});

		//show password code 
		ACC.validateForm.showPassword();
    },
   
    loginvalidateform : function () {
  
    	 $('#partnerRegistrationForm').validate({ // initialize the plugin
    	        rules: {
    	            name: {
    	                required: true
    	            },
    	            businessCategory:{
    	            	required: true
    	            },
    	            companyAddressCity:{
    	            	required: true,
    	            },
    	            companyAddressPostalCode:{
    	                    required: true,
    	                    number: true,
    	                    zipcode: true 
    	            },
    	            email:{
    	            	required:true,
    	            	email: true
    	            },
    	            companyName: {
    	                required: true
    	            },
    	            companyAddressStreet: {
    	            	 required: true
    	            },
    	            companyAddressRegion: {
    	            	 required: true
    	            },
    	            telephone:{
    	            	required: true,
    	            	number: true
    	            },
    	            message: {
    	            	required: true
    	            }
    	        },
    	       submitHandler: function (form) { 
    	            form.submit(); 
    	        }
    	    });
    },
    
    triggerModal: function() {
    	$(".openRegister").on("click",function(){
    		$('#leadregistrationrmodal').modal('show');
    	})
    },
    
    validatePdpAddToCartForm: function(form){
    	form.validate({
    		rules: {
				  pdpAddtoCartInput: {
			      required: true,
			      digits: true
			    }
			  },
			  messages:{
				  pdpAddtoCartInput:{
					  required:"This is a required field.",
					  digits:"Please enter digit only."
				  }
			  },
			  errorPlacement : function(error, element) {
					error.insertAfter(element);
					error.attr('id',$(element).attr('id')+'_label');
					element.attr('aria-describedby',$(element).attr('id')+'_label');
			  },
			  errorElement: "em"
		});
    },
    resetPasswordNewRules:{
		required: true,
		minlength: 8,
		alphanumeric: true,
		capital: true
	},
	resetPasswordNewMsg:{
		required: ACC.resetPasswordRequiredErrorMsg,
		minlength: ACC.resetPasswordMinlengthErrorMsg,
		alphanumeric: ACC.resetPasswordAlphanumericErrorMsg,
		capital: ACC.resetPasswordCapitalErrorMsg
	},
    updatePasswordFormValidate: function(){
    	/******MY PROFILE*******/
		$("#updatePasswordForm").validate({
			onfocusout: function(element) {
				$(element).valid();
             },
			rules:{
				currentPassword:{
       				required: true
       			},
       			newPassword: ACC.validateForm.resetPasswordNewRules,
       			checkNewPassword:{
       				required: true,
       				equalTo: "#newPassword"
       			}
			},
			messages:{
				currentPassword:{
       				required: ACC.resetPasswordRequiredErrorMsg
       			},
       			newPassword : ACC.validateForm.resetPasswordNewMsg,
       			checkNewPassword:{
       				required: ACC.resetPasswordRequiredErrorMsg,
       				equalTo: ACC.resetPasswordEqualtoErrorMsg
       			}
			},
			errorPlacement : function(error, element) {
				error.insertAfter(element);
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			},
			 errorElement: "em"
		});
    },
		
    pepsicoUpdatePwdFormValidate: function(){
    	/******EMAIL LINK*******/
		$("#pepsicoUpdatePwdForm").validate({
			submitHandler: function(form) {
			    // do other things for a valid form
				form.elements.password.value = encodeURIComponent(form.elements.password.value);
				document.getElementById("updatePwd-checkPwd").value = encodeURIComponent(document.getElementById("updatePwd-checkPwd").value);
			    form.submit();
			  },
			onfocusout: function(element) {
				$(element).valid();
             },
			rules:{
				pwd: ACC.validateForm.resetPasswordNewRules,
       			checkPwd:{
       				required: true,
       				equalTo: "#password"
       			}
			},
			messages:{
				pwd : ACC.validateForm.resetPasswordNewMsg,
       			checkPwd:{
       				required: ACC.resetPasswordRequiredErrorMsg,
       				equalTo: ACC.resetPasswordEqualtoErrorMsg
       			}
			},
			errorPlacement : function(error, element) {
				$('#password').val(decodeURIComponent($('#password').val()));
				$('#updatePwd-checkPwd').val(decodeURIComponent($('#updatePwd-checkPwd').val()));
				error.insertAfter(element);
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			},
			 errorElement: "em"
		});
    },
		
    pepsicoCustomerResestPasswordFormValidate: function(){
    	/******MY USERS*******/
		$("#pepsicoCustomerResestPasswordForm").validate({
			onfocusout: function(element) {
				$(element).valid();
             },
			rules:{
				newPassword: ACC.validateForm.resetPasswordNewRules,
       			checkNewPassword:{
       				required: true,
       				equalTo: "#profile-newPassword"
       			}
			},
			messages:{
       			newPassword: ACC.validateForm.resetPasswordNewMsg,
       			checkNewPassword:{
       				required: ACC.resetPasswordRequiredErrorMsg,
       				equalTo: ACC.resetPasswordEqualtoErrorMsg
       			}
			},
			errorPlacement : function(error, element) {
				error.insertAfter(element);
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			},
			 errorElement: "em"
		});
    },
		
    resetPasswordFormValidation : function(){
    	/******MY PROFILE*******/
    	ACC.validateForm.updatePasswordFormValidate();
		/******EMAIL LINK*******/
    	ACC.validateForm.pepsicoUpdatePwdFormValidate();
		/******MY USERS*******/
    	ACC.validateForm.pepsicoCustomerResestPasswordFormValidate();
	},    
    registervalidateform : function () {
    	  
    	$('#registerForm').validate({ // initialize the plugin
       		onfocusout: function(element) {
                this.element(element);
             },   
       		 rules: {
       			accountNumber:{
       				required: true
       			},
       			addressZipCode:{
       				required: true,
       				minlength: 5
       			},
       			addressBuilding:{
       				required: true
       			},
       			 firstName:{
       	            	required: true
       	            },
       	         lastName:{
       	            	required: true
       	            },
       	         telephone:{
   	                    required: true,
   	                    phoneDigit: true,
   	                    phoneMinLength: true,
   	                    phoneMaxLength: true
       	            },
       	         telephoneExtension:{
	                    digits: true,
	                    maxlength: 30
    	            },
       	         email:{
       	            	required:true,
       	            	email: true
       	            },
       	            companyName: {
       	                required: true
       	   
       	            },
       	            terms: {
       	            	 required: true
       	            }
       	        },
    	   	     messages:{
    	   	    	accountNumber:{
    					  required: ACC.registerAccountNo
    				  },
    				  addressZipCode:{
    					  required: ACC.registerPhysicalAddr,
    					  minlength: ACC.registerPhysicalAddr
    				  },
    				  addressBuilding:{
    					  required: ACC.registerDeliveryAddr
    				  },
    				  firstName:{
         	            	required:  ACC.registerFirstName
           	            	
         	            },
         	         lastName:{
         	            	required: ACC.registerLastName
         	            	
         	            },
         	         telephone:{
         	        	 	required: ACC.phoneFormatError,
       	                	minlength: ACC.phoneFormatError,
       	                	maxlength: ACC.registerPhoneNoMinLength
         	            },
         	           telephoneExtension:{
   	                     maxlength: ACC.registerPhoneNoExtnMaxLength
       	            },
         	         email:{
         	            	required:ACC.registerEmail
         	            },
         	            terms: {
         	            	 required: ACC.registerTermsRqr
         	            }
    			  },
    			  
    			  errorPlacement : function(error, element) {
    					error.insertAfter(element);
    					error.attr('id',$(element).attr('id')+'_label');
    					element.attr('aria-describedby',$(element).attr('id')+'_label');
    			  },
    			  errorElement: "em",
         	      submitHandler:function(form) {
         	    	  	if($(".regFormSubmit").is(":visible")) {
         	    	  		$("#customerRegSpinner").removeClass("display-none"); 
             	        	form.submit();
         	    	  	}
         	    	  	else {
         	    	  		if(!$("#authenticate").hasClass("disabled")){
         	    	  			$("#authenticate").click();
         	    	  		}
         	    	  		return false;
         	    	  	}
         	      } 
       	    });
   },
   updateProfileFocusOut: function(element){
	   $(element).valid();
	   if($(element).attr("name") == "jobTitle" || $(element).attr("name") == "firstName" || 
			   $(element).attr("name") == "lastName" || $(element).attr("name") == "phoneNo" ) {
		   $(element).closest('form').valid();
			}else {
				$(element).valid();
	    }  
   },
   profileFormValidationRules:{
	   jobTitle: {
		      required: true,
		      uniqueUser: true
	    },
	   firstName: {
		      required: true,
		      uniqueUser: true
	    },
	   lastName: {
		      required: true,
		      uniqueUser: true
	    },
	   phoneNo: {
		      required: true,
		      phoneFormat: true,
		      minlength: 12,
		      maxlength:12,
		      uniqueUser: true
	    },
	    emailId: {
		      required: true,
		      email: true,
	    },
	    alternatePhones:{
	    	phoneFormat: true,
	    	minlength: 12,
	    	maxlength:12
	    },
	    mobileNumber:{
	    	phoneFormat: true,
		    minlength: 12,
	    	maxlength: 12,
	    	required:{
	    		depends: function() {
	    			return $("#customerPreferenceForm").find("[id^=text_]").filter(":checked").length;
    	        }
	    	}
	    },
	    faxPhone:{
	    	phoneFormat: true,
	    	minlength: 12,
	    	maxlength: 12
	    },
	    phoneNoExtn:{
	    	maxlength:30
	    },
	    alternatePhonesExtn:{
	    	maxlength:30
	    }
   },
   profileEditFormValidationRules:{
	   jobTitle: {
		      required: true,
		      uniqueUser: true
	    },
	   firstName: {
		      required: true,
		      uniqueUser: true
	    },
	   lastName: {
		      required: true,
		      uniqueUser: true
	    },
	   phoneNo: {
		      required: true,
		      phoneFormat: true,
		      minlength: 12,
		      maxlength:12,
		      uniqueUser: true
	    },
	    emailId: {
		      email: true,
	    },
	    alternatePhones:{
	    	phoneFormat: true,
	    	minlength: 12,
	    	maxlength:12
	    },
	    mobileNumber:{
	    	phoneFormat: true,
		    minlength: 12,
	    	maxlength: 42
	    	
	    },
	    faxPhone:{
	    	phoneFormat: true,
	    	minlength: 12,
	    	maxlength: 42
	    },
	    phoneNoExtn:{
	    	maxlength:30
	    },
	    alternatePhonesExtn:{
	    	maxlength:30
	    }
   },
   
   profileEditUserMessages:{
	   jobTitle:{
		   required: ACC.jobTitleErrorMsg,
		   uniqueUser: ACC.duplicateUserErrorMsg
	   },
	   firstName: {
		   required: ACC.firstNameErrorMsg,
		   uniqueUser: ACC.duplicateUserErrorMsg
	   },
	   lastName: {
		   required: ACC.lastNameErrorMsg,
		   uniqueUser: ACC.duplicateUserErrorMsg
	   },
	   phoneNo: {
		   required : ACC.phoneNoRequiredErrorMsg,
		   minlength : ACC.phoneNoMinErrorMsg,
		   maxlength : ACC.phoneNoMaxErrorMsg,
		   uniqueUser: ACC.duplicateUserErrorMsg
	   },
	   alternatePhones: {
		   minlength : ACC.phoneNoMinErrorMsg,
		   maxlength : ACC.phoneNoMaxErrorMsg
	   },
	   mobileNumber:{
		   minlength : ACC.phoneNoMinErrorMsg
			
		},
		faxPhone:{
			minlength : ACC.phoneNoMinErrorMsg
		},
		emailId: {
			  email: ACC.emailValidErrorMsg
		}
	},
   
   updateProfileErrPlacement: function(error, element){
	   if( $.inArray( element.attr("name"), ["jobTitle", "firstName", "lastName", "phoneNo"] ) >= 0 ){
	    	if($(error).text() === ACC.duplicateUserErrorMsg ){
	    		$('[name="phoneNo"]').next('label.error').remove();
	    		$('[name="jobTitle"]').next('label.error').remove();
	    		$('[name="firstName"]').next('label.error').remove();
	    		$('[name="lastName"]').next('label.error').remove();
	    		error.removeAttr('for');
	    		$('.js-commonErrorMsg').attr('id',$(element).attr('id')+'_label').html(error);
	    		element.attr('aria-describedby',$(element).attr('id')+'_label');
	    		
	    	}else{
	    		error.insertAfter(element);
	    		error.attr('id',$(element).attr('id')+'_label');
	    		element.attr('aria-describedby',$(element).attr('id')+'_label');
	    	}
     		 
			}else {
				error.insertAfter(element);
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
	    }  
   },
   
   formSubmitHandler: function(form,modal) {
	   if(ACC.profile.allowFormSubmit){
		    $('#manageContactSpinner').removeClass("display-none");
		   $.ajax({
			    url: $(form).attr('action'),
               data: $(form).serialize(),
               method: 'POST',
			    success: function(){
	        		$('#manageContactSpinner').addClass("display-none");
	        		modal.modal({backdrop:'static'});
	        		ACC.profile.showModal(modal, "#manage-contacts");
	        	}
	        });
	   }else{
		   $('#duplicateEmailModal').modal({backdrop:'static'});
		   $('#duplicateEmailModal').on('shown.bs.modal', function () {
   			$('#duplicateEmailModal').find(".js-first-focus").focus();
   		    ACC.global.modalAccessibility( $('#duplicateEmailModal'), $('#duplicateEmailModal').find(".js-confirmDuplicateEmail"),  $('#duplicateEmailModal').find(".js-last-focus"));
   	    });
		   return false;
	   }
	},

   updateProfileFormValidation: function(){
	   	$('#updateProfileForm').validate({
	   		submitHandler: function(form) {
			   
			   if(ACC.profile.allowFormSubmit){
				   $('#manageContactSpinner').removeClass("display-none");
				   $.ajax({
					    url: $(form).attr('action'),
		                data: $(form).serialize(),
		                method: 'POST',
		                success: function(){
			        		sessionStorage.setItem("myProfileTabRedirAttr", "#personal-details");
			        		window.location.href = ACC.config.encodedContextPath + "/my-account/update-profile";
			        	}
			        });
				   
			   }else{
				   $('#duplicateEmailModal').modal({backdrop:'static'});
				   $('#duplicateEmailModal').on('shown.bs.modal', function () {
		    			$('#duplicateEmailModal').find(".js-first-focus").focus();
		    		    ACC.global.modalAccessibility( $('#duplicateEmailModal'), $('#duplicateEmailModal').find(".js-confirmDuplicateEmail"),  $('#duplicateEmailModal').find(".js-last-focus"));
		    	    });
				   return false;
			   }
			},
		   onfocusout: function(element) {
			   ACC.validateForm.updateProfileFocusOut(element);
            }, 
           rules: ACC.validateForm.profileFormValidationRules,
		   
		   messages:{
			   jobTitle:{
				   required: ACC.jobTitleErrorMsg,
				   uniqueUser: ACC.duplicateUserErrorMsg
			   },
			   firstName: {
				   required: ACC.firstNameErrorMsg,
				   uniqueUser: ACC.duplicateUserErrorMsg
			   },
			   lastName: {
				   required: ACC.lastNameErrorMsg,
				   uniqueUser: ACC.duplicateUserErrorMsg
			   },
			   phoneNo: {
				   required : ACC.phoneNoRequiredErrorMsg,
				   minlength : ACC.phoneNoMinErrorMsg,
				   maxlength : ACC.phoneNoMaxErrorMsg,
				   uniqueUser: ACC.duplicateUserErrorMsg
			   },
			   alternatePhones: {
				   minlength : ACC.phoneNoMinErrorMsg,
				   maxlength : ACC.phoneNoMaxErrorMsg
			   },
			   mobileNumber:{
				   minlength : ACC.phoneNoMinErrorMsg,
				   maxlength : ACC.phoneNoMaxErrorMsg
			    	
			    },
			    faxPhone:{
			    	minlength : ACC.phoneNoMinErrorMsg,
				    maxlength : ACC.phoneNoMaxErrorMsg
			    },
			    emailId: {
			    	required: ACC.emailRequiredErrorMsg,
				      email: ACC.emailValidErrorMsg,
			    },
			    
		   },
		   errorPlacement : function(error, element) {
			   ACC.validateForm.updateProfileErrPlacement(error, element);
		  },
		  errorElement: "em"
		  
	   });
   },
   
   editProfileFormValidation: function(){
	   $('#editProfileForm').validate({
		   submitHandler: function(form) {
			   ACC.validateForm.formSubmitHandler(form, $('#contactUpdateModal'));
			},
		   onfocusout: function(element) {
			   $(element).valid();
			   if( $.inArray( $(element).attr("name"), ["jobTitle", "firstName", "lastName", "phoneNo"] ) >= 0 ) {
				   $(element).closest('form').valid();
	   			}else {
	   				$(element).valid();
			    }
            }, 
		   rules: ACC.validateForm.profileEditFormValidationRules,
		   
		   messages: ACC.validateForm.profileEditUserMessages,
		   errorPlacement : function(error, element) {
			   ACC.validateForm.updateProfileErrPlacement(error, element);
		  }
	   });
   },
   addNewProfileFormValidation: function(){
	   $('#addNewProfileForm').validate({
		   submitHandler: function(form) {
			    // do other things for a valid form
			   ACC.validateForm.formSubmitHandler(form, $('#contactAddNewModal'));
			}, 
		   onfocusout: function(element) {
			   $(element).valid();
			   if( $.inArray( $(element).attr("name"), ["jobTitle", "firstName", "lastName", "phoneNo"] ) >= 0 ) {
				   $(element).closest('form').valid();
	   			}else {
	   				$(element).valid();
			    }
            }, 
		   rules: ACC.validateForm.profileEditFormValidationRules,
		   
		   messages: ACC.validateForm.profileEditUserMessages,
		   
		   errorPlacement : function(error, element) {
			   ACC.validateForm.updateProfileErrPlacement(error, element);
		  }
		  
	   });
   },
   formChangeValidation: function(formid){
	   var form = formid;
	   var original= form.serialize();
	   form.find(".form-control").change(function(){
		   if(form.serialize() !== original){
			   form.find('[type="submit"]').removeClass("disabled");
		   }
	   });
	   form.find('[type="checkbox"]').change(function(){
		   if(form.serialize() !== original){
			   form.find('[type="submit"]').removeClass("disabled");
		   }
	   });
	   form.find(".text").keyup(function(){
		   if(form.serialize() !== original){
			   form.find('[type="submit"]').removeClass("disabled");
		   }
	   });
   },
   businessformChangeValidation: function(){
	   var form1 = $('#businessHoursForm');
	   var original1= form1.serialize();
	   $(document).on('change', form1.find(".form-control"), function(){
		   if(form1.serialize() !== original1){
			   $('.js-update-businessInfo').removeClass("disabled");
		   }
	   });
	   $(document).on('change', form1.find('[type="checkbox"]'), function(){
		   if(form1.serialize() !== original1){
			   $('.js-update-businessInfo').removeClass("disabled");
		   }
	   });
	   $(document).on('keyup', form1.find(".text"), function(){
		   if(form1.serialize() !== original1){
			   $('.js-update-businessInfo').removeClass("disabled");
		   }
	   });
   },
   businessInfoFormValidation: function(){
	   var form2 = $('#businessInfoForm');
	   var original2= form2.serialize();
	   $(document).on('change', form2.find(".form-control"), function(){
		   if(form2.serialize() !== original2){
			   $('.js-update-businessInfo').removeClass("disabled");
		   }
	   });
	   $(document).on('change', form2.find('[type="checkbox"]'), function(){
		   if(form2.serialize() !== original2){
			   $('.js-update-businessInfo').removeClass("disabled");
		   }
	   });
	   $(document).on('keyup', form2.find(".text"), function(){ 
		   if(form2.serialize() !== original2){
			   $('.js-update-businessInfo').removeClass("disabled");
		   }
	   });
   },
   disableBusinessInfoSubmitBtn: function(form2, original2){
	   if(form2.serialize() !== original2){
		   $('.js-update-businessInfo').removeClass("disabled");
	   }
	   ACC.profileExtend.calculateDifference();
   }
    
};

//################################################################
//#### Validation Extended functions 
//################################################################

ACC.validateForm.extendedFunctions = function(){
	//autoload methods here :
	ACC.validateForm.leadGenerationForm();
	ACC.validateForm.leadGenEmailValidation();
	ACC.validateForm.preferencePopup();
	ACC.validateForm.updateDeliverySchedule();
	ACC.validateForm.closeAccountPriceForm();
	ACC.validateForm.addNewRules();
};

ACC.validateForm.closeAccountPriceForm = function(){
	ACC.customerInquiry.closeAccFormValidate = $('.js-closeAcc-form').validate({
		onfocusout: function(element) {
            this.element(element);
         },
		errorElement: "em",
		rules: {
			"js-closeReason":{
				required:true
			},
			"js-buyingFrom":{
				required:true,
				maxlength: 50
			},
			"js-closeSubReason":{
				required:true
			},
			"js-phone":{
				required:true,
				minlength:12,
		 		maxlength:12,
			},
			"close-effectiveDate":{
				required:true
			},
			"closeAcc-comments":{
				required:true,
				maxlength: 255
			}
		},
		messages:{
			"js-closeReason":{
				required: $('.js-closeAccReasonRequiredError').text()
			},
			"js-buyingFrom":{
				required: $('.js-closeAccBuyingFromRequiredError').text(),
				maxlength: $('.js-scloseAccReasonMaxError').text()
			},
			"js-closeSubReason":{
				required: $('.js-closeAccCloseSubReasonRequiredError').text()
			},
			"js-phone":{
				required: $('.js-closeAccphoneRequiredError').text(),
				minlength: ACC.leadGenPhoneMinLengthErrorMsg,
			    maxlength:ACC.leadGenPhoneMaxLengthErrorMsg,
			},
			"close-effectiveDate":{
				required: $('.js-closeAccEffectiveDateRequiredError').text()
			},
			"closeAcc-comments":{
				required: $('.js-closeAccCommentsRequiredError').text(),
				maxlength: $('.js-closeAccCommentsMaxError').text()
			}
			
			
		},
		submitHandler: function(form) {
			return ACC.customerInquiry.closeAccountAjaxFormSubmit(form);
    	},
		errorPlacement : function(error, element) {
			if(element.hasClass('hasDatepicker')){
				error.insertAfter(element.next('.ui-datepicker-trigger'));
				element.next('.ui-datepicker-trigger').next('.error').addClass('hide');
				element.addClass('overrideValidation');
			}else{
				error.insertAfter(element);
			}
			error.attr('id',$(element).attr('id')+'_label');
			element.attr('aria-describedby',$(element).attr('id')+'_label');
		  }
    });
	
	$('.js-closeAcc-form').find('[name="js-buyingFrom"],[name="js-closeSubReason"],[name="js-phone"],[name="close-effectiveDate"],[name="closeAcc-comments"]').data('required', true);
	$('.js-closeAcc-form').find('[name="js-buyingFrom"]').attr('maxlength',50);
	$('.js-closeAcc-form').find('[name="closeAcc-comments"]').attr('maxlength',255);
},

ACC.validateForm.deliveryScheduleForm = function(){
	ACC.customerInquiry.dsuFormValidate = $('.js-deliverySchedule-form').validate({
		onfocusout: function(element) {
            this.element(element);
         },
		errorElement: "em",
		rules: {
			"scheduleUpdateReason":{
				required:true
			},
			"prefDeliveryDay":{
				required:true
			},
			"js-dayToRemove":{
				required:true
			},
			"js-dayToKeep":{
				required:true
			},
			"js-requestedFrequency":{
				required:true
			},
			"js-effectiveDate":{
				required:true
			},
			"comments":{
				required:true,
				maxlength: 255
			}
		},
		messages:{ 
			"scheduleUpdateReason":{
				required: $('.js-scheduleUpdateReasonRequiredError').text()
			},
			"prefDeliveryDay":{
				required:$('.js-scheduleUpdatePrefDeliveryDayRequiredError').text()
			},
			"js-dayToRemove":{
				required:$('.js-scheduleUpdateDayToRemoveRequiredError').text()
			},
			"js-dayToKeep":{
				required:$('.js-scheduleUpdateDayToKeepRequiredError').text()
			},
			"js-requestedFrequency":{
				required:$('.js-scheduleUpdateRequestedFrequencyRequiredError').text()
			},
			"js-effectiveDate":{
				required:$('.js-scheduleUpdateEffectiveDateRequiredError').text()
			},
			"comments":{
				required:$('.js-scheduleUpdateCommentsRequiredError').text(),
				maxlength: $('.js-scheduleUpdateCommentsMaxError').text()
			}
		},
		submitHandler: function(form) {
			return ACC.customerInquiry.deliveryScheduleUpdateFormSubmit(form);
    	},
		errorPlacement : function(error, element) {
			if(element.hasClass('hasDatepicker')){
				error.insertAfter(element.next('.ui-datepicker-trigger'));
				element.next('.ui-datepicker-trigger').next('.error').addClass('hide');
				element.addClass('overrideValidation');
			}else{
				error.insertAfter(element);
			}
			error.attr('id',$(element).attr('id')+'_label');
			element.attr('aria-describedby',$(element).attr('id')+'_label');
		  },
    });
	$('.js-deliverySchedule-form').find('[name="scheduleUpdateReason"],[name="prefDeliveryDay"],[name="js-dayToRemove"],[name="js-dayToKeep"],[name="js-requestedFrequency"],[name="js-effectiveDate"],[name="comments"]').data('required', true);
	$('.js-deliverySchedule-form').find('[name="comments"]').attr('maxlength',255);
},

ACC.validateForm.poUpdateValidation = function(){
	 $('.js-poUpdateForm').validate({	
		 onfocusout: function(element) {
             this.element(element);
          },
		 submitHandler: function(form){
	 		   ACC.customerInquiry.poUpdateAjax(form);
	 		   return false;
	 	   }, 
	   rules: {
		   requireForAll:{
			   required: true
		   },
		   comment:{
			   required: true,
			   maxlength: 255
		   }
	   }
	});
	 $('.js-poUpdateForm').find('[name="requireForAll"],[name="comment"]').data('required', true);
	 $('.js-poUpdateForm').find('[name="comment"]').attr('maxlength',255);
}

ACC.validateForm.updateDeliverySchedule = function(){
	$('.js-rescheduleDay').validate({
		onfocusout: function(element) {
            this.element(element);
         },
		submitHandler: function(form){
 		   ACC.deliverySchedule.popupFormSubmit(form);
 		   return false;
 	   },
 	  rules: {
 		 rescheduleReason:{
 			required: true
 		 },
 		prefDay:{
 			required: true
		 },
		 commentsCurrentDay:{
 			required: true
		 },
		 removeDay:{
 			required: true
		 },
		 keepDay:{
 			required: true
		 },
		 commentsMultiDays:{
 			required: true
		 },	 
		 removeDay2:{
 			required: true
		 },
		 effectiveDate:{
 			required: true
		 },
		 commentsLessDelivery:{
 			required: true
		 }
 	  }
	});
}
ACC.validateForm.leadGenEmailValidation = function(){
	jQuery.validator.addMethod("leadgenemail", function(value, element) {
		return this.optional(element) || /^(([^`~!#$%^&*()=?/<>()\[\]\\{}|"',;:\s@."]+(\.[^`~!#$%^&*()=?/<>()\[\]\\{}|"',;:\s@."]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})|(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-zA-Z]{2,}))$/i.test(value);
	},ACC.leadGenEmailFormatErrorMsg);
};

ACC.validateForm.leadGenFormValidationRules = {
    	   name: {
 		      required: true
    	   },
 	    	businessName: {
 		      required: true
 	    	},
 	    	businessAddress: {
 		      required: true
 	    	},
	 	   city: {
	 		      required: true
	 	    },
	 	   state: {
	 		      required: true
	 	    },
	 	   zip:{
	 		  required: true,
	 		  minlength:5,
	 		  maxlength:5,
	 		  number: true
	 	    },
	 	   phone:{
	 		  required: true,
	 		 phoneFormat: true,
		      minlength: 12,
		      maxlength:12,
	 	    },
	 	   email:{
	 		  required: true,
	 		  leadgenemail: true
	 	    },
		  userComments: {
	 		 maxlength:4000,
	 		 required: true
		 	}  
 };
	   
ACC.validateForm.leadGenFormValidationRulesMsg = {
		   name : {
			   required:ACC.leadGenNameRequiredErrorMsg
		   },
		   businessName: {
	 		  required: ACC.leadGenBusinessNameRequiredErrorMsg
	 	   },
	 	  businessAddress: {
 		      required: ACC.leadGenBusinessAddRequiredErrorMsg
 	    	},
 	    	city: {
	 		      required: ACC.leadGenCityRequiredErrorMsg
	 	    },
	 	   state: {
	 		      required: ACC.leadGenStateRequiredErrorMsg
	 	    },
	 	   zip:{
		 		  required: ACC.leadGenZipRequiredErrorMsg,
		 		  minlength:ACC.leadGenZipMinLengthErrorMsg,
		 		  maxlength:ACC.leadGenZipMaxLengthErrorMsg,
		 		  number: ACC.leadGenZipNumberErrorMsg
		 	    },
		   phone:{
		   		required: ACC.leadGenPhoneRequiredErrorMsg,
		 		 phoneFormat: ACC.leadGenPhoneFormatErrorMsg,
			      minlength: ACC.leadGenPhoneMinLengthErrorMsg,
			      maxlength:ACC.leadGenPhoneMaxLengthErrorMsg,
		 	    },
	 	   email:{
		 		  required: ACC.leadGenEmailRequiredErrorMsg,
		 		  email: ACC.leadGenEmailFormatErrorMsg
		 	    },	 
		   userComments:{
			      required: ACC.leadGenCommentsRequiredErrorMsg
		   }
		    
	   };

ACC.validateForm.leadGenerationForm = function(){
   	$('#leadGenerationForm').validate({
   		submitHandler: function(form){
   			form.elements.email.value = $.trim(form.elements.email.value);   
   			ACC.leadGeneration.leadGenerationFormSubmit(form);
    		   return false;
	   },
       rules: ACC.validateForm.leadGenFormValidationRules,
	   
	   messages:ACC.validateForm.leadGenFormValidationRulesMsg,
	  errorPlacement : function(error, element) {
	  	error.insertAfter(element);
		error.attr('id',$(element).attr('id')+'_label');
		element.attr('aria-describedby',$(element).attr('id')+'_label');
	  },
	  errorElement: "em"
	  
   });
   	
   	ACC.validateForm.leadGenFormPhoneKeyEvent();
   	
   	ACC.validateForm.leadGenFormZipKeyEvent();
};

ACC.validateForm.leadGenFormPhoneKeyEvent = function(){

	$('#leadGenerationForm').find("[name='phone']").on("keydown", function(event) {
		ACC.profile.preventNonNumberEntry(event);
	}).on("keyup blur", function() {
		ACC.validateForm.masking($(this));
	});
};

ACC.validateForm.masking = function(el){
	var ph = el.val();
	if (ph.length == 10  ){
		ph = ph.replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3");
		el.val(ph);
		el.valid();
	}else if(ph.length < 12){
		var sanFormat = ph.replace(/-/g, '');
		el.val(sanFormat.length < 10 ? sanFormat : ph);
		if(sanFormat.length > 10 ){
			el.valid();
		}
	}
};
   	
ACC.validateForm.leadGenFormZipKeyEvent = function(){
   	$("#leadGenerationForm_zip").on("keydown", function(event) {			
		ACC.profile.preventNonNumberEntry(event);		
    });
};

ACC.validateForm.ajaxSubmitLoginForm = function(form){
	$.ajax({
        type: "POST",
        url: form.action,
        data: $(form).serialize(),
        success: function (result) {
        	ACC.validateForm.ajaxSubmitLoginFormSuccess(result, form);
        },
        error: function( jqXHR, textStatus, errorThrown){
        	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
        	ACC.validateForm.loginRedirect(false);
        }, 
        complete: function(result){
        	if ( result.responseText.indexOf("login_overlay") > -1 ) {
        		ACC.validateForm.clearError();
        	}
        }
    });
    return false; // required to block normal submit since you used ajax
};

ACC.validateForm.ajaxSubmitLoginFormSuccess = function(result, form){
        	if ( result.indexOf("login_overlay") > -1 ) {
            	var container = $(form).closest(".login_overlay").parent();
            	container.find(".login_overlay").remove();
            	container.append(result);
            	container.find('.login_overlay').slideToggle(function(){
            		$(this).find('.js-loginfailure').attr('tabindex',0).focus();
                });
            	
            	
            	ACC.login.enableLoginBtn();
    			ACC.login.showPassword();
    			if( $(".js-password-block").find(".js-password").length > 0 ){
    				ACC.login.showEyeIcon($(".js-password-block").find(".js-password"));
    			}
    			sessionStorage.removeItem("deliveryTimeStorage");
    			ACC.validateForm.validateLogin();
    			ACC.forgottenpassword.bindLink();
    			$("#loginSpinner").addClass("display-none");
    			ACC.home.setTermsChecked();
    			
        	}
        	else {
    			if( $(":checked#terms").length > 0 ){
    				ACC.login.createTermsCookie();
    			}
    			
    			var isServicesLinkReloaded = false;
    			if (typeof(Storage) !== "undefined") {
    				sessionStorage.setItem("loginSuccessGA", "gaLogin");
    				isServicesLinkReloaded = ACC.navigation.ServicesLinkEvent(result);
    			}
    			
    			ACC.login.loginSuccess();
    			ACC.validateForm.loginRedirect(isServicesLinkReloaded);
        	}
};


ACC.validateForm.loginRedirect = function(isServicesLinkReloaded) {
	var restrictedUrls = ['/error','login/pw','my-company/','my-account/update-profile','my-account/update-password',
	                      'my-account/orders','checkout/orderConfirmation','checkout/cancelOrderConfirmation','/partner/leadgeneration','/register/add'];
	
	if( !isServicesLinkReloaded ){
		var path = window.location.pathname;
		
		var found = false;
		$.each(restrictedUrls, function(i, val) {
			if (path.indexOf(val) >= 0) {
				found = true;
				return false;
			}
		});
		
		if(path && found ) {
			//redirect to home page
			window.location = ACC.config.encodedContextPath;
		} else {
			location.reload();
		}
	}
};

ACC.validateForm.clearError = function(){
        		$(".login_overlay").on("click", '.close', function(e){
        			e.preventDefault();
        			e.stopPropagation();
        			$(".login_overlay").find(".js-loginfailure").remove();
        		});
};

ACC.validateForm.preferencePopup = function(){
	$('#preferenceNumberUpdate').validate({ // initialize the plugin
   		onfocusout: function(element) {
            this.element(element);
         },   
   		 rules: {
   			
   	         telephone:{
	                    required: true,
	                    phoneDigit: true,
	                    phoneMinLength: true,
	                    phoneMaxLength: true
   	            }
   	        },
	   	     messages:{
	   	    	
     	         telephone:{
     	        	 	required: ACC.phoneFormatError,
     	        	 	phoneDigit: ACC.phoneFormatError,
   	                	minlength: ACC.phoneFormatError,
   	                	maxlength: ACC.registerPhoneNoMinLength
     	            }
			  },
			  
			  errorPlacement : function(error, element) {
					error.insertAfter(element);
					error.attr('id',$(element).attr('id')+'_label');
					element.attr('aria-describedby',$(element).attr('id')+'_label');
			  },
			  errorElement: "em",
     	      submitHandler:function() {
     	    	 ACC.profileExtend.updatePreferenceNumber();
     	    	 return false;
     	      } 
   	    });
};

ACC.validateForm.submitLoginForm = function(form){
	$("#loginSpinner").removeClass("display-none");
    // do other things for a valid form
	form.elements.j_username.value = form.elements.j_username.value.toLowerCase();
	form.elements.j_password.value = encodeURIComponent(form.elements.j_password.value);
	if( $(form).closest(".login_overlay").length ){
		return ACC.validateForm.ajaxSubmitLoginForm(form);
	}else{
		form.submit();
}
};

ACC.validateForm.highlightError = function(element, errorClass, validClass){
	if ( element.type === "radio" ) {
		this.findByName(element.name).addClass(errorClass).removeClass(validClass);
	} else if($(element).attr('type') === 'checkbox'){
		$(element).parent(".checkbox-wrap").addClass("error");
	}else {
		$(element).addClass(errorClass).removeClass(validClass);
	}
};

ACC.validateForm.removeError = function(element, errorClass, validClass){
	if ( element.type === "radio" ) {
		this.findByName(element.name).removeClass(errorClass).addClass(validClass);
	} else if($(element).attr('type') === 'checkbox'){
		$(element).parent(".checkbox-wrap").removeClass("error");
	}else {
		$(element).removeClass(errorClass).addClass(validClass);
	}
};

ACC.validateForm.showPassword = function(){
	$(document).on("mousedown", ".pwdBlock .glyphicon", function(){
		$(this).siblings("input").attr('type', 'text');
	});
	$(document).on("mouseup", ".pwdBlock .glyphicon", function(){
		$(this).siblings("input").attr('type', 'password');
	});
};

ACC.validateForm.addNewRules = function(){
	jQuery.validator.addMethod("enqPriceFormat", function(value, element) {
		return this.optional(element) || (/^(\d{1,15})?(\.\d{1,6})?$/).test(value);
	});
};

//################################################################
//#### Lead Generation 
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.leadGeneration={
	_autoload: [   		
		"init",
		"accessibility",
		"loadCaptcha"
	],
	
	flag: 0,
	captchaTries: 0,
	captchaStatus: false,
	accessibility : function(){
		enquire.register("screen and (max-width:" + screenXsMax + ")", {

            match: function () {
            	$('.js-owl-lead-generation').attr('aria-hidden',true);
            	$('.businessTypeComboBox').removeAttr('aria-hidden');
            },

            unmatch: function () {
            	$('.businessTypeComboBox').attr('aria-hidden',true);
            	$('.js-owl-lead-generation').removeAttr('aria-hidden');
               
            },
            setup:function(){
            	ACC.leadGeneration.businessTypeView();
            }

        });
	},
	businessTypeView : function(){
		if($('.js-owl-lead-generation').filter(":hidden").length > 0){
    		$('.js-owl-lead-generation').attr('aria-hidden',true);
    	}else{
    		$('.js-owl-lead-generation').removeAttr('aria-hidden');
    	}
    	if($('.businessTypeComboBox').filter(":hidden").length > 0){
    		$('.businessTypeComboBox').attr('aria-hidden',true);
    	}else{
    		$('.businessTypeComboBox').removeAttr('aria-hidden');
    	}
	},
	
	changeBusinessTypeCarousel: function(){
		$(document).on('change', '[type="radio"][name="businessTypeCarousel"]',function(){
			$('#businessType').val($('[name="businessTypeCarousel"]:checked').val());
			$('#businessTypeComboBox').val($('[name="businessTypeCarousel"]:checked').val());
			var owl = $(".js-owl-lead-generation");
			owl.trigger('owl.stop');
			
		});
	},
		
	changeBusinessTypeComboBox: function(){
		$(document).on('change', '#businessTypeComboBox',function(){
			$('#businessType').val($(this).val());
			$('[name="businessTypeCarousel"]').filter('[value="'+$('#businessType').val()+'"]').prop("checked", true);
			var goTo = $('[name="businessTypeCarousel"]').filter('[value="'+$('#businessType').val()+'"]').closest('.owl-item').index();
			var owl = $(".js-owl-lead-generation").data('owlCarousel');
			owl.goTo(goTo);
			
			
		});
	},
	
    init : function(){
    	
    	ACC.validateForm.profileValidationRules();
		ACC.validateForm.leadGenerationForm(); //bind validation
		
		$(document).on('click','.js-openLoginBox',function(e){ 
			ACC.home.displyLoginOverlay();
			e.preventDefault();
			e.stopPropagation();
		});
		
	},
	
	onShowPepsicoPartnerModal: function(){
		$('#pepsicoPartnerModal').on('shown.bs.modal', function () {
			ACC.leadGeneration.businessTypeView();
			$('#pepsicoPartnerModal').find(".js-first-focus").focus();
			ACC.global.modalAccessibility( $('#pepsicoPartnerModal'), $('#pepsicoPartnerModal').find(".close"),  $('#pepsicoPartnerModal').find(".js-last-focus"));
		});
	},
	
	onHidePepsicoPartnerModal: function(){
		$("#pepsicoPartnerModal").on('hidden.bs.modal', function () {
			if( ACC.pageName === "productDetails" ){
				window.location = window.location.href;
			}else{
				var owl = $(".js-owl-lead-generation").data('owlCarousel');
				owl.goTo(0);
				if(ACC.leadGeneration.flag == 0)
					ACC.track.trackLeadGenerationViews("viewed - dismissed");
			}
		});
	},
	
	leadGenerationFormSubmit : function(form){
		if(!ACC.leadGeneration.captchaStatus) {
			return false;
		}
		var errorText = ACC.submissionUnsuccessful;
   		$.ajax({
            type: "POST",
            url: $(form).attr('action'),
            data: $(form).serialize(),
            success: function (resp) {
            	if(resp === 'success'){
            		$("#leadGenBanner_success_text").removeClass('hide');
            		
            		$("#leadGenBanner_form_text").addClass('hide');
            		$("#leadGenerationFormContainer").addClass('hide');
            		$("#leadGenerationFormFooter").addClass('hide');
            		
            		ACC.global.footerAlignment();            		
            		ACC.track.trackLeadGenerationViews("viewed - submitted");
			   		ACC.leadGeneration.flag = 1;
				}
            	else if(resp === 'duplicateData'){
					var duplicateEmailMsg=ACC.leadGenDuplicateEmail;
					$('.js-duplicateDataText').html(duplicateEmailMsg);
					$('.js-duplicateDataText').show().focus();

				}else if(resp === 'failure'){
					$("#pepsicoPartnerModal").modal("hide");
					$("#leadGenSubmitConfirmationModal").find('.modal-body').html(errorText); //need suitable msg. in discussion with Vamsi. theoretically will never reach here
					$("#leadGenSubmitConfirmationModal").modal();
				} else {
					var errors = resp.split(":");
					var errorlength = errors.length;
					for (var i = 1; i < errorlength; i++) {
						if(errors[i]) {
							var error = errors[i].split("|")
							var fieldName = error[0];
							var fieldMsg = error[1];
							$("#leadGenerationForm").find('#leadGenerationForm_'+fieldName).parent().append('<em class="error">'+fieldMsg+'</em>');
							$("#leadGenerationForm").find('#leadGenerationForm_'+fieldName).addClass('error');
						}
					}
				}
            }
        });
   		
    },
    loadCaptcha : function(){
    	ACC.leadGeneration.captchaTries++;
    	if (ACC.leadGeneration.captchaTries > 5) {
            return;
    	}
    	if(typeof(grecaptcha) !== 'undefined') {
    		ACC.leadGeneration.captchaStatus = false;
        	$('#leadGenerationForm .leadGenSubBtn').addClass('disabled');
        	try {
	        	grecaptcha.render('leadGeneration_reCaptcha', {
	                'sitekey' : ACC.config.reCaptchaSiteKey,
	                'callback' : ACC.leadGeneration.verifyCaptcha,
	                'expired-callback': ACC.leadGeneration.expiredCaptcha,
	                'theme' : 'light'
	            });
	        	ACC.leadGeneration.captchaTries = 5;
			} catch (e) {
				// handle exception
				ACC.leadGeneration.captchaStatus = true;
	        	$('#leadGenerationForm .leadGenSubBtn').removeClass('disabled');
			}
        	
    	} else { //if reCAPTCHA API not loaded
    		ACC.leadGeneration.captchaStatus = true;
        	$('#leadGenerationForm .leadGenSubBtn').removeClass('disabled');
    	}
    	window.setTimeout(ACC.leadGeneration.loadCaptcha, 1000);
    },
    verifyCaptcha : function(token){
    	$.ajax({
    		type: 'POST',
    		url: ACC.config.encodedContextPath + "/partner/verifycaptcha", 
			data: {'token' : token},
			success: function(rsp){
				if(rsp === 'Success') {
					ACC.leadGeneration.captchaStatus = true;
					$('#leadGenerationForm .leadGenSubBtn').removeClass('disabled');
				}
			}
    	});
    },
    expiredCaptcha : function(){
    	ACC.leadGeneration.captchaStatus = false;
    	$('#leadGenerationForm .leadGenSubBtn').addClass('disabled');
    }
    
};

ACC.updatenavigation = {

    _autoload: [
        ["myAccountNavigation", $(".logged_in").length > 0 && $(".accNavComponent").length > 0],
        ["businessOption", $(".accNavComponent").length > 0],
        ["myCompanyNavigation", $(".logged_in").length > 0 && $(".companyNavComponent").length > 0],
        ["helpNavigation", $('li.hamburger').length > 0],
        ["expressCheckoutLink", $(".expressCheckoutLink").length > 0 && $(".desktopExpressCheckoutLink").length > 0 && $(".mobileExpressCheckoutLink").length > 0],
        "init"
    ],
    
    expressCheckoutLink: function(){
    	$(".desktopExpressCheckoutLink").after($(".expressCheckoutLink").html()).remove();
    	$(".mobileExpressCheckoutLink").after($(".expressCheckoutLink").html()).remove();
    	$(".submitExpressCheckout").on("click", function(){
    		$("#headerExpressOrderForm").submit();
    	})
    },
    
    myAccountNavigation: function(){
    	//my account items
    	
        if($(".logged_in") && $(".logged_in").length === 1){
        	
        	$('.myAccount').on('click', function(){
        		var myAccountNavLinks = $(this).find('div').filter("[data-id=MyAccountComponentId]");
	        	if(myAccountNavLinks.length){
	        		ACC.updatenavigation.toggleArrow($(this));
	        		ACC.updatenavigation.toggleActiveClass(myAccountNavLinks,"js-nav-order-tools--active");
	        		var myAccountLink = $(this).find('a.js-myAccount-toggle');
	        		var currValue = myAccountLink.attr('aria-expanded');
            	    if(currValue == 'true'){
            	      currValue = 'false';
            	    }else{
            	      currValue = 'true';
            	    }
            	    myAccountLink.attr('aria-expanded', currValue);
	        	}
        	}); 
    	}

    },
    
    businessOption: function(){
    	//business option items
    	
        	$('.businessOption').on('click', function(){
        		var businessOptionLinks = $(this).find('div').filter("[data-id=PepsicoBusinessOptionComponentId]");
	        	if(businessOptionLinks.length){
	        		ACC.updatenavigation.toggleArrow($(this));
	        		ACC.updatenavigation.toggleActiveClass(businessOptionLinks,"js-nav-order-tools--active");
	        	}
        	});
    },
    
    myCompanyNavigation: function(){
    	//my company items
    	var oMyCompanyData = $('.companyNavComponent');
    	
    	if($(".logged_in") && $(".logged_in").length === 1){
    		var myCompanyHook = $('<a aria-expanded=\"false\" class=\"myCompanyLinksHeader collapsed js-myAccount-toggle\" href=\"javascript:void(0)\" id=\"myCompanyLinksHeaderId\"><span class="zeplin-arrow-dropdown triangle-bottom zeplin-arrow"></span>' + oMyCompanyData.data("title") + '</a>');
            myCompanyHook.insertBefore(oMyCompanyData);
            $('#myCompanyLinksHeaderId').on('click', function(){
            	var myAccountNavLinks = $(this).siblings().filter("[data-id=MyAccountComponentId]");
            	if(myAccountNavLinks.length){
            		ACC.updatenavigation.toggleArrow($(this));
            		ACC.updatenavigation.toggleActiveClass(myAccountNavLinks,"js-nav-order-tools--active");
            		var currValue = $(this).attr('aria-expanded');
            	    if(currValue == 'true'){
            	      currValue = 'false';
            	    }else{
            	      currValue = 'true';
            	    }
            	    $(this).attr('aria-expanded', currValue);
            		
            	}
            });
    	}
    },
    
    helpNavigation: function(){
    	var oHelpNavigation = $('li.hamburger');
    		oHelpNavigation.on('click',function(){
    			var that = $(this);
    			if(that.find('ul li').length){
    				ACC.updatenavigation.toggleActiveClass(that.find('ul'),"active");
    				ACC.updatenavigation.toggleAriaExpanded(that.find('.helpLink'));
    			}
    		});
    },
    closeOtherNav:function(){
    	if($('.openArrow').length > 0){
			ACC.updatenavigation.removeActiveClass($('.js-nav-order-tools--active'),"js-nav-order-tools--active");
			ACC.updatenavigation.closeArrow($('.openArrow'));
		}else if($('ul.active').length > 0){
			ACC.updatenavigation.removeActiveClass($('.active'),"active");
			ACC.updatenavigation.closeArrow($('.openArrow'));
		}
    },
    closeArrow:function(el){
    	if(el.hasClass('openArrow')===true)
    		el.removeClass('openArrow');
    },
    removeActiveClass: function(l,c){
    	if(l.hasClass(c)===true)
    		l.removeClass(c);
    },
    toggleArrow:function(elem){
    	if(elem.hasClass('openArrow'))
    		elem.removeClass('openArrow');
    	else{
    		$('.openArrow').removeClass('openArrow');
    		elem.addClass('openArrow');
    	}
    },
    
    toggleAriaExpanded: function($el){
    	var expanded = $el.attr('aria-expanded');

    	// For some browsers, `attr` is undefined; for others,
    	// `attr` is false.  Check for both.
    	if (typeof expanded !== typeof undefined && expanded !== false) {
    		if( expanded === "true" ){
    			$el.attr("aria-expanded", "false");
    		}else{
    			$el.attr("aria-expanded", "true");
    		}
    	}
    },
    
    toggleActiveClass: function(element,cls){
    	if(element.hasClass(cls)){
    		element.removeClass(cls);
    	}
    	else{
	    	$('.js-nav-order-tools--active').removeClass('js-nav-order-tools--active');
	    	$('.active').not('.tabhead').removeClass('active');
	    	element.addClass(cls);
	    	if($(".js-enquire-has-sub.show-sub").length > 0){
	    		$(".js-enquire-has-sub").removeClass('show-sub');
    		}
    	}
    },
    
    displaySurveyForm: function(){
    	$.ajax({
			url: ACC.config.encodedContextPath + "/survey/feedbackform",
			data: {"surveycode":surveycode},
			async: false,
			complete: function(rsp) {
				if(rsp && rsp.responseText) {
					var surveyJSON = eval('('+ rsp.responseText +')');
					if(surveyJSON) {
						var survey = new Survey.Model(surveyJSON);
						$("#surveyContainer").SurveyWindow({
						    model: survey,
						    title: "Customer Satisfaction Survey",
						    expanded: true,
						    onComplete: ACC.updatenavigation.saveSurveyResult
						});
						ACC.updatenavigation.setCommentLimit();
						ACC.updatenavigation.replaceSurveyTitleKey();
					}
				}
			}
		});
    	$("#surveyContainer").on("click", ".sv_window_title a", function(){
			ACC.updatenavigation.setCommentLimit();
			ACC.updatenavigation.replaceSurveyTitleKey();
			var ele = $(".sv_window_title .glyphicon");
			var browser = ACC.browserDetect.returnIE(ACC.browserDetect.ua);
			if(ele.hasClass("glyphicon-chevron-up")) {
				$(".sv_window").css({"top":"auto" , "overflow-y": "hidden"});
				if(browser){
					$(".sv_window").css("top","3px");
				}
			}
			else {
				$(".sv_window").css({"top":"3px" , "overflow-y": "scroll"});
				if(browser){
					$(".sv_window").css("top","auto");
				}
			}
    	})
    }, 
    
    setCommentLimit: function(){
    	var text = $("#sq_page").find(":text");
    	if( text.length > 0 ){
    		text.attr("maxlength", ACC.surveyCommentLimit);
    	}
    	var limitBlock = $("#sq_page").find(".js-limit-text-container");
    	if( limitBlock.length === 0 ){
	    	text.after( $("<div/>").addClass("text-right js-limit-text-container").html(ACC.surveyCommentLimitText) );
	    	$(".js-limit-text-container").find(".js-text-limit").text(ACC.surveyCommentLimit);
    	}
    },
    
    replaceSurveyTitleKey: function(){
    	var title = $(".sv_main h3").text();
    	if( title.length > 0 ){
			title = title.replace("[**", "<b>").replace("**]", "</b>");
			title = title.replace("[$$", "<u>").replace("$$]", "</u>");
			$(".sv_main h3").html( title );
    	}
    },    
    saveSurveyResult: function(survey){
    	var orderedFeedback = {};
    	var unorderedFeedback = survey.data;
    	if(!unorderedFeedback.hasOwnProperty("Other Comments")) {
    		unorderedFeedback["Other Comments"] = "";
    	}
    	Object.keys(unorderedFeedback).sort().forEach(function(key) {
    		orderedFeedback[key] = unorderedFeedback[key];
    	});

		var feedback = JSON.stringify(orderedFeedback);
		var cof = ACC.CofNo;
		var time = new Date();
		ACC.track.trackSubmitSurveyForm(feedback,surveycode,cof,time);
		$.ajax({
			url: ACC.config.encodedContextPath + "/survey/savefeedback",
			method: 'POST',
			data: {"feedback":feedback,"surveycode":surveycode, "cof":cof, "time":time}		
		});
		
		$("<div><h4>Thanks for the feedback!</h4></div>").dialog({
	        title: "Customer Satisfaction Survey",
	        resizable: false,
	        modal: true,
	        show: 'fade',
	        dialogClass: 'no-close',
	        buttons: {
	            "Close": function(){
	                $(this).dialog("close");
	            }
	        }
	    });
	},
	
    init: function(){
    	$(".navigation--bottom .nav__links--products > li > span a").attr("href", "javascript:void(0);");
    	ACC.updatenavigation.mobileNavToggle();
    },
    
    mobileNavToggle: function(){
    	$(document).on("click", "#faqToggle, #cofMobile, #signedInCompanyToggle, #signedInUserAccountToggle", function(){
			ACC.global.setAria("expanded",  $(this),  !$(this).hasClass('collapsed'));
    	})
    },
    
    handleMenuCollapse: function(){
    	//hide and show contnet areas for desktop
    	$('.js-secondaryNavAccount').on('shown.bs.collapse', function () {
    	
    	    if($('.js-secondaryNavCompany').hasClass('in')){
    	        $('.js-myCompany-toggle').click();
    	    }
    	
    	});
    	
    	$('.js-secondaryNavCompany').on('shown.bs.collapse', function () {
    	
    	    if($('.js-secondaryNavAccount').hasClass('in')){
    	        $('.js-myAccount-toggle').click();
    	    }
    	
    	});
    	
    	//change icons for up and down
    	
    	
    	$('.js-nav-collapse-body').on('hidden.bs.collapse', function(e){
    	
    	    var target = $(e.target);
    	    var targetSpan = target.attr('data-trigger') + '  span.zeplin-arrow-left';
    	    if(target.hasClass('in')) {
    	        $(targetSpan).removeClass('zeplin-arrow-right').addClass('zeplin-arrow-left');
    	    }
    	    else {
    	        $(targetSpan).removeClass('zeplin-arrow-left').addClass('zeplin-arrow-right');
    	    }
    	
    	});
    	
    	$('.js-nav-collapse-body').on('show.bs.collapse', function(e){
    		
    	    var target = $(e.target);
    	    var targetSpan = target.attr('data-trigger') + '  span.zeplin-arrow-right';
    	    if(target.hasClass('in')) {
    	        $(targetSpan).removeClass('zeplin-arrow-left').addClass('zeplin-arrow-right');
    	    }
    	    else {
    	        $(targetSpan).removeClass('zeplin-arrow-right').addClass('zeplin-arrow-left');
    	    }
    	});
    },
    
    buildMenuListing: function(oMyAccountData, aAcctData, oMMainNavDesktop){
    	var navClose = '';
    	navClose += '<div class="close-nav">';
    	navClose += '<button type="button" class="js-toggle-sm-navigation btn" aria-label="Close hamburger Menu"><span class="glyphicon glyphicon-remove"></span></button>';
    	navClose += '</div>';
    	
    	
    	//create Welcome User + expand/collapse and close button
    	//This is for mobile navigation. Adding html and classes.
    	var oUserInfo = $(".nav__right ul li.logged_in");
    	//Check to see if user is logged in
    	if(oUserInfo && oUserInfo.length === 1)	{
    	    var sUserBtn = '';
    	    sUserBtn += '<li class=\"auto \">';
    	    sUserBtn += '<div class=\"userGroup\">';
    	    sUserBtn += '<div class="navLogo"></div>';
    	    sUserBtn += '</div>';
    	    sUserBtn += navClose;
    	
    	    $('.js-sticky-user-group').html(sUserBtn);
    	
    	
    	    $('.js-userAccount-Links').append($('<li class="auto"><div class="myAccountLinksContainer js-myAccountLinksContainer"></div></li>'));
    	    $('.navLogo').append($('.js-site-logo .yCmsComponent.visible-xs a').addClass('visible-xs visible-sm').clone());
    		$('.navLogo').append($('.js-site-logo .yCmsComponent.hidden-xs a').addClass('hidden-xs hidden-sm').clone());
    	
    	
    	    //FOR DESKTOP
    	    //Added for Pepsico Block Start
    	
    	    //FOR MOBILE
    	    //create a My Account Top link for desktop - in case more components come then more parameters need to be passed from the backend
    	    var myAccountHook = [];
    	    myAccountHook.push('<div class="sub-nav"><span>');
    	    myAccountHook.push('<a aria-expanded="false" href="javascript:void(0);" id="signedInUserAccountToggle" class=\"myAccountLinksHeader collapsed js-myAccount-toggle\" data-toggle=\"collapse\" data-target=".offcanvasGroup2">');
    	    myAccountHook.push(oMyAccountData.data("title"));
    	    myAccountHook.push('<span class="zeplin-arrow-right myAcctExp"></span>');
    	    myAccountHook.push('</a>');
    	    myAccountHook.push('</span></div>');
    	
    	    $('.js-myAccountLinksContainer').append(myAccountHook.join(''));
    	
    	    //add UL element for nested collapsing list
    	    $('.js-myAccountLinksContainer').append($('<ul data-trigger="#signedInUserAccountToggle" class="offcanvasGroup2 offcanvasNoBorder collapse js-nav-collapse-body subNavList js-myAccount-root sub-nav"></ul>'));
    	
    	
    	    //offcanvas items
    	    //TO-DO Follow up here to see the output of the account data in the offcanvas menu
    	    for(var j = 0; j < aAcctData.length; j++){
    	        var oLink = oDoc.createElement("a");
    	        oLink.title = aAcctData[j].text;
    	        oLink.href = aAcctData[j].link;
    	        oLink.className = aAcctData[j].classes;
    	        oLink.innerHTML = aAcctData[j].text;
    	        var sPan = oDoc.createElement("span");
    	        sPan.appendChild(oLink);
    	
    	        var oListItem = oDoc.createElement("li");
    	        oListItem.appendChild(sPan);
    	        oListItem = $(oListItem);
    	        oListItem.addClass("auto ");
    	        $('.js-myAccount-root').append(oListItem);
    	    }
    	
    	}
    	
    	//desktop
    	for(var k = 0; k < aAcctData.length; k++){
    	    var oLink_d = oDoc.createElement("a");
    	    oLink_d.title = aAcctData[k].text;
    	    oLink_d.href = aAcctData[k].link;
    	    oLink_d.innerHTML = aAcctData[k].text;
    	
    	    var oListItem_d = oDoc.createElement("li");
    	    oListItem_d.appendChild(oLink_d);
    	    oListItem_d = $(oListItem_d);
    	    oListItem_d.addClass("auto col-md-4");
    	    if( oMMainNavDesktop.length > 0 ){
    	    oMMainNavDesktop.get(0).appendChild(oListItem_d.get(0));
    	    }
    	}
    },
    
    hideTopNavSubMenuOnMouseOut: function(event){
    	var x = event.pageX;
	    var y = event.pageY;
	    
	    var subNav = $(".js-offcanvas-links").find(".js_sub__navigation:visible");
	    if( subNav.length ){
	    	var left = subNav.offset().left;
	    	var top = subNav.offset().top;
	    	var right = left + subNav.width();
	    	var bottom = top + subNav.height();
		   
	    	var topLink = subNav.siblings(".js_nav__link--drill__down");
	    	var _left = topLink.offset().left;
	    	var _top = topLink.offset().top;
	    	var _right = _left + topLink.width();
	    	var _bottom = _top + topLink.height();
	    	
	    	if( (x < left || y < top || x > right || y > bottom) ){
	    		if(x < _left || y < _top || x > _right || y > _bottom){
	    			subNav.parent().removeClass("show-sub");
	    		}else{
	    			//Do nothing
	    		}
	    	}
	    }
    }
};

ACC.navigation.myAccountNavigation = function(){

	//copy the site logo
	
	$('.mobileLogo').append($('.js-site-logo .yCmsComponent.visible-xs a').addClass('visible-xs visible-sm').clone());
	$('.mobileLogo').append($('.js-site-logo .yCmsComponent.hidden-xs a').addClass('hidden-xs hidden-sm').clone());
	
	
	//Add the order form img in the navigation
	$('.nav-form').html($('<span class="glyphicon glyphicon-list-alt"></span>'));
	
	
	var aAcctData = [];
	
	//my account items
	var oMyAccountData = $(".accNavComponent");
	
	//the my Account hook for the desktop
	var oMMainNavDesktop = $(".js-secondaryNavAccount > ul");
	
	//offcanvas menu for tablet/mobile
	
	if(oMyAccountData){
	    var aLinks = oMyAccountData.find("a");
	    for(var i = 0; i < aLinks.length; i++){
	    	aAcctData.push({link: aLinks[i].href, text: $(aLinks[i]).data('title') != undefined ? $(aLinks[i]).data('title') : aLinks[i].title , classes: aLinks[i].className}); 
	  }
	}
	
	ACC.updatenavigation.buildMenuListing(oMyAccountData, aAcctData, oMMainNavDesktop);
	
	ACC.updatenavigation.handleMenuCollapse();

}

$(window).load(function(){
	if( $(".js-toggle-xs-search").length > 0 ){
		$(".js-toggle-xs-search").removeClass("hide");
	}
	//Hide Subnav menu when mouse cursor is moved from the top menu item
	$(document).on("click",function(event){
		ACC.updatenavigation.hideTopNavSubMenuOnMouseOut(event);
	});
});

//################################################################
//#### Custom Js For PopUp ####
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.justintimeinventorystockmessage = {
	
	_autoload: [
			"bindJustInTimeInventoryStockMessageLink"
		],

		bindJustInTimeInventoryStockMessageLink: function() {
		$(document).on("click",".justInTimeInventoryStockMessageLink", function(e) {
			e.preventDefault();
			var url = $(this).attr("href");
			var title = $(this).attr("title");

			ACC.colorbox.open(title,{
				href: url,
				maxWidth:"100%",
				width:"320px",
				height:"320px",
				initialWidth :"320px"
			});
		})
	}
};
ACC.home = {
	_autoload: [
		["displayImageFullScreen", $(".banner__component--responsive").find(".glyphicon-fullscreen").length >0],
		"changeExpCheckoutModal",
		"homeCarousel",
		"validateSubscribe",
		"showReply",
		["leadRegistrationSuccess", $("#flagVal").length > 0],
		["homecarouselVariantGA", $(".bannerContainer").length > 0],
		["preloginOverlayToggle", $(".loginDD").length > 0],
		"init"
	],
	
	totalCount : $(".login-bg").find("img").length,
	
	superscript: function(){
		$(".bodyContainer").children().each(function () {
		    $(this).html( $(this).html().replace(/<sup>&reg;<\/sup>/gi,'&reg;').replace(/&reg;/gi,'<sup>&reg;</sup>').replace(//gi,'<sup>&reg;</sup>') );
		});
		$(".breadcrumb").children().each(function () {
		    $(this).html( $(this).html().replace(/<sup>&reg;<\/sup>/gi,'&reg;').replace(/&reg;/gi,'<sup>&reg;</sup>').replace(//gi,'<sup>&reg;</sup>') );
		});
		$(".sub__navigation").children().each(function () {
		    $(this).html( $(this).html().replace(/<sup>&reg;<\/sup>/gi,'&reg;').replace(/&reg;/gi,'<sup>&reg;</sup>').replace(//gi,'<sup>&reg;</sup>') );
		});
		
	},
	
	displayImageFullScreen: function(){
		$(".banner__component--responsive").on("click", ".glyphicon-fullscreen", function(){
			var wideScreenImg = $(this).siblings(".markettingBannerWideScreen");
			var url = wideScreenImg.attr("src");
			var width = wideScreenImg.width();
			var height = wideScreenImg.height();
			var left = ( $(window).width() - width )/2;
			window.open( window.location.origin + url, "mrktBannerFullWindow", "scrollbars=yes, resizable=yes, fullscreen=yes, width="+
					width+", height="+height+", left="+left);
		});
	},
	
	changeExpCheckoutModal: function(){
		$('#expOrdModal').on('show.bs.modal', function (event) {
			  var button = $(event.relatedTarget) // Button that triggered the modal
			  var recipient = button.attr('title') // Extract info from data-* attributes
			  var modal = $(this)
			  modal.find('.modal-title').text( recipient );
		});
		$('#expOrdModal').on('hide.bs.modal', function () {
			  var modal = $(this)
			  modal.find('.modal-title').text( "Express Checkout" );
		});
	},
	
	validateEmail : function() {
		var expr = /^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/;
		
    	var email = $(".emailInput input");
    	
        if (!(expr.test(email.val()))) {
            email.next().css("display","inline-block");
            event.preventDefault();
        }
	       
	},
	
	validateSubscribe : function() {
		if($("#subscribeVal").val()=="true") {
			$('#subscribeModal').modal('show');
		}
	},
	showReply : function() {
		$(document).on("click", ".replyBtn", function (e) {
            e.preventDefault();
            var reply = $(this).parent();
	    	reply.find(".replyArea").toggle();
        }) 
	},
	leadRegistrationSuccess: function(){
		var flag = $("#flagVal").html();
		if (flag.length){
			$('#successmsg').modal('show');
		} 
	},
	
  homecarouselVariantGA: function(){
		ACC.home.carouselABtestGA("display");
		$(".bannerContainer .carousel__component--carousel .carousel-banner-link").on("click", function(){
			ACC.home.carouselABtestGA("success");
		})
	},
	carouselABtestGA: function(role){
		var variant = $(".bannerContainer .carousel__component--carousel").data("uid");
		ACC.track.trackHomeCarouselVariant(variant,role);
	},
	
	setTermsChecked: function(){
		var termsCookie = ACC.login.getTermsCookie();
   		if( termsCookie ){
   			$('#loginForm').find(":checkbox#terms").prop("checked", true);
   			$('#loginForm').find(".js-terms-block").addClass("hide");
   		}else{
   			$('#loginForm').find(".js-terms-block").removeClass("hide");
   		}
	},
	ajaxLoadLoginForm: function(ele){
		var element = ele.parent();
		if(ACC.AnonymousCustomer == "true" && element.find(".login_overlay").length == 0 ){
  		  
  		  var formurl = ACC.config.encodedContextPath + "/login/pre?prelogin=true";
  		  
			 $.ajax({
                 url: formurl,
                 method: "GET",
                 dataType : 'html',
                 success: function(result){
              	   element.append(result);
              	   ACC.home.setTermsChecked();
          			ACC.login.enableLoginBtn();
          			ACC.login.showPassword();
          			if( $(".js-password-block").find(".js-password").length > 0 ){
          				ACC.login.showEyeIcon($(".js-password-block").find(".js-password"));
          				setTimeout(function(){$(".js-password").keyup();},1000);
          			}
          			sessionStorage.removeItem("deliveryTimeStorage");
              		
          			ACC.validateForm.validateLogin();
          			ACC.forgottenpassword.bindLink();
              	   
                   },
                   complete: function(){
                  	 ele.siblings('.login_overlay').slideToggle(ACC.home.hideLoginOverlay);
                   }
              });
  		}
	},
	
	openLoginOverlay: function(){
		$(".loginDD, #mobileLogin").on("click", function(e){
			var ele;
			if($(this).hasClass("loginDD")){
				ele = $(".loginDD a#loginDown");
				ACC.updatenavigation.toggleArrow($(this));
			}
			else {
				ele = $(this);
			}
			
			if( ele.parent().find(".login_overlay").length == 0 ){
				ACC.home.ajaxLoadLoginForm(ele);
			}else{
				ele.siblings('.login_overlay').slideToggle(ACC.home.hideLoginOverlay);
			}
			
        	  
        	  
        	  ACC.home.setTermsChecked();
  			  e.stopPropagation();
		});
	},
	
	closeLoginOverlay: function(){
		$(document).on("click touchend",function(e){
			if( $(e.target).closest('.loginDD').length === 0 && $(e.target).closest('.devicelogin').length === 0 ){
				$(".login_overlay").hide();
				var form = $("#loginForm");
				if( form.length > 0 ){
					var validator = form.validate();
					validator.resetForm();
					form.find(".error").removeClass("error");
				}
				ACC.home.hideLoginOverlay();
				if($(".loginDD").hasClass("openArrow")){
					ACC.updatenavigation.toggleArrow($(".loginDD"));
				}
			}
		})
	},
	
	preloginOverlayToggle: function() {
		ACC.home.openLoginOverlay();
		
		ACC.home.closeLoginOverlay();
		
		$("#mobileMainMenu .nav__links li div.nav__link").on("mouseover", function(){
			$(".login_overlay").hide();
			ACC.home.hideLoginOverlay();
		}) 
		
		 $(".loginDD, .devicelogin").on("click",".login_overlay",function(e){
			e.stopPropagation();
		})
	},
	
	hideLoginOverlay: function(){
		if( $(".js-loginfailure").length > 0 ){
			$(".js-loginfailure").hide();
		}
		if($('.loginDD').hasClass('openArrow')){
			$('#loginDown').attr('aria-expanded',true);
		}else{
			$('#loginDown').attr('aria-expanded',false);
		}
		
		if($(".login_overlay").is(":visible")){
			if( ACC.navigation.showEquipmentWarningMsg ){
				ACC.navigation.displayEquipmentWarning(true);
				ACC.navigation.showEquipmentWarningMsg = false;
			}else{
				ACC.navigation.displayEquipmentWarning(false);
			}
		}else{
			ACC.navigation.displayEquipmentWarning(false);
		}
	},
	
	displyLoginOverlay: function(){
		var overlayIntElem;
		if( $("#mobileLogin").is(":visible") ){
			overlayIntElem = $("#mobileLogin");
			ACC.cartitem.scrollTo(overlayIntElem);
		}else if( $(".loginDD").is(":visible") ){
			overlayIntElem = $(".loginDD a#loginDown");
			ACC.cartitem.scrollTo($('.loginDD'));
			ACC.updatenavigation.toggleArrow($(".loginDD"));
		}
		if( overlayIntElem ){
			ACC.home.ajaxLoadLoginForm(overlayIntElem);
			overlayIntElem.siblings('.login_overlay').slideToggle(ACC.home.hideLoginOverlay);
		}
	},
	
	init: function(){
		$(".openLoginBox").on("click", function(e){
			e.preventDefault();
			e.stopPropagation();
			ACC.home.displyLoginOverlay();
		});
		if( $("#cofChangeBackBtnModal").length > 0 ){
			var $modal = $("#cofChangeBackBtnModal");
			$modal.modal("show");
			
			$modal.on('shown.bs.modal', function () {
	        	$modal.find(".js-first-focus").focus();
			    ACC.global.modalAccessibility( $modal, $modal.find(".js-loop"),  $modal.find(".js-last-focus"));
			});
		}
		ACC.home.cofChangeYesBtnClick();
		ACC.home.captureGAOnCarouselBannerLink();
	},
	
	captureGAOnCarouselBannerLink: function(){
		$(document).on("click", ".js-carousel-banner-link", function(e){
			e.preventDefault();
			var $this = $(this);
			var bannerName = $this.closest(".js-item").find(".js_ga_banner_name").val();
			var bannerId = $this.closest(".js-item").find(".js_ga_banner_id").val();
			
			ACC.track.trackCarouselBannerClick(bannerName, bannerId);
			
			var url = $this.attr("href");
			if( url ){
				window.location = url;
			}
		})
	},
	
	cofChangeYesBtnClick: function(){
		if($("#cofChangeBackBtnModal").length > 0){
			$("#cofChangeBackBtnModal").find(".js-error-msg").addClass("hide").empty();
			ACC.global.setAria("hidden", $("#cofChangeBackBtnModal").find(".js-error-msg"), false);
		}
		
		$(document).on("click", ".js-cof-change-modal-yes", function(e){
			e.preventDefault();
			var $this = $(this);
			
			var url = $this.closest("a").attr("href");
			var previousCof = $this.closest("#cofChangeBackBtnModal").find(".js-previous-cof").val();
			
			ACC.home.cofChangeYesBtnClickAjax(url, previousCof);
		})
	},
	
	cofChangeYesBtnClickAjax: function(url, previousCof){
		$.ajax({
            url: ACC.config.encodedContextPath + "/checkout/forcedCofRedirection",
            method: "GET",
            data:{previousClientAcId:previousCof},
            success: function(){
         	   window.location = url;
            },
            error: function(jqXHR, textStatus, errorThrown){
            	$(".js-error-msg").removeClass("hide").text("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
            	ACC.global.setAria("hidden", $(".js-error-msg"), false);
            }
        });
	}
};

ACC.search = {
	
	_autoload: [
		"init",
		"setindex",
        "bindbutton",
        "isSearchGridPage",
		"bindrefinement"
	],
	
	w_width : "",
	filter : "",
	d_items_count: "", 
	
	init: function(){
		if($('#searchAllProducts').val()){
			var productCount = $('#productCount').val();
			$('#toggleProducts .facet__list__text').append('('+ productCount +')'); 
		}
		
	},
	
	setindex: function(){
		ACC.search.w_width = $(window).width();
		ACC.search.filter = $( ".facet" );
		
        if ( ACC.search.w_width >= parseInt(screenSmMin) && ACC.search.w_width < parseInt(screenMdMin) ) {
        	ACC.search.d_items_count = 1;
        }
        else if ( ACC.search.w_width >= parseInt(screenMdMin) && ACC.search.w_width < parseInt(screenLgMin) ) {                                
        	ACC.search.d_items_count = 2;
        }
        else {
        	ACC.search.d_items_count = 3;
        }
		ACC.search.shFilters("load");
	},
	
	shFilters: function(event){
		if( event !== "click" ){
			$(".js-product-facet").find(".js-facet").removeClass("hidden");
		}
		if( window.screen.width > parseInt(screenXsMax) ){
		ACC.search.filter.each(function( index ) {
	        	if( index > ACC.search.d_items_count ){
	        		if( event === "click" ){
        		$( this ).toggleClass('hidden');
	        		}else{
	        			$(this).addClass('hidden');
	        		}
        	}
        });
		}else{
			$(".js-product-facet").find(".js-facet").removeClass("hidden");
		}
	},
	
	
	isSearchGridPage:function(){
		if($('#searchAllProducts').val()){
			var equipmentProductCount = $('#equipmentProductCount').val();
			var articleProductCount = $('#articleProductCount').val();
			var recipeProductCount = $('#recipeProductCount').val();
			$('#toggleEquipments .facet__list__text').append('('+ equipmentProductCount +')');
			$('#toggleArticles .facet__list__text').append('('+ articleProductCount +')');
			$('#toggleRecipes .facet__list__text').append('('+ recipeProductCount +')');
		} 
	},
	
	bindbutton: function(){
						
		$( ".btn-smfilters" ).click(function() {
			var txt1 = $(".js-less-filter").text();   
			var txt2 = 	$(".js-more-filter").text();
		    var ele = $("<span></span>");  
			ele.addClass("zeplin-arrow"); 
			if($( this ).hasClass( "show-more" )){
				$(this).empty();
		    	$( this ).removeClass( "show-more" ).addClass( "show-less" ).append(txt1, ele);
		    }else{
		    	$(this).empty();
		    	$( this ).removeClass( "show-less" ).addClass( "show-more" ).append(txt2, ele);
		    }
			ACC.search.shFilters("click");
		});
	},
	
	bindrefinement: function(){
		$(document).ready(function(){
			if($('#searchAllProducts').val()){
			    $('#search-landing-refinement input[type="checkbox"]').click(function(){
			        var inputValue = $(this).attr("value");
			        $("." + inputValue).toggle();
			    });
			    
			    $('#search-landing-refinement .facet__list__label').keypress(function (e) {
			    	var key = e.which;
			    	if(key === 13 || key ===32)  // the enter and space key code
			    	{
			    		var inputValue = $(this).parent().find('input[type="checkbox"]').attr("value");
				        $("." + inputValue).toggle();
			    		return false;  
			    	}
		    	});  
			}
		});
	},
	
	resetFilterButton: function(){
		$(".btn-smfilters").removeClass("show-less").addClass("show-more").empty().append($(".js-more-filter").text(), $("<span></span>").addClass("zeplin-arrow"));
	}
};

//################################################################
//#### Custom Tooltip 
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.login={
	_autoload: [   		
		"preLogin",
		["sectionOffset", $(".login-section").length > 0],
		"callOnResize",
		["changeBgImage", $(".login-bg").find("img").length > 0],
		"login",
		["showPassword", $(".js-password-block").length > 0]
	],
	    	
    preLogin : function(){
    	$(".js-pre-login").on("click", function(){
    		$(this).closest(".pre-login-section").attr("style", "display:none !important");
    		$(".login-section").find(".login-content").attr("style", "display:block !important");
		    		ACC.login.sectionOffset();
    	});
    	
    	$("#j_username").focus(function() {
    	    $("label.js-loginfailure").hide();
    	});
    },
    sectionOffset : function(){
    	var screen_h = $(window).height();
    	var login_section_h = $(".login-section").height();
    	var top_offset = (screen_h > login_section_h) ? ((screen_h - login_section_h) / 2) : 0;
    	$(".login-section").css({
    		"margin-top" : top_offset + "px"
    	});
    },
    callOnResize:function(){
    	$(window).on("resize", function(){
    		ACC.login.sectionOffset();
    	})
    },
    changeBgImage: function(){
    	ACC.common.addHeightInLoginPage();
    	var num = Math.ceil( Math.random() * ACC.home.totalCount );
		var $img = $(".login-bg").find("#MVP_Login_BG_"+num);
		$("body").css({
			"background-image":"url("+ $img.attr("src") +")"
		});
    },
    enableLoginBtn: function(){
    	if( $(".js-login-bt").length > 0 ){
    		$(".js-login-bt").removeClass("disabled");
    	}
    },
    
    createTermsCookie: function(){
    	var modifiedTime = $(".js-terms-last-modified").val();
    	$.cookie('pepsi_terms', modifiedTime, { expires: 30, path: '/' });
    },
    
    getTermsCookie: function(){
    	var isTermsExist = $.cookie('pepsi_terms');
    	var modifiedTime = $(".js-terms-last-modified").val();
    	return isTermsExist && decodeURIComponent(isTermsExist) == modifiedTime ;
    },
    
    loginSuccessGA: function(cusstomerID){
    	var cof = ACC.CofNo ? ACC.CofNo : "NA";
    	var uid = ACC.gauid ? ACC.gauid : "NA";
    	var firstLoginDt = ACC.gafirstLoginDate ? ACC.gafirstLoginDate : "NA";
    	var registrationDt = ACC.garegistrationDate ? ACC.garegistrationDate : "NA";
    	var custId = ACC.gacustomerId ? ACC.gacustomerId : "NA";
    	var loginDt = ACC.galoginDate ? ACC.galoginDate : "NA";
    	if( cusstomerID ){
    		ACC.track.trackLoginSuccessWithCusIdInGA(cof, custId, loginDt);
    	}else{
    		ACC.track.trackLoginSuccessInGA(cof, uid, firstLoginDt, registrationDt);
    	}
    },
    
    login:function(){
    	$(".loginDD, .devicelogin").on("click",".js-login-bt",function(event){
    		event.preventDefault();
    		$(this).closest("form#loginForm").submit();
    	});
    	
    	var getloginSuccessGA = sessionStorage.getItem("loginSuccessGA");
    	if( typeof(getloginSuccessGA) !== "undefined" && getloginSuccessGA === "gaLogin" ){
    		sessionStorage.removeItem("loginSuccessGA");
    		ACC.login.loginSuccessGA(false);
    		ACC.login.loginSuccessGA(true);
    	}
    },
    
    showPassword: function(){
    	ACC.login.bindEyeIcon();
    	
    	$(".js-login-fa-eye").on("click", function(){
    		var $this = $(this);
    		var isOpen = $this.hasClass("fa-eye");
    		var password = $this.closest(".js-password-block").find(".js-password");
    		var unmaskDuration = ACC.pwdUnmaskDuration ? parseInt(ACC.pwdUnmaskDuration) : 1000;
    		if( isOpen ){
    			$this.removeClass("fa-eye").addClass("fa-eye-slash");
    			password.attr("type", "text");
    			setTimeout(function () {
    				$this.addClass("fa-eye").removeClass("fa-eye-slash");
    				password.attr("type", "password");
    	    	}, unmaskDuration);
    		}
    	})
    },
    
    bindEyeIcon: function(){
    	$(".js-password-block").on("keyup", ".js-password", function(){
    		ACC.login.showEyeIcon($(this));
    	});
    },
    
    showEyeIcon: function($this){
    	if( $this.val().length > 0 ){
    		$this.closest(".js-password-block").find(".fa").removeClass("display-none");
		}else{
			$this.closest(".js-password-block").find(".fa").addClass("display-none");
		}
    },
    
    loginSuccess: function(){
    	ACC.common.createGaGoal("gaGoal");
    	ACC.common.createGaGoal("gaProductGoal");
    }
};

$(window).load(function(){
	if( ACC.pageName === "SecureCustomerPortalSecuredLoginPage" ){
		ACC.login.enableLoginBtn();
		if( $(".js-password-block").find(".js-password").length > 0 ){
			ACC.login.showEyeIcon($(".js-password-block").find(".js-password"));
		}
		sessionStorage.removeItem("deliveryTimeStorage");
	}
});
/**
 * 
 */

ACC.recipe = {

    _autoload: [
        "init",
        "replyToReview"
    ],

    init : function(){
    	
        $("#recipeFilterCategory").change(function () {
        	ACC.recipe.reloadpage();
        });
        
        $(document).on("change",".filterCheckbox",function(){
        	$(this).parents("form").submit();
        });
        
        $(document).on("click",".recipeFilter .filterhead",function(){
        	$(this).toggleClass( "active" );
        	$(".filterbody").toggleClass( "hideFilterbody" );
        });
        
        
    },
    reloadpage : function(){
		var subcategoryId = $('#recipeFilterCategory').val();
		var action = $('#subCategoryForm').attr('action') + subcategoryId;
		$('#subCategoryForm').attr('action', action);
		$('#subCategoryForm').submit();
    },
    replyToReview : function(){
    	$(".tab-review").on("click",".viewReply", function() {
			var replies = $(this).parent();
			$(this).addClass("hide");
			replies.find(".collapseReply").removeClass("hide");
			replies.find(".repliesSec").addClass("show");

		});

		$(".tab-review").on("click",".collapseReply", function() {
			var replies = $(this).parent();
			$(this).addClass("hide");
			replies.find(".viewReply").removeClass("hide");
			replies.find(".repliesSec").removeClass("show");

		});
    },  
    socialShare : function(e){
    	e.preventDefault();
    	e.stopPropagation();
    	var sHref = $(e.target)[0].href + window.location.href;
		window.open(sHref,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
    },
    ftShare : function(e){
    	e.preventDefault();
    	e.stopPropagation();
    	var sHref = $(e.target)[0].href;
		window.open(sHref,'', 'height=600,width=600');
    },
    pInterestShare : function(e) {
    	e.preventDefault();
    	e.stopPropagation();
    	var pUrl = $(e.target)[0].href + window.location.href;
    	var pMedia = $(".pinteresrtImg").text();
		var sHref = pUrl+"&media="+pMedia;
		sHref = sHref.replace("#" , "");
    	window.open(sHref,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
    },
    mailShare : function(e) {
        e.preventDefault();
         e.stopPropagation();
         var subject = $(e.target).find(".sub").text();
         var content = $(e.target).find(".content").text();
         var title, link;
         if(window.location.href.indexOf("/article") > -1) {
               subject = subject.replace("Q_page_Q", "article");
               content = content.replace("Q_page_Q", "article");
               title = $(".articleDetail .title").text();
               link = window.location.href;
         }
         if(window.location.href.indexOf("/recipe") > -1) {
               subject = subject.replace("Q_page_Q", "recipe");
               content = content.replace("Q_page_Q", "recipe");
               title = $(".recipeTitle").text();
               link = window.location.href;
         }
         
         content = content.replace("Q_title_Q", title);
         content = content.replace("Q_link_Q", link);
         
         window.location = 'mailto:' + '?subject=' + subject + '&body=' +   content;
         
     }
}

/**
 * 
 */

ACC.subbrand = {

    _autoload: [
        "init",
        ["displayBrand",  typeof(ACC.brandSource) !== "undefined"]
    ],

    init : function(){
    	
    	ACC.subbrand.updateAllSubbrandLinks();
    	
    	$(".brand-categories").on("click", ".panel-title", function() {
    		ACC.subbrand.getBrands(this);
    	});
    },
    
    displayBrand : function(){
    	$('a[href="#'+ACC.brandSource+'"]').click();
    },

	getBrands : function(item){
        var selectedBrand=ACC.selectedBrand;
		var categoryCode = $(item).find('.catCode').val();
		var rootCategoryCode=$(item).find('.rootCat').val();
        if ($(item).closest(".brand-categories").find(".listgroup li").length == 0)
        {
        	$.ajax({
	            url: ACC.config.encodedContextPath + '/navigation/getBrands',
	            method: "GET",
	            data:{categoryCode:categoryCode,root:rootCategoryCode},
	            success: function (data, textStatus, jqXHR) {
	            	var unorderedList = $("<ul></ul>");
                	unorderedList.attr("class", "listgroup");
	                $.each(data.submenuItems, function (key, value) {
	                	var listItem = $("<li></li>");
	                	if(selectedBrand==value.name){
	                		listItem.attr("class", "listgroupitem highlight");
	                	}else{
	                		listItem.attr("class", "listgroupitem");
	                	}
	                	
	                	var link = $("<a/>");
	                	link.attr("href", ACC.config.encodedContextPath+value.url);
	                	link.text(value.name);
	                	listItem.append(link);
	                	unorderedList.append(listItem);
	                	$(item).closest(".brand-categories").find(".listgroup").parent().html(unorderedList);
	               	});
	            	
	            	ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
	         
	            },
	            error: function( jqXHR, textStatus, errorThrown){
	            	ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
	            },
	            complete: function(jqXHR, textStatus){
	            	ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
	            }
	        	
	            
	        });
        }
	},
	
	updateAllSubbrandLinks: function () {
		var paramList = ACC.common.splitParamsFromUrl(window.location.search);
		var root = paramList["root"];
		var source = paramList["source"];
		var selectedBrand = paramList["selectedBrand"];
		
		$('.brand-product-desc').find('a').each(function() {
			var subbrandUrl = $(this).attr('href');
			subbrandUrl = source ? ACC.subbrand.updateQueryParam(subbrandUrl, "source", source) : subbrandUrl;
			subbrandUrl = root ? ACC.subbrand.updateQueryParam(subbrandUrl, "root", root) : subbrandUrl;
			subbrandUrl = selectedBrand ? ACC.subbrand.updateQueryParam(subbrandUrl, "selectedBrand", selectedBrand) : subbrandUrl;
			subbrandUrl = ACC.subbrand.updateQueryParam(subbrandUrl, "fromSubbrand", "Y");
			$(this).attr('href', subbrandUrl);
		});
	},
	
	updateQueryParam: function (uri, key, value) {
		if(value.length >0 ) {	
			var re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
			var separator = uri.indexOf('?') !== -1 ? "&" : "?";
			if (uri.match(re)) {
				return uri.replace(re, '$1' + key + "=" + value + '$2');
			}
			else {
				return uri + separator + key + "=" + value;
			}
		}
		return uri;
	}
	
    
    
}
//################################################################
//#### Custom profile 
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.profile={
	_autoload: [   		
		"deletePhone",
		"populateHiddenfields",
		"updateProfileForm",
		"editContact",
		"addContact",
		["passwordHint",$('input#newPassword,input#password, input#profile-newPassword').length > 0],
		"deleteContact",
		"profileBackBtn",
		"primaryContact",
		"addHours",
		"removeHrs",
		["updatePasswordForm", $("#updatePasswordForm").length > 0],
		["addNewCustomerContact", $("#addNewProfileForm").length > 0],
		["updateCustomerContact", $("#editProfileForm").length > 0],
		["customerPreferenceForm", $("#customerPreferenceForm").length > 0],
		"datePicker",
		["operatingTime", $(".js-toOperating").length > 0],
		"serving",
		"takeout",
		"emailWarning",
		"confirmDuplicateEmail",
		"cancelDuplicateEmail",
		"initProfile",
		["phoneNoFormating",$("#addNewProfileForm").length > 0 || $("#editProfileForm").length > 0 || $("#updatePasswordForm").length > 0],
		["addPrefDropDown",$("#customerPreferenceForm").length > 0],
		"copyPaste"		
	],
	preferenceModalFlag : false, 
	globalTimeDiff:400,
	
	passwordHint : function(){
		enquire.register("screen and (min-width:768px)", function() {
            	$(document).on('focus','input#newPassword,input#password, input#profile-newPassword',function(){
        			$('.passwordTooltip').mouseover();
        			setTimeout(function(){
        				$('.passwordTooltip').mouseout();
        			}, 3000);
        		});
        		$(document).on('blur','input#newPassword,input#password, input#profile-newPassword',function(){
        			$('.passwordTooltip').mouseout();
        		});
            
		}).register("screen and (max-width:766px)", function() {
        	$(document).off('focus','input#newPassword,input#password, input#profile-newPassword');
    		$(document).on('blur','input#newPassword,input#password, input#profile-newPassword');
	});
		
	},
	phoneNoFormating: function(){
		var elems = '#updateProfileForm [name="phoneNo"], #updateProfileForm [name="alternatePhones"], #updateProfileForm [name="mobileNumber"], '+ 
					'#updateProfileForm [name="faxPhone"],#editProfileForm [name="phoneNo"],#editProfileForm [name="alternatePhones"], '+
					'#editProfileForm [name="mobileNumber"], #editProfileForm [name="faxPhone"], #addNewProfileForm [name="phoneNo"], '+
					'#addNewProfileForm [name="alternatePhones"], #addNewProfileForm [name="mobileNumber"], #addNewProfileForm [name="faxPhone"]'
		
		var extNo = '#updateProfileForm [name="phoneNoExtn"], #editProfileForm [name="phoneNoExtn"], #addNewProfileForm [name="phoneNoExtn"]';
		$(extNo).on("keydown", function(event) {			
			ACC.profile.preventNonNumberEntry(event);		
		});
		
		$(elems).on("keydown", function(event) {			
			ACC.profile.preventNonNumberEntry(event);		
		});	
		$(elems).on("keyup blur", function() {
			ACC.validateForm.masking($(this));
		});
		
		
	},	
	triggerEmailWarningModal:true,	
	emailCurrentForm: null,
	allowFormSubmit:true,
	emailWarning: function(){
			$(document).on('change','input[name="emailId"]', function(){
				var element = $(this);
				var allEmail = [];
				var contactId = element.closest('form').find('[name="contactId"]').val();
				var emailId = element.val().toLowerCase();
				$("[id^='emailAddress_']").each(function(){
					if( (element.closest('form').attr("id") === "addNewProfileForm" && $(this).text() !== "" ) 
							|| ($(this).text() !== "" && "emailAddress_" + contactId !== $(this).attr('id'))){
						allEmail.push($(this).text().trim().toLowerCase());
					}
				});
				if($.inArray( emailId, allEmail ) >= 0 ){
					ACC.profile.emailCurrentForm = element.closest('form');
					ACC.profile.allowFormSubmit = false;
				}else{
					ACC.profile.allowFormSubmit = true;
				}
			});
		},	
	confirmDuplicateEmail : function(){
		$(document).on('click','.js-confirmDuplicateEmail', function(){
			$('#duplicateEmailModal').modal('hide');
			ACC.profile.allowFormSubmit = true;
			ACC.profile.emailCurrentForm.submit();
		});
	},	
	cancelDuplicateEmail : function(){
		$(document).on('click','.js-cancelDuplicateEmail', function(){
			$('#duplicateEmailModal').modal('hide');
			ACC.profile.emailCurrentForm.find('input[name="emailId"]').focus();
		});
	},
	takeout: function(){
			$(document).on('change','[name="t"]', function(){
				if($(this).val() === 'yes'){
					$("#takeOut").val('30');
				}else{
					$("#takeOut").val('0');
				}
				$('.js-update-businessInfo').removeClass('disabled');
					
			});
		},
	serving: function(){
		$(document).on('change', '.js-serving', function(){
			var parent =  $(this).closest('.row');
			var length = parent.find(':checked').length;
			$('.js-update-businessInfo').removeClass('disabled');
			
			parent.find(':not(:checked)').next(':hidden').val('0');
			
			switch (length) {
			case 1:
				parent.find(':checked').next(':hidden').val('100');
				break;
			case 2:
				parent.find(':checked').next(':hidden').val('50');
				break;
			case 3:
				$("#breakfast_val").val('25');
				$("#lunch_val").val('50');
				$("#dinner_val").val('25');
				break;
			default:
				parent.find(':hidden').val('0');
				break;
			}
		});
	},
	
	changeOperatingHour: function(){
		$(document).on('change', '#js-operatingHrs select', function(){
			$('.no-operating-hour').addClass('hide');
			$('.regular-operating-hour').addClass('hide');
			var parentRowDay = $(this).closest(".row").data("rowday");
			var hasError = false;
			$("#js-operatingHrs").children("[data-rowday="+parentRowDay+"]").each(function(){
				var parentRow = $(this);
				var from = parentRow.find('.js-fromOperating');
				var to = parentRow.find('.js-toOperating');
				parentRow.find('.js-addHrs').removeClass('js-notFilled');
				to.removeClass('fillBoth');
				from.removeClass('fillBoth');
				//destination(to) - source(from) - overlapping(false)
				var error = ACC.profile.convertToNumber(to,from,false);
				if( error ){
					hasError = true;
				}
				if( parentRow.find('button').hasClass('disabled') ){
					var nextFrom = parentRow.next('.row').find('.js-fromOperating.second');
					to.removeClass('fillBoth');
					nextFrom.removeClass('fillBoth');
					//destination(nextFrom) - source(to) - overlapping(true)
					var overlap = ACC.profile.convertToNumber(nextFrom, to, true );
					if( overlap ){
						hasError = true;
					}
				}
			});
			if( !hasError ){
				$('.js-update-businessInfo').removeClass('js-preventDefult');
			}else{
				$('.js-update-businessInfo').addClass('js-preventDefult');
			}
		});
	},
	
	operatingTime:function(){
		
		ACC.profile.changeOperatingHour();
		
		$(document).on('click', '.js-preventDefult', function(e){
			e.preventDefault();
			$('.customError').eq(0).focus();
		});
		
		$(document).on('change', '.js-closed', function(){
			var that = $(this);
			var rowDay = that.closest('.row').data('rowday');
			that.closest('.row').find('.js-closedText').addClass('hide');
			$('.row[data-rowday="'+rowDay+'"]').find('.js-openContent').removeClass('hide');
			$('.row[data-rowday="'+rowDay+'"]').find('label.error.hide').removeClass('hide');
			that.addClass('js-notClosed');
			that.removeClass('js-closed');
		});
		
		$(document).on('change', '.js-notClosed', function(){
			var that = $(this);
			var rowDay = that.closest('.row').data('rowday');
			$('.row[data-rowday="'+rowDay+'"]').find('.js-openContent').addClass('hide');
			that.closest('.row').find('.js-closedText').removeClass('hide');
			$('.row[data-rowday="'+rowDay+'"]').find('label.error').addClass('hide');
			that.addClass('js-closed');
			that.removeClass('js-notClosed');
		});
		
		$(document).on("click", ".js-update-businessInfo" ,function(e){
			e.preventDefault();
			//check if at least one set of operating hours selected
			if(ACC.profile.getOperatingHoursCount() == 0) {
				return false;
			}
			if(!$(this).hasClass('js-preventDefult')){
				if($('.fillBoth').length > 0){
					$('.fillBoth').eq(0).change();
				}else{
				$('#manageContactSpinner').removeClass("display-none");
				ACC.profile.updateBusinessInfoCustomerDetails();
				}
			}
		});		
	},
	
	getOperatingHoursCount: function() {
		var count = 0;
		var deliveryDayOpen = false;
		var deliveryDaySelected = true;
		$('.no-operating-hour').addClass('hide');
		$('.regular-operating-hour').addClass('hide');
		$('#js-operatingHrs').find("div[class*='operating-']").each(function() {
			var rowday = $(this).data('rowday');
			if($('#Operating-'+rowday).is(":checked")) 
			{
				deliveryDayOpen = true;
				var from1 = $('#Operating-'+rowday+'From1').val();
				var from2 = $('#Operating-'+rowday+'From2').val();
				var to1 = $('#Operating-'+rowday+'To1').val();
				var to2 = $('#Operating-'+rowday+'To2').val();
				if( (from1 && to1) || (from2 && to2) ){
					count+=1;
				}
				else if($('#Operating-'+rowday).prop('disabled')) {
					deliveryDaySelected = false;
				}
			}
		});
		
		count = ACC.profile.setOperatingHoursCount(deliveryDaySelected, deliveryDayOpen, count);
		
		return count;
	},
	
	setOperatingHoursCount: function(deliveryDaySelected, deliveryDayOpen, count){
		if(!deliveryDaySelected) {
			count = 0;
			$('.regular-operating-hour').removeClass('hide').show();
		} else if(deliveryDayOpen && count == 0) {
			$('.no-operating-hour').removeClass('hide').show();
		} else {
			count = 1;
		}
		return count;
	},
	
	convertToNumber: function(el1,el2,fourHrDiff){
		var elem1 = el1;
		var elem2 = el2;
		var elem1Value = elem1.val();
		var elem2Value = elem2.val();
		var elem1Format = elem1Value.split(" ")[1];
		var elem2Format = elem2Value.split(" ")[1];
		
		//get the date
		elem1Value =  elem1Value.split(" ")[0];
		elem2Value =  elem2Value.split(" ")[0];
		
		
		//convert date to number . add 1200 if it is PM
		if(elem1Value.split(":")[0] < 12){
			elem1Value = (elem1Format === 'AM') ? parseInt(elem1Value.split(":")[0] + elem1Value.split(":")[1]) : parseInt(elem1Value.split(":")[0] + elem1Value.split(":")[1])+1200;
		}else{
			elem1Value = (elem1Format === 'AM') ? parseInt(elem1Value.split(":")[0] + elem1Value.split(":")[1])-1200 : parseInt(elem1Value.split(":")[0] + elem1Value.split(":")[1]);
		}
		
		if(elem2Value.split(":")[0] < 12){
			elem2Value = (elem2Format === 'AM') ? parseInt(elem2Value.split(":")[0] + elem2Value.split(":")[1]) : parseInt(elem2Value.split(":")[0] + elem2Value.split(":")[1])+1200;
		}else{
			elem2Value = (elem2Format === 'AM') ? parseInt(elem2Value.split(":")[0] + elem2Value.split(":")[1])-1200: parseInt(elem2Value.split(":")[0] + elem2Value.split(":")[1]) ;
		}
		
		return ACC.profile.compareTimeDiff(elem2Value,elem1Value,fourHrDiff,elem2,elem1);
	},
	
	compareTimeDiff: function(sourceTime, destTime, checkOverLapping, source, destination){
		var errorMsg;
		if( checkOverLapping ){
			errorMsg = ACC.profile.compareOverLappingTime(sourceTime, destTime, destination);
		}else{
			errorMsg = ACC.profile.compareRowTimes(sourceTime, destTime, destination);
		}
		return errorMsg.length > 0;
	},
	
	compareOverLappingTime: function(sourceTime, destTime, destination){
		var errorMsg = "";
		var label = destination.attr('aria-label');
		if(destTime < sourceTime){
			errorMsg = ACC.overlappingError;
			if(destination.closest('.row').find('.error.overlapping').length < 1){
				destination.closest('.row').append('<label class="error overlapping" style="width: 100%;">'+errorMsg+'</label>');
			}else{
				destination.closest('.row').find('.error.overlapping').text(errorMsg);
			}
			
			destination.addClass("customError");
			destination.attr('aria-label',label + ' ('+errorMsg+')');
		}else{
			destination.removeClass("customError");
			destination.closest('.row').find("label.error.overlapping").remove();
		}
		return errorMsg;
	},
	
	compareRowTimes: function(sourceTime, destTime, destination){
		var errorMsg = "";
		var label = destination.attr('aria-label');
		ACC.profile.removeSubmitTicketError(destination);
		if(destTime < sourceTime){
			errorMsg = ACC.greaterThanHrsDiffError;
			ACC.profile.showErrorMsg(destination,errorMsg,label);	
		}
 		else if ((sourceTime + ACC.profile.globalTimeDiff) > destTime) {
			if (ACC.profile.globalTimeDiff == 400) {
				errorMsg = ACC.fourHrsDiffError;
			} else if (ACC.profile.globalTimeDiff == 500) {
				errorMsg = ACC.fiveHrsDiffError;
			}

			ACC.profile.showErrorMsg(destination, errorMsg, label);
		}else if((isNaN(sourceTime) || isNaN(destTime)) && !(isNaN(sourceTime) && isNaN(destTime))){
			errorMsg = ACC.bothShouldBeFilledError;
			ACC.profile.showErrorMsg(destination,errorMsg,label);
		}
		
		errorMsg = ACC.profile.checkSubmitTicketError(errorMsg, sourceTime, destTime, destination, label);
		
		if(errorMsg.length === 0){
			destination.removeClass("customError");
			destination.closest('.row').find(".error.difference").remove();
		}
		return errorMsg;
	},
	
	removeSubmitTicketError: function(destination){
		if( ACC.pageName === "submitTicketPage" ){
			destination.closest(".js-time-container").removeClass("errorLeft errorRight");
			destination.closest(".js-time-container").find("[class*='js-time-']").each(function(){
				var orgAriaLabel = $(this).data("ariaLabel");
				$(this).attr("aria-label", orgAriaLabel).removeClass("customError");
			})
		}
	},
	
	checkSubmitTicketError: function(errorMsg, sourceTime, destTime, destination, label){
		var error = errorMsg;
		var elem;
		if( ACC.pageName === "submitTicketPage" && errorMsg.length === 0 && (sourceTime < 700 || destTime > 2300) ){
			error = "We are sorry, but our earliest start time is 7 AM and latest end time is 11 PM. Your time has been adjusted accordingly";
			if( sourceTime < 700 ){
				destination.closest(".js-time-container").addClass("errorLeft");
				elem = destination.closest(".js-time-container").find(".js-time-from");
			}else{
				destination.closest(".js-time-container").addClass("errorRight");
				elem = destination;
			}
			ACC.profile.showErrorMsg(elem,error,label);
		}
		return error;
	},
	
	showErrorMsg : function(elem,errorMsg,label){
		var boxclass;
		if(ACC.pageName === "submitTicketPage"){
			boxclass = "col-xs-12 no-space error difference bottom";
			boxclass += elem.closest(".js-day-row").data("name") === "sat" ? " margin-top-15" : " no-margin";
		}else{
			if( elem.closest(".row").find(".js-closedText").length > 0 ){
				boxclass = "col-md-7 col-xs-12 col-sm-7 no-space error difference";
			}else{
				boxclass = "col-md-7 col-xs-12 col-sm-7 col-md-offset-2 no-space error difference";
			}
		}
			
		var errorHtml = ACC.common.createMessage("warning", errorMsg, boxclass, "", "", true);
		if(elem.closest('.row').find('.error.difference').length < 1){
			elem.closest('.row').append(errorHtml);
		}else{
			elem.closest('.row').find('.error.difference .js-message').text(errorMsg);
		}
		
		var target = elem;
		var ariaLabel = label + ' ('+errorMsg+')';
		
		if( ACC.pageName === "submitTicketPage" ){
			ariaLabel = '('+errorMsg+')';
			if( !elem.closest(".js-time-container").hasClass("errorRight") && !elem.closest(".js-time-container").hasClass("errorLeft") ){
				var fromElem = elem.closest(".js-time-container").find(".js-time-from");
				if( isNaN(parseInt(fromElem.val())) ){
					target = fromElem;
					elem.closest(".js-time-container").addClass("errorLeft");
				}else{
			elem.closest(".js-time-container").addClass("errorRight");
		}
			}
		}
		
		target.addClass("customError");
		target.attr('aria-label',ariaLabel);
	},
	
	old_primary_contact:null,
	new_primary_contact:null,
	updatePasswordForm : function(){
		var updatePasswordForm = $('#updatePasswordForm');
		updatePasswordForm.ajaxForm({
            beforeSubmit: function(arr){
                var fieldArr = ["newPassword", "checkNewPassword","currentPassword"];
                for(var i=0; i<arr.length; i++){
                    if( $.inArray(arr[i].name, fieldArr) >= 0 ){
                            arr[i].value = encodeURIComponent(arr[i].value) ;
                    }
                }
            },
	    	success: function(resp){
	    		$("#accessibletabscontent0-1").next(".tabbody").find(".alert-dismissable").remove();
	    		var html;
	    		if(resp.success){
	    			html = '<div class="alert alert-success alert-dismissable">'+
					'<span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span>'+
					'<button class="close" aria-hidden="true" data-dismiss="alert" type="button">&times;</button>'+
					resp.message +
					'</div>';
	    		}else{
	    			html = '<div class="alert alert-warning alert-dismissable">'+
					'<span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span>'+
					'<button class="close" aria-hidden="true" data-dismiss="alert" type="button">&times;</button>'+
					resp.message +
					'</div>';
	    		}
	    		updatePasswordForm[0].reset();
	    		$("#accessibletabscontent0-1").next(".tabbody").prepend(html);
	    		$("#accessibletabscontent0-1").next(".tabbody").find('.alert.alert-dismissable').attr('tabindex',-1).focus();
	    	}
		});
	},   	
	updatePreferenceFormData:[],   
	addHours : function(){
		$(document).on("click", ".js-addHrs" ,function(){
			var that = $(this);
			var index = that.closest('.row').index();
			var day = that.data("day");
			var hrIndex = $('.operating-'+day).length;
			var prevToTime = that.closest('.row').children().eq(4).find('select').val();
			if(hrIndex <= 1){
				$("#addNewTimeTemplate").tmpl({"day": day, "index" : hrIndex, "prevToTime" : prevToTime }).insertAfter($('#js-operatingHrs .row').eq(index));
				that.addClass('disabled');
			}
			$('#Operating-'+day+'From2').addClass('fillBoth');
			$('#Operating-'+day+'From'+(hrIndex+1)).val(prevToTime);
    	});
	},
	removeHrs : function(){
		$(document).on("click", ".js-removeHrs" ,function(){
			var previousFormData = $('#businessHoursForm').serialize();
    		var delRow = $(this).closest('.row');
    		delRow.prev('.row').find(".js-addHrs").removeClass("disabled");
    		delRow.remove();
    		if($('#businessHoursForm').serialize() !== previousFormData){
    			$('.js-update-businessInfo').removeClass("disabled");
    		}
    	});
	},
	
    deletePhone : function(){
    	$(document).on("click", ".js-delNewPh" ,function(){
    		var delRow = $(this).closest('.row');
    		delRow.remove();
    	});
    	
    },
    editContact : function(){
    	$(document).on("click", ".js-editContact" ,function(){
    		var i = $(this).data('index');
    		ACC.profile.editContactFormData(i);
    		
    		$('.js-manageContactTable').addClass('hide');
    		$('.js-editFormContainer').removeClass('hide');
    		ACC.global.footerAlignment();
    	});
    },
    
    editContactFormData : function(i){
    	$('#editProfileForm_businessName').val($('#firstName_'+i).text());
		$('#editProfileForm_lastName').val($('#lastName_'+i).text());
		$('#editProfileForm_emailId').val(($('#emailAddress_'+i).text())?$('#emailAddress_'+i).text(): "");
		$('#editProfileForm_accountId').val($('#accountId_'+i).val());
		$('#editProfileForm_contactId').val($('#contactId_'+i).val());
		$('#editProfileForm_primaryFlag').val($('#primaryFlag_'+i).val());
		$('#editProfileForm_primaryAccountName').val($('#primaryAccountName_'+i).val());
		$('#editProfileForm_pepsiDirect').val($('#pepsiDirect_'+i).val());
		$('#editProfileForm_pepsiCoPartners').val($('#pepsiCoPartners_'+i).val());
		$('#editProfileForm_phoneType').val($('#phoneType_'+i).val());
		$('#editProfileForm_title').val($('#comment_'+i).val());
		
		//hidden fields for capturing pre-change value during validation
		$('.js-editProfileForm_businessName').val($('#firstName_'+i).text());
		$('.js-editProfileForm_lastName').val($('#lastName_'+i).text());
	
		
		var businessRole = $('#jobTitle_'+i).val();
		if(businessRole && (businessRole == 'OWNER'
			   			|| businessRole == 'MANAGER' 
			   			|| businessRole == 'BUYER'))
		{
			$('#editProfileForm_jobTitle').val(businessRole);
			$('.js-editProfileForm_jobTitle').val(businessRole);
		} else {
            $('#editProfileForm_jobTitle').val('');
            $('.js-editProfileForm_jobTitle').val('');
		}
		
		ACC.profile.editContactNumbers(i);
    },
    
    editContactNumbers: function(i){
    	$('#editProfileForm_phoneNo').val(($('#mobileNumber_'+i).val())?$('#mobileNumber_'+i).val().replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"): "");
		$('#editProfileForm_fax').val(($('#faxPhone_'+i).val())?$('#faxPhone_'+i).val().replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"): "");
    	var businessPhoneNo = $('#workPhone_'+i).val();
		if(businessPhoneNo){
			if( businessPhoneNo.length > 10) {
    			$('#editProfileForm_business').val(businessPhoneNo.substring(0, 10).replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
    			$('.js-editProfileForm_business').val(businessPhoneNo.substring(0, 10).replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
    			
    			$('#editProfileForm_business_ext').val(businessPhoneNo.substring(10));
    			$('.js-editProfileForm_business_ext').val(businessPhoneNo.substring(10));
    		} else {
    			$('#editProfileForm_business').val(businessPhoneNo.replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
    			$('.js-editProfileForm_business').val(businessPhoneNo.replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
    			
    			$('#editProfileForm_business_ext').val('');
    			$('.js-editProfileForm_business_ext').val('');
    		}
		}
    	
    	var alternatePhoneNo = $('#alternatePhone_'+i+'_0').val();
    	$('#editProfileForm_alternate').val('');
    	$('#editProfileForm_alternate_ext').val('');
    	$('#editProfileForm_alternateId').val('');
		if(alternatePhoneNo){
			if( alternatePhoneNo.length > 10) {
    			$('#editProfileForm_alternate').val(alternatePhoneNo.substring(0, 10).replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
    			$('#editProfileForm_alternate_ext').val(alternatePhoneNo.substring(10));
    		} else {
    			$('#editProfileForm_alternate').val(alternatePhoneNo.replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
    			$('#editProfileForm_alternate_ext').val('');
    		}
			$('#editProfileForm_alternateId').val($('#alternatePhoneId_'+i+'_0').val());
		}
    },
    addContact : function(){
    	$(document).on("click", ".js-addContact" ,function(){
    		$('#addNewProfileForm_title').val('');
    		$('#addNewProfileForm_jobTitle').val('');
    		$('#addNewProfileForm_alternateId').val('');
            $('#addNewProfileForm').find('input[type="text"] ').val('');
    		$('.js-manageContactTable').addClass('hide');
    		$('.js-addNewFormContainer').removeClass('hide');
    		ACC.global.footerAlignment();
    	});
    	
    },
    deleteContact : function() {
    	$(document).on("click", ".js-deleteContact" ,function(){
    		var id = $(this).data('index');
    		$('#deleteContactIdHidden').val(id);
    		var contactName = $('#firstName_'+id).text() + ' ' + $('#lastName_'+id).text();
    		$('.deleteContactName').text(contactName);
    		$('#confirmDeleteContactModal').modal();
    		
    		$('#confirmDeleteContactModal').on('shown.bs.modal', function () {
    			$('#confirmDeleteContactModal').find(".js-first-focus").focus();
    		    ACC.global.modalAccessibility( $('#confirmDeleteContactModal'), $('#confirmDeleteContactModal').find(".js-btn-close"),  $('#confirmDeleteContactModal').find(".js-last-focus"));
    		});
    	});
    	
    	ACC.profile.confirmDeleteForm();
    	
    },
    deleteContactErrorModal: function(){
		$('#deleteContactErrorModal').modal({backdrop:'static'});
		$('#deleteContactErrorModal').on('shown.bs.modal', function () {
			$('#deleteContactErrorModal').find(".js-first-focus").focus();
		    ACC.global.modalAccessibility( $('#deleteContactErrorModal'), $('#deleteContactErrorModal').find(".js-last-focus"),  $('#deleteContactErrorModal').find(".js-last-focus"));
		});
	},
    confirmDeleteForm : function(){
    	var confirmDeleteForm = $('#confirmDeleteContactForm');
    	
    	confirmDeleteForm.ajaxForm({
			beforeSubmit: function() {
				$("#confirmDeleteContactModal").modal('hide');
        		$("#manageContactSpinner").removeClass("display-none");
        	},
        	success: function(rsp){
        		$('#manageContactSpinner').addClass("display-none");
        		if(rsp == 'Success') {
	        		$('#deleteContactSuccessModal').modal({backdrop:'static'});
	        		ACC.profile.showModal($('#deleteContactSuccessModal') , "#manage-contacts");
        		} else {
        			ACC.profile.deleteContactErrorModal();
        		}
        	},
        	error: function() {
        		$('#manageContactSpinner').addClass("display-none");
        		ACC.profile.deleteContactErrorModal();
        	}
        });
    },
    profileBackBtn : function(){
    	$(document).on("click", ".js-back" ,function(){
    		var form = $(this).closest('form');
    		if(form.attr('id') === 'updateProfileForm'){
    			var sUrl = ACC.config.encodedContextPath;
                window.location = sUrl;
    		}else if (form.attr('id') === 'editProfileForm') {
    			$('.js-editProfileForm_phoneNo-row').each(function(){
    				if($(this).index() !== 0){
    					$(this).remove();
    				}
    			});
    			form.validate().resetForm();
    			$('.js-editFormContainer').addClass('hide');
    			form.find('[type="submit"]').addClass("disabled");
    			$('.js-manageContactTable').removeClass('hide');
    			ACC.profile.triggerEmailWarningModal = true;
    			ACC.global.footerAlignment();
    		}else{
    			ACC.profile.triggerEmailWarningModal = true;
    			form.validate().resetForm();
    			$('.js-addNewFormContainer').addClass('hide');
    			form.find('[type="submit"]').addClass("disabled");
	    		$('.js-manageContactTable').removeClass('hide');
	    		ACC.global.footerAlignment();
    		}
    	}); 
    },
    populateHiddenfields : function(){
    //populate 	
    	$('.js-updateProfileForm_jobTitle').val($('#updateProfileForm_jobTitle').val());
    	$('.js-updateProfileForm_businessName').val($('#updateProfileForm_businessName').val());
    	$('.js-updateProfileForm_lastName').val($('#updateProfileForm_lastName').val());
    	$('.js-updateProfileForm_business').val($('#updateProfileForm_business').val());
    	$('.js-updateProfileForm_business_ext').val($('#updateProfileForm_business_ext').val());
    },
    updateProfileForm : function(){
    	var updateProfileForm = $('#updateProfileForm');
    	ACC.validateForm.formChangeValidation(updateProfileForm);
    	updateProfileForm.ajaxForm({
    		beforeSubmit: function() {
        		$('#manageContactSpinner').removeClass("display-none");
        	},
        	success: function(){
        		sessionStorage.setItem("myProfileTabRedirAttr", "#personal-details");
        		window.location.href = ACC.config.encodedContextPath + "/my-account/update-profile";
        	}
        });
    },
    primaryContact : function(){
    	ACC.profile.old_primary_contact = ACC.profile.new_primary_contact = $("[id^='primaryContact_']:checked").val();
    	$(document).on("change", "[id^='primaryContact_']" ,function(){
    		ACC.profile.new_primary_contact = $(this).val();
    		$("#primaryHidden").val(ACC.profile.new_primary_contact);
    		$(".primaryContactName").text($("#firstName_"+ACC.profile.new_primary_contact).text() + " "+ $("#lastName_"+ACC.profile.new_primary_contact).text());
    		$("#confirmPrimaryContactModal").modal();
    		
    	});
    	//cancel btn
    	$(".js-cancelPrimary").click(function(){
    		$("#confirmPrimaryContactModal").modal('hide');
    		$("[id^='primaryContact_'][value='"+ACC.profile.old_primary_contact+"']").prop('checked', true);
    	});
    	//backdrop
    	$("#confirmPrimaryContactModal").on('hidden.bs.modal', function () {
    		$("#confirmPrimaryContactModal").modal('hide');
    		$("[id^='primaryContact_'][value='"+ACC.profile.old_primary_contact+"']").prop('checked', true);
    	});
    	//confirm btn
    	var confirmPrimaryForm = $('#confirmPrimaryForm');
		confirmPrimaryForm.ajaxForm({
			beforeSubmit: function() {
				$("#confirmPrimaryContactModal").modal('hide');
        		$("#manageContactSpinner").removeClass("display-none");
        	},
        	success: function(){
        		ACC.profile.old_primary_contact = ACC.profile.new_primary_contact;
        		$('#manageContactSpinner').addClass("display-none");
        		$('#primaryContactSuccessModal').modal({backdrop:'static'});
        		ACC.profile.showModal($('#primaryContactSuccessModal'), "#manage-contacts");
        	}
        });
    },		
    updateCustomerContact: function(){
		var editProfileForm = $('#editProfileForm');
		ACC.validateForm.formChangeValidation(editProfileForm);
		editProfileForm.find('[type="submit"]').attr('aria-haspopup','dialog');
		editProfileForm.ajaxForm({
			beforeSubmit: function() {
        		$('#manageContactSpinner').removeClass("display-none");
        	},
        	success: function(){
        		$('#manageContactSpinner').addClass("display-none");
        		
        		$('#contactUpdateModal').modal({backdrop:'static'});
        		ACC.profile.showModal($('#contactUpdateModal'), "#manage-contacts");
        	}
        });
	},
	addNewCustomerContact: function(){
		var addNewProfileForm = $('#addNewProfileForm');
		ACC.validateForm.formChangeValidation(addNewProfileForm);
		addNewProfileForm.find('[type="submit"]').attr('aria-haspopup','dialog');
		addNewProfileForm.ajaxForm({
			beforeSubmit: function() {
        		$('#manageContactSpinner').removeClass("display-none");
        	},
        	success: function(){
        		$('#manageContactSpinner').addClass("display-none");
        		
        		$('#contactAddNewModal').modal({backdrop:'static'});
        		ACC.profile.showModal($('#contactAddNewModal'), "#manage-contacts");
        	}
        });
	},
	
	updateCustomerContactDetails : function(inputUpdate, type) {	
		var i = $("#customerPreferenceForm_contactId").val();
		var url,form;
		if(i == "" || i == null) {
			url = ACC.config.encodedContextPath + "/my-account/update-profile";
			form = $('#updateProfileForm'); 
		}
		else {
			ACC.profile.editContactFormData(i);	
			
			url = ACC.config.encodedContextPath + "/my-account/update-contact";
			form = $('#editProfileForm'); 
		}
		
		$(form).find('input[name='+type+']').val(inputUpdate);
		
		
	    $.ajax({
           url: url,
           method: "POST",
           data: $(form).serialize(), 
           success: function() {
        	   $("#missingBusinessEmailModal .js-updatePreferenceSuccessModal").removeClass("hide");
        	   ACC.profile.preferenceModalFlag = true;
        	   $("#updateProfileForm").find('input[name='+type+']').attr("value", inputUpdate);
        	   
        	   var row = $("#row-" + i).find(".saved-phone");
        	   var tdTypeElem = $("<span></span>").addClass("azureColor");
        	   switch (type) {
        	   
					case "mobileNumber":
						if(row.length > 0) {
							row.find('input#mobileNumber_'+i).attr("value", inputUpdate);
						    row.find('span#mobileNo_'+i).text(inputUpdate);
						    tdTypeElem.text("("+ ACC.accountPrefManageTabMobile +")");
						    row.find('#mobilePh_'+i).append(tdTypeElem,"<br/>");
						}
						  $(".businessInfoForm #mobileNo").attr("value", inputUpdate);
						 break;
					case "faxPhone":
						if(row.length > 0) { 
							row.find('input#faxPhone_'+i).attr("value", inputUpdate);
							 row.find('span#faxNo_'+i).text(inputUpdate);
							 tdTypeElem.text("("+ ACC.accountPrefManageTabFax +")")
							 row.find('#faxPh_'+i).append(tdTypeElem,"<br/>");
						 }
						 $(".businessInfoForm #fax").attr("value", inputUpdate);
						 break;
					default:
						break;
				}
        	   $("#updatePopupContacts").addClass("display-none");
           }
         });
	},
	
	setPrefMissingModal: function(param){
		var modal = $('#missingBusinessEmailModal');
		modal.find(".modal-title").empty();
		modal.find(".description").empty();
		modal.find("#missingBusinessEmailModalForm").empty();
		
		modal.find(".modal-title").text(param.title);
		modal.find(".description").text(param.description);
		modal.find("#missingBusinessEmailModalForm").append(param.formSpanElem, param.formTextElem);
		modal.find("#modal_business").data("type", param.dataType);
		modal.find("#modal_business").attr("name", param.name);
		modal.find("#modal_business").attr("autocomplete", "off");
		if( typeof(param.extSpan) !== "undefined" ){
			modal.find("#missingBusinessEmailModalForm").append(param.extSpan, param.extText);
		}
		modal.find(".inputLabel").text(param.id);
		modal.find(".inputLabelExt").text("Ext. (Optional)");
	},
	
	openChangePreferenceModal: function($el, checkEl, param){
		if($el.prop('checked') === true && $(checkEl).val().trim() == ""){
			ACC.profile.setPrefMissingModal(param);
			$("#missingBusinessEmailModalForm .inputLabel").each(function() {
				$el.next("input").andSelf().wrapAll("<div class='form-element-wrapper' />")
			});
			
			$("#missingBusinessEmailModal .js-updatePreferenceSuccessModal").addClass("hide");
			
			ACC.register.mobileFormatValidation($("#missingBusinessEmailModalForm input"), 10);
			ACC.profile.preferenceModalFlag = false;
			$('#missingBusinessEmailModal').modal("show");
			$("#missingBusinessEmailModal").unbind('hidden.bs.modal');
			$("#missingBusinessEmailModal").on('hidden.bs.modal', function () {
				if(!ACC.profile.preferenceModalFlag){
					$el.attr('checked',false);
				}
				if( $(".js-orderRemTime").length > 0 && $("#customerPreferenceForm").find("[id^='orderRemTime_']").length > 0 ){
					$("#customerPreferenceForm").find("[id^='orderRemTime_']").val(ACC.cutOffTime.convertUTCtoLocalTime($(".js-orderRemTime").val(), "h:mm A"));
				}
			});
		}
	},
	
	onChangePreferenceCheckbox: function($el){
		var id = $el.attr("id").split("_")[0];
		var contactId = $("#customerPreferenceForm_contactId").val();
		var validPopup = (id == "text") ? "mobileNumber_"+ contactId  :"faxPhone_" + contactId; 

		if($("#"+validPopup).length <= 0 || !($("#"+validPopup).val()) ) {
			var checkEl, title, description;
			var formSpanElem = $("<label></label>").addClass("inputLabel control-label camelCase margin-bottom-10");
			var formTextElem = $("<input/>").attr({"id":"modal_business", "type":"text", "data-type":id, "class":"form-control", "autocomplete":"off"});
			var extSpan, extText;
			var dataType;
			switch (id) {
			
				case "text":
					checkEl = "#updateProfileForm_phoneNo";
					dataType = "mobileNumber";
					title = ACC.accountPrefPopupMobileTitle;
					description = ACC.accountPrefPopupMobileMsg;
					id=ACC.accountPrefPopupMobileLabel;
					break;
				case "fax":
					checkEl = "#updateProfileForm_"+id;
					dataType = "faxPhone";	
					title = ACC.accountPrefPopupFaxTitle;
					description = ACC.accountPrefPopupFaxMsg;
					break;
				default:
					break;
			}
			var param = {"title":title, "description":description, "formSpanElem":formSpanElem, "formTextElem":formTextElem, "dataType":dataType, "extSpan":extSpan, "extText":extText, "id":id, "name": "telephone"}
			ACC.profile.openChangePreferenceModal($el, checkEl, param);
		}
	},
	
	customerPreferenceForm : function(){
		var customerPreferenceForm = $('#customerPreferenceForm');
		
		customerPreferenceForm.on("change",".update:checkbox",function(){
			ACC.profile.onChangePreferenceCheckbox($(this));
		});

		ACC.profileExtend.reminderValuesDefault();
		
		ACC.validateForm.formChangeValidation(customerPreferenceForm);
		
		customerPreferenceForm.ajaxForm({
			beforeSerialize: function() {
				$('#manageContactSpinner').removeClass("display-none");
				return ACC.profileExtend.validateUpdatePreference();
        	},
        	success: function(){
        		$('#customerPreferenceForm').find('button').addClass('disabled');
        		sessionStorage.setItem("myProfileTabRedirAttr", "#manage-preferences");
        		window.location.href = ACC.config.encodedContextPath + "/my-account/update-profile";
        	}
		});
		
		// alert user if url changes
	    $(window).on('beforeunload', function() {
	        if (!$('#customerPreferenceForm').find('button').hasClass('disabled')) {
	            return ACC.accountPrefWarning;
	        }
	    });
	},
	
	updateBusinessInfoCustomerDetails : function() {	
		var url = ACC.config.encodedContextPath + "/my-account/update-businessinfo";
	    $.ajax({
           url: url,
           method: "POST",
           data: $("#businessInfoForm").serialize(), 
           success: function()
           {
        	   ACC.profile.updateBusinessInfoHours();
           }
         });
	},
	updateBusinessInfoHours : function() {	
		var url = ACC.config.encodedContextPath + "/my-account/update-businesshours";
	    $.ajax({
           url: url,
           method: "POST",
           data: $("#businessHoursForm").serialize(), 
           success: function()
           {
        	   sessionStorage.setItem("myProfileTabRedirAttr", "#business-info");
       		   window.location.href = ACC.config.encodedContextPath + "/my-account/update-profile";
           }
         });
	},
	showModal: function(modal, pageTab){
		modal.on('shown.bs.modal', function(){
	        setTimeout(function(){
	        	modal.find(".js-first-focus").focus();
	        	sessionStorage.setItem("myProfileTabRedirAttr", pageTab);
    			window.location.href = ACC.config.encodedContextPath + "/my-account/update-profile";
	        	},5000);
	    });
	},
	datePicker: function ()	{
		var dateFormat = "mm/dd/yy";
		var from = $( "#openDate" );
		var to = $( "#closedDate" );
		var fromVal = (from.val() !== "" )?from.val(): null;
		var toVal = (to.val() !== "" )?to.val(): null;
		var option = {
		          changeMonth: true,
		          dateFormat: dateFormat,
		          showOn: "button",
		          buttonText: "",
		          defaultDate: "",
		          disabled: false
		        };
		
		if( from.hasClass("js-disabled") ){
			option.disabled = true;
		}
		
		option.defaultDate = fromVal;
		from.datepicker(option)
	        .on( "change", function() {
	          to.datepicker( "option", "minDate", getDate( this ) );
	          ACC.profileExtend.calculateDifference();
	        });
		
		option.defaultDate = toVal;
		  to.datepicker(option)
		      .on( "change", function() {
		    	  from.datepicker( "option", "maxDate", getDate( this ) );
		    	  ACC.profileExtend.calculateDifference();
		      });
	 
	    function getDate( element ) {
	      var date;
	      try {
	        date = $.datepicker.parseDate( dateFormat, element.value );
	      } catch( error ) {
	        date = null;
	      }
	 
	      return date;
	    }
		
	},
			
	initProfile: function(){
		if( $("#b2BCustomerForm").length > 0 ){
			$("#b2BCustomerForm").find(".has-error").first().find("input[type=text]").focus();
		}
	}, 
	
	ctrlDown : false,
	shift: false,
	
	copyPaste: function(){
		var ctrlKey = 17,
        	cmdKey = 91;
		
        $(document).on('keydown',function(e) {
            if (e.keyCode == ctrlKey || e.keyCode == cmdKey) {
            	ACC.profile.ctrlDown = true;
            }
            if (e.keyCode == 16 ) {
            	ACC.profile.shift = true;
            }
        });
        $("body").on('keyup', function(e) {
            if (e.keyCode == ctrlKey || e.keyCode == cmdKey) {
            	ACC.profile.ctrlDown = false;
            }
            if (e.keyCode == 16 ) {
            	ACC.profile.shift = false;
            }
        });
        
	},
	allowedAsciiCodes : [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105],
	allowedNavKeys : [8, 9, 46, 37, 39],
	preventNonNumberEntry: function(event){
	   var e = event || window.event;  
	   var key = e.keyCode || e.which;                              
	   if ((!ACC.profile.ctrlDown && $.inArray( key, ACC.profile.allowedAsciiCodes.concat(ACC.profile.allowedNavKeys) ) == -1) || (ACC.profile.shift && $.inArray( key, ACC.profile.allowedAsciiCodes ) >= 0)){
	           if (e.preventDefault) {
	        	   e.preventDefault(); 
	           }
	           e.returnValue = false; 
	           return false;
	   }
	   return true;
			
	},
	
	addPrefDropDown: function(){
		$(".js-addPref").on('click', function(){
			$(".js-prefDropdown").toggleClass('open');
			if(!$(".js-prefDropdown").hasClass('open'))
				 $('.js-prefDropdown input[type=checkbox]').attr('checked',false);
			ACC.global.footerAlignment();
		});
		$('body').click(function(event){
			  if ($(event.target).closest('.addPref-dropdown').length) {
				  return; 
			  } else {
				  $('.js-prefDropdown').removeClass('open');
				  $('.js-prefDropdown input[type=checkbox]').attr('checked',false);
			  }
		});
	}
	/*Kindly do not add any new method in this file. Beyond 1000 line it will list under sonar defect. Add code in custom.account.extend.js instead*/
};

/**
 * Created for Campaign Only
 */
ACC.campaign = {
	_autoload: [
	      ["init", $("#autoShipModal").find(".js-modal-body").length > 0],
	      ["collapseReadMore", $(".js-campaign-offer-list").length > 0],
	      ["clickPdf", $(".js-file-pdf").length > 0],
	      ["bindButton", $(".js-addToOrderButton").length > 0],
	      ["initCampaignOffer", $(".cart-campaign-offer").length > 0],
	      ["initCompliance", $(".js-compliance-list").length > 0],
	      ["campaignDetail", $(".js-campaign-detail-list").length > 0],
	],
	modalType: null,
	campaignItemsJSON: null,
	campaignDetailItemsJSON: null,
	campaignOfferItemsJSON: null,
	campaignFreeGiftItemsJSON: null,
	campaignFreeGiftQtyArr: [],
	displayAutoShipModalSuccess: true,
	totalInputQty:0,
	
	init: function(){
		$('#autoShipModal').attr("aria-labelledby", "autoShipModalLabel");
		ACC.campaign.modalType = "AUTOSHIP";
		
		$("#autoShipModal").modal("show");
		
		var gaCampName = $(".js-auto-ship-campaign-name").val();
		gaCampName = ACC.campaignExtend.escapeCampaignName(gaCampName);
		var gaCampType = $(".js-auto-ship-campaign-type").val();
		gaCampType = ACC.campaignExtend.escapeCampaignType(gaCampType);
		ACC.track.trackCampaignViews(gaCampName,"No","NA", ACC.pageName,gaCampType);
		
		$('#autoShipModal').on('shown.bs.modal', function () {
			if( $(".js-compliance-section").length > 0 ){
				var total_modal_body = $('#autoShipModal').find(".js-modal-body").length ;
				var auto_ship_modal_exist = $('#autoShipModal').find(".js-modal-body").filter(".AUTOSHIP").length;
				if( total_modal_body === 2 && auto_ship_modal_exist ){
					$("#autoShipModal").find(".js-modal-body").filter(".COMPLIANCE").remove();
				}
				var $compliance_body_section = $(".js-compliance-section").find(".compliance").clone();
				var $compliance_footer_section = $(".js-compliance-section").find(".modal-footer").clone();
				$(".js-compliance-section").remove();
				$("#autoShipModal").find(".js-modal-body").append( $compliance_body_section );
				$("#autoShipModal").find(".js-modal-body").after( $compliance_footer_section );
			}
			$('#autoShipModal').find(".js-first-focus").focus();
			ACC.global.modalAccessibility( $('#autoShipModal'), $('#autoShipModal').find(".js-first-focus-elem"),  $('#autoShipModal').find(".js-last-focus"));
		    
			if( ACC.campaign.modalType === "CDACOMPLIANCE" ){
				$(".js-compliance").removeClass("hide");
			}
			
			var bodyContent = $.trim( $("#autoShipModal").find(".js-modal-body").html() ).length;
			if( !bodyContent ){
				$("#autoShipModal").modal("hide");
			}
		});
	},
	
	collapseReadMore: function(){
		ACC.campaign.doCollapse(".js-read-more", ".js-offer-details-desktop");
		ACC.campaign.doCollapse(".js-device-header", ".js-offer-details-device");
	},
	
	doCollapse: function(clickEl, CollapseEl){
		$(".js-campaign-offer-list").on("click", clickEl, function(){
			var $this = $(this);
			var isDown = $this.find(".fa-angle-down").length;
			if( $this.closest("tr").next(CollapseEl).length ){
				if( isDown){
					$this.closest("tr").next(CollapseEl).removeClass("display-none").css({"display":"table-row"});
					$this.find(".fa").addClass("fa-angle-up").removeClass("fa-angle-down");
					var campaignName = "";
					var campaignType = "";
					if( $this.find(".js-campaign-name").length > 0 ){
						campaignName = $this.find(".js-campaign-name").text();
						campaignName = ACC.campaignExtend.escapeCampaignName(campaignName);
					}
					if( $this.find(".js-campaign-type").length > 0 ){
						campaignType = $this.find(".js-campaign-type").text();
						campaignType = ACC.campaignExtend.escapeCampaignType(campaignType);
					}
					ACC.track.trackCampaignViews(campaignName,"No","NA", ACC.pageName,campaignType);
				}else{
					$this.closest("tr").next(CollapseEl).addClass("display-none").css({"display":"none"});
					$this.find(".fa").addClass("fa-angle-down").removeClass("fa-angle-up");
				}
				ACC.campaign.updateAriaExpanded( $this.hasClass("js-device-header") ? $this.find("a") : $this );
				ACC.global.footerAlignment();
			}
		});
	},
	
	updateAriaExpanded: function( $this ){
		if ($this.attr('aria-expanded') == 'false') { // region is collapsed
			// update the aria-expanded attribute of the region
			$this.attr('aria-expanded', 'true');
			// move focus to the region
			//Removed focus as of requirement to remove blue border on panel open
			if( $this.data("ariaOpened") ){
				ACC.global.setAria("label", $this, $this.data("ariaOpened"));
			}
		}else { // region is expanded
			// update the aria-expanded attribute of the region
			$this.attr('aria-expanded', 'false');
			if( $this.data("ariaClosed") ){
				ACC.global.setAria("label", $this, $this.data("ariaClosed"));
			}
		}
	},
	
	campaignProducts: function() {
    	ACC.campaign.campaignItemsJSON={items:[]};
    	$('.campaignItems').each(function(){
    		var productCode = $(this).find(".productCode").val();
    		var qty = $(this).find(".js-qty-selector-input").val();
    		var qtyAlreadyInCart = $(this).find(".js-qty-already-in-cart").val();
    		ACC.campaign.campaignItemsJSON.items.push({
    			"productCode":productCode,
    			"qty":qty,
    			"qtyAlreadyInCart":qtyAlreadyInCart
    		});
    	});
    },
    
	campaignDetailProducts: function() {
		
		ACC.campaign.campaignDetailItemsJSON={items:[]};
    	$(".js-applicable-product-table").find('.campaignDetailItems').each(function(){
    		var productCode = $(this).find(".productCode").val();
    		var qty = $(this).find(".js-qty-selector-input").val();
    		var qtyAlreadyInCart = $(this).find(".js-qty-already-in-cart").val();
			ACC.campaign.campaignDetailItemsJSON.items.push({
    			"productCode" : productCode,
    			"qty" : qty,
    			"qtyAlreadyInCart" :qtyAlreadyInCart
    		});
    	});
    	
    	if( $(".free-case-table").length > 0 ){
	    	$(".free-case-table").find('.campaignDetailItems').each(function(){
	    		var productCode = $(this).find(".productCode").val();
	    		var qty = $(this).find(".js-qty-selector-input").val();
				ACC.campaign.campaignDetailItemsJSON.items.push({
	    			"productCode" : productCode,
	    			"qty" : qty
	    		});
	    	});
    	}
    	
    	if( $(".free-gift-block").length > 0 ){
	    	$(".free-gift-block").find("[class^='js-freeGift-']:visible").find(".productCode").each(function(){
	    		var productCode = $(this).val();
	    		ACC.campaign.campaignDetailItemsJSON.items.push({
	    			"productCode":productCode,
	    			"qty":'1'
	    		});
	    	});
    	}
    },
    
    campaignFreeGiftProducts: function(parent) {
    	ACC.campaign.campaignFreeGiftItemsJSON={items:[]};
    	parent.find(".js-qty-selector-input").each(function(){
    		var productCode = $(this).closest("form").find(".productCode").val();
    		var qty = $(this).val();
    		var qtyAlreadyInCart = $(this).closest("form").find(".js-qty-already-in-cart").val();
    		ACC.campaign.campaignFreeGiftItemsJSON.items.push({
    			"productCode":productCode,
    			"qty":qty,
    			"qtyAlreadyInCart" :qtyAlreadyInCart
    		});
    	});
    	parent.find("[class*='js-freeGift-']:visible").find(".productCode").each(function(){
    		var productCode = $(this).val();
    		ACC.campaign.campaignFreeGiftItemsJSON.items.push({
    			"productCode":productCode,
    			"qty":'1',
    			"free":'yes'
    		});
    	});
    },
    
    campaignOfferProducts: function(parent) {
    	ACC.campaign.campaignOfferItemsJSON={items:[]};
    	parent.find(".js-qty-selector-input").each(function(){
    		var productCode = $(this).closest("form").find(".productCode").val();
    		var qty = $(this).val();
    		var qtyAlreadyInCart = $(this).closest("form").find(".js-qty-already-in-cart").val();
    		ACC.campaign.campaignOfferItemsJSON.items.push({
    			"productCode":productCode,
    			"qty":qty,
    			"qtyAlreadyInCart":qtyAlreadyInCart	
    		});
    	});
    },
    
    autoShipCampaignProducts: function( $parent ) {
    	ACC.campaign.campaignItemsJSON={items:[]};
    	$parent.find('.campaignItems').each(function(){
    		var productCode = $(this).find(".productCode").val();
    		var qty = $(this).find(".js-qty-selector-input").val();
    		var qtyAlreadyInCart = $(this).find(".js-qty-already-in-cart").val();
    		ACC.campaign.campaignItemsJSON.items.push({
    			"productCode":productCode,
    			"qty":qty,
    			"qtyAlreadyInCart":qtyAlreadyInCart
    		});
    	});
    },
    
    bindButton: function(){
    	$("#autoShipModal").on("click", ".js-addToOrderButton", function(){
    		$("#autoShipModal").off("click", ".js-addToOrderButton");
    		ACC.campaign.autoShipCampaignProducts( $(this).closest(".js-modal-body") );
    		var campaign_id = $(this).closest(".js-modal-body").find(".js-auto-ship-campaign-id").val();
    		var rejectionMsg = $(this).closest("#autoShipModal").find(".js-autoship-rejection-msg").val();
    		ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignItemsJSON), campaign_id, "", rejectionMsg, true);
    	});
    	$("#autoShipModal").on("click", ".js-notNowButton", function(){
    		if( $(".js-explain-area").hasClass("display-none") ){
    			$(".js-explain-area").removeClass("display-none");
    			$(".js-explain-area #explain_textarea").focus(); 
    		}else{
    			$(".js-explain-area").addClass("display-none");
    		}
    	});
    	$("#autoShipModal").on("click", ".js-submit-explain", function(){
    		$("#autoShipModal").off("click", ".js-submit-explain");
    		ACC.campaign.autoshipRejection($(this));
    	});
    	$("#autoShipModal").on("keyup", ".js-autoship-rejection-msg", function(){
    		$("#autoShipModal").find(".js-submit-explain").addClass("disabled").attr("aria-disabled", true);
    		if( $.trim( $(".js-autoship-rejection-msg").val() ).length > 0 ){
    			$("#autoShipModal").find(".js-submit-explain").removeClass("disabled").attr("aria-disabled", false);
    		}
    	})
    },
    
    openFreeSkuCampaignPanel: function(){
    	if( $(".cart-campaign-offer").find(".js-free-sku-modified").length > 0 ){
    		var firstFreeSku;
    		$(".cart-campaign-offer").find(".js-free-sku-modified").each(function( index ){
	    		if( index === 0 ){
	    			firstFreeSku = $(".cart-campaign-offer").find("[id^=collapse_freesku_]").eq(0);
	    		}
	    		var freeSkuArrow = $(this).closest(".js-panel-block").find(".js-arrow");
	    		freeSkuArrow.click();
    		});
    		$(window).on("load", function(){
    			ACC.cartitem.scrollTo( firstFreeSku );
    		});
    	}
    },
    
    openFreeGiftCampaignPanel: function(){
    	if( $(".cart-campaign-offer").find(".js-free-gift-modified").length > 0 ){
    		var firstFreeGift;
    		$(".cart-campaign-offer").find(".js-free-gift-modified").each(function( index ){
    			if( index === 0 ){
    				firstFreeGift = $(".cart-campaign-offer").find("[id^=collapse_freesku_]").eq(0);
    			}
    			var freeGiftArrow = $(this).closest(".js-panel-block").find(".js-arrow");
    			freeGiftArrow.click();
    		});
    		
    		$(window).on("load", function(){
    			ACC.cartitem.scrollTo( firstFreeGift );
    		});
    	}
    },
    
    bindCampaign: function(){
    	ACC.campaign.openFreeSkuCampaignPanel();
    	ACC.campaign.openFreeGiftCampaignPanel();
    	
    	$(".cart-campaign-offer").on("click", ".js-freeSkuAcceptBtn", function(){
    		$(".cart-campaign-offer").off("click", ".js-freeSkuAcceptBtn");
    		var parent = $(this).closest(".panel-body");
    		ACC.campaign.campaignOfferProducts(parent);
    		var campaign_id = parent.find(".js-campaignid").val();
    		var promo_code = parent.find(".js-valid-promo").val();
    		ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignOfferItemsJSON), campaign_id, promo_code, "", true);
    	});
    	
    	if( $(".cart-campaign-offer").find(".js-offer-product-list").length > 0 ){
    		$(".cart-campaign-offer").find(".js-offer-product-list").each(function(){
    			var firstInput = $(this).find(".js-cart-campaign-offer:eq(0)");
    			ACC.campaign.checkMinimum( firstInput );
    		});
    	}
    },
    
    getCampaignFreeGiftQtyArr : function($el){
    	ACC.campaign.campaignFreeGiftQtyArr = [];
    	$el.parent().find(".js-freeGift-tier").each(function(){
    		var qty = $(this).val();
    		ACC.campaign.campaignFreeGiftQtyArr.push( qty );
    	});
    },
    
    bindFreeGift: function(){
    	
    	$(".cart-campaign-offer").find(".js-free-gift-product-list").each(function(){
    		var $freeGiftBlock = $(this);
    		
    		ACC.campaign.checkFreeGift( $freeGiftBlock.find(".js-cart-campaign-free-gift:eq(0)") );
    	});
    	
    	$(".cart-campaign-offer").on("click", ".js-free-gift-accept-btn", function(){
    		$(".cart-campaign-offer").off("click", ".js-free-gift-accept-btn");
    		var parent = $(this).closest(".panel-body");
    		ACC.campaign.campaignFreeGiftProducts(parent);
    		var campaign_id = parent.find(".js-campaignid").val();
    		var promo_code = parent.find(".js-valid-promo").val();
    		ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignFreeGiftItemsJSON), campaign_id, promo_code, "", true);
    	});
    	ACC.campaign.onPanelDisplay();
    },
    
    onPanelDisplay: function(){
    	if( $('.cart-campaign-offer').find(".panel-collapse").length === 0 ){
    		$('.cart-campaign-offer').find("#accordion").removeAttr("role");
    	}
    	$('.cart-campaign-offer').find(".panel-collapse").on('hidden.bs.collapse', function () {
    		ACC.campaign.setAria( $(this) );
    		ACC.global.footerAlignment();
      	});
    	$('.cart-campaign-offer').find(".panel-collapse").on('shown.bs.collapse', function () {
    		ACC.campaign.setAria( $(this) );
    		if( $(this).closest('.cart-campaign-offer').hasClass("js-deal-section") ){
    			return false;
    		}
    		var campaignName = "";
    		if( $(this).find(".js-campaign-name").length > 0 ){
    			campaignName = $(this).find(".js-campaign-name").text();
    		}
    		campaignName = ACC.campaignExtend.escapeCampaignName(campaignName);
    		var campaignType = "";
    		if( $(this).find(".js-campaign-type").length > 0 ){
    			campaignType = $(this).find(".js-campaign-type").text();
    		}
    		campaignType = ACC.campaignExtend.escapeCampaignType(campaignType);
    		ACC.track.trackCampaignViews(campaignName,"No","NA", ACC.pageName,campaignType);
    		ACC.global.footerAlignment();
        });
    },
    
    setAria: function($this){
		var $triggeredEl = $this.closest(".panel-default").find("[aria-controls="+ $this.attr("id") +"]");
		ACC.campaign.updateAriaExpanded($triggeredEl);
    },
    
    initCampaignOffer: function(){
    	/*Offer*/
    	ACC.campaign.bindCampaign();
    	/*Free Gift*/
    	ACC.campaign.bindFreeGift();
    },
    
    addToCartMultipleItems:function(jsonString,campaignId,promoCode, rejectReason, acceptedFlag){
    	$.ajax({
            url: ACC.config.encodedContextPath + '/cart/add/mautipleProducts',
            method: "POST",
            data: {itemList:jsonString, campaignId:campaignId, promoCode:promoCode, rejectReason:rejectReason, acceptedFlag:acceptedFlag},
            success: function (data) {
            	var obj=JSON.parse(data);
            	var response = JSON.parse(obj.response);
            	$.each(response, function (key, value) {
        	        if(value.status === "success"){
        	        	if( ACC.campaign.displayAutoShipModalSuccess ){
        	        		$(".js-success-block").removeClass("display-none");
        	        		$(".js-error-block").addClass("display-none");
        	        	}
        	        	setTimeout(function () {
        	        		window.location = ACC.config.encodedContextPath + '/cart'; 
        	        	}, 1000);
        	        	
        	        }else{
        	        	$(".js-success-block").addClass("display-none");
        	        	$(".js-error-block").removeClass("display-none");
        	        }
        	    });
            	
            }
        });
    },
    
    enableAddToCart: function(){
    	var required = +$("#autoShipModal").find(".js-requiredQuantity").val();
    	var minSku = +$("#autoShipModal").find(".js_autoship_minSku").val();
    	var productSelected = 0;
    	var total = 0;
    	$(".js-minimum-sku-error, .js-req-qty-display-message").text("");
    	$("#autoShipModal").find(".js-qty-selector-input").each(function(){
    		var qty = +$(this).val();
    		var inCart = +$(this).siblings(".js-qty-already-in-cart").val();
    		total += parseInt( qty );
    		if( qty > 0 || inCart > 0 ){
    			productSelected++;
    		}
    	});
    	if( total >= required && productSelected >= minSku ){
    		$("#autoShipModal").find(".js-addToOrderButton").removeClass("disabled").attr("aria-disabled", false);
    		$("#autoShipModal").find(".js-req-qty-display-message").addClass("text-success").text(ACC.autoshipOrderBtnSuccess);
    	}else{
    		$(".js-minimum-sku-error").removeClass("display-none").html(ACC.autoshipMinskuError).find(".minSku").text(minSku);
    		$("#autoShipModal").find(".js-addToOrderButton").addClass("disabled").attr("aria-disabled", true);
    	}
    },
    
    existInCart: function($el){
    	var inCart = 0;
    	if( $el.closest(".js-offer-product-list").length > 0 || $el.closest(".js-free-gift-product-list").length > 0 ){
    		var cartQty = parseInt($el.closest(".js-qty-form").find(".js-qty-already-in-cart").val());
    		if( cartQty > 0 ){
    			inCart = cartQty;
    		}
    	}
    	return inCart;
    },
    
    getTotalCampaignProduct: function($el){
    	var totalProduct = 0;
    	var minSku = 0;
    	$el.each(function(){
    		var existInCart = ACC.campaign.existInCart($(this));
    		var qty = +$(this).val();
    		totalProduct += qty;
    		if( $(this).closest(".js-compliance-list").length > 0 ){
    			totalProduct += existInCart;
    		}
    		if( qty > 0 || existInCart > 0 ){
    			minSku++;
    		}
    	});
    	return {"total":totalProduct, "minsku":minSku};
    },
    getTotalCampaignOfferProducts: function($el){
    	return ACC.campaign.getTotalCampaignProduct( $el.closest(".panel-body").find(".js-offer-product-list").find(".js-qty-selector-input") );
    },
    getTotalCampaignFreeProducts: function($el){
    	return ACC.campaign.getTotalCampaignProduct( $el.closest(".panel-body").find(".js-offer-free-product-list").find(".js-qty-selector-input") );
    },
    hideCampaignOfferErrors: function($el){
    	$el.closest(".panel-body").find(".js-offer-min-sku-error-msg").addClass("display-none");
    	$el.closest(".panel-body").find(".js-display-min-offer-msg").addClass("display-none");
    	$el.closest(".panel-body").find(".js-display-min-offer-msg").addClass("display-none");
    	$el.closest(".panel-body").find(".js-promo-error-msg").addClass("display-none");
    },
    checkCampaignOfferValidity: function(params){
    	var hasError = false;
    	ACC.campaign.hideCampaignOfferErrors(params.el);
    	//Checking minimum sku[no. of product item]
    	if( params.totalProduct < params.minimumTotalProduct ){
    		params.el.closest(".panel-body").find(".js-offer-min-sku-error-msg").removeClass("display-none").
    		html(ACC.CampaignOfferTotalProdErr).find(".minimumTotalProduct").text(params.minimumTotalProduct);
    		hasError = true;
    		params.el.attr("aria-describedby", "js-offer-min-sku-error-msg");
    	}
    	else if( params.hasQuantity < params.minimumSku ){
    		params.el.closest(".panel-body").find(".js-offer-min-sku-error-msg").removeClass("display-none").
    		html(ACC.CampaignOfferMinProdErr).find(".minimumSku").text(params.minimumSku);
    		hasError = true;
    		params.el.attr("aria-describedby", "js-offer-min-sku-error-msg");
    	}else if( params.totalFree !== params.minimumFree ){
    		params.el.closest(".panel-body").find(".js-display-min-offer-msg").removeClass("display-none").text(ACC.CampaignOfferFreeProdErr);
    		hasError = true;
    		params.el.attr("aria-describedby", "js-display-min-offer-msg");
    	}
    	return hasError;
    },
    getSkuTierArr: function($parent){
    	var returnVal = [];
    	if( $parent.find(".js-campaign-freeSkuTiers").length > 0 ){
	    	var skuTierText = $parent.find(".js-campaign-freeSkuTiers").val();
	    	skuTierText = skuTierText.replace("{", "").replace("}", "");
	    	if( skuTierText.length > 0 ){
	    		var tiers = skuTierText.split(",");
	    		var arr = [];
	    		for( var i=0; i<tiers.length; i++ ){
	    			var itemArr = tiers[i].split("=");
	    			arr[i] = {"buy":parseInt(itemArr[0]), "get":itemArr[1]};
	    		}
	    		arr.sort(function(x,y) {
	    		    return x.buy - y.buy;
	    		});
	    		for( var j=0; j<arr.length; j++ ){
	    			returnVal[j] = arr[j].buy+"="+arr[j].get;
	    		}
	    	}
    	}
    	return returnVal;
    },
    getFirstSkuTier: function($parent){
    	var returnSku = [0, 0];
    	var skuTierArr = ACC.campaign.getSkuTierArr($parent);
    	if( skuTierArr.length > 0 ){
    		returnSku = skuTierArr[0].split("=");
    	}
    	return returnSku;
    },
    
    setOfferFreeCase: function($parent, freeQty){
    	$parent.find(".js-offer-free-product-list").find(".js-free-case-qty").text( freeQty );
    },
    
    setBuyProduct: function($parent, productQty){
    	$parent.find(".js-buy-product-qty").text( productQty );
    },
    
    getTotalCampaignAddToCartProducts: function( $parent ){
    	var totalAddToCart = 0;
    	$parent.find(".js-qty-already-in-cart").each(function(){
    		totalAddToCart += +$(this).val();
    	});
    	return totalAddToCart;
    },
    
    checkMinimum: function($el){
    	ACC.cartitem.showPriceOrder();
    	var skuTierArr = ACC.campaign.getSkuTierArr($el.closest(".js-panel-body"));
    	var totalObj = ACC.campaign.getTotalCampaignOfferProducts($el);
    	var totalProduct =  totalObj.total;
    	var hasQuantity = totalObj.minsku;
    	
    	var minimumSku = $el.closest(".panel-body").find(".js-offer-product-list").find(".js-campaign-freeSku-minsku").val();
    	
    	var alreadyInCart = ACC.campaign.getTotalCampaignAddToCartProducts( $el.closest(".js-panel-body").find(".js-offer-product-list") );
    	
    	var minimumFree = 0;
    	var minimumTotalProduct = 0;
    	var firstFreeQty = 0;
    	
    	for (var int = 0; int < skuTierArr.length; int++) {
			var item = skuTierArr[int].split("=");
			var buyQty = parseInt(item[0]);
			var getQty = parseInt(item[1]);
			if( totalProduct >= (buyQty - alreadyInCart) ){
    			minimumFree = getQty;
    			minimumTotalProduct = buyQty;
    		}
			if( !int ){
				firstFreeQty = getQty;
				minimumTotalProduct = buyQty;
			}
		}
    	ACC.campaign.setBuyProduct($el.closest(".js-panel-body").find(".js-offer-product-list"), minimumTotalProduct );
    	minimumTotalProduct -= alreadyInCart;
    	
    	var freeCaseQty = !minimumFree ? firstFreeQty : minimumFree;
    	ACC.campaign.setOfferFreeCase($el.closest(".js-panel-body"), freeCaseQty );
    	ACC.campaignExtend.setFreeSkuProduct($el, freeCaseQty );
    	var freeSkuForAllowMultiple = ACC.campaignExtend.allowMultipleFreeSku($el, skuTierArr, (totalProduct+alreadyInCart));
    	if( freeSkuForAllowMultiple > 0 ){
    		minimumFree = freeSkuForAllowMultiple;
    		ACC.campaign.setOfferFreeCase($el.closest(".js-panel-body"), freeSkuForAllowMultiple );
    	}
    	
    	if( !skuTierArr.length ){
			$el.closest(".js-panel-body").find(".js-offer-min-sku-error-msg").removeClass("display-none").html(ACC.DetailNoSKU);
			$el.attr("aria-describedby", "js-offer-min-sku-error-msg");
			return true;
		}
    	
    	var totalFree = ACC.campaign.getTotalCampaignFreeProducts($el).total;
    	var promo = $el.closest(".panel-body").find(".js-valid-promo").val();
    	var params = {"el":$el, "minimumFree": +minimumFree, "totalFree":totalFree, "promo":promo, "hasQuantity":hasQuantity, "minimumSku":+minimumSku, "totalProduct":totalProduct, "minimumTotalProduct":minimumTotalProduct};
    	var hasError = ACC.campaign.checkCampaignOfferValidity(params);
    	
    	if( hasError ){
    		$el.closest(".panel-body").find(".js-freeSkuAcceptBtn").addClass("disabled").attr("aria-disabled", true);
    	}else{
    		ACC.campaign.hideCampaignOfferErrors($el);
    		$el.closest(".panel-body").find(".js-freeSkuAcceptBtn").removeClass("disabled").attr("aria-disabled", false);
    		$el.removeAttr("aria-describedby");
    	}
    },
    
    getTotalCampaignFreeGiftProducts: function($el){
    	return ACC.campaign.getTotalCampaignProduct( $el.closest(".panel-body").find(".js-free-gift-product-list").find(".js-qty-selector-input") );
    },
    
    displayFreeGiftBlock: function($el, qty){
    	$el.closest(".panel-body").find(".js-free-gift-block").find("[class^='js-freeGift-']").addClass("display-none");
    	$el.closest(".panel-body").find(".js-free-gift-block").find(".js-freeGift-"+qty).removeClass("display-none");
    },
    
    checkFreeGift: function($el){
    	ACC.cartitem.showPriceOrder();
    	var totalObj = ACC.campaign.getTotalCampaignFreeGiftProducts($el);
    	var totalProduct =  totalObj.total;
    	var hasQuantity = totalObj.minsku;
    	var baseQuantity = 0;
    	ACC.campaign.getCampaignFreeGiftQtyArr( $el.closest(".js-free-gift-product-list") );
    	var alreadyInCart = ACC.campaign.getTotalCampaignAddToCartProducts( $el.closest(".js-free-gift-product-list") );
    	
    	for (var int = 0; int < ACC.campaign.campaignFreeGiftQtyArr.length; int++) {
			var item = parseInt(ACC.campaign.campaignFreeGiftQtyArr[int]);
			if( totalProduct >= (item - alreadyInCart) ){
				baseQuantity = item;
    		}
		}
    	if( !baseQuantity && ACC.campaign.campaignFreeGiftQtyArr.length > 0 ){
    		baseQuantity = parseInt(ACC.campaign.campaignFreeGiftQtyArr[0]);
    	}
    	
    	ACC.campaign.setBuyProduct($el.closest(".js-free-gift-product-list"), baseQuantity);
    	var minimumSku = +$el.closest(".panel-body").find(".js-free-gift-product-list").find(".js-campaign-freegift-minsku").val();
    	
    	$el.closest(".panel-body").find(".js-free-gift-accept-btn").addClass("disabled").attr("aria-disabled", true);
    	$el.closest(".panel-body").find(".js-free-gift-promo-error-msg, .js-free-gift-min-sku-error-msg").addClass("display-none");
    	
    	if( !ACC.campaign.campaignFreeGiftQtyArr.length ){
    		$el.closest(".panel-body").find(".js-free-gift-min-sku-error-msg").
    		removeClass("display-none").text(ACC.DetailNoGift);
    		$el.attr("aria-describedby", "js-free-gift-min-sku-error-msg");
			return true;
		}
    	
    	if( (totalProduct + alreadyInCart) >= baseQuantity && hasQuantity >= minimumSku ){
    		ACC.campaign.displayFreeGiftBlock($el, baseQuantity);
    		$el.closest(".panel-body").find(".js-free-gift-accept-btn").removeClass("disabled").attr("aria-disabled", false);
    		$el.removeAttr("aria-describedby");
    	}else{
    		$el.closest(".panel-body").find(".js-free-gift-min-sku-error-msg").
    		removeClass("display-none").html(ACC.freeGiftMinskuError).find(".baseQuantity").text(baseQuantity);
    		$el.attr("aria-describedby", "js-free-gift-min-sku-error-msg");
    	}
    },
    
    autoshipRejection:function($this){
    	var campaign_id = $this.closest(".js-modal-body").find(".js-auto-ship-campaign-id").val();
    	var rejectionMsg = $this.closest("#autoShipModal").find(".js-autoship-rejection-msg").val();
    	rejectionMsg = rejectionMsg.replace(/[]/g, "'").replace(/[]/g, '"');
    	ACC.campaign.autoShipCampaignProducts( $this.closest(".js-modal-body") );
    	ACC.campaignExtend.quantityExistInAutoShipModal();
    	var accepted = $this.closest("#autoShipModal").find(".js-addToOrderButton").hasClass("disabled");
    	ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignItemsJSON), campaign_id, "", rejectionMsg, !accepted);
    },
    
    cdaRejection:function(){
    	var campaign_id = $(".js-compliance-list").find(".js-campaign-id").val();
    	$.ajax({
            url: ACC.config.encodedContextPath + '/campaigns/cdaReject',
            method: "GET",
            data: {"campaignId":campaign_id },
            success: function () {
            	window.location = ACC.config.encodedContextPath + '/cart';
            }
        });
    },
    
	clickPdf: function(){
		$(document).on("click", ".js-file-pdf", function(){
			ACC.campaign.callAjax();
		});
	},
	
	callAjax: function(){
		$.ajax({
    		url: ACC.config.encodedContextPath + "",
    		method: "POST",
    		data: {},
    		dataType: "json",
    		success: function(){
    			//Do Coding
    		},
    		error: function(){
    			//Do Coding
    		},
    		complete: function(){
    			//Do Coding
    		}
		});
	},
	
	getTotalInputQty: function(){
		var total = 0;
		$(".js-compliance-list").find(".js-compliance-list-product").each(function(){
			total += +$(this).val();
		})
		return total;
	},
		
	initCompliance: function(){
		//js-qty-selector-input
		$(".js-compliance-list").on("click", ".js-addtocart", function(){
			$(this).off("click");
			ACC.campaign.campaignProducts();
    		var campaign_id = $(".js-compliance-list").find(".js-campaign-id").val();
    		ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignItemsJSON), campaign_id, "", "", true);
		});
		ACC.campaign.totalInputQty = ACC.campaign.getTotalInputQty();
		$(".js-compliance-list").on("click", ".js-back-tocart", function(){
			if( ACC.campaign.getTotalInputQty() !== ACC.campaign.totalInputQty ){
				ACC.campaign.campaignProducts();
	    		var campaign_id = $(".js-compliance-list").find(".js-campaign-id").val();
	    		ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignItemsJSON), campaign_id, "", "below minimum", true);
			}else{
				ACC.campaign.cdaRejection();
			}
		});
	},
	
	campaignDetail: function(){
		//js-qty-selector-input
		$(".js-campaign-detail-list").on("click", ".js-addtocart", function(){
			$(".js-campaign-detail-list").off("click", ".js-addtocart");
			ACC.campaign.campaignDetailProducts();
    		var campaign_id = $(".js-campaign-detail-list").find(".js-campaign-id").val();
    		var promo_code = $(".js-campaign-detail-list").find(".js-valid-promo").val();
    		ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignDetailItemsJSON), campaign_id, promo_code, "", true);
		});
		ACC.campaignExtend.bindGACampaignDetail();
		ACC.campaignExtend.checkCampaignDetail();
	},
	
	getTotalApplicableProduct: function(){
		var totalQty = 0;
		var hasQtyGtZero = 0;
		var allowMultiple = $(".js-AllowMultiple").val();
		var campaignApplied = $(".js-CampaignApplied").val();
		var inCart = 0;
		var qty = 0;
		var discardCartQty = false;
		if( ACC.pageName === "campaignDetailPage" && allowMultiple === "true" && campaignApplied === "true" ){
			discardCartQty = true;
		}
		$(".js-applicable-product-table").find(".campaignDetailItems").each(function(){
			if( !discardCartQty ){
				inCart = +$(this).find(".js-qty-already-in-cart").val();
			}
			qty = +$(this).find(".js-campaign-detail").val();
			if( qty > 0 || inCart > 0 ){
				hasQtyGtZero ++;
			}
			totalQty += inCart + qty;
		});
		return {"totalQty": totalQty, "hasQtyGtZero": hasQtyGtZero};
	},
	
	getTotalFreeSku: function(){
		var total = 0;
		$(".free-case-table").find(".campaignDetailItems").each(function(){
			var qty = +$(this).find(".js-campaign-detail").val();
			
			total += qty;
		});
		return total;
	},
	
	displayFreeSKUCampaignDetErr: function(totalApplicableProd, firstMinBuyQty, minUniqueProdReq, totalFreeSku, maxFreeSku){
		var hasError = false;
		if(totalApplicableProd.totalQty < firstMinBuyQty){
			hasError = true;
			$(".js-error-msg").html(ACC.DetailfreeSkuMinQtyError).find(".firstMinBuyQty").text(firstMinBuyQty);
		}
		else if( totalApplicableProd.hasQtyGtZero < minUniqueProdReq ){
			//show error
			hasError = true;
			$(".js-error-msg").html(ACC.DetailfreeSkuMinProdError).find(".minUniqueProdReq").text(minUniqueProdReq);
		}else if( totalFreeSku !== maxFreeSku ){
			//show error
			hasError = true;
			$(".js-error-msg").html(ACC.DetailfreeSkuMaxError).find(".maxFreeSku").text(maxFreeSku);
		}
		return hasError;
	},
	
	freeSKUCampaignDetail: function(){
		$(".js-error-msg").text("");
		
		var minUniqueProdReq = +$(".js-campaign-minsku").val();
		var totalApplicableProd = ACC.campaign.getTotalApplicableProduct();
		var minBuyQty = 0;
		var maxFreeSku = 0;
		var firstMinBuyQty = 0;
		
		var skuTierArr = ACC.campaign.getSkuTierArr($(".js-campaign-detail-list"));
		if( !skuTierArr.length ){
			$(".js-error-msg").html(ACC.DetailNoSKU);
			return true;
		}
		
		for (var int = 0; int < skuTierArr.length; int++) {
			var item = skuTierArr[int].split("=");
			var buyQty = parseInt(item[0]);
			var getQty = parseInt(item[1]);
			if( int === 0 ){
				firstMinBuyQty = buyQty;
				maxFreeSku = getQty;
    			minBuyQty = buyQty;
			}
			if( totalApplicableProd.totalQty >= buyQty ){
				maxFreeSku = getQty;
    			minBuyQty = buyQty;
    		}
		}
		
		var freeSkuProductCount = $(".js-freeSkuProductCount").length > 0 ? +$(".js-freeSkuProductCount").val() : 0;
		if( freeSkuProductCount === 1 ){
    		$(".free-case-table").find(".js-campaign-detail").val( maxFreeSku );
    	}
		
		$(".js-buy-product-qty").text(minBuyQty);
		$(".js-free-case-qty").text(maxFreeSku);
		
		var freeSkuForAllowMultiple = ACC.campaignExtend.allowMultipleFreeSku(null, skuTierArr, totalApplicableProd.totalQty);
    	if( freeSkuForAllowMultiple > 0 ){
    		maxFreeSku = freeSkuForAllowMultiple;
    		$(".js-free-case-qty").text(maxFreeSku);
    	}
    	var totalFreeSku = ACC.campaign.getTotalFreeSku();
		return ACC.campaign.displayFreeSKUCampaignDetErr(totalApplicableProd, firstMinBuyQty, minUniqueProdReq, totalFreeSku, maxFreeSku);
	},
	displayFreeGiftCampaignDetErr: function(totalApplicableProd, firstMinBuyQty, minUniqueProdReq, maxFreeSku){
		var hasError = false;
		if(totalApplicableProd.totalQty < firstMinBuyQty){
			hasError = true;
			$(".js-error-msg").html(ACC.DetailfreeGiftMinQtyError).find(".firstMinBuyQty").text(firstMinBuyQty);
		}
		else if( totalApplicableProd.hasQtyGtZero < minUniqueProdReq ){
			//show error
			hasError = true;
			$(".js-error-msg").html(ACC.DetailfreeGiftMinProdError).find(".minUniqueProdReq").text(minUniqueProdReq);
		}
    	$(".free-gift-block").find("[class^='js-freeGift-']").addClass("display-none");
    	if( $(".js-freeGift-"+maxFreeSku).length > 0 ){
    		$(".js-freeGift-"+maxFreeSku).removeClass("display-none");
    	}
    	return hasError;
	},
	freeGiftCampaignDetail: function(){
		$(".js-error-msg").text("");
		
		var minUniqueProdReq = +$(".js-campaign-minsku").val();
		var totalApplicableProd = ACC.campaign.getTotalApplicableProduct();
		var maxFreeSku = 0;
		var firstMinBuyQty = 0;
		
		if( !$(".free-gift").find(".js-freeGift-tier").length ){
			$(".js-error-msg").html(ACC.DetailNoGift);
			return true;
		}
		
		$(".free-gift").find(".js-freeGift-tier").each(function(){
    		var qty = +$(this).val();
    		ACC.campaign.campaignFreeGiftQtyArr.push( qty );
    	});
		
    	if( ACC.campaign.campaignFreeGiftQtyArr.length > 0 ){
    		$(".js-buy-product-qty").text(ACC.campaign.campaignFreeGiftQtyArr[0]);
    	}
    	
    	for (var i = 0; i < ACC.campaign.campaignFreeGiftQtyArr.length; i++) {
			var j = parseInt(ACC.campaign.campaignFreeGiftQtyArr[i]);
			if( i === 0 ){
				firstMinBuyQty = j;
				maxFreeSku = j;
			}
			if( totalApplicableProd.totalQty >= j ){
				maxFreeSku = j;
    		}
		}
    	
    	$(".js-buy-product-qty").text(maxFreeSku);
	    	
    	return ACC.campaign.displayFreeGiftCampaignDetErr(totalApplicableProd, firstMinBuyQty, minUniqueProdReq, maxFreeSku);
	},
		
	getTotalComplianceProducts: function($el){
    	return ACC.campaign.getTotalCampaignProduct( $el.closest(".js-subgroup").find(".js-qty-selector-input") );
    },
    checkEachCompliance: function( $group ){
    	var hasError = false;
    	var groupName = $.trim($group.data("groupName"));
		var firstElement = $group.find(".js-qty-selector-input:eq(0)");
		var totalObj = ACC.campaign.getTotalComplianceProducts( firstElement );
		var totalProduct =  totalObj.total;
		var hasQuantity = totalObj.minsku;
		var minimumSku = +$group.find(".js-minsku").val();
    	var requiredQty = +$group.find(".js-req-qty").val();
    	
    	if( totalProduct >= requiredQty ){
    		if( hasQuantity < minimumSku ){
    			// display error
    			$(".js-compliance-list").find(".js-error-msg").removeClass("display-none").
    			html(ACC.ComplianceMinSkuError).find(".minimumSku").text(minimumSku);
    			$(".js-compliance-list").find(".js-error-msg").find(".groupIndex").text('"'+groupName+'"');
    			hasError = true;
    		}
    	}else{
    		// display error
    		$(".js-compliance-list").find(".js-error-msg").removeClass("display-none").
    		html(ACC.ComplianceTotalProdError).find(".requiredQty").text(requiredQty);
    		$(".js-compliance-list").find(".js-error-msg").find(".groupIndex").text('"'+groupName+'"');
    		hasError = true;
    	}
    	
    	return hasError;
    },
    checkAllComplianceGroup: function(){
    	var hasError = false;
    	$(".js-compliance-list").find(".js-subgroup[data-compliant != true]").each(function(){
    		hasError = ACC.campaign.checkEachCompliance( $(this) );
    		$(this).attr("data-compliant", !hasError);
    	});
    	return hasError;
    },
    checkParentCompliance: function( $parent ){
    	var isCompliant = ACC.campaign.checkEachCompliance( $parent );
		$parent.attr("data-compliant", !isCompliant);
    	return isCompliant;
    },
    hasQuantityInNonCompliantGr: function(){
    	var hasQty = false;
    	$(".js-compliance-list").find(".js-subgroup[data-compliant != true]").each(function(){
    		var $el = $(this).find(".js-qty-selector-input:eq(0)");
    		var totalObj = ACC.campaign.getTotalComplianceProducts( $el );
    		hasQty = totalObj.total;
    		if( hasQty > 0 ){
    			ACC.campaign.checkEachCompliance( $(this) ); //Only to display error message which is not captured in enableComplianceAddToCart fn.
    			return false;
    		}
    	})
    	return hasQty;
    },
    hasQuantityInParentGroup: function($el){
    	var totalObj = ACC.campaign.getTotalComplianceProducts( $el );
		return totalObj.total;
    },
	enableComplianceAddToCart: function($el){
		$(".js-compliance-list").find(".js-addtocart").addClass("disabled").attr("aria-disabled", true);
    	$(".js-compliance-list").find(".js-error-msg").addClass("display-none");
    	$el.closest(".js-subgroup").removeAttr("data-compliant");
    	
    	var parentError = ACC.campaign.checkParentCompliance( $el.closest(".js-subgroup") );
    	var minGroupRequired = +$(".js-compliance-list").find(".js-min-group").val();
    	var visibleGroup = $(".js-compliance-list").find(".js-subgroup:visible").length;
		var groupCompliant = $(".js-compliance-list").find(".js-subgroup[data-compliant = true]").length;
    	if( !parentError ){
	    	if( groupCompliant >= minGroupRequired ){
    			//Check if "not required group" has quantity or not.
	    		if( !ACC.campaign.hasQuantityInNonCompliantGr() ){
    				$(".js-compliance-list").find(".js-addtocart").removeClass("disabled").attr("aria-disabled", false);
    			}
	    	}else{
	    		$(".js-compliance-list").find(".js-error-msg").removeClass("display-none").
	    		html(ACC.ComplianceMinGrError).find(".minGroupRequired").text(visibleGroup);
	    	}
    	}else{
    		//Execute If there is no qty in "already in cart" for any item in a group and user are trying to edit qty field in that group
    		if( !ACC.campaign.hasQuantityInParentGroup($el) && groupCompliant >= minGroupRequired  ){
    			$(".js-compliance-list").find(".js-addtocart").removeClass("disabled").attr("aria-disabled", false);
    			$(".js-compliance-list").find(".js-error-msg").addClass("display-none").text("");
    		}
    	}
	},
	
	displayCampaignOfferError: function($el, status){
		if( status ){
			$el.closest("form").addClass("has-error has-feedback");
			var msg = $('<div class="cartPageCampaigOfferPopover popover fade bottom in" role="tooltip"><div class="arrow"></div><div class="popover-content">'+ACC.cartQuantityCampaignError+'</div></div>');		
			if( $el.siblings(".popover").filter(".cartPageCampaigOfferPopover").length == 0 ){		
				$el.after(msg);		
			}
		}else{
			//ACC.cartitem.isDealProductRow( $el )
			if( $el.val().length > 0 ){
				$el.closest("form").removeClass("has-error has-feedback");
			}
			if( $el.siblings(".popover").filter(".cartPageCampaigOfferPopover").length > 0 ){		
				$el.siblings(".popover").filter(".cartPageCampaigOfferPopover").remove();		
			} 
			if( $el.val().length > 0 && $el.siblings(".popover").filter(".cartPageQuantityPopover").length > 0 ){		
				$el.siblings(".popover").filter(".cartPageQuantityPopover").remove();		
			}
		}
	},
	checkEligibility: function($el){
		$el.removeClass("js-not-eligible");
		ACC.campaign.displayCampaignOfferError($el, false);
		var newCartQuantity = $el.val();
		var initialCampQty = $el.closest("form").find("[name=initialCampQty]").val();
		var returnValue;
		var campaignData = $el.closest("form").find('.campaignproduct').val();
		var result = campaignData.split(',');
		var initQty = parseInt(initialCampQty);
		var newQty = parseInt(newCartQuantity);
		var boolean_flag = result[2] == "true" ? true : false;
		if( ((result[0].length != 0 || result[1].length != 0 || result[3] === "true") && boolean_flag) ){
			if(newQty >= initQty){
					returnValue = true; 
			}else{
			  $el.closest('form').find('input[name=initialQuantity]').val(initQty);
			  returnValue = false;
			}
		}else{
				returnValue = true;
			}
		if( !returnValue ){
			$el.addClass("js-not-eligible");
			ACC.campaign.displayCampaignOfferError($el, true);
		}
		return returnValue;
	},
	displaySafetyNet: function($el){
		var totalOrderObj = {"total":+$el.closest("form").find(".js-past-order-total").val(), "item":+$el.closest("form").find(".js-past-order-item").val()};
		var itemQty = +$el.val();
		var is_empty = $el.hasClass("js-empty-return");
		var showModal = ACC.cartitem.showSafetyModal(totalOrderObj, itemQty, is_empty);
		if( showModal ){
			$("#safetyNetModal").modal();
			var tabIndex = $el.data("tabindex");
			var parentRow = $el.closest(".js-relatedProducts");
			var nextTabIndex = +tabIndex + 1;
			var nextInput = parentRow.closest(".js-deal-product-block").find("input[data-tabindex="+nextTabIndex+"]");
			ACC.cartitem.safetyNetModalTabKey($el);
			ACC.cartitem.confirmSafetyNet(nextInput, "CART");
			ACC.cartitem.updateSafetyNet($el);
		}
	}
	/*Kindly do not add any new method in this file. Beyond 1000 line it will list under sonar defect. Add code in custom.campaign.extend.js instead*/
}
/**
 * Created for Campaign/Deal extension as original file is detected in Sonar
 */
ACC.campaignExtend = {
	_autoload: [
        "getDeal",
        "showDealsList",
        "bindCampaignGA",
        "bindDeal",
        ["outerCdaModal", $("#jsOuterCdaCompliance").length > 0],
        "initExtend"
	],
	
	dealItemsJSON: null,
	
	outerCdaModal: function(){
		$("#jsOuterCdaCompliance").modal("show");
	},
	
	bindDeal: function(){
		$(document).on("click", ".js-deal-section .js-more-link", function(){
			var $link = $(this);
			$(this).closest(".js-deal-product-block").find(".js-gt-six").slideToggle("slow", function(){
				if( $(this).css("display") === "none" ){
					$link.text("More");
				}else{
					$link.text("Less");
				}
			});
		});
	},

	getDeal : function(){
		$(document).on("click",".js-getDeal",function(){
			$(document).off("click", ".js-getDeal");
			var relatedProducts = $(this).closest('.right-part').find('.js-relatedProducts');
			ACC.campaignExtend.dealItemsJSON={items:[]};
			relatedProducts.each(function(){
				var productCode = $(this).data('code');
				var qty = $(this).find('.js-qty-selector-input').val() != "" ? $(this).find('.js-qty-selector-input').val() : 0;
				var qtyAlreadyInCart = $(this).find(".js-qty-already-in-cart").val();
				ACC.campaignExtend.dealItemsJSON.items.push({
	    			"productCode":productCode,
	    			"qty":qty,
	    			"qtyAlreadyInCart":qtyAlreadyInCart
	    		});
			});
			ACC.campaignExtend.addToCartDealItems(JSON.stringify(ACC.campaignExtend.dealItemsJSON));
		});
		
	},

	addToCartDealItems:function(jsonString){
    	$.ajax({
            url: ACC.config.encodedContextPath + '/cart/add/dealProducts',
            method: "POST",
            data: {itemList:jsonString},
            success: function (data) {
            	var obj=JSON.parse(data);
            	var response = JSON.parse(obj.response);
            	$.each(response, function (key, value) {
        	        if(value.status === "success"){
        	        	$(".js-success-block").removeClass("display-none");
        	        	setTimeout(function () {
        	        		window.location = ACC.config.encodedContextPath + '/cart'; 
        	        	}, 1000);
        	        	
        	        }else{
        	        	$(".js-success-block").addClass("display-none");
        	        }
        	    });
            	
            }
        });
    },
    
    cartItemUnitPriceByCode: function(code){
    	var unitPrice = 0;
		var cartItem = $("#js-cartDataTable").find("tr[data-cartitemprodcode="+code+"]");
		if( cartItem && cartItem.length > 0 ){
			unitPrice = +cartItem.find("[class*='item-unit-price']").first().text().replace("$", "");
			var cFactor = +cartItem.find(".js-conversion-factor").val();
			var casePack = +cartItem.find(".js-casepack").val();
			if( cFactor > 0 && casePack > 0 ){
				var conversionFactor = cFactor * casePack;
				unitPrice = unitPrice/conversionFactor;
			}
		}
		return unitPrice;
    },
    
    getCartItemUnitPrice: function($parent){
    	var unitPrice = 0;
    	if( $parent.find(".js-incart-text").length > 0 ){
	    	var $dealItemInCart = $parent.find(".js-incart-text").first().closest(".js-relatedProducts");	
			var code = $dealItemInCart.find(".js-product-code").val();
	    	unitPrice = ACC.campaignExtend.cartItemUnitPriceByCode(code);
    	}
		return unitPrice;
    },
    
    setDealItemPrice: function(){
    	$(".js-deal-row").each(function(){
    		var unitPrice = ACC.campaignExtend.getCartItemUnitPrice( $(this) );
    		var firstUnitPrice = unitPrice;
    		if( firstUnitPrice > 0 ){
    			$(this).find(".js-relatedProducts").each(function(){
    				var displayPrice;
    				var getUnitPrice;
    				if( $(this).find(".js-incart-text").length > 0 ){
    					getUnitPrice = ACC.campaignExtend.cartItemUnitPriceByCode( $(this).closest(".js-relatedProducts").find(".js-product-code").val() );
    					displayPrice = getUnitPrice;
    				}else{
    					getUnitPrice = firstUnitPrice;
    					displayPrice = firstUnitPrice;
    				}
    				
    				var cFactor = +$(this).find(".js-conversion-factor").val();
    				var casePack = +$(this).find(".js-casepack").val();
    				if( cFactor > 0 && casePack > 0 ){
    					displayPrice = getUnitPrice * cFactor * casePack;
    				}
    				
    				$(this).find(".js-deal-item-price").text("$"+displayPrice.toFixed(2));
    				$(this).siblings(".js-mobile-deal-item-price").find(".js-deal-item-price").text("$"+displayPrice.toFixed(2));
    			});
    		}
    	});
    },
    
	showDealsList : function(){
		$("#collapse_deal_0").on('shown.bs.collapse', function () {
			ACC.checkout.cartSpinnerDisplay(true);
			$.ajax({
				url: ACC.config.encodedContextPath + "/cart/availableDeals",
				method: "POST",
				dataType:"json",
				success: function(data){
					$("#collapse_deal_0 > .panel-body").html($("#campaignDealTemplate").tmpl(data));
					ACC.campaignExtend.setDealItemPrice();
					ACC.campaignExtend.getMinKeyFromDealTier(data);
					ACC.campaignExtend.enableGetDealButtonForAll();
				},
				complete: function(){
					ACC.checkout.cartSpinnerDisplay(false);
				}
			});
		});
	},

	getMinKeyFromDealTier: function(data){
		if( data && data.availableDeal && data.availableDeal.length > 0 ){
			var list = data;
			for (var int = 0; int < list.availableDeal.length; int++) {
				var tier = list.availableDeal[int].tierMap;
				ACC.campaignExtend.setMinReqdProdFromDealTier(int, tier);
			}
		}
	},

	enableGetDealButtonForAll: function(){
		$(document).find(".js-deal-section .js-deal-row").each(function(){
			var firstElementInRow = $(this).find(".js-deal-quantity").first();
			if( firstElementInRow ){
				ACC.campaignExtend.enableGetDealButton(firstElementInRow);
			}
		});
	},

	bindCampaignGA: function(){
		$(".cart-campaign-offer .banner").on("click", function(){
			var campaignName = "";
			if( $(this).find(".js-campaign-name").length > 0 ){
				campaignName = $(this).find(".js-campaign-name").text();
			}
			campaignName = ACC.campaignExtend.escapeCampaignName(campaignName);
			var campaignType = "";
			if( $(this).find(".js-campaign-type").length > 0 ){
				campaignType = $(this).find(".js-campaign-type").text();
			}
			campaignType = ACC.campaignExtend.escapeCampaignType(campaignType);
			ACC.track.trackCampaignViews(campaignName,"No","NA", ACC.pageName,campaignType);
		})
	},

	setMinReqdProdFromDealTier: function(int, tier){
		var min = 99999;
		for ( var each in tier) {
			if( +each < min ){
				min = +each;
			}
		}
		$(".js-min-required-products-"+int).val(min);
	},

	getTotalDealProduct: function( $el ){
		var totalQty = 0;
		$el.closest(".right-part").find(".js-qty-form").each(function(){
			var inCart = +$(this).find(".js-qty-already-in-cart").val();
			var qty = +$(this).find(".js-converted-qty").val();
			
			totalQty += inCart + qty;
		});
		return totalQty;
	},

	enableGetDealButton: function($el){
		if( $el ){
			var totalProduct = ACC.campaignExtend.getTotalDealProduct($el);
			var minProdRequired = +$el.closest(".deal-row-item").find("[class^=js-min-required-products-]").val();
			if( totalProduct >= minProdRequired ){
				$el.closest(".deal-row-item").find(".js-getDeal").removeClass("disabled");
			}else{
				$el.closest(".deal-row-item").find(".js-getDeal").addClass("disabled");
			}
		}
	},

	getConvertedQuantityAjax: function($el){
		var productCode = $el.closest("form").find(".js-product-code").val();
		var qty = +$el.val();
		$.ajax({
			url:ACC.config.encodedContextPath + "/cart/gallonConversion",
			data:{"productCode":productCode, "qty":qty},
			success: function(data){
				$el.closest("form").find(".js-converted-qty").val( data );
			},
			complete: function(){
				//Do coding
				ACC.campaignExtend.enableGetDealButton($el);
				ACC.campaign.displaySafetyNet($el);
			}
		});
	},

	checkCampaignDeal: function( $el ){
		ACC.cartitem.showPriceOrder();
		ACC.campaignExtend.getConvertedQuantityAjax($el);
	},
	
	allowMultipleFreeSku: function($el, skuTierArr, totalProduct){
		var allowMultiple = ACC.pageName === "campaignDetailPage" ? 
				$(".js-campaign-allow-multiple").val() : 
					$el.closest(".panel-body").find(".js-campaign-allow-multiple").val();
		var freeQty = 0;
		var freeSkuProductCount = ACC.pageName === "campaignDetailPage" ? 
				+$(".js-freeSkuProductCount").val() :
				+$el.closest(".js-panel-body").find(".js-freeSkuProductCount").val();
		if( skuTierArr.length === 1 && allowMultiple.toLowerCase() === "true" ){
			var item = skuTierArr[0].split("=");
			var buyQty = parseInt(item[0]);
			var getQty = parseInt(item[1]);
			
			var quotient = Math.floor(totalProduct/buyQty);
			freeQty = quotient * getQty;
			if( freeSkuProductCount === 1 ){
			ACC.pageName === "campaignDetailPage" ? 
					$(".free-case-table").find(".js-campaign-detail").val( freeQty ) :
						$el.closest(".js-panel-body").find(".js-offer-free-product-list").find(".js-cart-campaign-offer").val( freeQty );
			}
		}
		return freeQty;
	},
	
	setFreeSkuProduct: function($el, qty){
		var freeSkuProductCount = +$el.closest(".js-panel-body").find(".js-freeSkuProductCount").val();
		if( freeSkuProductCount === 1 ){
    		$el.closest(".js-panel-body").find(".js-offer-free-product-list").find(".js-cart-campaign-offer").val( qty );
    	}
	},
	
	doNotCall: function(){
		ACC.campaignExtend.bindDeal();
	},
	
	applyPromo: function(){
		$(document).on("click", ".js-btn-promo", function(){
			var $parent = $(this).closest(".js-promo-group");
			$parent.find(".js-valid-promo").val("");
			var promoList = $parent.find(".js-promocodeList").val();
			var promoListArr = []; 
			if( promoList.length > 0 ){
				promoListArr = promoList.split(",");
				promoListArr.pop();
			}
			var promo = $parent.find(".js-input-promo").val();
			var matched = false;
			if( promoListArr.length > 0 ){
				for (var int = 0; int < promoListArr.length; int++) {
					if( promoListArr[int] === promo ){
						matched = true;
						break;
					}
				}
			}
			if( matched ){
				$parent.find(".js-promo-error-msg").removeClass("display-none").removeClass("text-error").addClass("text-success").text(ACC.promoCodeSuccess);
				$parent.find(".js-valid-promo").val(promo);
			}else{
				$parent.find(".js-promo-error-msg").removeClass("display-none").removeClass("text-success").addClass("text-error").text(ACC.promoCodeError);
			}
		});
	},
	
	initExtend: function(){
		$(".cart-campaign-offer").on("click", ".js-discountAcceptBtn", function(){
    		$(".cart-campaign-offer").off("click", ".js-discountAcceptBtn");
    		var parent = $(this).closest(".panel-body");
    		ACC.campaign.campaignOfferProducts(parent);
    		var campaign_id = parent.find(".js-campaignid").val();
    		var promo_code = parent.find(".js-valid-promo").val();
    		ACC.campaign.addToCartMultipleItems(JSON.stringify(ACC.campaign.campaignOfferItemsJSON), campaign_id, promo_code, "", true);
    	});
		if( $(".js-discount-alert-error").length > 0 ){
			$(".js-discount-alert-error").each(function(){
				$(this).closest(".js-panel-block").find(".js-arrow").click();
			});
		}
		$(document).on("focus", ".js-input-promo", function(){
			$(this).closest(".js-promo-group").find(".js-promo-error-msg").addClass("display-none").text("");
		});
		ACC.campaignExtend.applyPromo();
	},
	
	checkDiscountCampaign: function($el){
		ACC.cartitem.showPriceOrder();
		var $parentPanel = $el.closest(".js-panel-body");
		
		if( !$parentPanel.find(".js-discountAcceptBtn").hasClass("disabled") ){
			$parentPanel.find(".js-discountAcceptBtn").addClass("disabled").attr("aria-disabled", true);
		}
		if( !$parentPanel.find(".js-discount-error-msg").hasClass("display-none") ){
			$parentPanel.find(".js-discount-error-msg").addClass("display-none");
		}
		
		var reqdQty = +$parentPanel.find(".js-requiredQuantity-discount").val();
		var minSku = +$parentPanel.find(".js-campaign-discount-minsku").val();
		
		var totalProduct = 0;
		var productInCart = 0;
		$parentPanel.find(".js-cart-campaign-discount").each(function(){
			var qty = +$(this).val();
			var inCart = +$(this).closest("form").find(".js-qty-already-in-cart").val();
			totalProduct += qty;
			if( qty > 0 || inCart > 0 ){
				productInCart++;
			}
		});
		
		if( totalProduct < reqdQty ){
			$parentPanel.find(".js-discount-error-msg").removeClass("display-none").html(ACC.discCampaignMinReqdQtyErr).find(".reqdQty").text(reqdQty);
			$el.attr("aria-describedby", "js-discount-error-msg");
		}else if( productInCart < minSku ){
			$parentPanel.find(".js-discount-error-msg").removeClass("display-none").html(ACC.discCampaignMinSkuErr).find(".minSku").text(minSku);
			$el.attr("aria-describedby", "js-discount-error-msg");
		}else{
			$parentPanel.find(".js-discountAcceptBtn").removeClass("disabled").attr("aria-disabled", false);
			$el.removeAttr("aria-describedby");
		}
	},
	
	campaignDiscountDetail: function(){
		if( !$(".js-campaign-detail-list").find(".js-addtocart").hasClass("disabled") ){
			$(".js-campaign-detail-list").find(".js-addtocart").addClass("disabled").attr("aria-disabled", true);
		}
		if( !$(".js-campaign-detail-list").find(".js-error-msg").hasClass("display-none") ){
			$(".js-campaign-detail-list").find(".js-error-msg").addClass("display-none");
		}
		
		var reqdQty = +$(".js-campaign-detail-list").find(".js-requiredQuantity-discount").val();
		var minSku = +$(".js-campaign-detail-list").find(".js-campaign-minsku").val();
		
		var totalProduct = 0;
		var productInCart = 0;
		$(".js-campaign-detail-list").find(".js-campaign-detail").each(function(){
			var qty = +$(this).val();
			var inCart = +$(this).closest("form").find(".js-qty-already-in-cart").val();
			totalProduct += qty;
			if( qty > 0 || inCart > 0 ){
				productInCart++;
			}
		});
		
		var hasError = false;
		if( totalProduct < reqdQty ){
			hasError = true;
			$(".js-campaign-detail-list").find(".js-error-msg").removeClass("display-none").
			html(ACC.discCampaignMinReqdQtyErr).find(".reqdQty").text(reqdQty);
		}else if( productInCart < minSku ){
			hasError = true;
			$(".js-campaign-detail-list").find(".js-error-msg").removeClass("display-none").
			html(ACC.discCampaignMinSkuErr).find(".minSku").text(minSku);
		}
		return hasError;
	},
	
	checkAutoShipModal: function($el){
		var qtyDecreased = false;
		$(".js-autoship-modal-prod-table").find(".campaignItems").each(function(){
			var initQty = +$(this).find(".js_autoship_init_qty").val();
			var currentQty = +$(this).find(".js-autoship-modal").val();
			if( currentQty < initQty ){
				qtyDecreased = true;
				return false;
			}
		});
		if( qtyDecreased ){
			$(".js-cart-button").find(".js-addToOrderButton").addClass("disabled").attr("aria-disabled", true);
		}else{
			$(".js-cart-button").find(".js-addToOrderButton").removeClass("disabled").attr("aria-disabled", false);
		} 
		
		var isFreeSku = $el.data("isFreesku");
		var oldValue = $el.data("initialValue");
		var currentValue = +$el.val();
		if(isFreeSku && currentValue > oldValue){
			$el.val(oldValue);
		}
	},
	
	quantityExistInAutoShipModal: function(){
		var quantity = false;
		if( ACC.campaign.campaignItemsJSON ){
			for (var prod = 0; prod < ACC.campaign.campaignItemsJSON.items.length; prod++) {
				var item = ACC.campaign.campaignItemsJSON.items[prod];
				if( +item.qty > 0 || +item.qtyAlreadyInCart > 0 ){
					quantity = true;
					break;
				}
			}
		}
		
		if( quantity ){
    		ACC.campaign.displayAutoShipModalSuccess = true;
    	}else{
    		ACC.campaign.displayAutoShipModalSuccess = false;
    	}
	},
	
	checkCampaignDetail: function(){
		var hasError = false;
		var allowMultiple = $(".js-AllowMultiple").val();
		var campaignApplied = $(".js-CampaignApplied").val();
		if( campaignApplied === "true" && allowMultiple === "false" ){
			$(".js-addtocart").addClass("disabled").attr("aria-disabled", true);
			$(".js-campaign-detail-list").find(".js-error-msg").text(ACC.campaignAppliedErr);
			return false;
		}
		if( $(".js-campaign-freeSkuTiers").length > 0 ){
			hasError = ACC.campaign.freeSKUCampaignDetail()
		}else if( $(".free-gift").length > 0 ){
			hasError = ACC.campaign.freeGiftCampaignDetail();
		}else if( $(".js-campaign-discount").length > 0 ){
			hasError = ACC.campaignExtend.campaignDiscountDetail();
		}
		
		if( !hasError ){
			$(".js-addtocart").removeClass("disabled").attr("aria-disabled", false);
		}else{
			$(".js-addtocart").addClass("disabled").attr("aria-disabled", true);
		}
	},
	bindGACampaignDetail: function(){
		var campaignName = $(".js-campaign-name").val();
		campaignName = ACC.campaignExtend.escapeCampaignName(campaignName);
		var campaignType = $(".js-campaign-type").val();
		campaignType = ACC.campaignExtend.escapeCampaignType(campaignType);
		ACC.track.trackCampaignViews(campaignName,"No","NA", ACC.pageName,campaignType);
	},
	
	escapeCampaignName: function(campaignName){
		return campaignName && campaignName.length > 0 ? campaignName.replace(/'/g, "\'").replace(/"/g, '\"') : "";
	},
	
	escapeCampaignType: function(campaignType){
		return campaignType && campaignType.length > 0 ? campaignType.replace(/'/g, "\'").replace(/"/g, '\"') : "";
	}
}
/**function hideShow() is the constructor for a hideShow widget. it accepts the html ID of
an element to attach to.
@param(id string) id is the html ID of the element to attach to
@return N/A **/
function hideShow(id) {
   this.$id = $('#' + id);
   this.$region = $('#' + this.$id.attr('aria-controls'));
   this.keys = {
               enter: 13,
               space: 32
               };
   this.toggleSpeed = 100;
   // bind handlers
   this.bindHandlers();
} // end hidShow() constructor
/** Function bindHandlers() is a member function to bind event handlers to the hideShow region
return N/A **/
hideShow.prototype.bindHandlers = function() {
   var thisObj = this;
   this.$id.click(function(e) {
      thisObj.toggleRegion();
      e.stopPropagation();
      return false;
   });
}

/** Function toggleRegion() is a member function to toggle the display of the hideShow region
return N/A **/
hideShow.prototype.toggleRegion = function() {
    // toggle the region
    this.$region.slideToggle(this.toggleSpeed, function() {
      if ($(this).attr('aria-expanded') == 'false') { // region is collapsed
        // update the aria-expanded attribute of the region
        $(this).attr('aria-expanded', 'true');
        // move focus to the region
        $(this).focus();
	}
      else { // region is expanded
        // update the aria-expanded attribute of the region
        $(this).attr('aria-expanded', 'false');
}
    });
} // end toggleRegion()
//################################################################
//#### Customer Inquiry 
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.customerInquiry={
	_autoload: [   		
		"init",
		["faqLeftNavigation", $(".js-faqJsonMenu").length > 0]
	],
	
	init : function() {
		ACC.customerInquiry.businessNameUpdate();
		ACC.customerInquiry.deliveryAddressUpdate();
		ACC.customerInquiry.poNumberInquiry();
		ACC.customerInquiry.deliveryScheduleUpdate();
		ACC.customerInquiry.addComment();
		ACC.customerInquiry.getInquiryDetails();
		ACC.customerInquiry.bindButton();
		ACC.customerInquiry.enableSKUPriceButton();
		ACC.customerInquiry.faqBindInquiryPageEvents();
		ACC.customerInquiry.closeAlerts();
		ACC.customerInquiry.accessibility();
	},
    	
	bnuFormValidate:null,
	priceFormValidate:null,
	closeAccFormValidate:null,
	pguFormValidate:null,
	invFormValidate:null,
	dauFormValidate:null,
	poInquiryForm: null,
	changeofownershipValidation: null,
	dsuFormValidate : null,
	
	accessibility: function(){
		$(".faq").on('keydown', 'a, textarea, input, select, button', function(e) { 
			  var keyCode = e.keyCode || e.which; 

			  if (keyCode == 9 && $('.js-faq-right-content').find('*').filter(":focusable" ).filter(':visible').filter(':last').text() === $(this).text() && ACC.profile.shift !== true ) { 
			    // refocus on the active link
		    	e.preventDefault();
			    $('.js-submenu.active > a').focus();
			  } 
			  
			});
		$('a[data-toggle="collapse"]').attr('aria-expanded',false).addClass('collapsed');
		
		$(".js-faq-cms-links .collapse").on('show.bs.collapse', function(){
	        $('.js-faq-cms-links [href="#'+$(this).attr('id')+'"]').attr('aria-expanded',true);
	    });
		$(".js-faq-cms-links .collapse").on('hidden.bs.collapse', function(){
	        $('.js-faq-cms-links [href="#'+$(this).attr('id')+'"]').attr('aria-expanded',false);
	    });
		
		$('.faq').on('click', 'a.js-primaryLink', function(){
			if($(this).closest('li').hasClass('active')){
				$(this).attr('aria-expanded',true);
			}else{
				$(this).attr('aria-expanded',false);
			}
		});
	},
	
	hideCustomerInquiryMessage: function($el){
		var hideMessage = ACC.pageName === 'faqPage' || $el.closest(".customer-inquiry-modal").length > 0;
		if( hideMessage ){
			$('.message-box').not('.unhide').addClass("hide").attr('aria-hidden',true);
		}
	},
	
	closeAlerts: function(){
		if(ACC.pageName === 'faqPage'|| ACC.pageName === 'update-profile' || ACC.pageName === 'cartPage' || ACC.pageName === 'campaignDetailPage'){
			$(document).on('change','form .form-control', function(){
				ACC.customerInquiry.hideCustomerInquiryMessage($(this));
			});
			$(document).on('keyup','form input[type="text"].form-control', function(){
				ACC.customerInquiry.hideCustomerInquiryMessage($(this));
			});
			$(document).on('keyup','form textarea.form-control', function(){
				ACC.customerInquiry.hideCustomerInquiryMessage($(this));
			});
		}
		
	}, 
	
	enableSKUPriceButton: function(){
		$(document).on("keyup input", ".js-prc-sku", function(){
			var value = $.trim($(this).val());
			
			var isvalid = true;
			if( ACC.customerInquiry.priceFormValidate ){
				isvalid = ACC.customerInquiry.priceFormValidate.element(".js-prc-sku");
			}
			
			if( value.length > 0 && isvalid){
				$(".js-sku-search-btn").removeClass("disabled").attr("aria-disabled", false);
			}else{
				$(".js-sku-search-btn").addClass("disabled").attr("aria-disabled", true);
			}
		});
	},
	
	poNumberInquiry: function(){
		$(document).on("click",'.js-updatePo', function(){
			
			ACC.global.displaySpinner($("#commonSpinner"), true);
			$.ajax({
				url: ACC.config.encodedContextPath + "/inquiry/updateponumber", 
				method: "GET",
				success: function(rsp){
					if( typeof(rsp) === "object" && rsp.hasOwnProperty("poInquiryFormBody") ){
						var page = $('.js-poInquiry');
						page.find('.modal-title').html(rsp.poInquiryFormTitle);
						page.find('.modal-body').html(rsp.poInquiryFormBody);
						page.find('.modal-footer').html(rsp.poInquiryFormFooter);
						
						ACC.customerInquiry.poInquiryForm = $('.js-poInquiry').find('form').serialize();
						
						$('.js-poInquiry').modal();
					} 
		        },
		        complete: function(){
					ACC.global.displaySpinner($("#commonSpinner"), false);
		        }
			});
		});
		
		$(".js-poInquiry").on('shown.bs.modal', function () {
			ACC.validateForm.poUpdateValidation();
			ACC.customerInquiry.enableButton($(".js-poUpdateForm"), $(".js-po-update-btn"));
			$('.js-po-update-btn').addClass("disabled").attr("aria-disabled","true");
		});
		
		//po number update from FAQ page
		$(document).on("click", ".js-po-issue", function(){
			$('.js-faq-inquiry-body:not(.js-poInquiryBody .js-faq-inquiry-body), .js-faq-inquiry-footer:not(.js-poInquiryFooter .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$('.js-poInquiryBody').find('.js-faq-inquiry-body').toggleClass("hide");
			var el = $(this);
			if($('.js-poInquiryBody').find('.js-faq-inquiry-body').hasClass("hide")){
				$('.js-poInquiryBody').find('.js-faq-inquiry-body').attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-poInquiryBody').find('.js-faq-inquiry-body').removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.js-poInquiryFooter').find('.js-faq-inquiry-footer').toggleClass("hide");
			if($('.js-poInquiryFooter').find('.js-faq-inquiry-footer').hasClass("hide")){
				$('.js-poInquiryFooter').find('.js-faq-inquiry-footer').attr('aria-hidden',true);
			}else{
				$('.js-poInquiryFooter').find('.js-faq-inquiry-footer').removeAttr('aria-hidden');
			}
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			$('#pOComments').removeClass("error");
			$('#poInquiryForm').find('em.error').remove();
			ACC.customerInquiry.poInquiryForm = $('.js-poInquiryBody').find('form').serialize();
			$('.js-faq-inquiry-footer').find('.message-box').addClass('hide').attr('aria-hidden',true);
			$('[name="requireForAll"]#option2').prop("checked", true).closest('.btn ').addClass('active');
			$('[name="requireForAll"]#option3').prop("checked", false).closest('.btn ').removeClass('active');
			$('.js-commentContainer').removeClass("hide").attr('aria-hidden',false);
			ACC.validateForm.poUpdateValidation();
			ACC.customerInquiry.enableButton($(".js-poUpdateForm"), $(".js-po-update-btn"));
			
		});
		
		$(document).on('change','input[type=radio][name="requireForAll"]',function(){
			$('.js-poInquiryFooter').find(".js-success-msg, .js-error-msg").addClass("hide").attr('aria-hidden',true);
			$("#poInquiry").find(".js-success-msg, .js-error-msg").addClass("hide").attr('aria-hidden',true);
			if (this.value == 'no') {
				$('.js-po-update-btn').addClass("disabled").attr("aria-disabled","true");
				$('#pOComments').val("");
				$('#pOComments').removeClass("error");
				$('#poInquiryForm').find('em.error').remove();
				$('.js-commentContainer,.js-po-open-msg, .js-po-success-msg').addClass("hide").attr('aria-hidden',true);
				$('.js-noPo-msg').removeClass("hide").attr('aria-hidden',false);
	        }
	        else{
	        	$('.js-commentContainer').removeClass("hide").attr('aria-hidden',false);
	        	$('.js-noPo-msg, .js-po-open-msg, .js-po-success-msg').addClass("hide").attr('aria-hidden',true);
	        }
		});
		
	},
	poUpdateAjax: function(){
		
		$("#commonSpinner").css("z-index", "2000");
		ACC.global.displaySpinner($("#commonSpinner"), true);
		var form = $('.js-poUpdateForm');
		$.ajax({
			url: ACC.config.encodedContextPath + form.attr('action'), 
			method: "POST",
			data: form.serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
	        		$(".js-po-success-msg").removeClass("hide").removeAttr('aria-hidden');
	        		ACC.track.trackCustomerInquiry(ACC.enquiryPOUpdate);
	        	} else if(rsp === 'Error') {
	        		$(".js-po-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else {
	        		$(".js-po-open-msg").removeClass("hide").removeAttr('aria-hidden');
	        	}
	        },
	        error:function(){
	        	$("#poInquiry").find(".js-po-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        },
	        complete: function(){
	        	$('.js-po-update-btn').addClass('disabled').attr("aria-disabled","true");
				ACC.global.displaySpinner($("#commonSpinner"), false);
				ACC.global.footerAlignment();
	        }
		});
		
	},
	
	effectiveDateCalendar : function(){
		if($( ".js-close-effectiveDate" ).length > 0){
			$(".js-close-effectiveDate").each(function(x){
				$(".js-close-effectiveDate-"+x).datepicker({
			          dateFormat: ACC.datepickerFormat,
			          showOn: "button",
			          buttonText: "",
			          minDate: 0,
			          defaultDate: "",
			          disabled: false,
			          onSelect:  function() {
			        	  $(".js-close-effectiveDate-"+x).change();
			        	  ACC.customerInquiry.closeAccFormValidate.element(".js-close-effectiveDate-"+x);
			        	  $(".js-effectiveDate").val($(".js-close-effectiveDate-"+x).val());
			 	       },
			 	      onClose:function(){
				 	    	 $(".js-close-effectiveDate-"+x).next('.ui-datepicker-trigger').next('.error').removeClass('hide');
				 	    	 $(".js-close-effectiveDate-"+x).removeClass('overrideValidation');
				 	  } 
			        });
				ACC.deliveryDate.accessibility($(".js-close-effectiveDate-"+x));
				$(".ui-datepicker-trigger").attr({"aria-label":"calendar icon", "aria-expanded":"false"});
			});
		}
		if($(".js-dsu-effectiveDate").length > 0){
			
			$(".js-dsu-effectiveDate").each(function(){
				var y = $(this).data("index");
				$("#dsu-effectiveDate-"+ y).datepicker({
			          dateFormat: ACC.datepickerFormat,
			          showOn: "button",
			          buttonText: "",
			          minDate: 0,
			          defaultDate: "",
			          disabled: false,
			          onSelect:  function() { 
			        	  $("#dsu-effectiveDate-"+ y).change();
			        	  ACC.customerInquiry.dsuFormValidate.element("#dsu-effectiveDate-"+ y);
			        	  $("#dsu-effectiveDate").val($("#dsu-effectiveDate-"+ y).val());
			 	       },
			 	      onClose:function(){
			 	    	  	$("#dsu-effectiveDate-"+ y).next('.ui-datepicker-trigger').next('.error').removeClass('hide');
			 	    	 	$("#dsu-effectiveDate-"+ y).removeClass('overrideValidation');
				 	  }
			        });
				ACC.deliveryDate.accessibility($("#dsu-effectiveDate-"+ y));
				$(".ui-datepicker-trigger").attr({"aria-label":"calendar icon", "aria-expanded":"false"});
			});
			
		}
		
		$(".js-bnu-effectiveDate").each(function(){
			$(".js-bnu-effectiveDate").datepicker({
		          dateFormat: ACC.datepickerFormat,
		          showOn: "button",
		          buttonText: "",
		          minDate: 0,
		          defaultDate: "",
		          disabled: false,
		          onSelect:  function() { 
		        	  $(".js-bnu-effectiveDate").change();
		        	  ACC.customerInquiry.bnuFormValidate.element(".js-bnu-effectiveDate");
		 	       },
		 	      onClose:function(){
		 	    	  	$(".js-bnu-effectiveDate").next('.ui-datepicker-trigger').next('.error').removeClass('hide');
						$( ".js-bnu-effectiveDate" ).removeClass('overrideValidation');
			 	  }
		        });
		});
	},
	
	onlyAllowNumber: function(selector){
		$(document).on("keydown", selector, function(event) {			
			ACC.profile.preventNonNumberEntry(event);		
		});
	},
	displayFormattedPhone: function(selector){
		$(document).on("keyup blur", selector, function() {
			ACC.validateForm.masking($(this));
		});
	},
	
	maskPhoneNo : function(){
		ACC.customerInquiry.onlyAllowNumber(".js-faq-customerInquiry-content [name='js-phone'], .js-faq-customerInquiry-content [name='js-ext'], .js-faq-customerInquiry-content .js-phone[name='phone'], .js-faq-customerInquiry-content .js-ext[name='ext']");
		ACC.customerInquiry.displayFormattedPhone(".js-faq-customerInquiry-content [name='js-phone'], .js-faq-customerInquiry-content .js-phone[name='phone']");
		ACC.customerInquiry.onlyAllowNumber(".customer-inquiry-modal .js-phone[name='phone'], .customer-inquiry-modal .js-ext[name='ext'], .customer-inquiry-modal .js-dsu-zip");
		ACC.customerInquiry.displayFormattedPhone(".customer-inquiry-modal [name='js-phone'], .customer-inquiry-modal .js-phone[name='phone']");
	},
	enableButton: function(form, button){
    	form.on("keyup change", '.form-control', function() {
	        var empty = false;
	        form.find('.form-control:visible').each(function() {
	            if ($(this).val() == '' && $(this).data('required') === true) {
	                empty = true;
	                return false;
	            }
	        });

	        if (empty) {
	        	button.addClass('disabled').attr("aria-disabled","true"); 
	        } else {
	        	button.removeClass('disabled').attr("aria-disabled","false"); 
	        }
	    });
	},
	businessNameUpdate: function(){
		$(document).on("click", ".js-upd-business-name", function(){
			ACC.customerInquiry.businessNameUpdateAjax();
		});
		
		/*Submit Form*/
		$(document).on("click", ".js-bnu-update-btn", function(){
			ACC.track.trackCustomerInquiry("Business Name Update");
			$('.js-bnu-form').submit();
		});
		
		$(document).on("change", ".js-bnuUpdateSubReason", function(){
			$('.js-hidden-updateSubReason').val($(this).val());
		});
	},
	
	businessNameUpdateAjax: function(){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
			url: ACC.config.encodedContextPath + "/inquiry/updatebusinessname", 
			method: "GET",
    		success: function(rsp){
    			if( typeof(rsp) === "object" && rsp.hasOwnProperty("businessNameUpdateFormBody") ){
    				var modal = $('.customer-inquiry-modal');
    				modal.find('.modal-title').text(rsp.businessNameUpdateFormTitle);
    				modal.find('.modal-body').html(rsp.businessNameUpdateFormBody);
    				modal.find('.modal-footer').html(rsp.businessNameUpdateFormFooter);
    				modal.modal("show");
    				ACC.customerInquiry.bnuSuccessAjax(modal);
    			}
            },
            complete: function(){
				ACC.global.displaySpinner($("#commonSpinner"), false);
            }
    	});
	},
	
	bnuSuccessAjax: function(modal){
		if( modal.length > 0 ){
			/*Display Modal*/
			modal.on('shown.bs.modal', function () {
				modal.find(".js-first-focus").focus();
				ACC.global.modalAccessibility( modal, modal.find(".close"),  modal.find(".js-last-focus"));
				ACC.customerInquiry.disableOptionforMobile();
			});
			modal.on('hidden.bs.modal', function () {
				ACC.customerInquiry.bnuResetForm();
			});
			
			/*Dropdown Change*/
			ACC.customerInquiry.bnuReasonChange();
						
			/*Form Validate*/
			ACC.customerInquiry.bnuValidate();
			ACC.customerInquiry.effectiveDateCalendar();
			ACC.customerInquiry.maskPhoneNo();
			ACC.customerInquiry.enableButton($(".js-bnu-form"),$(".js-bnu-update-btn"));
		}
	},
	
	bnuReasonChange: function(){
		$(document).on("change", ".js-bnu-updateReason", function(){
			var optionvalue = $(this).val();
			if( optionvalue.length === 0 ){
				ACC.customerInquiry.bnuResetForm();
				$('.js-bnu-subDiv').addClass("hide").attr("aria-hidden", true);
				$('.js-businessNameUpdateFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true); 
			}
			else {
				$('.js-bnu-form').find('.form-control').not('[name="updateReason"]').not('[disabled="disabled"]').val("");
				$('.js-bnu-form').find('.form-control').removeClass('error');
				$('.js-bnu-form').find('em.error').remove();
				$(this).closest("form").find(".js-form-area").removeClass("hide").attr("aria-hidden", false);
				$("[class*='js-bnu-subreason-']").addClass("hide").attr("aria-hidden", true);
				var subReason = $(this).find(":selected").data("subreason");
				var subReasonElem = $(".js-bnu-subreason-"+subReason);
				
				if( subReasonElem.length > 0 ){
					subReasonElem.removeClass("hide").attr("aria-hidden", false);
				}
				if(optionvalue === $('.js-bnu-hasSubOption').text().trim()){
					$('.js-bnu-subDiv').removeClass('hide').removeAttr('aria-hidden');
				}else{
					$('.js-bnu-subDiv').addClass("hide").attr("aria-hidden", true);
				}
				$('.js-bnu-update-btn').addClass("disabled").attr("aria-disabled","true");
				$('.js-businessNameUpdateFooter').find('.js-faq-inquiry-footer').removeClass("hide").removeAttr('aria-hidden'); 
			}
			ACC.global.footerAlignment();
		});
	},
	
	bnuResetForm: function(){
		$(".js-bnu-form").find(".js-form-area").addClass("hide").attr("aria-hidden", true);
		$(".js-bnu-update-btn").addClass("disabled").attr("aria-disabled","true");
		$(".js-bnu-info-msg, .js-bnu-success-msg").addClass("hide").attr('aria-hidden',true);
		$('.js-bnu-form').find('.form-control').not('[disabled="disabled"]').val("");
		$('.js-bnu-form').find(":input").removeClass("error");
		
		if(ACC.customerInquiry.bnuFormValidate) {
			ACC.customerInquiry.bnuFormValidate.resetForm();
		}
	},
	
	closeAccResetForm: function(){
		$(".js-closeAcc-form").find("div[class^='js-closeAcc-subreason-']").addClass("hide").attr('aria-hidden',true);
		$(".js-closeAcc-form").find("div[class^='js-closeAcc-subDiv-']").addClass("hide").attr('aria-hidden',true);
		$(".js-closeAcc-form").find(".js-closeAcc-comments").addClass("hide").attr('aria-hidden',true);
		$(".js-closeAcc-form").find(".js-closeAcc-effectiveDate").addClass("hide").attr('aria-hidden',true);
		$(".js-closeAcc-submit-btn").addClass("hide").attr('aria-hidden',true);
		$('.js-closeAcc-form')[0].reset();
		$('.js-closeAcc-form').find(":input").removeClass("error");
		
	},
	
	bnuValidate: function(){
		ACC.customerInquiry.bnuFormValidate = $('.js-bnu-form').validate({
			onfocusout: function(element) {
                this.element(element);
             },
			errorElement: "em",
			rules: {
				"updateReason":{
					required:true
				},
				"bnuUpdateSubReason":{
					required:true
				},
				"businessName":{
					required:true,
					maxlength: 50
				},
				"effectiveDate":{
					required:true
				},
				"ext":{maxlength: 30},
				"phone":{
					required:true,
					minlength:12,
			 		maxlength:12
				}
			},
			messages: {
				"updateReason": {
					required: $('.js-bnu-updateReason-req-error-msg').text().trim()
				},
				"bnuUpdateSubReason": {
					required: $('.js-bnu-updateSubReason-req-error-msg').text().trim()
				},
				"businessName": {
					required: $('.js-bnu-businessName-req-error-msg').text().trim(),
					maxlength: $('.js-bnu-businessName-max-error-msg').text().trim()
				},
				"phone":{
					minlength: ACC.leadGenPhoneMinLengthErrorMsg,
				    maxlength:ACC.leadGenPhoneMaxLengthErrorMsg
				}
			},
			submitHandler: function(form) {
				return ACC.customerInquiry.bnuAjaxFormSubmit(form);
	    	},
	    	errorPlacement : function(error, element) {
				if(element.hasClass('hasDatepicker')){
					error.insertAfter(element.next('.ui-datepicker-trigger'));
					element.next('.ui-datepicker-trigger').next('.error').addClass('hide');
					element.addClass('overrideValidation');
				}else{
					error.insertAfter(element);
				}
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			}
	    });
		$('.js-bnu-form').find('[name="updateReason"],[name="bnuUpdateSubReason"],[name="businessName"],[name="effectiveDate"],[name = "phone"]').data('required', true);
		$('.js-bnu-form').find('[name="businessName"]').attr('maxlength', 50);
		$('.js-bnu-form').find('[name="phone"]').attr('maxlength', 10);
		$('.js-bnu-form').find('[name="ext"]').attr('maxlength', 30);
	},
			
	bnuAjaxFormSubmit: function(form){
		$("#commonSpinner").css("z-index", "2000");
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
	        type: "POST",
	        url: form.action,
	        data: $(form).serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
		        	$(".js-bnu-info-msg").removeClass("hide").removeAttr('aria-hidden');
		        	ACC.track.trackCustomerInquiry(ACC.enquiryBusinessNameUpdate);
	        	} else if(rsp === 'Error') {
	        		$(".js-bnu-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else {
	        		$(".js-bnu-warning-msg").removeClass("hide").removeAttr('aria-hidden');
	        	}
	        },
	        error: function(){
	        	$(".js-bnu-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        },
	        complete: function(){
	        	$(".js-bnu-update-btn").addClass("disabled").attr("aria-disabled","true");
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
		return false;
	},
	
	bindButton: function(){
		$(document).on("click", ".js-closeAcc-inquiry-btn", function(){
			ACC.track.trackCustomerInquiry(ACC.faqCloseAccount);
			$('.js-closeAcc-form').submit();
		});
		$(document).on("click", ".js-pricing-inquiry-btn", function(){
			ACC.track.trackCustomerInquiry(ACC.faqPricing);
			$('.js-prc-form').submit();
		});
		$(document).on("click", ".js-pgu-inquiry-btn", function(){
			ACC.track.trackCustomerInquiry(ACC.faqUpdateProductGroup);
			$(this).closest('.js-pgu-form').submit();
		});
		$(document).on("click", ".js-dau-update-btn", function(){
			ACC.track.trackCustomerInquiry(ACC.enquiryDeliveryAddressUpdate);
			$('.js-dau-form').submit();
		});
		$(document).on("click", ".js-coo-submit-btn", function(){
			ACC.track.trackCustomerInquiry(ACC.faqChangeOwnership);
			$('.js-changeofownership-form').submit();
		});
		/*Submit Form*/
		$(document).on("click", ".js-dsu-inquiry-btn", function(){
			ACC.track.trackCustomerInquiry(ACC.enquiryDeliveryScheduleUpdate);
			$(".js-deliverySchedule-form").submit();
		});
		
		$(document).on("click", ".js-po-update-btn", function(){
			ACC.track.trackCustomerInquiry("PO Number Requirement Update");
			$(".js-poUpdateForm").submit();
		});
	},
	
	//Close online Inquiry
	faqCloseOnlineInquiry: function(){
		$(document).on("click", "a[class^='js-closeAcc-issue-']", function(){
			var index = $(this).data("index");
			var el = $(this);
			$(".js-closeSubReasonText-hidden, .js-closeReasonText-hidden").val("");
			ACC.validateForm.closeAccountPriceForm();
			ACC.customerInquiry.populateHiddenField();
			$('.js-faq-inquiry-body, .js-faq-inquiry-footer').not('.js-closeOnlineAccountBody .js-faq-inquiry-body-'+ index +' , .js-closeOnlineAccountFooter .js-faq-inquiry-footer-' + index).addClass("hide").attr('aria-hidden',true);
			$('.js-closeOnlineAccountBody').find('.js-faq-inquiry-body-'+ index).toggleClass("hide");
			if($('.js-closeOnlineAccountBody').find('.js-faq-inquiry-body-'+ index).hasClass("hide")){
				$('.js-closeOnlineAccountBody').find('.js-faq-inquiry-body-'+ index).attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-closeOnlineAccountBody').find('.js-faq-inquiry-body-'+ index).removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.js-closeOnlineAccountFooter').find('.js-faq-inquiry-footer-'+ index).toggleClass("hide");
			if($('.js-closeOnlineAccountFooter').find('.js-faq-inquiry-footer-'+ index).hasClass("hide")){
				$('.js-closeOnlineAccountFooter').find('.js-faq-inquiry-footer-'+ index).attr('aria-hidden',true);
			}else{
				$('.js-closeOnlineAccountFooter').find('.js-faq-inquiry-footer-'+ index).removeAttr('aria-hidden');
			}
			$(".js-closeAcc-form").find(".js-closeAcc-issue").val($(this).data('value'));
			$(".js-closeAcc-form").find(".js-closeAcc-reason-" + $(this).data('index')).removeClass("hide").removeAttr('aria-hidden');
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			ACC.customerInquiry.enableButton($(".js-closeAcc-form"),$(".js-closeAcc-inquiry-btn"));	
		});
		$(document).on("change", ".js-closeAcc-commentsTextarea", function(){
			var value = $(this).val(); 
			$('.js-coa-closeAcc-comments').val(value);
		});
		$(".js-faq-customerInquiry-content").on("change", "select[id^='close-AccReason-']", function(){
			var index = $(this).data("index");
			var priceForm = $(".js-closeAcc-form");
			var effectiveDate = priceForm.find('.js-faq-inquiry-body-'+ index).find(".js-closeAcc-effectiveDate");
			var comment = priceForm.find('.js-faq-inquiry-body-'+ index).find(".js-closeAcc-comments");
			priceForm.find('.js-faq-inquiry-body-'+ index).find('.form-control:not(select[id^="close-AccReason-"])').removeClass('error').val("");
			priceForm.find('.js-faq-inquiry-body-'+ index).find('em.error').remove();
			$('.js-closeAcc-inquiry-btn').addClass('disabled').attr("aria-disabled","true");
			if($(this).val() === '') {
				priceForm.find("div[class^='js-closeAcc-subreason-']").addClass("hide").attr('aria-hidden',true);
				priceForm.find("div[class^='js-closeAcc-subDiv-']").addClass("hide").attr('aria-hidden',true);
				comment.addClass("hide").attr('aria-hidden',true);
				effectiveDate.addClass("hide").attr('aria-hidden',true);
				$('.js-faq-inquiry-footer-'+ index).find(".js-closeAcc-submit-btn").addClass("hide").attr('aria-hidden',true);
				$(".js-prc-product-container").empty();
			} 
			else {
				var subindex = $(this).find("option:selected").data('subindex');
				var subreason = priceForm.find(".js-closeAcc-subreason-" + subindex);
				var subdiv = priceForm.find(".js-closeAcc-subDiv-" + subindex);
				priceForm.find("div[class^='js-closeAcc-subreason-']").addClass("hide").attr('aria-hidden',true);
				priceForm.find("div[class^='js-closeAcc-subDiv-']").addClass("hide").attr('aria-hidden',true);
				if( subreason.length > 0 ) {
					subreason.removeClass("hide").removeAttr('aria-hidden');
				} 				
				if( subdiv.length > 0 ) {
					subdiv.removeClass("hide").removeAttr('aria-hidden');
				} 				
				effectiveDate.removeClass("hide").removeAttr('aria-hidden');
				comment.removeClass("hide").removeAttr('aria-hidden');
				$('.js-faq-inquiry-footer-'+ index).find(".js-closeAcc-submit-btn").removeClass("hide").removeAttr('aria-hidden');
				$(".js-closeAcc-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
			}
			ACC.global.footerAlignment();
		});
	},
	
	emptyFaqPricingInquery: function(){
		$(".js-prc-form").find("em.error").remove();
		$(".js-prc-form").find("[id^='prc-']").removeClass("error");
		$(".js-prc-form").find("[class*='js-input']").removeClass("error");
		$(".js-prc-product-container").empty();
		$('.js-pricing-inquiry-btn, .js-sku-search-btn').addClass("disabled").attr("aria-disabled","true");
		$(".js-prc-form").find(".js-input").val("");
	},
	
	faqPricingInquiry: function(){
		$(document).on("change keyup", ".js-prc-sku", function(){
			$('.js-prc-sku-hidden').val('').change();
		});
		$(document).on("click", "a[class^='js-prc-issue-']", function(){
			var el = $(this);
			ACC.customerInquiry.faqPricingInqueryReset();
			ACC.customerInquiry.faqPricingProductSearch();
			$(".js-prc-form").find(".js-prc-issue").val($(this).data('value'));
			$(".js-prc-form").find(".js-prc-reason-" + $(this).data('index')).removeClass("hide").removeAttr('aria-hidden');
			$('.js-faq-inquiry-body:not(.js-pricingInquiryBody .js-faq-inquiry-body), .js-faq-inquiry-footer:not(.js-pricingInquiryFooter .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$('.js-pricingInquiryBody').find('.js-faq-inquiry-body').toggleClass("hide");
			if($('.js-pricingInquiryBody').find('.js-faq-inquiry-body').hasClass("hide")){
				$('.js-pricingInquiryBody').find('.js-faq-inquiry-body').attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-pricingInquiryBody').find('.js-faq-inquiry-body').removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.js-pricingInquiryFooter').find('.js-faq-inquiry-footer').toggleClass("hide");
			if($('.js-pricingInquiryFooter').find('.js-faq-inquiry-footer').hasClass("hide")){
				$('.js-pricingInquiryFooter').find('.js-faq-inquiry-footer').attr('aria-hidden',true);
			}else{
				$('.js-pricingInquiryFooter').find('.js-faq-inquiry-footer').removeAttr('aria-hidden');
			}
			$(".js-prc-submit-btn").addClass("hide").attr('aria-hidden',true);
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			ACC.customerInquiry.submitPriceForm();
			ACC.global.footerAlignment();
		});
		$(document).on("change", "select[id^='prc-pricingReason-']", function(){
			ACC.customerInquiry.emptyFaqPricingInquery();
			var priceForm = $(".js-prc-form");
			var subreasonDefault = priceForm.find(".js-prc-promisedPrice, .js-prc-promisedByWho");
			if($(this).val() === '') {
				priceForm.find(".js-prc-sku-form").addClass("hide").attr('aria-hidden',true);
				priceForm.find("div[class^='js-prc-subreason-']").addClass("hide").attr('aria-hidden',true);
				priceForm.find(".js-prc-comments").addClass("hide").attr('aria-hidden',true);
				subreasonDefault.addClass("hide").attr('aria-hidden',true);
				$(".js-prc-submit-btn").addClass("hide").attr('aria-hidden',true);
				$(".js-prc-sku").val('');
				$(".js-prc-product-container").empty();
			} 
			else {
				var subindex = $(this).find("option:selected").data('subindex');
				var subreason = priceForm.find(".js-prc-subreason-" + subindex);
				if( subreason.length > 0 ) {
					subreasonDefault.addClass("hide").attr('aria-hidden',true);
					$('#prc-comments').attr('maxlength',255);
					subreason.removeClass("hide").removeAttr('aria-hidden');
				} else {
					subreasonDefault.removeClass("hide").removeAttr('aria-hidden');
					$('#prc-comments').attr('maxlength',180);
					priceForm.find("div[class^='js-prc-subreason-']").addClass("hide").attr('aria-hidden',true);
				}
				priceForm.find(".js-prc-comments").removeClass("hide").removeAttr('aria-hidden');
				priceForm.find(".js-prc-sku-form").removeClass("hide").removeAttr('aria-hidden');
				$(".js-prc-submit-btn").removeClass("hide").removeAttr('aria-hidden');
				ACC.customerInquiry.enableButton($(".js-prc-form"),$(".js-pricing-inquiry-btn"));
			}
			ACC.global.footerAlignment();
		});
	},
	
	
	faqPricingInqueryReset: function() {
		ACC.customerInquiry.emptyFaqPricingInquery();
		$(".js-prc-form").find("[id^='prc-']").val('');
		$(".js-prc-form").find("div[class^='js-prc-']").addClass("hide").attr('aria-hidden',true);
		$(".js-closeAcc-submit-btn, .js-prc-submit-bt").addClass("hide").attr('aria-hidden',true);
		$(".js-faq-customerInquiry-content").find(".js-btn-group, .js-success-msg").addClass("hide").attr('aria-hidden',true);
	},
	
	populateHiddenField: function(){
		$('.js-closeReason').change( function(){
			var value= $(this).val();
			$('.js-closeReason-hidden').val(value);
			$('.js-closeSubReason-hidden, .js-closeSubReasonText-hidden').val("");
			$(".js-closeReasonText-hidden").val( $(this).find("option:selected").text() );
		});
		$('.js-phone').change( function(){
			var value= $(this).val();
			$('.js-phone-hidden').val(value);
		});
		$('.js-ext').change( function(){
			var value= $(this).val();
			$('.js-ext-hidden').val(value);
		});
		$('.js-buyingFrom').change( function(){
			var value= $(this).val();
			$('.js-buyingFrom-hidden').val(value);
		});
		$('.js-closeSubReason').change( function(){
			var value= $(this).val();
			$('.js-closeSubReason-hidden').val(value);
			$(".js-closeSubReasonText-hidden").val( $(this).find("option:selected").text() );
		});
		
	},
	
	submitPriceForm: function(){
		ACC.customerInquiry.priceFormValidate = $('.js-prc-form').validate({
			onfocusout: function(element) {
                this.element(element);
             },
			errorElement: "em",
			rules: {
				"pricingReason":{
					required:true
				},
				"sku":{
					required:true,
					number:true,
					maxlength: 50
				},
				"promisedPrice":{
					required:true,
					enqPriceFormat:true
				},
				"promisedByWho":{
					required:true,
					maxlength: 50
				},
				"comments":{
					required:true,
					maxlength: 255
				},
				"pricingSubReason":{
					required:true
				}
			},
			messages: {
				"pricingReason":{
					required:$('.js-prc-pricingSubReason-req-error-msg').text().trim()
				},
				"sku":{
					required: $('.js-prc-sku-req-error-msg').text().trim(),
					number:$('.js-prc-promisedPrice-number-error-msg').text().trim()
				},
				"promisedPrice":{
					required:$('.js-prc-promisedPrice-req-error-msg').text().trim(),
					enqPriceFormat:$('.js-prc-promisedPrice-error-msg').text().trim()
				},
				"promisedByWho":{
					required:$('.js-prc-promisedByWho-req-error-msg').text().trim(),
					maxlength: $('.js-prc-promisedByWho-max-msg').text().trim()
				},
				"comments":{
					required: $('.js-prc-comments-req-error-msg').text().trim(),
					maxlength: $('.js-prc-comments-comments-max-msg').text().trim()
				},
				"pricingSubReason":{
					required:$('.js-prc-pricingSubReason-req-error-msg').text().trim()
				}
			},
			errorPlacement : function(error, element) {
					error.insertAfter(element);
					error.attr('id',$(element).attr('id')+'_label');
					element.attr('aria-describedby',$(element).attr('id')+'_label');
			},
			submitHandler: function(form) {
				return ACC.customerInquiry.priceAjaxFormSubmit(form);
	    	}
	    });
		$('.js-prc-form').find('[name="pricingReason"],[name="sku"],[name="promisedPrice"],[name="promisedByWho"],[name="comments"],[name="pricingSubReason"],[name="js-prc-sku-hidden"]').data('required', true);
		$('.js-prc-form').find('[name="comments"]').attr('maxlength', 255);
		$('.js-prc-form').find('[name="promisedByWho"],[name="sku"]').attr('maxlength', 50);
		$('.js-prc-form').find('[name="promisedPrice"]').attr('maxlength', 22);
	},
	
	
	
	closeAccountAjaxFormSubmit: function(form){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
	        type: "POST",
	        url: form.action,
	        data: $(form).serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
	        		$(".js-closeOnlineAccountFooter").find(".js-success-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else if(rsp === 'Error') {
	        		$(".js-closeOnlineAccountFooter").find(".js-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else {
	        		$(".js-closeOnlineAccountFooter").find(".js-open-msg").removeClass("hide").removeAttr('aria-hidden');
	        	}
	        },
	        error: function() {
	        	$(".js-faq-customerInquiry-content").find(".js-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        },
	        complete: function() {
	        	$('.js-pricing-inquiry-btn').addClass("disabled").attr("aria-disabled","true");
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
		return false;
		
	},
	
	priceAjaxFormSubmit: function(form){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
	        type: "POST",
	        url: form.action,
	        data: $(form).serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
	        		$(".js-faq-customerInquiry-content").find(".js-success-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else if(rsp === 'Error') {
	        		$(".js-faq-customerInquiry-content").find(".js-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else {
	        		$(".js-faq-customerInquiry-content").find(".js-open-msg").removeClass("hide").removeAttr('aria-hidden');
	        	}
	        },
	        error: function() {
	        	$(".js-faq-customerInquiry-content").find(".js-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        },
	        complete: function() {
	        	$('.js-pricing-inquiry-btn').addClass("disabled").attr("aria-disabled","true");
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
		return false;
	},
	
	resetFaqCustomerInquirySection: function(){
		$(".js-faq-customerInquiry-content").find('form').each(function() {
			this.reset();
		});
		$(".js-faq-customerInquiry-content").find('.form-group').find('button.btn-default').addClass('disabled').attr("aria-disabled","true");
		if($(".js-faq-customerInquiry-content").find('.js-bnu-form').length > 0) {
			ACC.customerInquiry.bnuResetForm();
		}
		if($(".js-faq-customerInquiry-content").find('.js-dau-form').length > 0) {
			ACC.customerInquiry.dauResetForm();
		}
		$(".js-faq-inquiry-footer").find('.btn-default').each(function() {
			$(this).addClass("disabled").attr("aria-disabled","true");
		});
		if($(".js-faq-customerInquiry-content").find('.js-closeAcc-form').length > 0) {
			ACC.customerInquiry.closeAccResetForm();
		}
		$(".js-faq-customerInquiry-content").removeClass("hide").removeAttr('aria-hidden').removeAttr("style");
		ACC.global.footerAlignment();
	},
	
	faqPricingProductSearch : function() {
		$(document).on("click", ".js-sku-search-btn", function()
		{
			ACC.customerInquiry.faqPricingProductSearchAjax();
		});
	},
	
	faqPricingProductSearchAjax: function(){
		var sku = $('.js-prc-sku').val();
		if(!sku) {
			return false;
		}
		
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
			url: ACC.config.encodedContextPath + "/inquiry/productinquiry", 
			method: "GET",
			data: {"sku" : sku},
    		success: function(rsp){
    			ACC.customerInquiry.faqPricingProductSearchAjaxSuccess(rsp);
            },
            complete: function(){
				ACC.global.displaySpinner($("#commonSpinner"), false);
				$(".js-faq-customerInquiry-content").find(".js-success-msg, .js-error-msg").addClass("hide").attr('aria-hidden',true);
				ACC.global.footerAlignment();
            }
    	});
	},
	
	faqPricingProductSearchAjaxSuccess: function(rsp){
		if( typeof(rsp) === "object" && rsp.hasOwnProperty("productInquiryNotFoundError") ){
			$('.js-prc-product-container').html(rsp.productInquiryNotFoundError);
			$('.js-prc-product-container').removeClass("hide").removeAttr('aria-hidden');
			$(".js-pricing-inquiry-btn, .js-sku-search-btn").addClass("disabled").attr("aria-disabled", true);
			$('.js-prc-sku, .js-prc-sku-hidden').val("");
		}
		else if( typeof(rsp) === "object" && rsp.hasOwnProperty("productInquiryNotSellableError") ){
			$('.js-prc-product-container').html(rsp.productInquiryNotSellableError);
			$('.js-prc-product-container').removeClass("hide").removeAttr('aria-hidden');
			$(".js-pricing-inquiry-btn, .js-sku-search-btn").addClass("disabled").attr("aria-disabled", true);
			$('.js-prc-sku, .js-prc-sku-hidden').val("");
		}
		else if( typeof(rsp) === "object" && rsp.hasOwnProperty("productInquiryDetails") ){
			$('.js-prc-product-container').html(rsp.productInquiryDetails);
			$('.js-prc-product-container').removeClass("hide").removeAttr('aria-hidden');
			if(rsp.hasOwnProperty("productInquiryPricingError")) {
				$(".js-pricing-inquiry-btn, .js-sku-search-btn").addClass("disabled").attr("aria-disabled", true);
				$('.js-prc-sku, .js-prc-sku-hidden').val("");
			} else {
				$('.js-prc-sku-hidden').val($('.js-prc-sku').val()).change();
			}
		}
	},
	
	faqProductGroupUpdate: function(){
		$(document).on("click", "a[class^='js-pgu-issue-']", function(){
			var el = $(this);
			var index = $(this).data('index');
			var url = $(this).data('url');
			if(url.length>0){
				$(this).closest('form').attr('action',url);
			}
			$(".js-pgu-form").find(".js-pgu-issue").val($(this).data('value'));
			$(".js-pgu-form").find(".js-pgu-reason-" + $(this).data('index')).removeClass("hide").removeAttr('aria-hidden');
			
			$(".js-pgu-form").find("[class*='js-pgu-reason-']").find(".js-productGroupReason").attr("disabled", "disabled").attr("aria-disabled","true");
			$(".js-pgu-form").find(".js-pgu-reason-"+index).find(".js-productGroupReason").removeAttr("disabled").attr("aria-disabled","false");
			
			$(".js-pgu-form").find(".js-pgu-comments").addClass("hide").attr('aria-hidden',true);
			$(".js-pgu-submit-btn").removeClass("hide").removeAttr('aria-hidden');
			$('.js-faq-inquiry-body, .js-faq-inquiry-footer').not('.js-productGroupUpdateBody .js-faq-inquiry-body-'+index+' , .js-productGroupUpdateFooter .js-faq-inquiry-footer-'+index).addClass("hide").attr('aria-hidden',true);			
			$('.js-productGroupUpdateBody').find('.js-faq-inquiry-body-'+index).toggleClass("hide");
			if($('.js-productGroupUpdateBody').find('.js-faq-inquiry-body-'+index).hasClass("hide")){
				$('.js-productGroupUpdateBody').find('.js-faq-inquiry-body-'+index).attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-productGroupUpdateBody').find('.js-faq-inquiry-body-'+index).removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.js-productGroupUpdateFooter').find('.js-faq-inquiry-footer-'+index).addClass("hide").attr('aria-hidden',true);
			$('.js-fountain').addClass("hide").attr('aria-hidden',true);
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			ACC.customerInquiry.submitProductGroupUpdateForm();
			$('.js-productGroupUpdateBody').find('.form-control').removeClass('error');
			$('.js-productGroupUpdateBody').find('.error').remove();
			ACC.global.footerAlignment();
			ACC.customerInquiry.enableButton($(".js-pgu-form"),$(this).closest('form').find(".js-pgu-inquiry-btn"));
		});
		
		$(document).on("change", "[id*='pgu-comments-']", function(){
			var comment = $(this).val();
			$('.js-pgu-comments-txtArea').val(comment);
		});
		
		$(document).on("change", ".js-pgu-form .js-productGroupReason", function(){
			var index = $(this).data('index');
			var optionvalue = $(this).val();
			var updateProductGroup2opt = $('.js-updateProductGroup2opt').text().trim();
			$('.js-fountain').addClass("hide").attr('aria-hidden',true);
			$('.js-pgu-form').find('.form-control').not('.js-productGroupReason').val("");
			$('.js-pgu-form').find('.form-control').removeClass("error");
			$('.js-pgu-form').find('em.error').remove();
			if( optionvalue.length === 0 ){
				$('.js-productGroupUpdateBody .js-faq-inquiry-body-'+index).find(".js-pgu-comments").addClass("hide").attr('aria-hidden',true);
				$('.js-productGroupUpdateFooter').find('.js-faq-inquiry-footer-'+index).addClass("hide").attr('aria-hidden',true);
				$('.js-productGroupUpdateBody').find('.form-control').removeClass('error');
				$('.js-productGroupUpdateBody').find('.error').remove();
			}
			else {
				$('.js-productGroupUpdateBody .js-faq-inquiry-body-'+index).find(".js-pgu-comments").removeClass("hide").removeAttr('aria-hidden');
				$('.js-productGroupUpdateFooter').find('.js-faq-inquiry-footer-'+index).removeClass("hide").removeAttr('aria-hidden');
				$('.js-productGroupUpdateFooter').find('.js-faq-inquiry-footer-'+index).find(".js-pgu-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
				if(optionvalue === updateProductGroup2opt){
					$('.js-fountain').removeClass("hide").removeAttr('aria-hidden');
				}
			}
			ACC.global.footerAlignment();
		});
	},
	
	submitProductGroupUpdateForm: function(){
		ACC.customerInquiry.pguFormValidate = $('.js-pgu-form').validate({
			onfocusout: function(element) {
                this.element(element);
             },
			errorElement: "em",
			rules: {
				"productGroupReason":{
					required:true
				},
				"comment":{
					required:true,
					maxlength: 255
				}
			},
			messages: {
				"productGroupReason":{
					required: $('.js-pgu-productGroupReason-req-error-msg').text().trim()
				},
				"comment":{
					required: $('.js-pgu-comment-req-error-msg').text().trim(),
					maxlength: $('.js-pgu-comment-max-error-msg').text().trim()
				}
			},
			errorPlacement : function(error, element) {
				error.insertAfter(element);
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			},
			submitHandler: function(form) {
				return ACC.customerInquiry.pguAjaxFormSubmit(form);
	    	}
	    });
		
		$('.js-pgu-form').find('[name="productGroupReason"],[name="comment"]').data('required', true);
		$('.js-pgu-form').find('[name="comment"]').attr('maxlength', 255);
	},
	
	pguAjaxFormSubmit: function(form){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
	        method: "POST",
	        url: form.action,
	        data: $(form).serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
		        	$(".js-pgu-info-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else if(rsp === 'Error') {
	        		$(".js-pgu-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else {
	        		$(".js-pgu-warning-msg").removeClass("hide").removeAttr('aria-hidden');
	        	}
	        },
	        error: function(){
	        	$(".js-pgu-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        },
	        complete: function(){
	        	$(".js-pgu-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
		return false;
	},
	
	faqInventoryInquiry: function(){
		$(document).on("click", "a[class^='js-inven-issue-']", function(){
			$(".js-inven-form").find("[class*='js-inven-reason-']").not(".js-inven-reason-" + $(this).data('index')).addClass("hide").attr("aria-hidden", true);
			var el = $(this);
			$(".js-inven-form").find("[name=productGroupReason]").attr({"disabled":"disabled", "aria-disabled":true});
			$(".js-inven-form").find(".js-inven-issue").val($(this).data('value'));
			$(".js-inven-form").find(".js-inven-group-text").val("");
			$(".js-inven-form").find(".js-inven-reason-" + $(this).data('index')).toggleClass("hide");
			if($(".js-inven-form").find(".js-inven-reason-" + $(this).data('index')).hasClass("hide")){
				$(".js-inven-form").find(".js-inven-reason-" + $(this).data('index')).attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$(".js-inven-form").find(".js-inven-reason-" + $(this).data('index')).removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			$(".js-inven-form").find(".js-inven-reason-" + $(this).data('index')).find("[name=productGroupReason]").removeAttr("disabled").attr("aria-disabled", false);
			$("#faqForm").insertAfter($(this));
			$("#js-inven-submit-cont").insertAfter("#faqForm");
			$('.js-faq-inquiry-body:not(.js-inventoryInquiryBody .js-faq-inquiry-body), .js-faq-inquiry-footer:not(#js-inven-submit-cont .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$('.js-inventoryInquiryBody').find('.js-faq-inquiry-body').removeClass("hide").removeAttr('aria-hidden');
			$(".js-inven-form").find(".js-inven-comments").addClass("hide").attr("aria-hidden", true);
			$('#js-inven-submit-cont').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
			ACC.customerInquiry.faqInventoryInquiryFormReset();
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			ACC.customerInquiry.submitInventoryInquiryForm();
		});
		$(document).on("click", ".js-inven-inquiry-btn", function(){
			$('.js-inven-form').submit();
		});
		$(document).on("change",".js-inventoryInquiryBody select", function(){
			if($(this).val().length > 0) {
				$(".js-inven-form").find(".js-inven-group-text").val($(this).find("option:selected").text());
				$(".js-inven-form").find(".js-inven-comments").removeClass("hide").removeAttr('aria-hidden');
				$('#js-inven-submit-cont').find('.js-faq-inquiry-footer').removeClass("hide").removeAttr('aria-hidden');
				$("#inven-comments").removeClass('error').val("");
				$("#inven-comments").closest('.row').find('.error').remove();
				$(".js-inven-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
				
			}else{
				$(".js-inven-form").find(".js-inven-comments").addClass("hide").attr("aria-hidden", true);
				$('#js-inven-submit-cont').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
			}
			ACC.customerInquiry.enableButton($(".js-inven-form"),$(".js-inven-inquiry-btn"));
			ACC.global.footerAlignment();
		});
	},
	
	faqInventoryInquiryFormReset: function(){
		if($("#inventoryInquiryForm")[0].length > 0){
			$("#inventoryInquiryForm")[0].reset();
		}
		$("#js-inven-submit-cont .message-box").addClass("hide").attr('aria-hidden',true);
		$(".js-inven-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
	},
	
	submitInventoryInquiryForm: function(){
		ACC.customerInquiry.invFormValidate = $('.js-inven-form').validate({
			onfocusout: function(element) {
                this.element(element);
             },
			errorElement: "em",
			rules: {
				"productGroupReason":{
					required:true
				},
				"comments":{
					required:true,
					maxlength: 255
				}
			},
			messages: {
				"productGroupReason":{
					required: $('.js-inven-productGroupReason-req-error-msg').text().trim()
				},
				"comments":{
					required: $('.js-inven-comments-req-error-msg').text().trim(),
					maxlength: $('.js-inven-comments-max-error-msg').text().trim()
				}
			},
			errorPlacement : function(error, element) {
				error.insertAfter(element);
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			},
			submitHandler: function(form) {
				return ACC.customerInquiry.invenAjaxFormSubmit(form);
	    	}
	    });
		
		$('.js-inven-form').find('[name="productGroupReason"],[name="comments"]').data('required', true);
		$('.js-inven-form').find('[name="comments"]').attr('maxlength', 255);
	},
	
	invenAjaxFormSubmit: function(form){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
	        method: "POST",
	        url: form.action,
	        data: $(form).serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
		        	$(".js-inven-info-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else if(rsp === 'Error') {
	        		$(".js-inven-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else {
	        		$(".js-inven-warning-msg").removeClass("hide").removeAttr('aria-hidden');
	        	}
	        },
	        error: function(){
	        	$(".js-inven-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        },
	        complete: function(){
	        	$(".js-inven-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
		return false;
	},
	
	deliveryAddressUpdate: function(){
		$(document).on("click", ".js-upd-business-address", function(){
			ACC.customerInquiry.deliveryAddressUpdateAjax();
		});
	},
	
	deliveryAddressUpdateAjax: function(){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
			url: ACC.config.encodedContextPath + "/inquiry/updatedeliveryaddress", 
			method: "GET",
    		success: function(rsp){
    			if( typeof(rsp) === "object" && rsp.hasOwnProperty("deliveryAddressUpdateFormBody") ){
    				var modal = $('.customer-inquiry-modal');
    				modal.find('.modal-title').text(rsp.deliveryAddressUpdateFormTitle);
    				modal.find('.modal-body').html(rsp.deliveryAddressUpdateFormBody);
    				modal.find('.modal-footer').html(rsp.deliveryAddressUpdateFormFooter);
    				modal.modal("show");
    				ACC.customerInquiry.dauSuccessAjax(modal);
    			}
            },
            complete: function(){
				ACC.global.displaySpinner($("#commonSpinner"), false);
            }
    	});
	},
	
	dauSuccessAjax: function(modal){
		if( modal.length > 0 ){
			modal.on('shown.bs.modal', function () {
				modal.find(".js-first-focus").focus();
				ACC.global.modalAccessibility( modal, modal.find(".close"),  modal.find(".js-last-focus"));
				ACC.customerInquiry.disableOptionforMobile();
			});
			modal.on('hidden.bs.modal', function () {
				ACC.customerInquiry.dauResetForm();
			});
			ACC.customerInquiry.dauReasonChange();
			ACC.customerInquiry.dauValidate();
			ACC.customerInquiry.enableButton($(".js-dau-form"),$(".js-dau-update-btn"));
		}
	},
	
	dauResetForm: function(){
		$(".js-dau-new-address").addClass("hide").attr("aria-hidden", true);
		$(".js-dau-update-btn").addClass("disabled").attr("aria-disabled","true");
		$(".js-dau-info-msg, .js-bnu-error-msg, .js-dau-warning-msg").addClass("hide").attr('aria-hidden',true);
		$('.js-dau-form')[0].reset();
		$('.js-dau-form').find(":input").removeClass("error");
		if(ACC.customerInquiry.dauFormValidate) {
			ACC.customerInquiry.dauFormValidate.resetForm();
		}
	},
	
	dauReasonChange: function(){
		$(document).on("change", ".js-dau-updateReason", function(){
			var optionvalue = $(this).val();
			if( optionvalue.length === 0 ){
				ACC.customerInquiry.dauResetForm();
				$('.js-deliveryAddressUpdateFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
			}
			else {
				$('.js-dau-form').find('.form-control').not('[name="updateReason"]').val("");
				$('.js-dau-form').find('.form-control').removeClass("error");
				$('.js-dau-form').find('em.error').remove();
				$(".js-dau-new-address").removeClass("hide").attr("aria-hidden", false);
				$('.js-deliveryAddressUpdateFooter').find('.js-faq-inquiry-footer').removeClass("hide").removeAttr('aria-hidden');
				$(".js-dau-update-btn").addClass("disabled").attr("aria-disabled","true");
			}
			ACC.global.footerAlignment();
		});
	},
	
	dauValidate: function(){
		ACC.customerInquiry.dauFormValidate = $('.js-dau-form').validate({
			onfocusout: function(element) {
                this.element(element);
             },
			errorElement: "em",
			rules: {
				"updateReason":{
					required:true
				},
				"streetAddress":{
					required:true,
					maxlength: 50
				},
				"city":{
					required:true,
					maxlength: 50
				},
				"state":{
					required:true
				},
				"zip":{
					required:true,
					number: true,
					maxlength: 5
				}
			},
			messages: {
				"updateReason":{
					required: $('.js-dau-updateReason-required').text().trim()
				},
				"streetAddress":{
					required: $('.js-dau-streetAddress-required').text().trim(),
					maxlength: $('.js-dau-streetAddress-max').text().trim()
				},
				"city":{
					required: $('.js-dau-city-required').text().trim(),
					maxlength: $('.js-dau-city-max').text().trim(),
				},
				"state":{
					required: $('.js-dau-state-required').text().trim()
				},
				"zip":{
					required: $('.js-dau-zip-required').text().trim(),
					number:  $('.js-dau-zip-format').text().trim(),
					maxlength: $('.js-dau-zip-max').text().trim()
				}
			},
			errorPlacement : function(error, element) {
				error.insertAfter(element);
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
		  },
			submitHandler: function(form) {
				return ACC.customerInquiry.dauAjaxFormSubmit(form);
	    	}
	    });
		
		$('.js-dau-form').find('[name="updateReason"],[name="streetAddress"],[name="city"],[name="state"],[name="zip"]').data('required', true);
		$('.js-dau-form').find('[name="streetAddress"],[name="city"]').attr('maxlength', 50);
		$('.js-dau-form').find('[name="zip"]').attr('maxlength', 5);
		$('.js-dau-form').find('[name="zip"]').on("keydown", function(event) {			
			ACC.profile.preventNonNumberEntry(event);		
	    });
	},
	
	dauAjaxFormSubmit: function(form){
		$("#commonSpinner").css("z-index", "2000");
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
	        type: "POST",
	        url: form.action,
	        data: $(form).serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
		        	$(".js-dau-info-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else if(rsp === 'Error') {
	        		$(".js-dau-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        	} else {
	        		$(".js-dau-warning-msg").removeClass("hide").removeAttr('aria-hidden');
	        	}
	        },
	        error: function(){
	        	$(".js-dau-error-msg").removeClass("hide").removeAttr('aria-hidden');
	        },
	        complete: function(){
	        	$(".js-dau-update-btn").addClass("disabled").attr("aria-disabled","true");
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
		return false;
	},
	
	validateChangeOfOwnership: function(){
		ACC.customerInquiry.changeofownershipValidation = $('.js-changeofownership-form').validate({  
			onfocusout: function(element) {
                this.element(element);
             },
			submitHandler: function() {
				return ACC.customerInquiry.faqChangeOfOwnershipInquiryPostAjax();
	    	},
			rules: {
				"reason":{
					required:true
				},
				"phone":{
					required:true,
					minlength:12,
			 		maxlength:12,
				},
				"effectiveDate":{
					required:true
				}
			},
			messages:{
				"phone":{
					minlength: ACC.leadGenPhoneMinLengthErrorMsg,
				    maxlength:ACC.leadGenPhoneMaxLengthErrorMsg,
				}
			},
			errorElement: "em",
			errorPlacement : function(error, element) {
				if(element.hasClass('hasDatepicker')){
					error.insertAfter(element.next('.ui-datepicker-trigger'));
					element.next('.ui-datepicker-trigger').next('.error').addClass('hide');
					element.addClass('overrideValidation');
				}else{
					error.insertAfter(element);
				}
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			}
	    });
		$('.js-changeofownership-form').find('[name="reason"],[name="phone"],[name="effectiveDate"]').data('required', true);
	},
	
	bindCooElem: function() {
		$( ".js-coo-effective-dt" ).datepicker({
			dateFormat: ACC.datepickerFormat,
			showOn: "button",
			buttonText: "",
			minDate: 0,
			onSelect:  function() { 
				$( ".js-coo-effective-dt" ).change();
				ACC.customerInquiry.changeofownershipValidation.element(".js-coo-effective-dt" );
			},
			onClose:function(){
				$( ".js-coo-effective-dt" ).next('.ui-datepicker-trigger').next('.error').removeClass('hide');
				$( ".js-coo-effective-dt" ).removeClass('overrideValidation');
			}
		});
		$(".ui-datepicker-trigger").attr({"aria-label":"calendar icon", "aria-expanded":"false"});
		ACC.deliveryDate.accessibility($(".js-coo-effective-dt"));
		
		$(".js-changeofownership-form").find(".ui-datepicker-trigger").addClass("effectivedate").attr({"aria-label":"calendar icon", "aria-expanded":"false"});
		
		ACC.customerInquiry.validateChangeOfOwnership();
		
		ACC.customerInquiry.onlyAllowNumber(".js-coo-phone, .js-coo-ext");
		ACC.customerInquiry.displayFormattedPhone(".js-coo-phone");
		
	},
	
	faqChangeOfOwnershipInquiryPostAjax: function(){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		var form = $('.js-changeofownership-form');
		$.ajax({
			url: ACC.config.encodedContextPath + form.attr('action'), 
			method: "POST",
			data: form.serialize(),
	        success: function (rsp) {
	        	if(rsp === 'Success') {
	        		$(".js-changeofownershipFooter").find(".js-ownership-success-msg").removeClass("hide").attr({"aria-hidden":false});
	        	} else if(rsp === 'Error') {
	        		$(".js-changeofownershipFooter").find(".js-ownership-error-msg").removeClass("hide").attr({"aria-hidden":false});
	        	} else {
	        		$(".js-changeofownershipFooter").find(".js-ownership-open-msg").removeClass("hide").attr({"aria-hidden":false});
	        	}
	        },
	        error:function(){
	        	$(".js-customerInquiry-footer").find(".js-ownership-error-msg").removeClass("hide").attr({"aria-hidden":false});
	        },
	        complete: function(){
	        	$('.js-coo-submit-btn').addClass('disabled').attr("aria-disabled","true");
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
		return false;
	},
	
	faqChangeOfOwnershipInquiry: function(){
		$(document).on("click", ".js-coo-issue", function() {
			var el = $(this);
			$('.js-faq-inquiry-body:not(.js-changeofownershipBody .js-faq-inquiry-body), .js-faq-inquiry-footer:not(.js-changeofownershipFooter .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$('.js-changeofownershipBody').find('.js-faq-inquiry-body').toggleClass("hide");
			if($('.js-changeofownershipBody').find('.js-faq-inquiry-body').hasClass("hide")){
				$('.js-changeofownershipBody').find('.js-faq-inquiry-body').attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-changeofownershipBody').find('.js-faq-inquiry-body').removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.js-changeofownershipFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			ACC.customerInquiry.bindCooElem();
			$('.js-coo-phone-container, .js-coo-effective-dt-container').addClass("hide").attr('aria-hidden',true);
			$('.js-changeofownershipFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
			$('.js-changeofownership-form .form-control').removeClass('error').val('');
			$('.js-changeofownership-form').find('.error').remove();
			$(".js-coo-submit-btn").addClass('disabled').attr("aria-disabled","true");
			ACC.customerInquiry.enableButton($(".js-changeofownership-form"),$(".js-coo-submit-btn"));
		});
		$(document).on("change", ".js-coo-reason", function() {
			var $form = $(this).closest("form");
			var $selectedOption = $(this).find("option:selected");
			if( $(".js-changeofownership-form").find(".js-hidden-inquiryCode").length > 0 ){
				var code = $selectedOption.data("code") ? $selectedOption.data("code") : "";
				$(".js-changeofownership-form").find(".js-hidden-inquiryCode").val(code);
				$(".js-changeofownership-form").find("em.error").remove();
				$(".js-changeofownership-form").find(".form-control").removeClass('error');
			}
			if($(this).val() === '') {
				$form.find(".js-hidden-inquiryText").val("");
				$('.js-coo-phone-container, .js-coo-effective-dt-container').addClass("hide").attr('aria-hidden',true);
				$('.js-changeofownershipFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
				$('.js-changeofownership-form .form-control').removeClass('error').val('');
				$('.js-changeofownership-form').find('.error').remove();
			} 
			else {
				$form.find(".js-hidden-inquiryText").val($selectedOption.text());
				$('.js-changeofownership-form').find('.form-control').not('.js-coo-reason').val("");
				$('.js-coo-phone-container, .js-coo-effective-dt-container').removeClass("hide").removeAttr('aria-hidden');
				$('.js-changeofownershipFooter').find('.js-faq-inquiry-footer').removeClass("hide").removeAttr('aria-hidden');
				$(".js-coo-submit-btn").addClass('disabled').attr("aria-disabled","true");

			}

			ACC.global.footerAlignment();
		});
	},
	menuAccordian: function(){
		$('.js-accordianMenu').find('li').find('a').click(function(e){
			e.preventDefault();
			
			if($(this).closest('li').hasClass('js-submenu')){
				$('.js-submenu').removeClass('active');
			}else{
				$(this).closest('li').siblings().removeClass('active');
			}
			$(this).closest('li').toggleClass('active');
			
			var codesValues = $(this).data('codes');
			var contentId = $(this).data('content');
			
			$('.js-faq-customerInquiry-content').find('.js-customerInquiry-body').html(''); //empty container
			
			if(contentId) {
				ACC.customerInquiry.faqLeftNavActionStatic(contentId);
			}
			if(codesValues){
				var codes= JSON.parse(codesValues);
				ACC.customerInquiry.faqLeftNavActionAjax(codes);
			}
			ACC.global.footerAlignment();
		});
		
	},
	
	faqLeftNavigation: function(){
		var data = '';
		try {
			data = JSON.parse($('.js-faqJsonMenu').text());
	    } catch (e) {
	        return false;
	    }
	    
		var menuList = $("<ul></ul>");
		menuList.attr("class", "js-accordianMenu");
        $.each(data, function (i, value) {
        	var listItem = $("<li></li>");
        	var link = $("<a/>");
        	link.text(value.name);
        	link.attr('href', 'javascript:void(0)');
        	link.attr('aria-expanded', false);
        	link.addClass('js-primaryLink');
        	listItem.append(link);
        	
        	if(value.submenu){
        		var submenuList = $("<ul></ul>");
        		$.each(value.submenu, function (t, submenu) {
            		var sublistItem = $("<li></li>");
            		sublistItem.attr("class", "js-submenu");
                	var sublink = $("<a/>");
                	sublink.attr('href', 'javascript:void(0)');
                	if(submenu.codes){
                		var codes = JSON.stringify(submenu.codes);
                		sublink.data('codes', codes);
                	}
                	if(submenu.content){
                		sublink.data('content', submenu.content);
                	}
                	sublink.text(submenu.name);
                	sublistItem.append(sublink);
                	submenuList.append(sublistItem);
                	listItem.append(submenuList);
            	});
        	}
        	menuList.append(listItem);
        	$('.js-faq-left-navigation').append(menuList);
       	});
        ACC.customerInquiry.menuAccordian();
        //keep first menu open by default
        $('.js-accordianMenu>li:first-child').addClass('active');
        $('.js-accordianMenu>li:first-child > a').attr('aria-expanded', true);
        $('.js-accordianMenu>li:first-child > ul > li:first-child ').find('a').click().focus();
        
	},
	
	faqLeftNavActionStatic: function(contentId){
		$('.faq-right').find('.content').css('display','none');
		$('.js-faq-cms-links').find(contentId).closest('.content').show();
		$('.js-faq-cms-links').find(contentId).closest('.content').find('h4').attr('tabindex',0).focus();
		$('.js-faq-cms-links').find(contentId).find('a[data-toggle="collapse"]').find("span").attr("aria-hidden", false);
		ACC.global.footerAlignment();
	},
	
	disableOptionforMobile: function(){
		if(ACC.browserDetect.isiOS()){
			$('.faq-right').find('option[hidden]').attr({'disabled': true, "aria-disabled":true});
			$('.customer-inquiry-modal').find('option[hidden]').attr({'disabled': true, "aria-disabled":true});
		}else{
			$('.faq-right').find('option[hidden]').removeAttr('disabled').attr("aria-disabled","false");
			$('.customer-inquiry-modal').find('option[hidden]').removeAttr('disabled').attr("aria-disabled","false");
		}
	},
	
	faqLeftNavActionAjax: function(codes) {
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
			type: "POST",
	        data: {"faqOptions":codes},
	        dataType: "json",
    		traditional: true,
			url : ACC.config.encodedContextPath + "/inquiry/renderFaqOptions",
			success : function(rsp) {
				if (typeof (rsp) === "object" && rsp.hasOwnProperty("faqOptionsBody")) 
				{
					//setting dynamic inquiry contents now
					var data = rsp.faqOptionsBody;
					var inquiryFaq = $('.js-faq-customerInquiry-content');
					$.each(data, function(i, value) {
						inquiryFaq.find('.js-customerInquiry-body').append(
								value.formBody).append(value.formFooter);
					});
					$(".js-faq-customerInquiry-content").removeClass("hide").removeAttr('aria-hidden');
					ACC.customerInquiry.effectiveDateCalendar();
					ACC.customerInquiry.maskPhoneNo();
					ACC.customerInquiry.disableOptionforMobile();
					ACC.customerInquiry.onlyAllowNumber('.js-prc-sku');
				}
			},
			complete : function() {
				ACC.global.displaySpinner($("#commonSpinner"), false);
				ACC.global.footerAlignment();
			}
    	});
	},
	
	faqBindInquiryPageEvents: function() {
		
		ACC.customerInquiry.faqPricingInquiry();
		ACC.customerInquiry.faqInventoryInquiry();
		ACC.customerInquiry.faqProductGroupUpdate();
		ACC.customerInquiry.faqCloseOnlineInquiry();
		ACC.customerInquiry.faqChangeOfOwnershipInquiry();

		//business name update from FAQ page
		$(document).on("click", ".js-bnu-issue", function(){
			var el = $(this);
			$('.js-faq-inquiry-body:not(.js-businessNameUpdateBody .js-faq-inquiry-body), .js-faq-inquiry-footer:not(.js-businessNameUpdateFooter .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$('.js-businessNameUpdateBody').find('.js-faq-inquiry-body').toggleClass("hide");
			if($('.js-businessNameUpdateBody').find('.js-faq-inquiry-body').hasClass("hide")){
				$('.js-businessNameUpdateBody').find('.js-faq-inquiry-body').attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-businessNameUpdateBody').find('.js-faq-inquiry-body').removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.js-businessNameUpdateFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass('active');
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			
			ACC.customerInquiry.bnuValidate();
			ACC.customerInquiry.enableButton($(".js-bnu-form"),$(".js-bnu-update-btn"));
			
		});
		ACC.customerInquiry.bnuReasonChange();
		//delivery address update from FAQ page
		$(document).on("click", ".js-dau-issue", function(){
			var el = $(this);
			$('.js-faq-inquiry-body:not(.js-deliveryAddressUpdateBody .js-faq-inquiry-body), .js-faq-inquiry-footer:not(.js-deliveryAddressUpdateFooter .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$('.js-deliveryAddressUpdateBody').find('.js-faq-inquiry-body').toggleClass("hide");
			if($('.js-deliveryAddressUpdateBody').find('.js-faq-inquiry-body').hasClass("hide")){
				$('.js-deliveryAddressUpdateBody').find('.js-faq-inquiry-body').attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-deliveryAddressUpdateBody').find('.js-faq-inquiry-body').removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$('.js-deliveryAddressUpdateFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			ACC.customerInquiry.dauValidate();
			ACC.customerInquiry.enableButton($(".js-dau-form"),$(".js-dau-update-btn"));
		});
		ACC.customerInquiry.dauReasonChange();
		
		//delivery schedule update from FAQ page
		$(document).on("click", ".js-dsu-issue", function(){
			var el = $(this);
			$('.js-faq-inquiry-body:not(.js-deliveryScheduleUpdateBody .js-faq-inquiry-body), .js-faq-inquiry-footer:not(.js-deliveryScheduleUpdateFooter .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$('.js-deliveryScheduleUpdateBody').find('.js-faq-inquiry-body').toggleClass("hide");
			if($('.js-deliveryScheduleUpdateBody').find('.js-faq-inquiry-body').hasClass("hide")){
				$('.js-deliveryScheduleUpdateBody').find('.js-faq-inquiry-body').attr('aria-hidden',true);
				el.attr('aria-expanded',false);
			}else{
				$('.js-deliveryScheduleUpdateBody').find('.js-faq-inquiry-body').removeAttr('aria-hidden');
				el.attr('aria-expanded',true);
			}
			$(".js-deliverySchedule-form").find("div[class^='js-dsu-subDiv-']").addClass("hide").attr('aria-hidden',true);
			$('.js-deliveryScheduleUpdateFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);	
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			$(".js-deliverySchedule-form").find(".js-deliverySchedule-comments").addClass("hide").attr('aria-hidden',true);
			$(".js-dsu-submit-btn").addClass("hide").attr('aria-hidden',true);
			$(".js-prc-product-container").empty();
			ACC.customerInquiry.resetFaqCustomerInquirySection();
			ACC.validateForm.deliveryScheduleForm();
			ACC.customerInquiry.deliveryScheduleUpdate();
			ACC.customerInquiry.enableButton($(".js-deliverySchedule-form"),$(".js-dsu-inquiry-btn"));
		});
		
		
		
		
	},
	
	
	// delivery Schedule Update from modal windows
	deliveryScheduleUpdate: function(){		
		$(document).on("click", ".js-deliveryScheduleUpdate", function() {
			ACC.customerInquiry.deliveryScheduleUpdateAjax();
		});		
		
		$(document).on("change", ".js-dsu-prefDeliveryDay , .js-dsu-dayToRemove", function(){
			var day = $(this).val();
			$('#dsu-reqDeliveryDay').val(day);
		});
		
		$(document).on("change", ".js-dsu-dayToKeep", function(){
			var day = $(this).val();
			$('#dsu-dayToKeep').val(day);
		});
		
		$(document).on("change", ".js-dsu-requestedFrequency", function(){
			var day = $(this).val();
			$('#dsu-requestedFrequency').val(day);
		});
		
		$(document).on("change", ".js-dsu-effectiveDate", function(){
			var day = $(this).val();
			$('#dsu-effectiveDate').val(day);
		});
		
		$(document).on("change", ".js-dsu-updateReason", function(){
			var form = $(".js-deliverySchedule-form");
			var comment = form.find(".js-deliverySchedule-comments");
			form.find('.form-control:not(select.js-dsu-updateReason,.js-dsu-currentFrequency)').removeClass('error').val("");
			form.find('em.error').remove();
			$('.js-dsu-inquiry-btn').addClass('disabled').attr("aria-disabled","true");
			form.find('.message-box').addClass("hide").attr('aria-hidden',true);
			if($(this).val() === '') {
				form.find("div[class^='js-dsu-subDiv-']").addClass("hide").attr('aria-hidden',true);
				$('.js-deliveryScheduleUpdateFooter').find('.js-faq-inquiry-footer').addClass("hide").attr('aria-hidden',true);	
				comment.addClass("hide").attr('aria-hidden',true);
				$(".js-dsu-submit-btn").addClass("hide").attr('aria-hidden',true);
				$(".js-prc-product-container").empty();
			} 
			else {
				var subindex = $(this).find("option:selected").data('subindex');
				var subreason = form.find(".js-dsu-subreason-" + subindex);
				var subdiv = form.find(".js-dsu-subDiv-" + subindex);
				form.find("div[class^='js-dsu-subreason-']").addClass("hide").attr('aria-hidden',true);
				form.find("div[class^='js-dsu-subDiv-']").addClass("hide").attr('aria-hidden',true);
				if( subreason.length > 0 ) {
					subreason.removeClass("hide").attr('aria-hidden',false);
				} 				
				if( subdiv.length > 0 ) {
					subdiv.removeClass("hide").attr('aria-hidden',false);
				}
				
				if($(this).val() === $('.js-multipleDeliveryDay').text().trim()){
					$('.js-deliverySchedule-comments label .font12').removeClass("hide").attr('aria-hidden',false);
				}else{
					$('.js-deliverySchedule-comments label .font12').addClass("hide").attr('aria-hidden',true);
				}
				comment.removeClass("hide").removeAttr('aria-hidden');
				$(".js-dsu-submit-btn").removeClass("hide").attr('aria-hidden',false);
				$('.js-deliveryScheduleUpdateFooter').find('.js-faq-inquiry-footer').removeClass("hide").removeAttr('aria-hidden');
				$(".js-dsu-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
			}
			ACC.global.footerAlignment();
		});
	},
	
	deliveryScheduleUpdateAjax: function(){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
			url: ACC.config.encodedContextPath + "/inquiry/updatedeliveryschedule", 
			method: "GET",
    		success: function(rsp){
    			if( typeof(rsp) === "object" && rsp.hasOwnProperty("deliveryScheduleUpdateFormBody") ){
    				var modal = $('.customer-inquiry-modal.cem');
    				modal.find('.modal-title').text(rsp.deliveryScheduleUpdateFormTitle);
    				modal.find('.modal-body').html(rsp.deliveryScheduleUpdateFormBody);
    				modal.find('.modal-footer').html(rsp.deliveryScheduleUpdateFormFooter);
    				modal.modal("show");
    				ACC.customerInquiry.dsuSuccessAjax(modal);
    				ACC.customerInquiry.effectiveDateCalendar();
    			}
            },
            complete: function(){
				ACC.global.displaySpinner($("#commonSpinner"), false);
            }
    	});
	},
	
	dsuSuccessAjax: function(modal){
		if( modal.length > 0 ){
			/*Display Modal*/
			modal.on('shown.bs.modal', function () {
				modal.find(".js-first-focus").focus();
				ACC.global.modalAccessibility( modal, modal.find(".close"),  modal.find(".js-last-focus"));
				ACC.validateForm.deliveryScheduleForm();
				ACC.customerInquiry.enableButton($(".js-deliverySchedule-form"),$(".js-dsu-inquiry-btn"));
				ACC.customerInquiry.disableOptionforMobile();
			});
			
		}
	},
	
	deliveryScheduleUpdateFormSubmit: function(form){
		
		ACC.global.displaySpinner($("#commonSpinner"), true);
			$.ajax({
		        type: "POST",
		        url: form.action,
		        data: $(form).serialize(),
		        success: function (rsp) {
		        	if(rsp === 'Success') {
		        		if($('#dsu_updateReason').find("option:selected").data('subindex') === 2){
		        			$(document).find(".js-success-frequency-msg").removeClass("hide").removeAttr('aria-hidden');
		        		}else{
		        			$(document).find(".js-success-msg").removeClass("hide").removeAttr('aria-hidden');
		        		}
		        		
		        	} else if(rsp === 'Error') {
		        		
		        		$(document).find(".js-error-msg").removeClass("hide").removeAttr('aria-hidden');
		        	}else {
		        		$(document).find(".js-duplicate-dsu-msg").removeClass("hide").removeAttr('aria-hidden');
		        	}
		        },
		        error: function() {
		        	$(document).find(".js-error-msg").removeClass("hide").removeAttr('aria-hidden');
		        },
		        complete: function() {
		        	$('.js-dsu-inquiry-btn').addClass("disabled").attr("aria-disabled","true");
		        	ACC.global.displaySpinner($("#commonSpinner"), false);
		        	ACC.global.footerAlignment();
		        }
			});
			return false;
	},
	
	displayLocalDate: function($el, type){
		var dateValue = $el.data("value");
		var format = type === "update" ? 'M/D/YYYY h:mm A z' : 'M/D/YYYY';
		if( dateValue.length > 0 ){
			var formattedCutoffDate = ACC.cutOffTime.convertUTCtoLocalTime(dateValue, format);
			$el.text(formattedCutoffDate);
		}
	},
	
	getInquiryDetails:function(){
		$('.js-requestHistoryTable').dataTable({
			"searching": false,
			"lengthChange": false,
			"info": false,
			"autoWidth": false,
			order: [[ 0, 'desc' ]],
			"drawCallback": function() {
				$('.js-requestHistoryTable').find('tbody').find('tr').each(function(){
					var id=$(this).find('.js-comment').attr('id');
					$(this).after('<tr class="hide js-comment-container_'+id+'" aria-hidden="true"><td colspan="6" class="no-space-left no-space-right"></td></tr>');
					
					var html='<div class="commentSection js-commentSection col-sm-12 no-space">'+
					'<div class="row">'+$('.js-comment-cont_'+id).html()+'</div></div>';
					
					$('.js-comment-container_'+id).find('td').html(html);
					var placeholder = $('.js-comment-container_'+id).find('td').find('.js-comment-textarea').data("placeholder");
					$('.js-comment-container_'+id).find('td').find('.js-comment-textarea').attr('placeholder',placeholder);
					
					var updatedDateCol = $(this).find(".js-update-date");
					ACC.customerInquiry.displayLocalDate(updatedDateCol, "update");
					
					var createdDateCol = $(this).find(".js-create-date");
					ACC.customerInquiry.displayLocalDate(createdDateCol, "create");
				});
				$('.js-comment').find('.fa.open').removeClass('open');
    		    }
		});
		
		$(document).on("click", ".js-comment", function(){
			var inquiryId=$(this).attr('id');
			if(inquiryId==null){
				inquiryId="";
			}
			
			var $parentRow = $(this).closest("tr");
			var ticketId = $parentRow.find(".js-inquiry-ticketId").val();
			
			var open = $(this).find('.fa').hasClass('open');
			
			$('.js-comment-container_'+ inquiryId).addClass("hide").attr('aria-hidden',true);
			$(".js-comment").attr("aria-expanded",false).find(".fa").removeClass("open");
			if(open){
				$(this).attr('aria-expanded',false).find('.fa').removeClass("open");
				$parentRow.next('.js-comment-container_'+ inquiryId).addClass("hide").attr('aria-hidden',true);
			}else{
				$(this).attr('aria-expanded',true).find('.fa').addClass("open");
				$parentRow.next('.js-comment-container_'+ inquiryId).removeClass("hide").removeAttr('aria-hidden');
				
				ACC.customerInquiry.populateInquiryTable(inquiryId,ticketId);
			}
			
			$(".js-error-inquiry-msg").addClass("hide").attr('aria-hidden',true);
			ACC.global.footerAlignment();
			
		});
		
		
		$(document).on("keyup", ".js-comment-textarea", function(){
			if($(this).val().trim().length < 1){
				$(this).closest('.row').find('.error.mandatory').removeClass("hide").removeAttr('aria-hidden');
				$(this).closest('.row').find('.error.maximum').addClass("hide").attr('aria-hidden',true);
				$(this).closest('.row').find('.js-submitComment').addClass('disabled').attr("aria-disabled","true");
			}else if($(this).val().trim().length > 255){
				$(this).closest('.row').find('.error.maximum').removeClass("hide").removeAttr('aria-hidden');
				$(this).closest('.row').find('.error.mandatory').addClass("hide").attr('aria-hidden',true);
				$(this).closest('.row').find('.js-submitComment').removeClass('disabled').attr("aria-disabled","false");
			}else{
				$(this).closest('.row').find('.error.maximum').addClass("hide").attr('aria-hidden',true);
				$(this).closest('.row').find('.error.mandatory').addClass("hide").attr('aria-hidden',true);
				$(this).closest('.row').find('.js-submitComment').removeClass('disabled').attr("aria-disabled","false");
			}
			
			$(".js-error-inquiry-msg").addClass("hide").attr('aria-hidden',true);
		});
	},
	populateInquiryTable:  function(inquiryId, ticketId){
		$("#commonSpinner").css("z-index", "2000");
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
	        type: "GET",
	        url: ACC.config.encodedContextPath + "/inquiry/getInquiryDetails?inquiryId="+inquiryId+"&ticketId="+ticketId,
	        success: function (inquiryDetails) {
	        	if(null!=inquiryDetails){
	        		var commentList=inquiryDetails.customerInquiryComments;
	        			if(null!=commentList){
	        				$('.js-comment-container_'+inquiryId).find('td').find('.comment').remove();	
	        			$.each(commentList, function(k,value){
	        				var updatedDate = (value.lastUpdatedDate!= null)? ACC.cutOffTime.convertUTCtoLocalTime(value.lastUpdatedDate, 'M/D/YYYY h:mm A z'): "";
	        				var createdByName = (value.createdByName != null)? value.createdByName : "";
	        				var commentHtml = '<div class="comment col-xs-12">'+
			        					'<div class="row no-margin"><div class="commentHeader col-xxs-6 col-sm-9 col-md-9 no-space text-bold" >'+ createdByName +'</div><div class="commentDate col-xxs-6 col-sm-3 col-md-3 no-space text-bold font12 text-right" >'+ updatedDate +'</div></div>'+
			        					'<div class="row no-margin comment-wrapper">'+
			        						'<div class="commentContent col-sm-12 col-md-9 no-space" >'+ value.comment +
			        						'</div>'+
			        					'</div>'+
			        				'</div>';
	        				$('.js-comment-container_'+inquiryId).find('td').append(commentHtml);
	        				
	        			});
	        		}
	        	}
	        },
	        complete: function(){
	        	ACC.global.displaySpinner($("#commonSpinner"), false);
	        	ACC.global.footerAlignment();
	        }
		});
	},
	addComment:function(){
		$(document).on("click", ".js-submitComment", function(){
			var inquiryId= $(this).closest(".js-commentSection").find("textarea").data("inquiryid");
			var comment=$(this).closest(".js-commentSection").find("textarea").val();
			var ticketId = ($(this).closest("tr").prev("tr").find(".js-inquiry-ticketId").val() != "null") ? $(this).closest("tr").prev("tr").find(".js-inquiry-ticketId").val() : "";
			if(comment.length > 255){
				$(this).closest('.row').find('.error.maximum').removeClass("hide").removeAttr('aria-hidden');
				return false;
			}
			$(this).closest('.row').find('.error').addClass("hide").attr('aria-hidden',true);
			var btn = $(this);
			$("#commonSpinner").css("z-index", "2000");
			ACC.global.displaySpinner($("#commonSpinner"), true);
			$.ajax({
		        type: "POST",
		        url: ACC.config.encodedContextPath + "/inquiry/postComment",
		        data:{inquiryId:inquiryId,comment:comment},
		        
		        success: function (response) {
		        	if (response === 'Success'){
		        		ACC.customerInquiry.populateInquiryTable(inquiryId,ticketId);
		        		$('.js-comment-textarea').val("");
		        	}else{
		        		$(".js-error-inquiry-msg").removeClass("hide").removeAttr('aria-hidden');
		        		$('.js-comment-textarea').val("");
		        	}
		        },
		        error: function(){
		        	$(".js-error-inquiry-msg").removeClass("hide").removeAttr('aria-hidden');
		        },
		        complete: function(){
		        	ACC.global.displaySpinner($("#commonSpinner"), false);
		        	ACC.global.footerAlignment();
		        	btn.addClass('disabled').attr("aria-disabled","true");
		        }
			});
		});
		
	}
	
}

//################################################################
//#### Customer Inquiry Extend
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.customerInquiryExtend={
	_autoload: [   		
		"init"
	],
	
	init : function() {
		ACC.customerInquiryExtend.fulfilment();
		ACC.customerInquiryExtend.dsuAddressUpdate();
	},
	fffulfilmentvalidation: null,
	
	fulfilment: function(){
		$(document).on("click", "[class*='js-firstFocus-ff-issue-']", function(){
			var index = $(this).data("index");
			
			$('.js-faq-inquiry-body:not(.js-FirstFocus-FF-Body .js-faq-inquiry-body), .js-faq-inquiry-footer:not(.js-FirstFocus-FF-Body .js-faq-inquiry-footer)').addClass("hide").attr('aria-hidden',true);
			$(".js-firstfocus-ff-body").not(".js-form-body-"+index).addClass("hide").attr('aria-hidden',true);
			$(".js-firstfocus-ff-body").filter(".js-form-body-"+index).toggleClass("hide");
			if($(".js-firstfocus-ff-body").filter(".js-form-body-"+index).hasClass("hide")){
				$(".js-firstfocus-ff-body").filter(".js-form-body-"+index).addClass("hide").attr('aria-hidden',true);
			}else{
				$(".js-firstfocus-ff-body").filter(".js-form-body-"+index).attr('aria-hidden',false);
			}
			$('.js-firstFocus-subDiv').addClass("hide").attr('aria-hidden',true);
			$('.js-firstFocus-comments').addClass("hide").attr('aria-hidden',true);
			$(".js-firstfocus-footer").addClass("hide").attr('aria-hidden',true);
			$("[class^='js-ff-subdiv-']").addClass("hide").attr('aria-hidden',true);
			$(".js-firstfocus-ff-form")[0].reset();
			$(".js-ff-inquiry-btn").addClass('disabled').attr("aria-disabled","true");
			$(".js-firstfocus-ff-form").find('.form-control').removeClass('error');
			$(".js-firstfocus-ff-form").find('.error').remove();
			$('.faqLinks').not($(this)).removeClass('active');
			$(this).toggleClass("active");
			ACC.customerInquiryExtend.ffDatepicker();
			$('.js-firstfocus-ff-form').find(".ui-datepicker-trigger").addClass("effectivedate").attr({"aria-label":"calendar icon", "aria-expanded":"false"});
			ACC.customerInquiryExtend.ffValidation();
			$('.js-firstFocus-ff-issue').val($("[class*='js-firstFocus-ff-issue-']").filter('.active').data('value'));
			ACC.customerInquiry.enableButton($(".js-firstfocus-ff-form"),$(".js-firstfocus-ff-body").find(".js-ff-inquiry-btn"));
			ACC.global.footerAlignment();
		});
		
		$(document).on("change", ".js-firstFocusReason", function(){
			var form = $(this).closest(".js-firstfocus-ff-form");
			if($(this).val() === '') {
				$(this).closest('.js-firstfocus-ff-body').find('.js-firstFocus-subDiv').addClass("hide").attr('aria-hidden',true);
				$('.js-firstFocus-comments').addClass("hide").attr('aria-hidden',true);
				$(".js-firstfocus-footer").addClass("hide").attr('aria-hidden',true);
				form.find("[class^='js-ff-subdiv-']").addClass("hide").attr('aria-hidden',true);
				form.find(".js-ff-Com-Channel-hidden").val("");
			}else{
				$('.js-firstfocus-ff-form').find('.form-control').not('.js-firstFocusReason').val('');
				$('.js-firstfocus-ff-form').find('.form-control').removeClass('error');
				$('.js-firstfocus-ff-form').find('em.error').remove();
				
				var selectedOption = $(this).find("option:selected");
				var subindex = selectedOption.data('subindex');
				form.find(".js-ff-Com-Channel-hidden").val( selectedOption.text() );
				
				var subdiv = form.find(".js-ff-subdiv-" + subindex);
				form.find("[class^='js-ff-subdiv-']").addClass("hide").attr('aria-hidden',true);
				form.find("[class^='js-ff-subdiv-']").find('.form-control').val('');
				if( subdiv.length > 0 ) {
					subdiv.removeClass("hide").attr('aria-hidden',false);
				}
				
				$(this).closest('.js-firstfocus-ff-body').find('.js-firstFocus-subDiv').removeClass("hide").attr('aria-hidden',false);
				$(this).closest('.js-firstfocus-ff-body').find('.js-firstFocus-comments').removeClass("hide").attr('aria-hidden',false);
				$(this).closest('.js-firstfocus-ff-body').find(".js-firstfocus-footer").removeClass("hide").attr('aria-hidden',false);
				$(this).closest('.js-firstfocus-ff-body').find(".js-firstfocus-footer").find('.js-closeAcc-submit-btn').removeClass("hide").attr('aria-hidden',false);
				
				$('.js-ff-Reason-hidden').val($(this).val());
				$(this).closest(".js-firstfocus-ff-body").find(".js-ff-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
					
			}
			ACC.global.footerAlignment();
		});
		
		
		$(document).on("click", ".js-ff-inquiry-btn", function(){
			if($(this).closest('.customer-inquiry-modal').length > 0){
				$(this).closest('.customer-inquiry-modal').find('form').submit();
			}else{
				$(this).closest('form').submit();
			}
			
		});
		
		$(document).on("change", ".js-ff-comment", function(){
			$('.js-firstFocus-ff-comments').val($(this).val());
		});
		
		$(document).on("change", ".js-expectedFreeCase", function(){
			$('.js-firstFocus-ff-expectedFreeCase').val($(this).val());
		});
		
		$(document).on("change", ".js-expectedPromotionalItem", function(){
			$('.js-firstFocus-ff-expectedPromotionalItem').val($(this).val());
		});
		
	},
	
	ffDatepicker: function(){
		if($( ".js-ff-dateOfDelivery" ).length > 0){
			$(".js-ff-dateOfDelivery").each(function(){
				var x = $(this).data('index');
				$("#deliveryDate"+x).datepicker({
					dateFormat: ACC.datepickerFormat,
					showOn: "button",
					buttonText: "",
					maxDate: -1,
			          onSelect:  function() {
			        	  $("#deliveryDate"+x).change();
			        	  ACC.customerInquiryExtend.fffulfilmentvalidation.element("#deliveryDate"+x);
			        	  $(".js-firstFocus-ff-deliveryDate").val($("#deliveryDate"+x).val());
			 	       },
			 	      onClose:function(){
			 	    	 $("#deliveryDate"+x).next('.ui-datepicker-trigger').next('.error').removeClass('hide');
			 	    	 $("#deliveryDate"+x).removeClass('overrideValidation');
				 	  } 
		        });
				ACC.deliveryDate.accessibility($("#deliveryDate"+x));
				$(".ui-datepicker-trigger").attr({"aria-label":"calendar icon", "aria-expanded":"false"});
			});
		}
	},
	
	ffAjaxFormSubmit: function(form){
			$("#commonSpinner").css("z-index", "2000");
			ACC.global.displaySpinner($("#commonSpinner"), true);
			$.ajax({
		        type: "POST",
		        url: form.action,
		        data: $(form).serialize(),
		        success: function (rsp) {
		        	if(rsp === 'Success') {
			        	$(".js-ff-success-msg").removeClass("hide").attr('aria-hidden',false);
		        	} else if(rsp === 'Error') {
		        		$(".js-ff-error-msg").removeClass("hide").attr('aria-hidden',false);
		        	} else {
		        		$(".js-ff-warning-msg").removeClass("hide").attr('aria-hidden',false);
		        	}
		        },
		        error: function(){
		        	$(".js-ff-error-msg").removeClass("hide").attr('aria-hidden',false);
		        },
		        complete: function(){
		        	$(".js-ff-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
		        	ACC.global.displaySpinner($("#commonSpinner"), false);
		        	ACC.global.footerAlignment();
		        }
			});
			return false;
	},
	
	ffValidationRules: function(){
		return {
				"firstFocusReason":{
					required:true
				},
				"js-expectedFreeCase":{
					required:true,
					maxlength: 50
				},
				"js-expectedPromotionalItem":{
					required:true,
					maxlength: 50
				},
				"js-deliveryDate":{
					required:true
				},
				"comment":{
					required:true,
					maxlength: 255
				},
				//extra
				"name":{
					required:true,
					maxlength: 50
				},
				"address":{
					required:true,
					maxlength: 50
				},
				"city":{
					required:true,
					maxlength: 50
				},
				"state":{
					required:true
				},
				"zip":{
					required:true,
					maxlength: 5,
					number: true
				}
			};
			},
	
	ffValidationMessages: function(){
		return {
				"firstFocusReason":{
					required: $('.js-fff-firstFocusReason-req-error-msg').text().trim()
				},
				"js-expectedFreeCase":{
					required: $('.js-fff-expectedFreeCase-req-error-msg').text().trim(),
					maxlength: $('.js-fff-expectedFreeCase-max-error-msg').text().trim()
				},
				"js-expectedPromotionalItem":{
					required: $('.js-fff-expectedPromotionalItem-req-error-msg').text().trim(),
					maxlength: $('.js-fff-expectedPromotionalItem-max-error-msg').text().trim()
				},
				"js-deliveryDate":{
					required: $('.js-fff-deliveryDate-req-error-msg').text().trim()
				},
				"comment":{
					required: $('.js-fff-comment-req-error-msg').text().trim(),
					maxlength: $('.js-fff-comment-max-error-msg').text().trim()
				},
				//extra
				"name":{
				required: $('.js-fff-name-req-error-msg').text().trim(),
				maxlength: $('.js-fff-name-max-error-msg').text().trim()
				},
				"address":{
					required: $('.js-fff-address-req-error-msg').text().trim(),
					maxlength: $('.js-fff-address-max-error-msg').text().trim()
				},
				"city":{
					required: $('.js-fff-city-req-error-msg').text().trim(),
					maxlength: $('.js-fff-city-max-error-msg').text().trim()
				},
				"state":{
					required: $('.js-fff-state-req-error-msg').text().trim()
				},
				"zip":{
					required: $('.js-fff-zip-req-error-msg').text().trim(),
					number: $('.js-fff-zip-number-error-msg').text().trim(),
					maxlength: $('.js-fff-zip-max-error-msg').text().trim()
				}
		};
			},
	
	ffValidation: function(){
		
		ACC.customerInquiryExtend.fffulfilmentvalidation = $('.js-firstfocus-ff-form').validate({
			onfocusout: function(element) {
                this.element(element);
             },
			errorElement: "em",
			rules: ACC.customerInquiryExtend.ffValidationRules(),
			messages: ACC.customerInquiryExtend.ffValidationMessages(),
			errorPlacement : function(error, element) {
				if(element.hasClass('hasDatepicker')){
					error.insertAfter(element.next('.ui-datepicker-trigger'));
					element.next('.ui-datepicker-trigger').next('.error').addClass('hide');
					element.addClass('overrideValidation');
				}else{
					error.insertAfter(element);
				}
				error.attr('id',$(element).attr('id')+'_label');
				element.attr('aria-describedby',$(element).attr('id')+'_label');
			},
			submitHandler: function(form) {
				return ACC.customerInquiryExtend.ffAjaxFormSubmit(form);
	    	}
	    });
		$('.js-firstfocus-ff-form').find('[name="firstFocusReason"],[name="js-expectedFreeCase"],[name="js-expectedPromotionalItem"],[name="comment"],[name="js-deliveryDate"]').data('required', true);
		$('.js-firstfocus-ff-form').find('[name="name"],[name="address"],[name="city"],[name="state"],[name="zip"]').data('required', true);
		$('.js-firstfocus-ff-form').find('[name="address"],[name="city"],[name="js-expectedFreeCase"],[name="js-expectedPromotionalItem"]').attr('maxlength', 50);
		$('.js-firstfocus-ff-form').find('[name="zip"]').attr('maxlength', 5);
		$('.js-firstfocus-ff-form').find('.js-ff-comment').attr('maxlength', 255);
		$('.js-firstfocus-ff-form').find('.jsfreeCase').attr('maxlength', 150);
	},

/*ship to address update*/
	
	dsuAddressUpdate: function(){
		$(document).on("click", ".js-upd-ds-address", function(){
			ACC.customerInquiryExtend.dsuAddressUpdateAjax();
		});
	},
	
	dsuAddressUpdateAjax: function(){
		ACC.global.displaySpinner($("#commonSpinner"), true);
		$.ajax({
			url: ACC.config.encodedContextPath + "/inquiry/firstFocusFulfillment", 
			method: "GET",
    		success: function(rsp){
    			if( typeof(rsp) === "object" && rsp.hasOwnProperty("firstFocusFulfillmentFormBody") ){
    				var modal = $('.cem.customer-inquiry-modal');
    				modal.find('.modal-title').text(rsp.firstFocusFulfillmentFormTitle);
    				modal.find('.modal-body').html(rsp.firstFocusFulfillmentFormBody);
    				modal.find('.modal-footer').html(rsp.firstFocusFulfillmentFormFooter);
    				modal.modal("show");
    				ACC.customerInquiryExtend.fffSuccessAjax(modal);
    				ACC.customerInquiryExtend.ffValidation();
    				modal.find(".js-firstfocus-ff-body").find(".js-ff-inquiry-btn").addClass("disabled").attr("aria-disabled","true");
    			}
            },
            complete: function(){
				ACC.global.displaySpinner($("#commonSpinner"), false);
            }
    	});
	},
	
	fffSuccessAjax: function(modal){
		if( modal.length > 0 ){
			modal.on('shown.bs.modal', function () {
				modal.find(".js-first-focus").focus();
				ACC.global.modalAccessibility( modal, modal.find(".close"),  modal.find(".js-last-focus"));
				ACC.customerInquiry.enableButton($('.js-usa-Body').find(".js-firstfocus-ff-form"),$('.js-usa-Footer').find(".js-ff-inquiry-btn"));
				ACC.customerInquiry.disableOptionforMobile();
			});


		}
	}
	
}

ACC.register = {

    _autoload: [
        "authenticateFields",
        "authenticateData",
        "digitsValidation",
        "sessionPageRefresh",
        "emailChange",
        ["displayRegisterForm", $(".js-registration-submit-error").length > 0],
        "init"
    ],
    
    init: function(){
    	ACC.register.handleSubmit();
    },

    getCurrentDateForGA: function(){
    	return moment(new Date()).format('MM/DD/YYYY');
    },
    
    handleSubmit: function(){
    	if( ACC.pageName === "PepsicoSecurePortalRegistrationSuccessPage" && $(".js-RegistrationResult").length > 0 ){
    		var RegistrationResultValue = $(".js-RegistrationResult").val();
    		if( RegistrationResultValue === "SUCCESS" ){
    			var date = ACC.register.getCurrentDateForGA();
        		ACC.track.trackRegistrationInGA(date);
        		
        		var cof = $(".js-gacof").val() ? $(".js-gacof").val() : "NA";
            	var uid = $(".js-gauid").val() ? $(".js-gauid").val() : "NA";
            	var firstLoginDt = $(".js-gafirstLoginDate").val() ? $(".js-gafirstLoginDate").val() : "NA";
            	var registrationDt = $(".js-garegistrationDate").val() ? $(".js-garegistrationDate").val() : "NA";
        		ACC.track.trackLoginSuccessInGA(cof, uid, firstLoginDt, registrationDt);
    		}
    	}
    },
    
    authenticateFields : function(){
       
       $('.autheFields').keypress(function (event) {
    	   if($(this).attr("type") == "number") {
    		   return ACC.register.isNumber(event, this)
    	   }
       });

    	$(".autheFields").on("keyup blur",function(){
    		ACC.register.authentication();
    	});
    	
      
    	$("#additionalOptions .checkbox").on("click",function(){
    		if($('#additionalOptions input[type="checkbox"]').is(':checked')){
            	  var _t=$('#additionalOptions :checkbox:checked').map(function(){
            	    	return $(this).attr("id");
            	    	}).get().join(", ");
            	    	$('#interestedIn').val(_t);
    			$("#personalDetails").show();
    			$(".fillDetails").show();
    			ACC.global.footerAlignment();
		    }
              else {
            	  $("#personalDetails").hide();
            	  $(".fillDetails").hide();
              }
    	});
    },
    
    authentication : function() {
		var allFields = $(".autheFields");
		var flag = 1;
		
		allFields.each(function(){
			flag = flag * $(this).val().length;
		})
		var errFields = $(".required").find("input.error").length;
		
		if(flag > 0 && errFields < 1) {
			$("#authenticate").removeClass("disabled").attr("aria-disabled","false");
		}
		else {
			$("#authenticate").addClass("disabled").attr("aria-disabled","true");
		}
	},
	
    // THE SCRIPT THAT CHECKS IF THE KEY PRESSED IS A NUMERIC OR DECIMAL VALUE.
    isNumber : function(evt, element) {

        var charCode = (evt.which) ? evt.which : event.keyCode;

        if ((charCode != 46 || $(element).val().indexOf('.') != -1) && (charCode < 48 || charCode > 57)) {
        	if(charCode == 8 || charCode == 13)
            	return true;
        	return false;
        }
        return true;
    },    
    
   checkPreference: function(data){
	   $("#registerForm").find(".js-preference-pes").prop({"checked":false, "disabled":false}).removeAttr("checked aria-checked disabled aria-disabled");
	   $("#registerForm").find(".js-preference-online").prop({"checked":false, "disabled":false}).removeAttr("checked aria-checked disabled aria-disabled");
	   $("#registerForm").find(".js-hidden-pesFlag, .js-hidden-marketingFlag, .js-hidden-onlineorderingFlag").attr("disabled", "disabled");
	   if( data.pesEligible && data.pesEligible === "Y" ){
		   $("#registerForm").find(".js-preference-pes").prop({"checked":true, "disabled":true}).attr({"checked":"checked", "aria-checked":true, "disabled":"disabled", "aria-disabled":true});
		   $("#registerForm").find(".js-hidden-pesFlag").removeAttr("disabled").val("true");
	   }
	   if( data.ecommFlag && data.ecommFlag === "Y" ){
		   $("#registerForm").find(".js-preference-online").prop({"checked":true, "disabled":true}).attr({"checked":"checked", "aria-checked":true, "disabled":"disabled", "aria-disabled":true});
		   $("#registerForm").find(".js-hidden-onlineorderingFlag").removeAttr("disabled").val("true");
	   }
	   if( $("[class*='js-preference-']:checked").length > 0 ){
		   ACC.register.displayEntireForm();
		   if( $("#regSubmit").is(":visible") ){
			   $("#regRegister").hide();
		   }
	   }
   },
   
   displayEntireForm: function(){
	   $("#personalDetails").show();
       $(".fillDetails").show();
       if( $("#regRegister").is(":hidden") ){
    	   $("#regSubmit").show();
       }
   },
   
   authenticateAjaxSuccessStatus: function(data){
		$("#authenticate").hide();
		var form = $('#registerForm');
		form.find('input[name=CSRFToken]').val(data.csrfToken);
		$("#companyName").val(data.accountName);
		$("#authenticationStatus").val(data.authenticationStatus);
		$("#accountName").val(data.accountName);
		$("#salesMethod").val(data.salesMethod);
		$("#csrfToken").val(data.csrfToken);
		$("#createCustomer").val(data.isCreateCustomer);
		$("#pesEligible").val(data.pesEligible);
		if (data.message === "success") {
			$("#regAccName").text('"' + data.accountName + '"');
			$(".authResponse").hide();
			$("#successMsg").show();
			$("#processFlow").val(data.processFlow);
			$("#clientAccountId").val(data.clientAccountId);
			$("#ecommFlag").val(data.ecommFlag);
			$("#pesEligible").val(data.pesEligible);
			$(document).find("[id='register.email']").parent().removeClass(
					"has-error");
			$(document).find("[id='register.email']").siblings(".help-block")
					.remove();
			ACC.register.checkPreference(data);
		}

		if (data.message === "AdminExist") {
			$("#failedMsg_adminFound").show();
		}
		if (data.processFlow == 'approval'
				|| data.processFlow == 'highavailability') {
			$("#additionalOptions").show();
			$("#processFlow").val(data.processFlow);
			$("#clientAccountId").val(data.clientAccountId);
			$("#ecommFlag").val(data.ecommFlag);
			if ($("#regSubmit").is(":hidden")) {
				$("#regRegister").show();
			}
		} else {
			ACC.register.displayEntireForm();
		}  
   },
   
    authenticateDataAjaxSuccess: function(data){
		if (data.authenticationStatus) {
			ACC.register.authenticateAjaxSuccessStatus(data);
		} else {
			if (data.processFlow == 'SessionOut') {
				$('#register-timeout').modal('show');
			}
			$(".authResponse").hide();
			$("#authenticate").hide();
			if (data.message === "AccountNotFound") {
				$("#failedMsg_accountNotFound").show();
			} else if (data.message === "AdminExist") {
				$("#failedMsg_adminFound").show();
			}
			var date = ACC.register.getCurrentDateForGA();
			ACC.track.trackRegistrationInGA(date);
		}
    	ACC.global.footerAlignment();
    },
    
    displayRegisterForm: function(){
    	
    	$("#authenticate").hide();   
    	 $("#successMsg").show();
    	 $("#regAccName").text('"'+$("#regAccountName").text()+'"');
    	 ACC.register.fieldChange();
    	var processFlow = $("#processFlow").val();
        if (processFlow == 'approval' || processFlow == 'highavailability')
        {
              $("#additionalOptions").show();
               $("#regRegister").show();
              
        }
      else {
           $("#regSubmit").show();
		}
        $("#personalDetails").show();
        $(".fillDetails").show();
        
        ACC.global.footerAlignment();
    },
    
    authenticateData : function(){
       
       $("#authenticate").on("click",function(){
             if(!$("#authenticate").hasClass("disabled")) {
            	 var accNo = $("#registerAccount").val();
                 var addressZipcode = $("#addressZipCode").val();
                 var deliveryAdd = encodeURIComponent($("#addressBuilding").val());
                 $("#customerRegSpinner").removeClass("display-none");
                 ACC.register.fieldChange();
                 $.ajax({
    	             url: "/register/validate",
    	             data: {"accountNumber":accNo,"addressZipcode":addressZipcode,"addressBuilding":deliveryAdd},
    	             method: "POST",
    	             success: function(data){
    	            	 ACC.register.authenticateDataAjaxSuccess(data);
    	             },
    	             error: function () {
    	            	 var date = ACC.register.getCurrentDateForGA();
    	       			 ACC.track.trackRegistrationInGA(date);
    	            	 location.reload();
    	             },
    	            	 
    	             complete: function(){
    	            	 $("#customerRegSpinner").addClass("display-none");
    	             }
                });
             }
             else {
            	 var allFields = $(".autheFields");
         		
         		allFields.each(function(){
         			$("#registerForm").validate().element(this);
         		})
            	 
            	 return false;
             }
	   		 
    	})
    	
    	
    },
    
    fieldChange: function() {
    	$('.autheFields').each(function() {
			   var elem = $(this);
			   elem.data('oldVal', elem.val());
			   elem.on("propertychange change click keyup input paste", function(){
			      // If value has changed...
			      if (elem.data('oldVal') != elem.val()) {
			    	  	$("#additionalOptions").hide();
	    				$("#personalDetails").hide();
	    				$(".fillDetails").hide();
	    				$("#authenticate").show();
	    				$(".authResponse").hide();
	    				$("em.error").remove();
                              $("#regRegister").hide();
                              $("#regSubmit").hide();
	    				$("#personalDetails input").removeClass("error");
	    				$(':input','#registerForm').not('.autheFields').val('').removeAttr('checked').removeAttr('selected');
	    				ACC.global.footerAlignment();
			     }
		   });
       });
    },
    
    digitsValidation: function() {
    
    	var ele = $(".phoneNo");
    	ACC.register.mobileFormatValidation(ele, 10);
    	
    	$("#addressZipCode").on("keyup change",function (){
    		ACC.register.digitsValidationMethod($(this), 5);
    	});
    	
    	$(".extn").on("keyup change",function (){
    		ACC.register.digitsValidationMethod($(this), 30);
    	});
    },
    
    digitsValidationMethod: function(ele, limit) {
    	if(ele.val().length <= limit) 
			return true;
		else {
			var str = ele.val();
	        str = str.substring(0, limit);
	        ele.val(str);
		}
    },
    
    emailChange: function() {
    	$(document).find("[id='register.email']").on("keyup change",function (){
    		if($(this).parent().hasClass("has-error")){
    			$(this).parent().removeClass("has-error");
    			$(this).siblings(".help-block").remove();
    			$(".js-registration-submit-error").remove();
    		}
    	});
    },
    
    sessionPageRefresh: function(){
    	var timeoutTime = 1800000;
    	var timeoutTimer = setTimeout("$('#register-timeout').modal('show');", timeoutTime);
    	$(document).ready(function() {
    	    $('body').bind('mousedown keydown', function() {
    	        clearTimeout(timeoutTimer);
    	        timeoutTimer = setTimeout("$('#register-timeout').modal('show');", timeoutTime);
    	    });
    	});
    },
    
    reloadPage : function(){
		$('#register-timeout').on('hidden.bs.modal', function () {
			location.reload();
		})
		 
	},
	
	mobileFormatValidation : function(ele, limit){
		ele.on("keyup",function (){
    		ACC.register.digitsValidationMethod($(this), limit);
    		
    	}).on("blur",function(){
    		var ph = $(this).val();
 			$(this).val(ph.replace(/^(\d{3})(\d{3})(\d{4,})+$/, "$1-$2-$3"));
    	}).on("focus",function(){
    		var ph = $(this).val();
 			$(this).val(ph.replace(/[-]/g, ""));
    	});
	}
}
$(window).load(function(){
	//This should be the last statement. Do not write code beyond this line.
	ACC.global.footerAlignment();
});

//################################################################
//#### Custom profile 
//################################################################
var ACC = ACC || {}; // make sure ACC is available
ACC.profileExtend={
	_autoload: [   		
		"init",
		["addNewPref",$("#customerPreferenceForm").length > 0],
		["showPrefModal",$("#customerPreferenceForm").length > 0],
		["switchTabsAfterLoad", $(".page-update-profile").length > 0],
		"syncTabHeights",
		["reminderTimePicker",$("#customerPreferenceForm .timepicker").length > 0],
		"setGroupAccess"
	],
	remFlag : {
		"hasDefault" : false,
		"timeBound"  : false,
		"sTime"		 : "",
		"eTime"		 : ""
	},
	
	init: function(){
		if( $(".js-order-pref-block").length > 0 ){
			ACC.profileExtend.setOrderPreference();
		}
		ACC.profileExtend.showMessagesOnHover();
	},
		
	setOrderPreference: function(){
		ACC.profileExtend.disableEmailField( ACC.accountPrefPartner );
		if( $("#customerPreferenceForm_orderingPreference").length > 0 ){
			$(document).on("click", "#js-ord-pref-pep-partner, #js-ord-pref-cont-center", function(){
				$("#customerPreferenceForm_orderingPreference").val( $(this).val() );
				if( $("#customerPreferenceForm").find(".js-update-bt").length > 0 ){
					$("#customerPreferenceForm").find(".js-update-bt").removeClass("disabled");
				}
			})
		}
	},
	
	disableEmailField: function( prefType ){
		var orderPreference = $(".js-order-pref-form").find(":checked").val();
		var cutOffColTd = $("#customerPreferenceForm").find(".col-header:contains("+ACC.accPrefCutoffReminders+")");
		if( orderPreference && cutOffColTd.length > 0 && orderPreference === prefType ){
			var cutOffRow = cutOffColTd.closest("tr");
			var emailField = cutOffRow.find("[id^=email_]");
			if( emailField.length > 0 ){
				ACC.profileExtend.manageHiddenEmail(orderPreference, emailField);
			}
		}
	},
	
	manageHiddenEmail: function(orderPreference, emailField){
		var hiddenEmail = emailField.closest("div").find(".js-hidden-email");
		var fieldName;
		if( orderPreference === ACC.accountPrefPartner ){
			if( hiddenEmail.length === 0 ){
				fieldName = emailField.attr("name");
				emailField.attr("disabled", "disabled").prop("checked", true).removeAttr("name");
				
				var hiddenElem = $("<input/>").attr("type", "hidden").attr("class", "js-hidden-email").attr("value", "ON");
				if( fieldName ){
					hiddenElem.attr("name", fieldName);
				}
				emailField.closest("div").append( hiddenElem );
			}
		}else if( orderPreference === ACC.accountPrefContact ){
			emailField.removeAttr("disabled").prop("checked", false);
			
			if( hiddenEmail.length > 0 ){
				fieldName = hiddenEmail.attr("name");
				hiddenEmail.remove();
				if( fieldName ){
					emailField.attr("name", fieldName);
				}
			}
		}
	},
	
	setPreferenceValidationMsg: function(){
		var returnVal = true;
		var missingRowNum = 0;
		
		$("#customerPreferenceForm").find("tr:visible[data-checkrequire = 'yes']").each(function(index,element){
			var checkedNum = $(element).find(":checked").length;
			var colHeaderText = $.trim($(element).find(".col-header").text().toLowerCase());
			if( !checkedNum ){
				++missingRowNum;
				returnVal = false;
				$('#manageContactSpinner').addClass("display-none");
				var messageText = ACC.accountPrefMissingRem;
				if( colHeaderText.indexOf("confirmation") >= 0 ){
					messageText = ACC.accountPrefMissingConf;
				}
				$(".js-missingChannel").find(".js-message").text(messageText);
			}
			 
		});
		
		if( missingRowNum === 2 ){
			$(".js-missingChannel").find(".js-message").text(ACC.accountPrefMissingRemConf);
		}
		if( !returnVal ){
			$(".js-missingChannel").removeClass("hide");
			ACC.cartitem.scrollTo($('.js-missingChannel'));
		}
		else {
			var orTime = new Date(ACC.orderReminderDefaultDate + " " + $("[id^='orderRemTime_']").val());
			$("[id^='orderRemTime_']").val(ACC.cutOffTime.convertLocaltoUTC(orTime, "HH:mm:ss"));
			
			$("#customerPreferenceForm").find(".js-orderRemTime").val(ACC.cutOffTime.convertLocaltoUTC(orTime, 'MM/DD/YYYY HH:mm:ss'));
		}
		return returnVal;
	},
	
	showMissingMobileNumberModal: function(){
		var returnValue = true;
		var mobileCheckBoxCheckedNumber = 0;
		var phoneNo = $.trim($("#updateProfileForm_phoneNo").val());
		var $checkedMobileCheckBox;
		$("#customerPreferenceForm").find("tr:visible[id ^= 'row-']").each(function(index,element){
			if( $(element).find(":checked[id^=text_]").length > 0 ){
				++mobileCheckBoxCheckedNumber;
				$checkedMobileCheckBox = $(element).find(":checked[id^=text_]");
			}
		});
		if( mobileCheckBoxCheckedNumber > 0 && phoneNo.length === 0 ){
			ACC.profile.onChangePreferenceCheckbox($checkedMobileCheckBox);
			returnValue = false;
		}
		return returnValue;
	},
	
	validateUpdatePreference: function(){
		var returnVal = true;
		var checkedElem = $(".js-order-pref-form").find(":checked[name=orderPreference]");
		if( checkedElem.length > 0 ){
			if( checkedElem.val() === ACC.accountPrefPartner ){
				returnVal = ACC.profileExtend.setPreferenceValidationMsg();
			}
			else {
				var orTime = new Date(ACC.orderReminderDefaultDate + " " + $("[id^='orderRemTime_']").val());
				$("[id^='orderRemTime_']").val(ACC.cutOffTime.convertLocaltoUTC(orTime, "HH:mm:ss"));
				
				$("#customerPreferenceForm").find(".js-orderRemTime").val(ACC.cutOffTime.convertLocaltoUTC(orTime, 'MM/DD/YYYY HH:mm:ss'));
			}
			if( returnVal ){
				returnVal = ACC.profileExtend.showMissingMobileNumberModal();
			}
		}else{
			returnVal = false;
			$(".js-missingPreference").removeClass("hide");
			ACC.cartitem.scrollTo($('.js-missingPreference'));
		}
		if( !returnVal ){
			$('#manageContactSpinner').addClass("display-none");
		}
		return returnVal;
	},
	showPrefModal: function(){
		var currentTab
		var currentTabBody;
		var customerTabBody;
		var customerTab;
		$(document).on("click", ".tabs-list>li>a" ,function(){
			if(!($('#customerPreferenceForm').find('button[type=submit]').hasClass('disabled'))){
    			 currentTab = $(this).parent('li');
    			 currentTabBody = $(this).attr('href');
				 customerTabBody = $('#customerPreferenceForm').closest('.tabbody').prev('.tabhead');
    			 customerTab = $("a[href='#"+customerTabBody.attr('id')+"']").parent('li');
    			$(currentTabBody).removeClass('active');
    			currentTab.removeClass('active');
    			
    			customerTabBody.addClass('active');
    			customerTab.addClass('active');
    			
				$('#confirmAddPrefModal').modal();
    		}
			if($(".tabs-list>li.active a").attr("id") == "preferences") {
				$('.contactPreferenceUpdatedMsg').addClass('hide');
				ACC.profileExtend.cutoffForAdmin();
				ACC.profileExtend.disableEmailField( ACC.accountPrefPartner );
			}
		});
		$('.js-confirmAddPref').on('click', function(){
			customerTabBody.removeClass('active');
			customerTab.removeClass('active');
			$(currentTabBody).addClass('active');
			currentTab.addClass('active');
			$('#confirmAddPrefModal').modal('hide');
			$("#customerPreferenceForm")[0].reset();
			ACC.profileExtend.reminderValuesRender(ACC.profileExtend.remFlag.preference);
			
			if($('.js-prefTable').length >0){
				$('.js-prefTable').find('tbody').empty();
				$('.js-missingChannel, .contactPreferenceUpdatedMsg').addClass('hide');
				$(".js-nocontact-pref-msg").removeClass("hide");
				$('.js-prefTable').addClass('hide');
			}else{
				if($(".orderRemRow").hasClass("js-added")) {
					$(".reminderInfo").addClass("js-added");
				}
				$('#customerPreferenceForm').find('table tbody').find('.js-added').remove();
			}
			$('.js-prefDropdown').removeClass('hide');
			$('.addPref-dropdown').removeClass('hide');
			$('.js-prefDropdown').find('.form-group').removeClass('hide');
			$('#customerPreferenceForm').find('button[type=submit]').addClass('disabled')
		});
	},
	
	cancelModalPreference: function(){
		$('.js-cancelPref').on('click', function(){
			if( $(".js-order-pref-form").length > 0 ){
				$(".js-order-pref-form")[0].reset();
			}
			
			if($("#checkAdminUser").val() === "true" && $('.js-order-pref-form input[name=orderPreference]:checked').attr("id") == "js-ord-pref-pep-partner" ) {
				 $('#customerPreferenceForm').find('table tbody').find('.js-added:not(".forAdmin")').remove();
				 $('.js-prefDropdown').find('.form-group:not(".forAdmin")').removeClass('hide');
			}
			else {
				if($('.js-prefTable').length > 0){
					$('.js-missingChannel, .contactPreferenceUpdatedMsg').addClass('hide');
					$(".js-nocontact-pref-msg").removeClass("hide");
					$('.js-prefTable').find('tbody').empty();
					$('.js-prefTable').addClass('hide');
				  }else{
					  if($(".orderRemRow").hasClass("js-added")) {
							$(".reminderInfo").addClass("js-added");
					  }
					  $('#customerPreferenceForm').find('table tbody').find('.js-added').remove();
				  }
				$('.js-prefDropdown').find('.form-group').removeClass('hide');
			}
			
			$("#customerPreferenceForm")[0].reset();
			ACC.profileExtend.reminderValuesRender(ACC.profileExtend.remFlag.preference);
			
			$('.js-prefDropdown').removeClass('hide');
			$('.addPref-dropdown').removeClass('hide');
			$("#customerPreferenceForm").find("button[type=submit]").addClass('disabled');
			ACC.global.footerAlignment();
		});
	},
	
	submitModalPreference: function(){
		$(document).on('click','.js-submitAddPref',function(){
			$('.js-prefDropdown').find( "input:checked" ).each(function() {
				  var i = $( this ).val();
				 
				  var newRow = $('.additionalPref_'+i).find('tbody').html();
				  newRow = $(newRow);
				  
				  $('.js-prefDropdown').removeClass('open');
				  if($('.js-prefTable').length > 0){
					  $('.js-prefTable').removeClass('hide');
					  $('.message-box').addClass('hide');
				  }
				  $("#customerPreferenceForm").find('.responsive-table').find('tbody').append(newRow);
				  if($("#customerPreferenceForm").find("[id^='orderRemTime_']").length > 0) {
					  ACC.profileExtend.reminderTimePicker();
					  ACC.profileExtend.reminderValues();
				  }
				  ACC.global.footerAlignment();
				  $(this).prop('checked', false);
				  $(this).parent('.form-group').addClass('hide');
				  $('#customerPreferenceForm').find('button').removeClass('disabled');
				  if($('.js-prefDropdown').find( ".form-group" ).length === $('.js-prefDropdown').find( ".form-group.hide" ).length){	
					  $('.js-prefDropdown').addClass('hide');
					  $('.addPref-dropdown').addClass('hide');
				  }
				  ACC.global.footerAlignment();
			});
			
		});
	},
	
	addNewPref: function(){
		if ($("#customerPreferenceForm").length >0){
			ACC.profileExtend.submitModalPreference();
			
			ACC.profileExtend.cancelModalPreference();
			
		}
			   
	},
	
	calculateDifference: function(){
		var fromDate = $("#openDate").datepicker( 'getDate' );
		var toDate = $("#closedDate").datepicker( 'getDate' );
		
		if( fromDate === null || toDate === null ){
			return false;
		}
		
		var diff = ((toDate - fromDate)/(1000 * 60 * 60 * 24)) + 1; //the count of sixty days should include the first and last dates
		var hasError = false;
		if( diff < 60 || diff > 305){
			$(".js-date-validation-msg").text(ACC.seasonalDateErrorMsg).removeClass("hide");
			hasError = true;
		}
		if( hasError ){
			$(".js-update-businessInfo").addClass("disabled");
		}else{
			$(".js-date-validation-msg").text("");
			$(".js-update-businessInfo").removeClass("disabled");
		}
	},
	
	showMessagesOnHover: function(){
		$(document).on("mouseenter", "#openDate.js-disabled, #closedDate.js-disabled", function(){
			$(this).siblings(".js-disabled-msg").attr("aria-hidden","false").removeClass("hide").find(".js-text").text(ACC.seasonalDateHoverErrorMsg);
			$(this).closest(".js-calendar-group").find(".js-mobile-disabled-msg").attr("aria-hidden","false").removeClass("hide").text(ACC.seasonalDateHoverErrorMsg);
		}).on("mouseleave", "#openDate.js-disabled, #closedDate.js-disabled", function(){
			$(this).siblings(".js-disabled-msg").attr("aria-hidden","true").addClass("hide").find(".js-text").text("");
			$(this).closest(".js-calendar-group").find(".js-mobile-disabled-msg").attr("aria-hidden","true").addClass("hide").text("");
		});
	},

	reminderTimePicker: function(){
		$("[id^='orderRemTime_']").timepicker({
			minuteStep: 1
		});
	},
	reminderValuesDefault : function(){
		ACC.profileExtend.remFlag.preference = $('.js-order-pref-form input[name=orderPreference]:checked').attr("id");
		ACC.profileExtend.remFlag.remtime = ACC.cutOffTime.convertUTCtoLocalTime($("#preferredLeadTime").val(), "h:mm A");
		ACC.profileExtend.remFlag.remDays = $("#preferredLeadDays").val();
		if(ACC.profileExtend.remFlag.remtime && ACC.profileExtend.remFlag.remDays ){
			ACC.profileExtend.remFlag.hasDefault = true;
		}
		
		var pref = $('.js-order-pref-form input[name=orderPreference]:checked').attr("id");
		$('.js-order-pref-form input[name=orderPreference]').on('change', function() {
			 pref = $('.js-order-pref-form input[name=orderPreference]:checked').attr("id");
			 ACC.profileExtend.reminderValuesRender(pref);
			 ACC.profileExtend.cutoffForAdmin();
			 
			 ACC.profileExtend.disableEmailField( ACC.accountPrefPartner );
			 ACC.profileExtend.disableEmailField( ACC.accountPrefContact );
		});
		$("#customerPreferenceForm").on("change", "#reminderDay", function(){
			var val = $('#reminderDay').val();
			$("[id^='orderRemday_']").attr("value", val);
			ACC.profileExtend.getMinMaxTime(pref);
			ACC.profileExtend.getTimeDifference(pref, $("[id^='orderRemTime_']").val());
		});
		ACC.profileExtend.reminderValues();
	},
	
	checkDaylightBeforeConvertingUTCtoLocalTime: function(inputTime, format){
		var inputDate = new Date(inputTime);
		var diffInOffset = inputDate.getTimezoneOffset() - ACC.profileExtend.stdTimezoneOffset(inputDate);
		var daylight = false;
		if (diffInOffset < 0)
		{
			daylight = true;
		}
		
		if (daylight)
		{
			inputDate = new Date(inputDate.getTime() - 3600000);
		}
		inputDate = moment(inputDate).format('MM/DD/YYYY HH:mm:ss');
		return ACC.cutOffTime.convertUTCtoLocalTime(inputDate, format);
	},
	
	stdTimezoneOffset: function(prefDate) {
		var jan = new Date(prefDate.getFullYear(), 0, 1);
		var jul = new Date(prefDate.getFullYear(), 6, 1);
		return Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());
	},
	
	reminderValues : function(){
		
		var pref = $('.js-order-pref-form input[name=orderPreference]:checked').attr("id");
		
		ACC.profileExtend.reminderValuesRender(pref);
		
		setTimeout(function(){ 
			$("#customerPreferenceForm .timepicker input").on("blur", function(){
				ACC.profileExtend.getTimeDifference(pref, this.value);
			});
			
		}, 3000);
		
	},
	
	reminderValuesRender : function(pref){
		var remDays, remtime;
		var s = $('#reminderDay');
		
		if(pref == "js-ord-pref-pep-partner") {
			remDays = $("#cutOffLeadDays").val();
			$(".reminderInfo fieldset").removeAttr('disabled');
		}
		else {
			remDays = $("#bestLeadDays").val() ;
			$(".reminderInfo fieldset").removeAttr('disabled');
			if (typeof pref === "undefined") {
				$(".reminderInfo fieldset").attr('disabled', 'disabled');
			}
		}
		
		s.empty();
		for (var i=remDays; i <= $('#maximumLeadDays').val(); i++) {
		    s.append($('<option/>').attr({ 'value': i }).text(i));
		}
		if(ACC.profileExtend.remFlag.preference == pref && ACC.profileExtend.remFlag.hasDefault) {
			remtime = ACC.profileExtend.remFlag.remtime;
			remDays = ACC.profileExtend.remFlag.remDays;
		}
		else {
			remDays = $("#bestLeadDays").val();
			remtime = ACC.profileExtend.getReducedTime(ACC.cutOffTime.convertUTCtoLocalTime($("#bestCallTimeReminders").val(), "h:mm A"));
		}
		
		if(pref == "js-ord-pref-pep-partner") {
			var cutOffLeadDays = +$("#cutOffLeadDays").val();
			$("#reminderDay").val(cutOffLeadDays).change();
		}
		s.val(remDays);
		ACC.profileExtend.getMinMaxTime(pref);
		
		$("[id^='orderRemday_']").attr("value", remDays);
		$("[id^='orderRemTime_']").timepicker().unbind('hide.timepicker');
		$("[id^='orderRemTime_']").timepicker().on('hide.timepicker', function(e) {
			var previousFormData = $('#customerPreferenceForm').serialize();
			
			ACC.profileExtend.getTimeDifference(pref, e.time.value);
			
			if($('#customerPreferenceForm').serialize() !== previousFormData){
				$('#customerPreferenceForm').find('[type="submit"]').removeClass("disabled");
		    }
		});
		
		remtime = ACC.profileExtend.getTimeFormat(remtime);
		$("[id^='orderRemTime_']").attr("value", remtime);
		ACC.profileExtend.getTimeDifference(pref, remtime);
		
	},
	
	getMinMaxTime : function(pref) {
		 var remtime;
		 var dumDate = ACC.orderReminderDefaultDate;
		 var sTime = new Date(dumDate + " " + ACC.profileExtend.checkDaylightBeforeConvertingUTCtoLocalTime(dumDate + " 12:00", "h:mm A") );
		 var eTime = new Date(sTime);
		 eTime.setMinutes ( sTime.getMinutes() + 15*60 );
		 var browser = ACC.browserDetect.returnIE(ACC.browserDetect.ua);
		 var ieVersion = ACC.browserDetect.getIEVersion();
		 if( (browser && ieVersion > 10) || ( typeof(browser) === "undefined" ) ){
			 eTime = new Date(dumDate + " " + eTime.toLocaleString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true }).replace(/[^A-Za-z 0-9 \.,\?""!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~]*/g, '') );
		 }else{
			 var tempTime = eTime.toLocaleString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true });
			 eTime = new Date(dumDate + " " + ACC.profileExtend.getTimeFormat(tempTime));
		 }
		 ACC.profileExtend.remFlag.sTime = sTime;
		 ACC.profileExtend.remFlag.eTime = eTime;

		//Checking if start and end time falls on different days as per local time-zone
		if(eTime - sTime < 0 ) {
			ACC.profileExtend.remFlag.timeBound = true;
		}
		 
		 if(pref == "js-ord-pref-pep-partner") {
			//Check if cutoff days & preferred lead days is same
			if($('#reminderDay').val() == $("#cutOffLeadDays").val()) {
				remtime = ACC.cutOffTime.convertUTCtoLocalTime($("#cutOffLeadTime").val(), "h:mm A");
				ACC.profileExtend.setMinMaxTime(remtime, pref);
			}
		 }
		 else if($('#reminderDay').val() == $("#bestLeadDays").val()) {
			 remtime = ACC.cutOffTime.convertUTCtoLocalTime($("#bestCallTimeReminders").val(), "h:mm A");
			 ACC.profileExtend.setMinMaxTime(remtime, pref);
		 }
		 
		 $(".reminderInfo .remFrom").empty().text( ACC.profileExtend.extractTimeFromDateTime(ACC.profileExtend.remFlag.sTime) );
		 $(".reminderInfo .remTo").empty().text( ACC.profileExtend.extractTimeFromDateTime(ACC.profileExtend.remFlag.eTime) );
	}, 
	
	extractTimeFromDateTime: function(str){
		var browser = ACC.browserDetect.returnIE(ACC.browserDetect.ua);
		var ieVersion = ACC.browserDetect.getIEVersion();
		 
		var newStr = str.toLocaleString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true });
		if( (browser && ieVersion > 10) || ( typeof(browser) === "undefined" ) ){	
			newStr = newStr.replace(/[^A-Za-z 0-9 \.,\?""!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~]*/g, '');
		}else{
			var strList = newStr.split(" ");
			if( strList.length === 6 ){
				var time = strList[4];
				var meridiem = strList[5];
				time = time.substring(0, time.lastIndexOf(":"));
				newStr = time + " " + meridiem;
			}
		}
		return newStr;
	},
	
	getTimeFormat: function(str){
		var browser = ACC.browserDetect.returnIE(ACC.browserDetect.ua);
		var ieVersion = ACC.browserDetect.getIEVersion();
		var newStr = str; 
		if( (browser && ieVersion <= 10) ){
			var strList = newStr.split(" ");
			if( strList.length === 6 ){
				var time = strList[4];
				var meridiem = strList[5];
				time = time.substring(0, time.lastIndexOf(":"));
				newStr = time + " " + meridiem;
			}
		}
		return newStr;
	},
	
	getReducedTime : function(eleTime) {
		var remtime = new Date(ACC.orderReminderDefaultDate + " " + eleTime );
		remtime.setMinutes(remtime.getMinutes() - $('#minimumMinutesBeforeBestCallTime').val()); //Before 120 mins 
		remtime = remtime.toLocaleString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true }).replace(/[^A-Za-z 0-9 \.,\?""!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~]*/g, '');
		return remtime;
	},
	
	getTimeDifference : function(pref, eleVal) {
		
			var minBound, maxBound, userTime;
			userTime = new Date(ACC.orderReminderDefaultDate + " " + eleVal);
			
			if(ACC.profileExtend.remFlag.timeBound) {
				minBound = ACC.profileExtend.remFlag.sTime - userTime;
				maxBound = userTime - ACC.profileExtend.remFlag.eTime; 
				if (maxBound > 0 && minBound > 0){
					userTime = ACC.profileExtend.remFlag.eTime;
				}
			}
			else {
				minBound = ACC.profileExtend.remFlag.eTime - userTime;
				maxBound = userTime - ACC.profileExtend.remFlag.sTime; 
				if (maxBound < 0 || minBound < 0) {
					userTime = ACC.profileExtend.remFlag.sTime;
				}
			}
			
			var timeFormat = ACC.profileExtend.extractTimeFromDateTime(userTime);
			
			$("[id^='orderRemTime_']").timepicker("setTime", timeFormat);
			$("[id^='orderRemTime_']").attr("value", timeFormat);
			
			var localDate = ACC.orderReminderDefaultDate + " " + timeFormat;
			$("#customerPreferenceForm").find(".js-orderRemTime").val(ACC.cutOffTime.convertLocaltoUTC(new Date(localDate), 'MM/DD/YYYY HH:mm:ss'));
	},
	
	setMinMaxTime : function(prefTime, pref){
		var sTime, eTime;
		sTime = ACC.profileExtend.remFlag.sTime;
		eTime = ACC.profileExtend.remFlag.eTime; 
		
		prefTime  = new Date(ACC.orderReminderDefaultDate + " " + prefTime);
		
		
		if (ACC.profileExtend.remFlag.timeBound) {
			if(!(eTime - prefTime < 0 &&  prefTime - sTime < 0)) {
				if(prefTime <= eTime)
					eTime = prefTime;
				else if(sTime - prefTime <= 0) {
					eTime = prefTime;
					ACC.profileExtend.remFlag.timeBound = false;
				}
			}
			else
			{
				ACC.profileExtend.removeOutOfBoundsSelector(pref);
			}
		}
		else {
			if(sTime - prefTime <= 0 && prefTime - eTime <= 0) 
			{
				eTime = prefTime;
			}
			else 
			{
				ACC.profileExtend.removeOutOfBoundsSelector(pref);
			}
		}
		ACC.profileExtend.remFlag.sTime = sTime;
		ACC.profileExtend.remFlag.eTime = eTime;
	},
	
	removeOutOfBoundsSelector: function(pref){
		if (pref == "js-ord-pref-pep-partner" && $('#reminderDay').val() == $("#cutOffLeadDays").val())
		{
			var cutOffLeadDays = +$("#cutOffLeadDays").val();
			 $("#reminderDay").find("option").filter("[value=" + cutOffLeadDays + "]").prevAll().remove();
			 $("#reminderDay").find("option").filter("[value=" + cutOffLeadDays + "]").remove();
		}
	},
	
	cutoffForAdmin : function() {
		if($('.js-order-pref-form input[name=orderPreference]:checked').attr("id") == "js-ord-pref-pep-partner" ) {
			$.each($(".js-prefDropdown .form-group"), function() {
				var ele = $(this);
				var i = ele.find("input").val();
				//Including 2796 story 
				ACC.profileExtend.addRemindersConfirmation(ele, i);
				
				//customer expansion story 3179
				if( $("#checkAdminUser").val() === "true" && (ele.hasClass("cutoffReminders") && !$(".cutoffReminders").hasClass("hide")) ){
					$(".cutoffReminders input").prop('checked', true);
					ele.addClass("forAdmin");
					$('.additionalPref_'+i).find('tbody .js-added').addClass("forAdmin");
				}
			})
			$(".js-prefDropdown .js-submitAddPref").click();
		}
	},
	
	addRemindersConfirmation:function(ele, i){
				if((ele.text() == "Order Reminders" || ele.text() == "Order Confirmation")  && !ele.hasClass("hide")) {
					ele.find("input").prop('checked', true);
					ele.addClass("forAdmin");
					$('.additionalPref_'+i).find('tbody .js-added').addClass("forAdmin");
			if( ele.text() == "Order Reminders" ){
						$(".reminderInfo ").addClass("forAdmin");
				}
		}
	},
	
	switchTabsAfterLoad: function() {
		var tabRedirAttr = sessionStorage.getItem("myProfileTabRedirAttr");
		if(tabRedirAttr) {
			if(tabRedirAttr == '#personal-details') {
				$('.personalDetailsUpdatedMsg').removeClass('hide');
				$('.tabs a[href="#accessibletabscontent0-0"]').tab('show');
			} else if(tabRedirAttr == '#update-passwd') {
				$('.tabs a[href="#accessibletabscontent0-1"]').tab('show');
			} else if(tabRedirAttr == '#manage-preferences') {
				$('.contactPreferenceUpdatedMsg').removeClass('hide');
				$('.tabs a[href="#accessibletabscontent0-2"]').tab('show');
				ACC.profileExtend.cutoffForAdmin();
				ACC.profileExtend.disableEmailField( ACC.accountPrefPartner );
			} else if(tabRedirAttr == '#business-info') {
				$('.businessInfoUpdatedMsg').removeClass('hide');
				$('.tabs a[href="#accessibletabscontent0-3"]').tab('show');
			} else if(tabRedirAttr == '#manage-contacts') {
				$('.tabs a[href="#accessibletabscontent0-4"]').tab('show');
			} 
			
			sessionStorage.removeItem("myProfileTabRedirAttr");
		}
	},
	updatePreferenceNumber: function(){
		$("#updatePopupContacts").removeClass("display-none");
		var input = $('#missingBusinessEmailModal').find("#modal_business");
		var type = input.data("type");
		var inputVal = input.val();
		if( type === "phoneNo" ){
			var ext = $('#missingBusinessEmailModal').find("#modal_business_ext").val();
			$('#updateProfileForm').find('input[name=phoneNoExtn]').val(ext);
		}
		ACC.profile.updateCustomerContactDetails(inputVal,type);
	},
    syncTabHeights : function(){
    	$(document).on("click", ".tabs-list>li>a" ,function(){
    		var currentForm = $('.tabs .tabhead.active + .tabbody').find('form');
    		if(currentForm && currentForm.validate()) {
    			currentForm.validate().resetForm();
    		}
    		if(currentForm && currentForm.attr('id') === "businessHoursForm"){
    			$('.js-update-businessInfo').removeClass('js-preventDefult');
    			$('.customError').removeClass('customError');
    			$('label.error.overlapping, label.error.difference').remove();
    		}
    		if(currentForm && currentForm.attr('id') !== "addNewProfileForm"){
    			$('.js-manageContactTable').removeClass('hide');
    			if(! $('.js-addNewFormContainer').hasClass('hide')){
    				$("#addNewProfileForm").validate().resetForm();
    				$("#addNewProfileForm").find('.form-control.error').removeClass('error');
    				$('.js-addNewFormContainer').addClass('hide');
    			}
    			else{
    				$("#editProfileForm").validate().resetForm();
    				$("#editProfileForm").find('.form-control.error').removeClass('error')
    				$('.js-editFormContainer').addClass('hide');
    			}
    		}
    		
    		ACC.profile.triggerEmailWarningModal = true;
    		ACC.global.footerAlignment();
    	});
	},
	updateB2bUnitAjax: function(){
        if( ACC.pageName === "my-company" && $(".js-manage-users-table").length > 0 ){
               $(document).on("click", "[class*='js-online-'], [class*='js-pes-']", function(){
                     var customerId = $(this).data("customerId");
                     var cof = $(this).data("cof");
                     var onlineChbox = $('.js-online-' + cof + '[data-customer-id="'+customerId+'"]:visible').prop("checked");
                     var pesChbox = $('.js-pes-' + cof + '[data-customer-id="'+customerId+'"]:visible').prop("checked");
                     $.ajax({
                      url: ACC.config.encodedContextPath + "/my-company/organization-management/manage-users/updateCustomerPreferences",
                      data: {"customerId":customerId, "cof":cof, "onlineFlag": onlineChbox, "pesFlag": pesChbox},
                      method: "POST",
                      success: function(rsp, textStatus, jqXHR){
                            ACC.common.logConsole("Success response. Details [" + jqXHR.status + ", " + jqXHR.statusText + "]");
                    },
                    error: function( jqXHR, textStatus, errorThrown){
                    ACC.common.logConsole("Failed to get response. Error details [" + textStatus + ", " + errorThrown + "]");
                    },
                    complete: function(jqXHR, textStatus){
                    ACC.common.logAjaxCompleteConsole("Response completed. Details [" + textStatus + "]");
                    }
               });
               });
        }
 },

	
	setGroupAccess: function(){
		$(document).on("change", "#js-parentB2BUnitsId", function(){
			var selectedOption = $(this).find("option:selected");
			ACC.profileExtend.displayGroupAccess(selectedOption);
		});
		
		ACC.profileExtend.updateB2bUnitAjax();
		if( ACC.pageName === "my-company" && $(".js-b2bUnitsListPage").length > 0 && $("[class*='js-b2bUnit-']").length > 0 ){
			$("[class*='js-b2bUnit-']").each(function(){
				var cof = $(this).data("cof");
				var cofequipmentflag = $(this).data("cofequipmentflag");
				var cofonlineflag = $(this).data("cofonlineflag");
				var onlineChbox = $(".js-online-"+cof).not(".js-admin-user");
				var pesChbox = $(".js-pes-"+cof).not(".js-admin-user");
				if( onlineChbox.length > 0 ){
					ACC.profileExtend.setDisabled(cofonlineflag, onlineChbox);
				}
				if( pesChbox.length > 0 ){
					ACC.profileExtend.setDisabled(cofequipmentflag, pesChbox);
				}
			});
		}
		ACC.profileExtend.setBusinessGroupAccess();
		
		if( $("#js-parentB2BUnitsId").length > 0 ){
			var selectedOption = $("#js-parentB2BUnitsId").find("option:selected");
			ACC.profileExtend.displayGroupAccess(selectedOption);
		}
	},
	
	setBusinessGroupAccess: function(){
		if( ACC.pageName === "organizationManagement" && $(".js-is-admin").length > 0 ){
			ACC.profileExtend.setDisabled(false, $(".js-b2bonlinegroup"));
			ACC.profileExtend.setDisabled(false, $(".js-b2bequipmentgroup"));
		}
	},
	
	setDisabled: function(isEnabled, $el){
		if( isEnabled ){
			$el.prop("disabled", false).removeAttr("disabled").attr("aria-disabled", false);
		}else{
			$el.prop("disabled", true).attr({"disabled":"disabled", "aria-disabled":true});
		}
	},
	
	setChecked: function(isChecked, $el){
		if( isChecked ){
			$el.prop("checked", true).attr({"checked":"checked", "aria-checked":true});
			if($(".js-is-admin").length > 0) {
				ACC.profileExtend.setDisabled( false, $el);
			}
		}else{
			$el.prop("checked", false).removeAttr("checked").attr("aria-checked", false);
		}
	},
	
	displayGroupAccess: function(selectedOption){
		$(".js-b2bonlinegroup, .js-b2bequipmentgroup").removeAttr("disabled checked aria-disabled aria-checked");
		if( selectedOption.length > 0 ){
			var onlineflag = selectedOption.data("onlineflag");
			var hasequipment = selectedOption.data("hasequipment");
			var buValue = selectedOption.val();
			
			ACC.profileExtend.setDisabled(onlineflag, $(".js-b2bonlinegroup"));
			ACC.profileExtend.setDisabled(hasequipment, $(".js-b2bequipmentgroup"));
			
			var preference = $("#js-preferencesSelected").find(".js-"+buValue);
			if( preference.length > 0 ){
				var customerOnlineflag = preference.data("cofonlineflag");
				var customerHasequipment = preference.data("cofequipmentflag");
				
				ACC.profileExtend.setChecked(customerOnlineflag, $(".js-b2bonlinegroup"));
				ACC.profileExtend.setChecked(customerHasequipment, $(".js-b2bequipmentgroup"));
				
			}
		}
	}
};


/*!
* surveyjs - Survey JavaScript library v0.10.4
* (c) Devsoft Baltic O - http://surveyjs.io/
* License: MIT (http://www.opensource.org/licenses/mit-license.php)
*/

!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("Survey",["jquery"],t):"object"==typeof exports?exports.Survey=t(require("jquery")):e.Survey=t(e.jQuery)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.__assign=void 0;var o=n(2);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var s=n(1);Object.defineProperty(t,"__assign",{enumerable:!0,get:function(){return s.__assign}});var u=n(40),a=i(u),l=n(40),c=i(l),h=n(39),p=n(64),d=n(75),f=r(d);f["default"].fn.extend({Survey:function(t){this.each(function(){c.render(a.createElement(h.Survey,e({},t)),this)})},SurveyWindow:function(t){this.each(function(){c.render(a.createElement(p.SurveyWindow,e({},t)),this)})}})}).call(t,n(1))},function(e,t,n){(function(n){"use strict";function n(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.__assign=n,"undefined"!=typeof e&&e.exports&&(t=e.exports=n),t.__assign=n}).call(t,n(1))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=t.QuestionFactory=t.ReactQuestionFactory=t.SurveyWindow=t.SurveyQuestionRating=t.SurveyProgress=t.SurveyQuestionMatrixDynamicRow=t.SurveyQuestionMatrixDynamic=t.SurveyQuestionText=t.SurveyQuestionRadiogroup=t.SurveyQuestionMultipleTextItem=t.SurveyQuestionMultipleText=t.SurveyQuestionFile=t.SurveyQuestionHtml=t.SurveyQuestionMatrixRow=t.SurveyQuestionMatrix=t.SurveyQuestionMatrixDropdownRow=t.SurveyQuestionMatrixDropdown=t.SurveyQuestionDropdown=t.SurveyQuestionCheckboxItem=t.SurveyQuestionCheckbox=t.SurveyQuestionComment=t.SurveyQuestionCommentItem=t.SurveyQuestionElementBase=t.SurveyElementBase=t.SurveyQuestionErrors=t.SurveyQuestion=t.SurveyRow=t.SurveyPage=t.SurveyNavigation=t.SurveyNavigationBase=t.Model=t.ReactSurveyModel=t.Survey=t.defaultBootstrapCss=t.defaultStandardCss=void 0;var r=n(3);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var i=n(37);Object.defineProperty(t,"defaultStandardCss",{enumerable:!0,get:function(){return i.defaultStandardCss}});var o=n(38);Object.defineProperty(t,"defaultBootstrapCss",{enumerable:!0,get:function(){return o.defaultBootstrapCss}});var s=n(39);Object.defineProperty(t,"Survey",{enumerable:!0,get:function(){return s.Survey}});var u=n(44);Object.defineProperty(t,"ReactSurveyModel",{enumerable:!0,get:function(){return u.ReactSurveyModel}}),Object.defineProperty(t,"Model",{enumerable:!0,get:function(){return u.ReactSurveyModel}});var a=n(51);Object.defineProperty(t,"SurveyNavigationBase",{enumerable:!0,get:function(){return a.SurveyNavigationBase}});var l=n(50);Object.defineProperty(t,"SurveyNavigation",{enumerable:!0,get:function(){return l.SurveyNavigation}});var c=n(45);Object.defineProperty(t,"SurveyPage",{enumerable:!0,get:function(){return c.SurveyPage}}),Object.defineProperty(t,"SurveyRow",{enumerable:!0,get:function(){return c.SurveyRow}});var h=n(46);Object.defineProperty(t,"SurveyQuestion",{enumerable:!0,get:function(){return h.SurveyQuestion}}),Object.defineProperty(t,"SurveyQuestionErrors",{enumerable:!0,get:function(){return h.SurveyQuestionErrors}});var p=n(48);Object.defineProperty(t,"SurveyElementBase",{enumerable:!0,get:function(){return p.SurveyElementBase}}),Object.defineProperty(t,"SurveyQuestionElementBase",{enumerable:!0,get:function(){return p.SurveyQuestionElementBase}});var d=n(47);Object.defineProperty(t,"SurveyQuestionCommentItem",{enumerable:!0,get:function(){return d.SurveyQuestionCommentItem}}),Object.defineProperty(t,"SurveyQuestionComment",{enumerable:!0,get:function(){return d.SurveyQuestionComment}});var f=n(53);Object.defineProperty(t,"SurveyQuestionCheckbox",{enumerable:!0,get:function(){return f.SurveyQuestionCheckbox}}),Object.defineProperty(t,"SurveyQuestionCheckboxItem",{enumerable:!0,get:function(){return f.SurveyQuestionCheckboxItem}});var y=n(54);Object.defineProperty(t,"SurveyQuestionDropdown",{enumerable:!0,get:function(){return y.SurveyQuestionDropdown}});var m=n(55);Object.defineProperty(t,"SurveyQuestionMatrixDropdown",{enumerable:!0,get:function(){return m.SurveyQuestionMatrixDropdown}}),Object.defineProperty(t,"SurveyQuestionMatrixDropdownRow",{enumerable:!0,get:function(){return m.SurveyQuestionMatrixDropdownRow}});var v=n(56);Object.defineProperty(t,"SurveyQuestionMatrix",{enumerable:!0,get:function(){return v.SurveyQuestionMatrix}}),Object.defineProperty(t,"SurveyQuestionMatrixRow",{enumerable:!0,get:function(){return v.SurveyQuestionMatrixRow}});var g=n(57);Object.defineProperty(t,"SurveyQuestionHtml",{enumerable:!0,get:function(){return g.SurveyQuestionHtml}});var b=n(58);Object.defineProperty(t,"SurveyQuestionFile",{enumerable:!0,get:function(){return b.SurveyQuestionFile}});var C=n(59);Object.defineProperty(t,"SurveyQuestionMultipleText",{enumerable:!0,get:function(){return C.SurveyQuestionMultipleText}}),Object.defineProperty(t,"SurveyQuestionMultipleTextItem",{enumerable:!0,get:function(){return C.SurveyQuestionMultipleTextItem}});var w=n(60);Object.defineProperty(t,"SurveyQuestionRadiogroup",{enumerable:!0,get:function(){return w.SurveyQuestionRadiogroup}});var x=n(61);Object.defineProperty(t,"SurveyQuestionText",{enumerable:!0,get:function(){return x.SurveyQuestionText}});var P=n(62);Object.defineProperty(t,"SurveyQuestionMatrixDynamic",{enumerable:!0,get:function(){return P.SurveyQuestionMatrixDynamic}}),Object.defineProperty(t,"SurveyQuestionMatrixDynamicRow",{enumerable:!0,get:function(){return P.SurveyQuestionMatrixDynamicRow}});var V=n(52);Object.defineProperty(t,"SurveyProgress",{enumerable:!0,get:function(){return V.SurveyProgress}});var S=n(63);Object.defineProperty(t,"SurveyQuestionRating",{enumerable:!0,get:function(){return S.SurveyQuestionRating}});var O=n(64);Object.defineProperty(t,"SurveyWindow",{enumerable:!0,get:function(){return O.SurveyWindow}});var E=n(49);Object.defineProperty(t,"ReactQuestionFactory",{enumerable:!0,get:function(){return E.ReactQuestionFactory}}),Object.defineProperty(t,"QuestionFactory",{enumerable:!0,get:function(){return E.ReactQuestionFactory}});var q=n(5);Object.defineProperty(t,"__extends",{enumerable:!0,get:function(){return q.__extends}}),n(65)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);Object.defineProperty(t,"AnswerCountValidator",{enumerable:!0,get:function(){return r.AnswerCountValidator}}),Object.defineProperty(t,"EmailValidator",{enumerable:!0,get:function(){return r.EmailValidator}}),Object.defineProperty(t,"NumericValidator",{enumerable:!0,get:function(){return r.NumericValidator}}),Object.defineProperty(t,"RegexValidator",{enumerable:!0,get:function(){return r.RegexValidator}}),Object.defineProperty(t,"SurveyValidator",{enumerable:!0,get:function(){return r.SurveyValidator}}),Object.defineProperty(t,"TextValidator",{enumerable:!0,get:function(){return r.TextValidator}}),Object.defineProperty(t,"ValidatorResult",{enumerable:!0,get:function(){return r.ValidatorResult}}),Object.defineProperty(t,"ValidatorRunner",{enumerable:!0,get:function(){return r.ValidatorRunner}});var i=n(6);Object.defineProperty(t,"Base",{enumerable:!0,get:function(){return i.Base}}),Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return i.Event}}),Object.defineProperty(t,"ItemValue",{enumerable:!0,get:function(){return i.ItemValue}}),Object.defineProperty(t,"SurveyError",{enumerable:!0,get:function(){return i.SurveyError}});var o=n(10);Object.defineProperty(t,"ChoicesRestfull",{enumerable:!0,get:function(){return o.ChoicesRestfull}});var s=n(11);Object.defineProperty(t,"Condition",{enumerable:!0,get:function(){return s.Condition}}),Object.defineProperty(t,"ConditionNode",{enumerable:!0,get:function(){return s.ConditionNode}}),Object.defineProperty(t,"ConditionRunner",{enumerable:!0,get:function(){return s.ConditionRunner}});var u=n(12);Object.defineProperty(t,"ConditionsParser",{enumerable:!0,get:function(){return u.ConditionsParser}});var a=n(13);Object.defineProperty(t,"ProcessValue",{enumerable:!0,get:function(){return a.ProcessValue}});var l=n(7);Object.defineProperty(t,"CustomError",{enumerable:!0,get:function(){return l.CustomError}}),Object.defineProperty(t,"ExceedSizeError",{enumerable:!0,get:function(){return l.ExceedSizeError}}),Object.defineProperty(t,"RequreNumericError",{enumerable:!0,get:function(){return l.RequreNumericError}});var c=n(9);Object.defineProperty(t,"JsonError",{enumerable:!0,get:function(){return c.JsonError}}),Object.defineProperty(t,"JsonIncorrectTypeError",{enumerable:!0,get:function(){return c.JsonIncorrectTypeError}}),Object.defineProperty(t,"JsonMetadata",{enumerable:!0,get:function(){return c.JsonMetadata}}),Object.defineProperty(t,"JsonMetadataClass",{enumerable:!0,get:function(){return c.JsonMetadataClass}}),Object.defineProperty(t,"JsonMissingTypeError",{enumerable:!0,get:function(){return c.JsonMissingTypeError}}),Object.defineProperty(t,"JsonMissingTypeErrorBase",{enumerable:!0,get:function(){return c.JsonMissingTypeErrorBase}}),Object.defineProperty(t,"JsonObject",{enumerable:!0,get:function(){return c.JsonObject}}),Object.defineProperty(t,"JsonObjectProperty",{enumerable:!0,get:function(){return c.JsonObjectProperty}}),Object.defineProperty(t,"JsonRequiredPropertyError",{enumerable:!0,get:function(){return c.JsonRequiredPropertyError}}),Object.defineProperty(t,"JsonUnknownPropertyError",{enumerable:!0,get:function(){return c.JsonUnknownPropertyError}});var h=n(14);Object.defineProperty(t,"MatrixDropdownCell",{enumerable:!0,get:function(){return h.MatrixDropdownCell}}),Object.defineProperty(t,"MatrixDropdownColumn",{enumerable:!0,get:function(){return h.MatrixDropdownColumn}}),Object.defineProperty(t,"MatrixDropdownRowModelBase",{enumerable:!0,get:function(){return h.MatrixDropdownRowModelBase}}),Object.defineProperty(t,"QuestionMatrixDropdownModelBase",{enumerable:!0,get:function(){return h.QuestionMatrixDropdownModelBase}});var p=n(20);Object.defineProperty(t,"MatrixDropdownRowModel",{enumerable:!0,get:function(){return p.MatrixDropdownRowModel}}),Object.defineProperty(t,"QuestionMatrixDropdownModel",{enumerable:!0,get:function(){return p.QuestionMatrixDropdownModel}});var d=n(21);Object.defineProperty(t,"MatrixDynamicRowModel",{enumerable:!0,get:function(){return d.MatrixDynamicRowModel}}),Object.defineProperty(t,"QuestionMatrixDynamicModel",{enumerable:!0,get:function(){return d.QuestionMatrixDynamicModel}});var f=n(22);Object.defineProperty(t,"MatrixRowModel",{enumerable:!0,get:function(){return f.MatrixRowModel}}),Object.defineProperty(t,"QuestionMatrixModel",{enumerable:!0,get:function(){return f.QuestionMatrixModel}});var y=n(23);Object.defineProperty(t,"MultipleTextItemModel",{enumerable:!0,get:function(){return y.MultipleTextItemModel}}),Object.defineProperty(t,"QuestionMultipleTextModel",{enumerable:!0,get:function(){return y.QuestionMultipleTextModel}});var m=n(24);Object.defineProperty(t,"PageModel",{enumerable:!0,get:function(){return m.PageModel}}),Object.defineProperty(t,"QuestionRowModel",{enumerable:!0,get:function(){return m.QuestionRowModel}});var v=n(15);Object.defineProperty(t,"Question",{enumerable:!0,get:function(){return v.Question}});var g=n(16);Object.defineProperty(t,"QuestionBase",{enumerable:!0,get:function(){return g.QuestionBase}});var b=n(18);Object.defineProperty(t,"QuestionCheckboxBase",{enumerable:!0,get:function(){return b.QuestionCheckboxBase}}),Object.defineProperty(t,"QuestionSelectBase",{enumerable:!0,get:function(){return b.QuestionSelectBase}});var C=n(25);Object.defineProperty(t,"QuestionCheckboxModel",{enumerable:!0,get:function(){return C.QuestionCheckboxModel}});var w=n(26);Object.defineProperty(t,"QuestionCommentModel",{enumerable:!0,get:function(){return w.QuestionCommentModel}});var x=n(27);Object.defineProperty(t,"QuestionDropdownModel",{enumerable:!0,get:function(){return x.QuestionDropdownModel}});var P=n(19);Object.defineProperty(t,"QuestionFactory",{enumerable:!0,get:function(){return P.QuestionFactory}});var V=n(28);Object.defineProperty(t,"QuestionFileModel",{enumerable:!0,get:function(){return V.QuestionFileModel}});var S=n(29);Object.defineProperty(t,"QuestionHtmlModel",{enumerable:!0,get:function(){return S.QuestionHtmlModel}});var O=n(30);Object.defineProperty(t,"QuestionRadiogroupModel",{enumerable:!0,get:function(){return O.QuestionRadiogroupModel}});var E=n(31);Object.defineProperty(t,"QuestionRatingModel",{enumerable:!0,get:function(){return E.QuestionRatingModel}});var q=n(32);Object.defineProperty(t,"QuestionTextModel",{enumerable:!0,get:function(){return q.QuestionTextModel}});var T=n(33);Object.defineProperty(t,"SurveyModel",{enumerable:!0,get:function(){return T.SurveyModel}});var j=n(35);Object.defineProperty(t,"SurveyTrigger",{enumerable:!0,get:function(){return j.SurveyTrigger}}),Object.defineProperty(t,"SurveyTriggerComplete",{enumerable:!0,get:function(){return j.SurveyTriggerComplete}}),Object.defineProperty(t,"SurveyTriggerSetValue",{enumerable:!0,get:function(){return j.SurveyTriggerSetValue}}),Object.defineProperty(t,"SurveyTriggerVisible",{enumerable:!0,get:function(){return j.SurveyTriggerVisible}}),Object.defineProperty(t,"Trigger",{enumerable:!0,get:function(){return j.Trigger}});var M=n(36);Object.defineProperty(t,"SurveyWindowModel",{enumerable:!0,get:function(){return M.SurveyWindowModel}});var R=n(17);Object.defineProperty(t,"TextPreProcessor",{enumerable:!0,get:function(){return R.TextPreProcessor}});var N=n(34);Object.defineProperty(t,"dxSurveyService",{enumerable:!0,get:function(){return N.dxSurveyService}});var Q=n(8);Object.defineProperty(t,"surveyLocalization",{enumerable:!0,get:function(){return Q.surveyLocalization}}),Object.defineProperty(t,"surveyStrings",{enumerable:!0,get:function(){return Q.surveyStrings}})},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmailValidator=t.RegexValidator=t.AnswerCountValidator=t.TextValidator=t.NumericValidator=t.ValidatorRunner=t.SurveyValidator=t.ValidatorResult=void 0;var r=n(6),i=n(7),o=n(8),s=n(9),u=t.ValidatorResult=function(){function e(e,t){void 0===t&&(t=null),this.value=e,this.error=t}return e}(),a=t.SurveyValidator=function(t){function n(){t.call(this),this.text=""}return e(n,t),n.prototype.getErrorText=function(e){return this.text?this.text:this.getDefaultErrorText(e)},n.prototype.getDefaultErrorText=function(e){return""},n.prototype.validate=function(e,t){return void 0===t&&(t=null),null},n}(r.Base),l=(t.ValidatorRunner=function(){function e(){}return e.prototype.run=function(e){for(var t=0;t<e.validators.length;t++){var n=e.validators[t].validate(e.value,e.getValidatorTitle());if(null!=n){if(n.error)return n.error;n.value&&(e.value=n.value)}}return null},e}(),t.NumericValidator=function(t){function n(e,n){void 0===e&&(e=null),void 0===n&&(n=null),t.call(this),this.minValue=e,this.maxValue=n}return e(n,t),n.prototype.getType=function(){return"numericvalidator"},n.prototype.validate=function(e,t){if(void 0===t&&(t=null),!e||!this.isNumber(e))return new u(null,new i.RequreNumericError);var n=new u(parseFloat(e));return this.minValue&&this.minValue>n.value?(n.error=new i.CustomError(this.getErrorText(t)),n):this.maxValue&&this.maxValue<n.value?(n.error=new i.CustomError(this.getErrorText(t)),n):"number"==typeof e?null:n},n.prototype.getDefaultErrorText=function(e){var t=e?e:"value";return this.minValue&&this.maxValue?o.surveyLocalization.getString("numericMinMax").format(t,this.minValue,this.maxValue):this.minValue?o.surveyLocalization.getString("numericMin").format(t,this.minValue):o.surveyLocalization.getString("numericMax").format(t,this.maxValue)},n.prototype.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},n}(a)),c=t.TextValidator=function(t){function n(e,n){void 0===e&&(e=0),void 0===n&&(n=0),t.call(this),this.minLength=e,this.maxLength=n}return e(n,t),n.prototype.getType=function(){return"textvalidator"},n.prototype.validate=function(e,t){return void 0===t&&(t=null),this.minLength>0&&e.length<this.minLength?new u(null,new i.CustomError(this.getErrorText(t))):this.maxLength>0&&e.length>this.maxLength?new u(null,new i.CustomError(this.getErrorText(t))):null},n.prototype.getDefaultErrorText=function(e){return this.minLength>0&&this.maxLength>0?o.surveyLocalization.getString("textMinMaxLength").format(this.minLength,this.maxLength):this.minLength>0?o.surveyLocalization.getString("textMinLength").format(this.minLength):o.surveyLocalization.getString("textMaxLength").format(this.maxLength)},n}(a),h=t.AnswerCountValidator=function(t){function n(e,n){void 0===e&&(e=null),void 0===n&&(n=null),t.call(this),this.minCount=e,this.maxCount=n}return e(n,t),n.prototype.getType=function(){return"answercountvalidator"},n.prototype.validate=function(e,t){if(void 0===t&&(t=null),null==e||e.constructor!=Array)return null;var n=e.length;return this.minCount&&n<this.minCount?new u(null,new i.CustomError(this.getErrorText(o.surveyLocalization.getString("minSelectError").format(this.minCount)))):this.maxCount&&n>this.maxCount?new u(null,new i.CustomError(this.getErrorText(o.surveyLocalization.getString("maxSelectError").format(this.maxCount)))):null},n.prototype.getDefaultErrorText=function(e){return e},n}(a),p=t.RegexValidator=function(t){function n(e){void 0===e&&(e=null),t.call(this),this.regex=e}return e(n,t),n.prototype.getType=function(){return"regexvalidator"},n.prototype.validate=function(e,t){if(void 0===t&&(t=null),!this.regex||!e)return null;var n=new RegExp(this.regex);return n.test(e)?null:new u(e,new i.CustomError(this.getErrorText(t)))},n}(a),d=t.EmailValidator=function(t){function n(){t.call(this),this.re=/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i}return e(n,t),n.prototype.getType=function(){return"emailvalidator"},n.prototype.validate=function(e,t){return void 0===t&&(t=null),e?this.re.test(e)?null:new u(e,new i.CustomError(this.getErrorText(t))):null},n.prototype.getDefaultErrorText=function(e){return o.surveyLocalization.getString("invalidEmail")},n}(a);s.JsonObject.metaData.addClass("surveyvalidator",["text"]),s.JsonObject.metaData.addClass("numericvalidator",["minValue:number","maxValue:number"],function(){return new l},"surveyvalidator"),s.JsonObject.metaData.addClass("textvalidator",["minLength:number","maxLength:number"],function(){return new c},"surveyvalidator"),s.JsonObject.metaData.addClass("answercountvalidator",["minCount:number","maxCount:number"],function(){return new h},"surveyvalidator"),s.JsonObject.metaData.addClass("regexvalidator",["regex"],function(){return new p},"surveyvalidator"),s.JsonObject.metaData.addClass("emailvalidator",[],function(){return new d},"surveyvalidator")}).call(t,n(5))},function(e,t,n){(function(n){"use strict";function n(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=n,"undefined"!=typeof e&&e.exports&&(t=e.exports=n),t.__extends=n}).call(t,n(5))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemValue=function(){function e(e,t){void 0===t&&(t=null),this.text=t,this.value=e}return e.setData=function(t,n){t.length=0;for(var r=0;r<n.length;r++){var i=n[r],o=new e(null);if("undefined"!=typeof i.value){var s=null;"undefined"!=typeof i.getType&&"itemvalue"==i.getType()&&(i.itemValue=i.itemValue,o.itemText=i.itemText,s=e.itemValueProp),e.copyAttributes(i,o,s)}else o.value=i;t.push(o)}},e.getData=function(e){for(var t=new Array,n=0;n<e.length;n++){var r=e[n];r.hasText?t.push({value:r.value,text:r.text}):t.push(r.value)}return t},e.getItemByValue=function(e,t){for(var n=0;n<e.length;n++)if(e[n].value==t)return e[n];return null},e.copyAttributes=function(e,t,n){for(var r in e)"function"!=typeof e[r]&&(n&&n.indexOf(r)>-1||(t[r]=e[r]))},e.prototype.getType=function(){return"itemvalue"},Object.defineProperty(e.prototype,"value",{get:function(){return this.itemValue},set:function(t){if(this.itemValue=t,this.itemValue){var n=this.itemValue.toString(),r=n.indexOf(e.Separator);r>-1&&(this.itemValue=n.slice(0,r),this.text=n.slice(r+1))}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasText",{get:function(){return!!this.itemText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.hasText?this.itemText:this.value?this.value.toString():null},set:function(e){this.itemText=e},enumerable:!0,configurable:!0}),e.Separator="|",e.itemValueProp=["text","value","hasText"],e}(),t.Base=function(){function e(){}return e.prototype.getType=function(){throw new Error("This method is abstract")},e}(),t.SurveyError=function(){function e(){}return e.prototype.getText=function(){throw new Error("This method is abstract")},e}(),t.SurveyPageId="sq_page",t.SurveyElement=function(){function e(){}return e.ScrollElementToTop=function(e){if(!e)return!1;var t=document.getElementById(e);if(!t||!t.scrollIntoView)return!1;var n=t.getBoundingClientRect().top;return n<0&&t.scrollIntoView(),n<0},e.FocusElement=function(e){if(!e)return!1;var t=document.getElementById(e);return!!t&&(t.focus(),!0)},e}(),t.Event=function(){function e(){}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return null==this.callbacks||0==this.callbacks.length},enumerable:!0,configurable:!0}),e.prototype.fire=function(e,t){if(null!=this.callbacks)for(var n=0;n<this.callbacks.length;n++){this.callbacks[n](e,t)}},e.prototype.add=function(e){null==this.callbacks&&(this.callbacks=new Array),this.callbacks.push(e)},e.prototype.remove=function(e){if(null!=this.callbacks){var t=this.callbacks.indexOf(e,0);void 0!=t&&this.callbacks.splice(t,1)}},e}()},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomError=t.ExceedSizeError=t.RequreNumericError=t.AnswerRequiredError=void 0;var r=n(8),i=n(6);t.AnswerRequiredError=function(t){function n(){t.call(this)}return e(n,t),n.prototype.getText=function(){return r.surveyLocalization.getString("requiredError")},n}(i.SurveyError),t.RequreNumericError=function(t){function n(){t.call(this)}return e(n,t),n.prototype.getText=function(){return r.surveyLocalization.getString("numericError")},n}(i.SurveyError),t.ExceedSizeError=function(t){function n(e){t.call(this),this.maxSize=e}return e(n,t),n.prototype.getText=function(){return r.surveyLocalization.getString("exceedMaxSize").format(this.getTextSize())},n.prototype.getTextSize=function(){var e=["Bytes","KB","MB","GB","TB"],t=[0,0,2,3,3];if(0==this.maxSize)return"0 Byte";var n=Math.floor(Math.log(this.maxSize)/Math.log(1024)),r=this.maxSize/Math.pow(1024,n);return r.toFixed(t[n])+" "+e[n]},n}(i.SurveyError),t.CustomError=function(t){function n(e){t.call(this),this.text=e}return e(n,t),n.prototype.getText=function(){return this.text},n}(i.SurveyError)}).call(t,n(5))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.surveyLocalization={currentLocale:"",locales:{},getString:function(e){var t=this.currentLocale?this.locales[this.currentLocale]:r;return t&&t[e]||(t=r),t[e]},getLocales:function(){var e=[];e.push("");for(var t in this.locales)e.push(t);return e.sort(),e}},r=t.surveyStrings={pagePrevText:"Previous",pageNextText:"Next",completeText:"Complete",otherItemText:"Other (describe)",progressText:"Page {0} of {1}",emptySurvey:"There is no visible page or question in the survey.",completingSurvey:"Thank you for completing the survey!",loadingSurvey:"Survey is loading...",optionsCaption:"Choose...",requiredError:"Please answer the question.",requiredInAllRowsError:"Please answer questions in all rows.",numericError:"The value should be numeric.",textMinLength:"Please enter at least {0} symbols.",textMaxLength:"Please enter less than {0} symbols.",textMinMaxLength:"Please enter more than {0} and less than {1} symbols.",minRowCountError:"Please fill in at least {0} rows.",minSelectError:"Please select at least {0} variants.",maxSelectError:"Please select no more than {0} variants.",numericMinMax:"The '{0}' should be equal or more than {1} and equal or less than {2}",numericMin:"The '{0}' should be equal or more than {1}",numericMax:"The '{0}' should be equal or less than {1}",invalidEmail:"Please enter a valid e-mail address.",urlRequestError:"The request returned error '{0}'. {1}",urlGetChoicesError:"The request returned empty data or the 'path' property is incorrect",exceedMaxSize:"The file size should not exceed {0}.",otherRequiredError:"Please enter the other value.",uploadingFile:"Your file is uploading. Please wait several seconds and try again.",addRow:"Add row",removeRow:"Remove"};n.locales.en=r,String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})})},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=t.JsonObjectProperty=function(){function e(e){this.name=e,this.typeValue=null,this.choicesValue=null,this.choicesfunc=null,this.className=null,this.classNamePart=null,this.baseClassName=null,this.defaultValue=null,this.onGetValue=null}return Object.defineProperty(e.prototype,"type",{get:function(){return this.typeValue?this.typeValue:"string"},set:function(e){this.typeValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasToUseGetValue",{get:function(){return this.onGetValue},enumerable:!0,configurable:!0}),e.prototype.isDefaultValue=function(e){return this.defaultValue?this.defaultValue==e:!e},e.prototype.getValue=function(e){return this.onGetValue?this.onGetValue(e):null},Object.defineProperty(e.prototype,"hasToUseSetValue",{get:function(){return this.onSetValue},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e,t,n){this.onSetValue&&this.onSetValue(e,t,n)},e.prototype.getObjType=function(e){return this.classNamePart?e.replace(this.classNamePart,""):e},e.prototype.getClassName=function(e){return this.classNamePart&&e.indexOf(this.classNamePart)<0?e+this.classNamePart:e},Object.defineProperty(e.prototype,"choices",{get:function(){return null!=this.choicesValue?this.choicesValue:null!=this.choicesfunc?this.choicesfunc():null},enumerable:!0,configurable:!0}),e.prototype.setChoices=function(e,t){this.choicesValue=e,this.choicesfunc=t},e}(),i=t.JsonMetadataClass=function(){function e(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null),this.name=e,this.creator=n,this.parentName=r,this.properties=null,this.requiredProperties=null,this.properties=new Array;for(var i=0;i<t.length;i++){var o=this.createProperty(t[i]);o&&this.properties.push(o)}}return e.prototype.find=function(e){for(var t=0;t<this.properties.length;t++)if(this.properties[t].name==e)return this.properties[t];return null},e.prototype.createProperty=function(t){var i="string"==typeof t?t:t.name;if(i){var o=null,s=i.indexOf(e.typeSymbol);s>-1&&(o=i.substring(s+1),i=i.substring(0,s)),i=this.getPropertyName(i);var u=new r(i);if(o&&(u.type=o),"object"===("undefined"==typeof t?"undefined":n(t))){if(t.type&&(u.type=t.type),t["default"]&&(u.defaultValue=t["default"]),t.isRequired&&this.makePropertyRequired(u.name),t.choices){var a="function"==typeof t.choices?t.choices:null,l="function"!=typeof t.choices?t.choices:null;u.setChoices(l,a)}t.onGetValue&&(u.onGetValue=t.onGetValue),t.onSetValue&&(u.onSetValue=t.onSetValue),t.className&&(u.className=t.className),t.baseClassName&&(u.baseClassName=t.baseClassName),t.classNamePart&&(u.classNamePart=t.classNamePart)}return u}},e.prototype.getPropertyName=function(t){return 0==t.length||t[0]!=e.requiredSymbol?t:(t=t.slice(1),this.makePropertyRequired(t),t)},e.prototype.makePropertyRequired=function(e){this.requiredProperties||(this.requiredProperties=new Array),this.requiredProperties.push(e)},e.requiredSymbol="!",e.typeSymbol=":",e}(),o=t.JsonMetadata=function(){function e(){this.classes={},this.childrenClasses={},this.classProperties={},this.classRequiredProperties={}}return e.prototype.addClass=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null);var o=new i(e,t,n,r);if(this.classes[e]=o,r){var s=this.childrenClasses[r];s||(this.childrenClasses[r]=[]),this.childrenClasses[r].push(o)}return o},e.prototype.overrideClassCreatore=function(e,t){var n=this.findClass(e);n&&(n.creator=t)},e.prototype.getProperties=function(e){var t=this.classProperties[e];return t||(t=new Array,this.fillProperties(e,t),this.classProperties[e]=t),t},e.prototype.createClass=function(e){var t=this.findClass(e);return t?t.creator():null},e.prototype.getChildrenClasses=function(e,t){void 0===t&&(t=!1);var n=[];return this.fillChildrenClasses(e,t,n),n},e.prototype.getRequiredProperties=function(e){var t=this.classRequiredProperties[e];return t||(t=new Array,this.fillRequiredProperties(e,t),this.classRequiredProperties[e]=t),t},e.prototype.addProperty=function(e,t){var n=this.findClass(e);if(n){var r=n.createProperty(t);r&&(this.addPropertyToClass(n,r),this.emptyClassPropertiesHash(n))}},e.prototype.removeProperty=function(e,t){var n=this.findClass(e);if(!n)return!1;var r=n.find(t);r&&(this.removePropertyFromClass(n,r),this.emptyClassPropertiesHash(n))},e.prototype.addPropertyToClass=function(e,t){null==e.find(t.name)&&e.properties.push(t)},e.prototype.removePropertyFromClass=function(e,t){var n=e.properties.indexOf(t);n<0||(e.properties.splice(n,1),e.requiredProperties&&(n=e.requiredProperties.indexOf(t.name),n>=0&&e.requiredProperties.splice(n,1)))},e.prototype.emptyClassPropertiesHash=function(e){this.classProperties[e.name]=null;for(var t=this.getChildrenClasses(e.name),n=0;n<t.length;n++)this.classProperties[t[n].name]=null},e.prototype.fillChildrenClasses=function(e,t,n){var r=this.childrenClasses[e];if(r)for(var i=0;i<r.length;i++)t&&!r[i].creator||n.push(r[i]),this.fillChildrenClasses(r[i].name,t,n)},e.prototype.findClass=function(e){return this.classes[e]},e.prototype.fillProperties=function(e,t){var n=this.findClass(e);if(n){n.parentName&&this.fillProperties(n.parentName,t);for(var r=0;r<n.properties.length;r++)this.addPropertyCore(n.properties[r],t,t.length)}},e.prototype.addPropertyCore=function(e,t,n){for(var r=-1,i=0;i<n;i++)if(t[i].name==e.name){r=i;break}r<0?t.push(e):t[r]=e},e.prototype.fillRequiredProperties=function(e,t){var n=this.findClass(e);n&&(n.requiredProperties&&Array.prototype.push.apply(t,n.requiredProperties),n.parentName&&this.fillRequiredProperties(n.parentName,t))},e}(),s=t.JsonError=function(){function e(e,t){this.type=e,this.message=t,this.description="",this.at=-1}return e.prototype.getFullDescription=function(){return this.message+(this.description?"\n"+this.description:"")},e}(),u=t.JsonUnknownPropertyError=function(t){function n(e,n){t.call(this,"unknownproperty","The property '"+e+"' in class '"+n+"' is unknown."),this.propertyName=e,this.className=n;var r=p.metaData.getProperties(n);if(r){this.description="The list of available properties are: ";for(var i=0;i<r.length;i++)i>0&&(this.description+=", "),
this.description+=r[i].name;this.description+="."}}return e(n,t),n}(s),a=t.JsonMissingTypeErrorBase=function(t){function n(e,n,r){t.call(this,n,r),this.baseClassName=e,this.type=n,this.message=r,this.description="The following types are available: ";for(var i=p.metaData.getChildrenClasses(e,!0),o=0;o<i.length;o++)o>0&&(this.description+=", "),this.description+="'"+i[o].name+"'";this.description+="."}return e(n,t),n}(s),l=t.JsonMissingTypeError=function(t){function n(e,n){t.call(this,n,"missingtypeproperty","The property type is missing in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=n}return e(n,t),n}(a),c=t.JsonIncorrectTypeError=function(t){function n(e,n){t.call(this,n,"incorrecttypeproperty","The property type is incorrect in the object. Please take a look at property: '"+e+"'."),this.propertyName=e,this.baseClassName=n}return e(n,t),n}(a),h=t.JsonRequiredPropertyError=function(t){function n(e,n){t.call(this,"requiredproperty","The property '"+e+"' is required in class '"+n+"'."),this.propertyName=e,this.className=n}return e(n,t),n}(s),p=t.JsonObject=function(){function e(){this.errors=new Array}return Object.defineProperty(e,"metaData",{get:function(){return e.metaDataValue},enumerable:!0,configurable:!0}),e.prototype.toJsonObject=function(e){return this.toJsonObjectCore(e,null)},e.prototype.toObject=function(t,n){if(t){var r=null;if(n.getType&&(r=e.metaData.getProperties(n.getType())),r)for(var i in t)if(i!=e.typePropertyName)if(i!=e.positionPropertyName){var o=this.findProperty(r,i);o?this.valueToObj(t[i],n,i,o):this.addNewError(new u(i.toString(),n.getType()),t)}else n[i]=t[i]}},e.prototype.toJsonObjectCore=function(t,n){if(!t.getType)return t;var r={};null==n||n.className||(r[e.typePropertyName]=n.getObjType(t.getType()));for(var i=e.metaData.getProperties(t.getType()),o=0;o<i.length;o++)this.valueToJson(t,r,i[o]);return r},e.prototype.valueToJson=function(e,t,n){var r=null;if(r=n.hasToUseGetValue?n.getValue(e):e[n.name],void 0!==r&&null!==r&&!n.isDefaultValue(r)){if(this.isValueArray(r)){for(var i=[],o=0;o<r.length;o++)i.push(this.toJsonObjectCore(r[o],n));r=i.length>0?i:null}else r=this.toJsonObjectCore(r,n);n.isDefaultValue(r)||(t[n.name]=r)}},e.prototype.valueToObj=function(e,t,n,r){if(null!=e){if(null!=r&&r.hasToUseSetValue)return void r.setValue(t,e,this);if(this.isValueArray(e))return void this.valueToArray(e,t,n,r);var i=this.createNewObj(e,r);i.newObj&&(this.toObject(e,i.newObj),e=i.newObj),i.error||(t[n]=e)}},e.prototype.isValueArray=function(e){return e&&e.constructor.toString().indexOf("Array")>-1},e.prototype.createNewObj=function(t,n){var r={newObj:null,error:null},i=t[e.typePropertyName];return!i&&null!=n&&n.className&&(i=n.className),i=n.getClassName(i),r.newObj=i?e.metaData.createClass(i):null,r.error=this.checkNewObjectOnErrors(r.newObj,t,n,i),r},e.prototype.checkNewObjectOnErrors=function(t,n,r,i){var o=null;if(t){var s=e.metaData.getRequiredProperties(i);if(s)for(var u=0;u<s.length;u++)if(!n[s[u]]){o=new h(s[u],i);break}}else r.baseClassName&&(o=i?new c(r.name,r.baseClassName):new l(r.name,r.baseClassName));return o&&this.addNewError(o,n),o},e.prototype.addNewError=function(t,n){n&&n[e.positionPropertyName]&&(t.at=n[e.positionPropertyName].start),this.errors.push(t)},e.prototype.valueToArray=function(e,t,n,r){this.isValueArray(t[n])||(t[n]=[]);for(var i=0;i<e.length;i++){var o=this.createNewObj(e[i],r);o.newObj?(t[n].push(o.newObj),this.toObject(e[i],o.newObj)):o.error||t[n].push(e[i])}},e.prototype.findProperty=function(e,t){if(!e)return null;for(var n=0;n<e.length;n++)if(e[n].name==t)return e[n];return null},e.typePropertyName="type",e.positionPropertyName="pos",e.metaDataValue=new o,e}()}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChoicesRestfull=void 0;var r=n(6),i=n(9),o=n(8),s=n(7),u=t.ChoicesRestfull=function(t){function n(){t.call(this),this.url="",this.path="",this.valueName="",this.titleName="",this.error=null}return e(n,t),n.prototype.run=function(){if(this.url&&this.getResultCallback){this.error=null;var e=new XMLHttpRequest;e.open("GET",this.url),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var t=this;e.onload=function(){200==e.status?t.onLoad(JSON.parse(e.response)):t.onError(e.statusText,e.responseText)},e.send()}},n.prototype.getType=function(){return"choicesByUrl"},Object.defineProperty(n.prototype,"isEmpty",{get:function(){return!(this.url||this.path||this.valueName||this.titleName)},enumerable:!0,configurable:!0}),n.prototype.setData=function(e){this.clear(),e.url&&(this.url=e.url),e.path&&(this.path=e.path),e.valueName&&(this.valueName=e.valueName),e.titleName&&(this.titleName=e.titleName)},n.prototype.clear=function(){this.url="",this.path="",this.valueName="",this.titleName=""},n.prototype.onLoad=function(e){var t=[];if(e=this.getResultAfterPath(e),e&&e.length)for(var n=0;n<e.length;n++){var i=e[n];if(i){var u=this.getValue(i),a=this.getTitle(i);t.push(new r.ItemValue(u,a))}}else this.error=new s.CustomError(o.surveyLocalization.getString("urlGetChoicesError"));this.getResultCallback(t)},n.prototype.onError=function(e,t){this.error=new s.CustomError(o.surveyLocalization.getString("urlRequestError").format(e,t)),this.getResultCallback([])},n.prototype.getResultAfterPath=function(e){if(!e)return e;if(!this.path)return e;for(var t=this.getPathes(),n=0;n<t.length;n++)if(e=e[t[n]],!e)return null;return e},n.prototype.getPathes=function(){var e=[];return e=this.path.indexOf(";")>-1?this.path.split(";"):this.path.split(","),0==e.length&&e.push(this.path),e},n.prototype.getValue=function(e){if(this.valueName)return e[this.valueName];var t=Object.keys(e).length;return t<1?null:e[Object.keys(e)[0]]},n.prototype.getTitle=function(e){return this.titleName?e[this.titleName]:null},n}(r.Base);i.JsonObject.metaData.addClass("choicesByUrl",["url","path","valueName","titleName"],function(){return new u})}).call(t,n(5))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConditionRunner=t.ConditionNode=t.Condition=void 0;var r=n(12),i=n(13),o=(t.Condition=function(){function e(){this.opValue="equal"}return Object.defineProperty(e,"operators",{get:function(){return null!=e.operatorsValue?e.operatorsValue:(e.operatorsValue={empty:function(e,t){return!e},notempty:function(e,t){return!!e},equal:function(e,t){return e==t},notequal:function(e,t){return e!=t},contains:function(e,t){return e&&e.indexOf&&e.indexOf(t)>-1},notcontains:function(e,t){return!e||!e.indexOf||e.indexOf(t)==-1},greater:function(e,t){return e>t},less:function(e,t){return e<t},greaterorequal:function(e,t){return e>=t},lessorequal:function(e,t){return e<=t}},e.operatorsValue)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"operator",{get:function(){return this.opValue},set:function(t){t&&(t=t.toLowerCase(),e.operators[t]&&(this.opValue=t))},enumerable:!0,configurable:!0}),e.prototype.perform=function(t,n){return void 0===t&&(t=null),void 0===n&&(n=null),t||(t=this.left),n||(n=this.right),e.operators[this.operator](this.getPureValue(t),this.getPureValue(n))},e.prototype.getPureValue=function(e){if(!e||"string"!=typeof e)return e;e.length>0&&("'"==e[0]||'"'==e[0])&&(e=e.substr(1));var t=e.length;return t>0&&("'"==e[t-1]||'"'==e[t-1])&&(e=e.substr(0,t-1)),e},e.operatorsValue=null,e}(),t.ConditionNode=function(){function e(){this.connectiveValue="and",this.children=[]}return Object.defineProperty(e.prototype,"connective",{get:function(){return this.connectiveValue},set:function(e){e&&(e=e.toLowerCase(),"&"!=e&&"&&"!=e||(e="and"),"|"!=e&&"||"!=e||(e="or"),"and"!=e&&"or"!=e||(this.connectiveValue=e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0==this.children.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.children=[],this.connective="and"},e}());t.ConditionRunner=function(){function e(e){this.root=new o,this.expression=e,this.processValue=new i.ProcessValue}return Object.defineProperty(e.prototype,"expression",{get:function(){return this.expressionValue},set:function(e){this.expression!=e&&(this.expressionValue=e,(new r.ConditionsParser).parse(this.expressionValue,this.root))},enumerable:!0,configurable:!0}),e.prototype.run=function(e){return this.values=e,this.runNode(this.root)},e.prototype.runNode=function(e){for(var t="and"==e.connective,n=0;n<e.children.length;n++){var r=this.runNodeCondition(e.children[n]);if(!r&&t)return!1;if(r&&!t)return!0}return t},e.prototype.runNodeCondition=function(e){return!!e&&(e.children?this.runNode(e):!!e.left&&this.runCondition(e))},e.prototype.runCondition=function(e){var t=e.left,n=this.getValueName(t);if(n){if(!this.processValue.hasValue(n,this.values))return!1;t=this.processValue.getValue(n,this.values)}var r=e.right;if(n=this.getValueName(r)){if(!this.processValue.hasValue(n,this.values))return!1;r=this.processValue.getValue(n,this.values)}return e.perform(t,r)},e.prototype.getValueName=function(e){return e?"string"!=typeof e?null:e.length<3||"{"!=e[0]||"}"!=e[e.length-1]?null:e.substr(1,e.length-2):null},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConditionsParser=void 0;var r=n(11);t.ConditionsParser=function(){function e(){}return e.prototype.parse=function(e,t){this.text=e,this.root=t,this.root.clear(),this.at=0,this.length=this.text.length;var n=this.parseText();return n},e.prototype.toString=function(e){return this.root=e,this.nodeToString(e)},e.prototype.toStringCore=function(e){return e?e.children?this.nodeToString(e):e.left?this.conditionToString(e):"":""},e.prototype.nodeToString=function(e){if(e.isEmpty)return"";for(var t="",n=0;n<e.children.length;n++){var r=this.toStringCore(e.children[n]);r&&(t&&(t+=" "+e.connective+" "),t+=r)}return e!=this.root&&e.children.length>1&&(t="("+t+")"),t},e.prototype.conditionToString=function(e){if(!e.right||!e.operator)return"";var t=e.left;t&&!this.isNumeric(t)&&(t="'"+t+"'");var n=t+" "+this.operationToString(e.operator);if(this.isNoRightOperation(e.operator))return n;var r=e.right;return r&&!this.isNumeric(r)&&(r="'"+r+"'"),n+" "+r},e.prototype.operationToString=function(e){return"equal"==e?"=":"notequal"==e?"!=":"greater"==e?">":"less"==e?"<":"greaterorequal"==e?">=":"lessorequal"==e?"<=":e},e.prototype.isNumeric=function(e){var t=parseFloat(e);return!isNaN(t)&&isFinite(t)},e.prototype.parseText=function(){this.node=this.root,this.expressionNodes=[],this.expressionNodes.push(this.node);var e=this.readConditions();return e&&this.at>=this.length},e.prototype.readConditions=function(){var e=this.readCondition();if(!e)return e;var t=this.readConnective();return!t||(this.addConnective(t),this.readConditions())},e.prototype.readCondition=function(){if(!this.readExpression())return!1;var e=this.readString();if(!e)return!1;var t=this.readOperator();if(!t)return!1;var n=new r.Condition;if(n.left=e,n.operator=t,!this.isNoRightOperation(t)){var i=this.readString();if(!i)return!1;n.right=i}return this.addCondition(n),!0},e.prototype.readExpression=function(){if(this.skip(),this.at>=this.length||"("!=this.ch)return!0;this.at++,this.pushExpression();var e=this.readConditions();return e&&(this.skip(),e=")"==this.ch,this.at++,this.popExpression()),e},Object.defineProperty(e.prototype,"ch",{get:function(){return this.text.charAt(this.at)},enumerable:!0,configurable:!0}),e.prototype.skip=function(){for(;this.at<this.length&&this.isSpace(this.ch);)this.at++},e.prototype.isSpace=function(e){return" "==e||"\n"==e||"\t"==e||"\r"==e},e.prototype.isQuotes=function(e){return"'"==e||'"'==e},e.prototype.isOperatorChar=function(e){return">"==e||"<"==e||"="==e||"!"==e},e.prototype.isBrackets=function(e){return"("==e||")"==e},e.prototype.readString=function(){if(this.skip(),this.at>=this.length)return null;var e=this.at,t=this.isQuotes(this.ch);t&&this.at++;for(var n=this.isOperatorChar(this.ch);this.at<this.length&&(t||!this.isSpace(this.ch));){if(this.isQuotes(this.ch)){t&&this.at++;break}if(!t){if(n!=this.isOperatorChar(this.ch))break;if(this.isBrackets(this.ch))break}this.at++}if(this.at<=e)return null;var r=this.text.substr(e,this.at-e);if(r&&r.length>1&&this.isQuotes(r[0])){var i=r.length-1;this.isQuotes(r[r.length-1])&&i--,r=r.substr(1,i)}return r},e.prototype.isNoRightOperation=function(e){return"empty"==e||"notempty"==e},e.prototype.readOperator=function(){var e=this.readString();return e?(e=e.toLowerCase(),">"==e&&(e="greater"),"<"==e&&(e="less"),">="!=e&&"=>"!=e||(e="greaterorequal"),"<="!=e&&"=<"!=e||(e="lessorequal"),"="!=e&&"=="!=e||(e="equal"),"<>"!=e&&"!="!=e||(e="notequal"),"contain"==e&&(e="contains"),"notcontain"==e&&(e="notcontains"),e):null},e.prototype.readConnective=function(){var e=this.readString();return e?(e=e.toLowerCase(),"&"!=e&&"&&"!=e||(e="and"),"|"!=e&&"||"!=e||(e="or"),"and"!=e&&"or"!=e&&(e=null),e):null},e.prototype.pushExpression=function(){var e=new r.ConditionNode;this.expressionNodes.push(e),this.node=e},e.prototype.popExpression=function(){var e=this.expressionNodes.pop();this.node=this.expressionNodes[this.expressionNodes.length-1],this.node.children.push(e)},e.prototype.addCondition=function(e){this.node.children.push(e)},e.prototype.addConnective=function(e){if(this.node.children.length<2)this.node.connective=e;else if(this.node.connective!=e){var t=this.node.connective,n=this.node.children;this.node.clear(),this.node.connective=e;var i=new r.ConditionNode;i.connective=t,i.children=n,this.node.children.push(i);var o=new r.ConditionNode;this.node.children.push(o),this.node=o}},e}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ProcessValue=function(){function e(){}return e.prototype.getFirstName=function(e){if(!e)return e;for(var t="",n=0;n<e.length;n++){var r=e[n];if("."==r||"["==r)break;t+=r}return t},e.prototype.hasValue=function(e,t){var n=this.getValueCore(e,t);return n.hasValue},e.prototype.getValue=function(e,t){var n=this.getValueCore(e,t);return n.value},e.prototype.getValueCore=function(e,t){var n={hasValue:!1,value:null},r=t;if(!r)return n;for(var i=!0;e&&e.length>0;){var o=!i&&"["==e[0];if(o){if(!Array.isArray(r))return n;for(var s=1,u="";s<e.length&&"]"!=e[s];)u+=e[s],s++;if(e=s<e.length?e.substr(s+1):"",s=this.getIntValue(u),s<0||s>=r.length)return n;r=r[s]}else{i||(e=e.substr(1));var a=this.getFirstName(e);if(!a)return n;if(!r[a])return n;r=r[a],e=e.substr(a.length)}i=!1}return n.value=r,n.hasValue=!0,n},e.prototype.getIntValue=function(e){return"0"==e||(0|e)>0&&e%1==0?Number(e):-1},e}()},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionMatrixDropdownModelBase=t.MatrixDropdownRowModelBase=t.MatrixDropdownCell=t.MatrixDropdownColumn=void 0;var r=n(9),i=n(15),o=n(6),s=n(8),u=n(18),a=n(19),l=t.MatrixDropdownColumn=function(t){function n(e,n){void 0===n&&(n=null),t.call(this),this.name=e,this.choicesValue=[],this.isRequired=!1,this.hasOther=!1,this.minWidth="",this.cellType="default",this.colCountValue=-1}return e(n,t),n.prototype.getType=function(){return"matrixdropdowncolumn"},Object.defineProperty(n.prototype,"title",{get:function(){return this.titleValue?this.titleValue:this.name},set:function(e){this.titleValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"choices",{get:function(){return this.choicesValue},set:function(e){o.ItemValue.setData(this.choicesValue,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"colCount",{get:function(){return this.colCountValue},set:function(e){e<-1||e>4||(this.colCountValue=e)},enumerable:!0,configurable:!0}),n}(o.Base),c=t.MatrixDropdownCell=function(){function e(e,t,n){this.column=e,this.row=t,this.questionValue=n.createQuestion(this.row,this.column),this.questionValue.setData(t)}return Object.defineProperty(e.prototype,"question",{get:function(){return this.questionValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.question.value},set:function(e){this.question.value=e},enumerable:!0,configurable:!0}),e}(),h=(t.MatrixDropdownRowModelBase=function(){function e(t,n){this.rowValues={},this.rowComments={},this.isSettingValue=!1,this.cells=[],this.data=t,this.value=n,this.idValue=e.getId(),this.buildCells()}return e.getId=function(){return"srow_"+e.idCounter++},Object.defineProperty(e.prototype,"id",{get:function(){return this.idValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowName",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.rowValues},set:function(e){if(this.isSettingValue=!0,this.rowValues={},null!=e)for(var t in e)this.rowValues[t]=e[t];for(var n=0;n<this.cells.length;n++)this.cells[n].question.onSurveyValueChanged(this.getValue(this.cells[n].column.name));this.isSettingValue=!1},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e){return this.rowValues[e]},e.prototype.setValue=function(e,t){this.isSettingValue||(""===t&&(t=null),null!=t?this.rowValues[e]=t:delete this.rowValues[e],this.data.onRowChanged(this,this.value))},e.prototype.getComment=function(e){return this.rowComments[e]},e.prototype.setComment=function(e,t){this.rowComments[e]=t},Object.defineProperty(e.prototype,"isEmpty",{get:function(){var e=this.value;if(!e)return!0;for(var t in e)return!1;return!0},enumerable:!0,configurable:!0}),e.prototype.buildCells=function(){for(var e=this.data.columns,t=0;t<e.length;t++){var n=e[t];this.cells.push(this.createCell(n))}},e.prototype.createCell=function(e){return new c(e,this,this.data)},e.idCounter=1,e}(),t.QuestionMatrixDropdownModelBase=function(t){function n(e){t.call(this,e),this.name=e,this.columnsValue=[],this.choicesValue=[],this.isRowChanging=!1,this.cellTypeValue="dropdown",this.columnColCountValue=0,this.columnMinWidth="",this.horizontalScroll=!1}return e(n,t),n.prototype.getType=function(){return"matrixdropdownbase"},Object.defineProperty(n.prototype,"columns",{get:function(){return this.columnsValue},set:function(e){this.columnsValue=e,this.fireCallback(this.columnsChangedCallback)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cellType",{get:function(){return this.cellTypeValue},set:function(e){this.cellType!=e&&(this.cellTypeValue=e,this.fireCallback(this.updateCellsCallbak))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columnColCount",{get:function(){return this.columnColCountValue},set:function(e){e<0||e>4||(this.columnColCountValue=e,this.fireCallback(this.updateCellsCallbak))},enumerable:!0,configurable:!0}),n.prototype.getColumnTitle=function(e){var t=e.title;if(e.isRequired&&this.survey){var n=this.survey.requiredText;n&&(n+=" "),t=n+t}return t},n.prototype.getColumnWidth=function(e){return e.minWidth?e.minWidth:this.columnMinWidth},Object.defineProperty(n.prototype,"choices",{get:function(){return this.choicesValue},set:function(e){o.ItemValue.setData(this.choicesValue,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"optionsCaption",{get:function(){return this.optionsCaptionValue?this.optionsCaptionValue:s.surveyLocalization.getString("optionsCaption")},set:function(e){this.optionsCaptionValue=e},enumerable:!0,configurable:!0}),n.prototype.addColumn=function(e,t){void 0===t&&(t=null);var n=new l(e,t);return this.columnsValue.push(n),n},Object.defineProperty(n.prototype,"visibleRows",{get:function(){return this.generatedVisibleRows=this.generateRows(),this.generatedVisibleRows},enumerable:!0,configurable:!0}),n.prototype.generateRows=function(){return null},n.prototype.createMatrixRow=function(e,t,n){return null},n.prototype.createNewValue=function(e){return e?e:{}},n.prototype.getRowValue=function(e,t,n){void 0===n&&(n=!1);var r=t[e.rowName]?t[e.rowName]:null;return!r&&n&&(r={},t[e.rowName]=r),r},n.prototype.onBeforeValueChanged=function(e){},n.prototype.onValueChanged=function(){if(!this.isRowChanging&&(this.onBeforeValueChanged(this.value),this.generatedVisibleRows&&0!=this.generatedVisibleRows.length)){this.isRowChanging=!0;for(var e=this.createNewValue(this.value),t=0;t<this.generatedVisibleRows.length;t++){var n=this.generatedVisibleRows[t];this.generatedVisibleRows[t].value=this.getRowValue(n,e)}this.isRowChanging=!1}},n.prototype.supportGoNextPageAutomatic=function(){var e=this.generatedVisibleRows;if(e||(e=this.visibleRows),!e)return!0;for(var t=0;t<e.length;t++){var n=this.generatedVisibleRows[t].cells;if(n)for(var r=0;r<n.length;r++){var i=n[r].question;if(i&&(!i.supportGoNextPageAutomatic()||!i.value))return!1}}return!0},n.prototype.hasErrors=function(e){void 0===e&&(e=!0);var n=this.hasErrorInColumns(e);return t.prototype.hasErrors.call(this,e)||n},n.prototype.hasErrorInColumns=function(e){if(!this.generatedVisibleRows)return!1;for(var t=!1,n=0;n<this.columns.length;n++)for(var r=0;r<this.generatedVisibleRows.length;r++){var i=this.generatedVisibleRows[r].cells;t=i&&i[n]&&i[n].question&&i[n].question.hasErrors(e)||t}return t},n.prototype.getFirstInputElementId=function(){var e=this.getFirstCellQuestion(!1);return e?e.inputId:t.prototype.getFirstInputElementId.call(this)},n.prototype.getFirstErrorInputElementId=function(){var e=this.getFirstCellQuestion(!0);return e?e.inputId:t.prototype.getFirstErrorInputElementId.call(this)},n.prototype.getFirstCellQuestion=function(e){if(!this.generatedVisibleRows)return null;for(var t=0;t<this.generatedVisibleRows.length;t++)for(var n=this.generatedVisibleRows[t].cells,r=0;r<this.columns.length;r++){if(!e)return n[r].question;if(n[r].question.currentErrorCount>0)return n[r].question}return null},n.prototype.createQuestion=function(e,t){var n=this.createQuestionCore(e,t);return n.name=t.name,n.isRequired=t.isRequired,n.hasOther=t.hasOther,t.hasOther&&n instanceof u.QuestionSelectBase&&(n.storeOthersAsComment=!1),n},n.prototype.createQuestionCore=function(e,t){var n="default"==t.cellType?this.cellType:t.cellType,r=this.getQuestionName(e,t);return"checkbox"==n?this.createCheckbox(r,t):"radiogroup"==n?this.createRadiogroup(r,t):"text"==n?this.createText(r,t):"comment"==n?this.createComment(r,t):this.createDropdown(r,t)},n.prototype.getQuestionName=function(e,t){return e.rowName+"_"+t.name},n.prototype.getColumnChoices=function(e){return e.choices&&e.choices.length>0?e.choices:this.choices},n.prototype.getColumnOptionsCaption=function(e){return e.optionsCaption?e.optionsCaption:this.optionsCaption},n.prototype.createDropdown=function(e,t){var n=this.createCellQuestion("dropdown",e);return n.choices=this.getColumnChoices(t),n.optionsCaption=this.getColumnOptionsCaption(t),n},n.prototype.createCheckbox=function(e,t){var n=this.createCellQuestion("checkbox",e);return n.choices=this.getColumnChoices(t),n.colCount=t.colCount>-1?t.colCount:this.columnColCount,n},n.prototype.createRadiogroup=function(e,t){var n=this.createCellQuestion("radiogroup",e);return n.choices=this.getColumnChoices(t),n.colCount=t.colCount>-1?t.colCount:this.columnColCount,n},n.prototype.createText=function(e,t){return this.createCellQuestion("text",e)},n.prototype.createComment=function(e,t){return this.createCellQuestion("comment",e)},n.prototype.createCellQuestion=function(e,t){return a.QuestionFactory.Instance.createQuestion(e,t)},n.prototype.deleteRowValue=function(e,t){return delete e[t.rowName],0==Object.keys(e).length?null:e},n.prototype.onRowChanged=function(e,t){var n=this.createNewValue(this.value),r=this.getRowValue(e,n,!0);for(var i in r)delete r[i];if(t){t=JSON.parse(JSON.stringify(t));for(var i in t)r[i]=t[i]}0==Object.keys(r).length&&(n=this.deleteRowValue(n,e)),this.isRowChanging=!0,this.setNewValue(n),this.isRowChanging=!1},n}(i.Question));r.JsonObject.metaData.addClass("matrixdropdowncolumn",["name",{name:"title",onGetValue:function(e){return e.titleValue}},{name:"choices:itemvalues",onGetValue:function(e){return o.ItemValue.getData(e.choices)},onSetValue:function(e,t){e.choices=t}},"optionsCaption",{name:"cellType","default":"default",choices:["default","dropdown","checkbox","radiogroup","text","comment"]},{name:"colCount","default":-1,choices:[-1,0,1,2,3,4]},"isRequired:boolean","hasOther:boolean","minWidth"],function(){return new l("")}),r.JsonObject.metaData.addClass("matrixdropdownbase",[{name:"columns:matrixdropdowncolumns",className:"matrixdropdowncolumn"},"horizontalScroll:boolean",{name:"choices:itemvalues",onGetValue:function(e){return o.ItemValue.getData(e.choices)},onSetValue:function(e,t){e.choices=t}},{name:"optionsCaption",onGetValue:function(e){return e.optionsCaptionValue}},{name:"cellType","default":"dropdown",choices:["dropdown","checkbox","radiogroup","text","comment"]},{name:"columnColCount","default":0,choices:[0,1,2,3,4]},"columnMinWidth"],function(){return new h("")},"question")}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Question=void 0;var r=n(9),i=n(16),o=n(6),s=n(8),u=n(7),a=n(4),l=n(17);t.Question=function(t){function n(e){t.call(this,e),this.name=e,this.titleValue=null,this.isRequiredValue=!1,this.hasCommentValue=!1,this.hasOtherValue=!1,this.commentTextValue="",this.errors=[],this.validators=new Array,this.isValueChangedInSurvey=!1}return e(n,t),Object.defineProperty(n.prototype,"hasTitle",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasInput",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"inputId",{get:function(){return this.id+"i"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this.titleValue?this.titleValue:this.name},set:function(e){this.titleValue=e,this.fireCallback(this.titleChangedCallback)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"processedTitle",{get:function(){return null!=this.survey?this.survey.processText(this.title):this.title},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fullTitle",{get:function(){if(this.survey&&this.survey.questionTitleTemplate){if(!this.textPreProcessor){var e=this;this.textPreProcessor=new l.TextPreProcessor,this.textPreProcessor.onHasValue=function(t){return e.canProcessedTextValues(t.toLowerCase())},this.textPreProcessor.onProcess=function(t){return e.getProcessedTextValue(t)}}return this.textPreProcessor.process(this.survey.questionTitleTemplate)}var t=this.requiredText;t&&(t+=" ");var n=this.no;return n&&(n+=". "),n+t+this.processedTitle},enumerable:!0,configurable:!0}),n.prototype.focus=function(e){void 0===e&&(e=!1),o.SurveyElement.ScrollElementToTop(this.id);var t=e?this.getFirstErrorInputElementId():this.getFirstInputElementId();o.SurveyElement.FocusElement(t)&&this.fireCallback(this.focusCallback)},n.prototype.getFirstInputElementId=function(){return this.inputId},n.prototype.getFirstErrorInputElementId=function(){return this.getFirstInputElementId()},n.prototype.canProcessedTextValues=function(e){return"no"==e||"title"==e||"require"==e},n.prototype.getProcessedTextValue=function(e){return"no"==e?this.no:"title"==e?this.processedTitle:"require"==e?this.requiredText:null},n.prototype.supportComment=function(){return!1},n.prototype.supportOther=function(){return!1},Object.defineProperty(n.prototype,"isRequired",{get:function(){return this.isRequiredValue},set:function(e){this.isRequired!=e&&(this.isRequiredValue=e,this.fireCallback(this.titleChangedCallback))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasComment",{get:function(){return this.hasCommentValue},set:function(e){this.supportComment()&&(this.hasCommentValue=e,this.hasComment&&(this.hasOther=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"commentText",{get:function(){return this.commentTextValue?this.commentTextValue:s.surveyLocalization.getString("otherItemText")},set:function(e){this.commentTextValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasOther",{get:function(){return this.hasOtherValue},set:function(e){this.supportOther()&&this.hasOther!=e&&(this.hasOtherValue=e,this.hasOther&&(this.hasComment=!1),this.hasOtherChanged())},enumerable:!0,configurable:!0}),n.prototype.hasOtherChanged=function(){},Object.defineProperty(n.prototype,"no",{get:function(){if(this.visibleIndex<0)return"";var e=1,t=!0,n="";return this.survey&&this.survey.questionStartIndex&&(n=this.survey.questionStartIndex,parseInt(n)?e=parseInt(n):1==n.length&&(t=!1)),t?(this.visibleIndex+e).toString():String.fromCharCode(n.charCodeAt(0)+this.visibleIndex)},enumerable:!0,configurable:!0}),n.prototype.onSetData=function(){t.prototype.onSetData.call(this),this.onSurveyValueChanged(this.value)},Object.defineProperty(n.prototype,"value",{get:function(){return this.valueFromData(this.getValueCore())},set:function(e){this.setNewValue(e),this.fireCallback(this.valueChangedCallback)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"comment",{get:function(){return this.getComment()},set:function(e){this.comment!=e&&(this.setComment(e),this.fireCallback(this.commentChangedCallback))},enumerable:!0,configurable:!0}),n.prototype.getComment=function(){return null!=this.data?this.data.getComment(this.name):this.questionComment},n.prototype.setComment=function(e){this.setNewComment(e)},n.prototype.isEmpty=function(){return null==this.value},n.prototype.hasErrors=function(e){return void 0===e&&(e=!0),this.checkForErrors(e),this.errors.length>0},Object.defineProperty(n.prototype,"currentErrorCount",{get:function(){return this.errors.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"requiredText",{get:function(){return null!=this.survey&&this.isRequired?this.survey.requiredText:""},enumerable:!0,configurable:!0}),n.prototype.addError=function(e){this.errors.push(e),this.fireCallback(this.errorsChangedCallback)},n.prototype.checkForErrors=function(e){var t=this.errors?this.errors.length:0;if(this.errors=[],this.onCheckForErrors(this.errors),0==this.errors.length&&this.value){var n=this.runValidators();n&&this.errors.push(n)}if(this.survey&&0==this.errors.length){var n=this.survey.validateQuestion(this.name);n&&this.errors.push(n)}e&&(t!=this.errors.length||t>0)&&this.fireCallback(this.errorsChangedCallback)},n.prototype.onCheckForErrors=function(e){this.hasRequiredError()&&this.errors.push(new u.AnswerRequiredError)},n.prototype.hasRequiredError=function(){return this.isRequired&&this.isEmpty()},n.prototype.runValidators=function(){return(new a.ValidatorRunner).run(this)},n.prototype.setNewValue=function(e){this.setNewValueInData(e),this.onValueChanged()},n.prototype.setNewValueInData=function(e){this.isValueChangedInSurvey||(e=this.valueToData(e),this.setValueCore(e))},n.prototype.getValueCore=function(){return null!=this.data?this.data.getValue(this.name):this.questionValue},n.prototype.setValueCore=function(e){null!=this.data?this.data.setValue(this.name,e):this.questionValue=e},n.prototype.valueFromData=function(e){return e},n.prototype.valueToData=function(e){return e},n.prototype.onValueChanged=function(){},n.prototype.setNewComment=function(e){null!=this.data?this.data.setComment(this.name,e):this.questionComment=e},n.prototype.onSurveyValueChanged=function(e){this.isValueChangedInSurvey=!0,this.value=this.valueFromData(e),this.fireCallback(this.commentChangedCallback),this.isValueChangedInSurvey=!1},n.prototype.getValidatorTitle=function(){return null},n}(i.QuestionBase);r.JsonObject.metaData.addClass("question",[{name:"title:text",onGetValue:function(e){return e.titleValue}},{name:"commentText",onGetValue:function(e){return e.commentTextValue}},"isRequired:boolean",{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"}],null,"questionbase")}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionBase=void 0;var r=n(6),i=n(9),o=n(11);t.QuestionBase=function(t){
function n(e){t.call(this),this.name=e,this.conditionRunner=null,this.visibleIf="",this.visibleValue=!0,this.startWithNewLine=!0,this.visibleIndexValue=-1,this.width="",this.renderWidthValue="",this.rightIndentValue=0,this.indent=0,this.idValue=n.getQuestionId(),this.onCreating()}return e(n,t),n.getQuestionId=function(){return"sq_"+n.questionCounter++},Object.defineProperty(n.prototype,"visible",{get:function(){return this.visibleValue},set:function(e){e!=this.visible&&(this.visibleValue=e,this.fireCallback(this.visibilityChangedCallback),this.fireCallback(this.rowVisibilityChangedCallback),this.survey&&this.survey.questionVisibilityChanged(this,this.visible))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleIndex",{get:function(){return this.visibleIndexValue},enumerable:!0,configurable:!0}),n.prototype.hasErrors=function(e){return void 0===e&&(e=!0),!1},Object.defineProperty(n.prototype,"currentErrorCount",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasTitle",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasInput",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasComment",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.idValue},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"renderWidth",{get:function(){return this.renderWidthValue},set:function(e){e!=this.renderWidth&&(this.renderWidthValue=e,this.fireCallback(this.renderWidthChangedCallback))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightIndent",{get:function(){return this.rightIndentValue},set:function(e){e!=this.rightIndent&&(this.rightIndentValue=e,this.fireCallback(this.renderWidthChangedCallback))},enumerable:!0,configurable:!0}),n.prototype.focus=function(e){void 0===e&&(e=!1)},n.prototype.setData=function(e){this.data=e,this.survey=e&&e.questionAdded?e:null,this.onSetData()},n.prototype.fireCallback=function(e){e&&e()},n.prototype.onSetData=function(){},n.prototype.onCreating=function(){},n.prototype.runCondition=function(e){this.visibleIf&&(this.conditionRunner||(this.conditionRunner=new o.ConditionRunner(this.visibleIf)),this.conditionRunner.expression=this.visibleIf,this.visible=this.conditionRunner.run(e))},n.prototype.onSurveyValueChanged=function(e){},n.prototype.onSurveyLoad=function(){},n.prototype.setVisibleIndex=function(e){this.visibleIndexValue!=e&&(this.visibleIndexValue=e,this.fireCallback(this.visibleIndexChangedCallback))},n.prototype.supportGoNextPageAutomatic=function(){return!1},n.questionCounter=100,n}(r.Base);i.JsonObject.metaData.addClass("questionbase",["!name",{name:"visible:boolean","default":!0},"visibleIf:text",{name:"width"},{name:"startWithNewLine:boolean","default":!0},{name:"indent:number","default":0,choices:[0,1,2,3]}])}).call(t,n(5))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.TextPreProcessorItem=function(){function e(){}return e}();t.TextPreProcessor=function(){function e(){}return e.prototype.process=function(e){if(!e)return e;if(!this.onProcess)return e;for(var t=this.getItems(e),n=t.length-1;n>=0;n--){var r=t[n],i=this.getName(e.substring(r.start+1,r.end));if(this.canProcessName(i)&&(!this.onHasValue||this.onHasValue(i))){var o=this.onProcess(i);null==o&&(o=""),e=e.substr(0,r.start)+o+e.substr(r.end+1)}}return e},e.prototype.getItems=function(e){for(var t=[],r=e.length,i=-1,o="",s=0;s<r;s++)if(o=e[s],"{"==o&&(i=s),"}"==o){if(i>-1){var u=new n;u.start=i,u.end=s,t.push(u)}i=-1}return t},e.prototype.getName=function(e){if(e)return e.trim()},e.prototype.canProcessName=function(e){if(!e)return!1;for(var t=0;t<e.length;t++){var n=e[t];if(" "==n||"-"==n||"&"==n)return!1}return!0},e}()},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionCheckboxBase=t.QuestionSelectBase=void 0;var r=n(9),i=n(15),o=n(6),s=n(8),u=n(7),a=n(10),l=t.QuestionSelectBase=function(t){function n(e){t.call(this,e),this.visibleChoicesCache=null,this.otherItem=new o.ItemValue("other",s.surveyLocalization.getString("otherItemText")),this.choicesFromUrl=null,this.cachedValueForUrlRequestion=null,this.choicesValues=new Array,this.otherErrorText=null,this.storeOthersAsComment=!0,this.choicesOrderValue="none",this.isSettingComment=!1,this.choicesByUrl=this.createRestfull();var n=this;this.choicesByUrl.getResultCallback=function(e){n.onLoadChoicesFromUrl(e)}}return e(n,t),Object.defineProperty(n.prototype,"isOtherSelected",{get:function(){return this.getStoreOthersAsComment()?this.getHasOther(this.value):this.getHasOther(this.cachedValue)},enumerable:!0,configurable:!0}),n.prototype.getHasOther=function(e){return e==this.otherItem.value},n.prototype.createRestfull=function(){return new a.ChoicesRestfull},n.prototype.getComment=function(){return this.getStoreOthersAsComment()?t.prototype.getComment.call(this):this.commentValue},n.prototype.setComment=function(e){this.getStoreOthersAsComment()?t.prototype.setComment.call(this,e):this.isSettingComment||e==this.commentValue||(this.isSettingComment=!0,this.commentValue=e,this.isOtherSelected&&this.setNewValueInData(this.cachedValue),this.isSettingComment=!1)},n.prototype.setNewValue=function(e){e&&(this.cachedValueForUrlRequestion=e),t.prototype.setNewValue.call(this,e)},n.prototype.valueFromData=function(e){return this.getStoreOthersAsComment()?t.prototype.valueFromData.call(this,e):(this.cachedValue=this.valueFromDataCore(e),this.cachedValue)},n.prototype.valueToData=function(e){return this.getStoreOthersAsComment()?t.prototype.valueToData.call(this,e):(this.cachedValue=e,this.valueToDataCore(e))},n.prototype.valueFromDataCore=function(e){return this.hasUnknownValue(e)?e==this.otherItem.value?e:(this.comment=e,this.otherItem.value):e},n.prototype.valueToDataCore=function(e){return e==this.otherItem.value&&this.getComment()&&(e=this.getComment()),e},n.prototype.hasUnknownValue=function(e){if(!e)return!1;for(var t=this.activeChoices,n=0;n<t.length;n++)if(t[n].value==e)return!1;return!0},Object.defineProperty(n.prototype,"choices",{get:function(){return this.choicesValues},set:function(e){o.ItemValue.setData(this.choicesValues,e),this.onVisibleChoicesChanged()},enumerable:!0,configurable:!0}),n.prototype.hasOtherChanged=function(){this.onVisibleChoicesChanged()},Object.defineProperty(n.prototype,"choicesOrder",{get:function(){return this.choicesOrderValue},set:function(e){e!=this.choicesOrderValue&&(this.choicesOrderValue=e,this.onVisibleChoicesChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"otherText",{get:function(){return this.otherItem.text},set:function(e){this.otherItem.text=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleChoices",{get:function(){return this.hasOther||"none"!=this.choicesOrder?(this.visibleChoicesCache||(this.visibleChoicesCache=this.sortVisibleChoices(this.activeChoices.slice()),this.hasOther&&this.visibleChoicesCache.push(this.otherItem)),this.visibleChoicesCache):this.activeChoices},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"activeChoices",{get:function(){return this.choicesFromUrl?this.choicesFromUrl:this.choices},enumerable:!0,configurable:!0}),n.prototype.supportComment=function(){return!0},n.prototype.supportOther=function(){return!0},n.prototype.onCheckForErrors=function(e){if(t.prototype.onCheckForErrors.call(this,e),this.isOtherSelected&&!this.comment){var n=this.otherErrorText;n||(n=s.surveyLocalization.getString("otherRequiredError")),e.push(new u.CustomError(n))}},n.prototype.getStoreOthersAsComment=function(){return this.storeOthersAsComment&&(null==this.survey||this.survey.storeOthersAsComment)},n.prototype.onSurveyLoad=function(){this.choicesByUrl&&this.choicesByUrl.run()},n.prototype.onLoadChoicesFromUrl=function(e){var t=this.errors.length;this.errors=[],this.choicesByUrl&&this.choicesByUrl.error&&this.errors.push(this.choicesByUrl.error),(t>0||this.errors.length>0)&&this.fireCallback(this.errorsChangedCallback);var n=null;e&&e.length>0&&(n=new Array,o.ItemValue.setData(n,e)),this.choicesFromUrl=n,this.onVisibleChoicesChanged(),this.cachedValueForUrlRequestion&&(this.value=this.cachedValueForUrlRequestion)},n.prototype.onVisibleChoicesChanged=function(){this.visibleChoicesCache=null,this.fireCallback(this.choicesChangedCallback)},n.prototype.sortVisibleChoices=function(e){var t=this.choicesOrder.toLowerCase();return"asc"==t?this.sortArray(e,1):"desc"==t?this.sortArray(e,-1):"random"==t?this.randomizeArray(e):e},n.prototype.sortArray=function(e,t){return e.sort(function(e,n){return e.text<n.text?-1*t:e.text>n.text?1*t:0})},n.prototype.randomizeArray=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e},n}(i.Question);t.QuestionCheckboxBase=function(t){function n(e){t.call(this,e),this.name=e,this.colCountValue=1}return e(n,t),Object.defineProperty(n.prototype,"colCount",{get:function(){return this.colCountValue},set:function(e){e<0||e>4||(this.colCountValue=e,this.fireCallback(this.colCountChangedCallback))},enumerable:!0,configurable:!0}),n}(l);r.JsonObject.metaData.addClass("selectbase",["hasComment:boolean","hasOther:boolean",{name:"choices:itemvalues",onGetValue:function(e){return o.ItemValue.getData(e.choices)},onSetValue:function(e,t){e.choices=t}},{name:"choicesOrder","default":"none",choices:["none","asc","desc","random"]},{name:"choicesByUrl:restfull",className:"ChoicesRestfull",onGetValue:function(e){return e.choicesByUrl.isEmpty?null:e.choicesByUrl},onSetValue:function(e,t){e.choicesByUrl.setData(t)}},{name:"otherText","default":s.surveyLocalization.getString("otherItemText")},"otherErrorText",{name:"storeOthersAsComment:boolean","default":!0}],null,"question"),r.JsonObject.metaData.addClass("checkboxbase",[{name:"colCount:number","default":1,choices:[0,1,2,3,4]}],null,"selectbase")}).call(t,n(5))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.QuestionFactory=function(){function e(){this.creatorHash={}}return e.prototype.registerQuestion=function(e,t){this.creatorHash[e]=t},e.prototype.getAllTypes=function(){var e=new Array;for(var t in this.creatorHash)e.push(t);return e.sort()},e.prototype.createQuestion=function(e,t){var n=this.creatorHash[e];return null==n?null:n(t)},e.Instance=new e,e.DefaultChoices=["one","two|second value","three|third value"],e}()},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionMatrixDropdownModel=t.MatrixDropdownRowModel=void 0;var r=n(14),i=n(9),o=n(6),s=n(19),u=t.MatrixDropdownRowModel=function(t){function n(e,n,r,i){t.call(this,r,i),this.name=e,this.text=n}return e(n,t),Object.defineProperty(n.prototype,"rowName",{get:function(){return this.name},enumerable:!0,configurable:!0}),n}(r.MatrixDropdownRowModelBase),a=t.QuestionMatrixDropdownModel=function(t){function n(e){t.call(this,e),this.name=e,this.rowsValue=[]}return e(n,t),n.prototype.getType=function(){return"matrixdropdown"},Object.defineProperty(n.prototype,"rows",{get:function(){return this.rowsValue},set:function(e){o.ItemValue.setData(this.rowsValue,e)},enumerable:!0,configurable:!0}),n.prototype.generateRows=function(){var e=new Array;if(!this.rows||0===this.rows.length)return e;var t=this.value;t||(t={});for(var n=0;n<this.rows.length;n++)this.rows[n].value&&e.push(this.createMatrixRow(this.rows[n].value,this.rows[n].text,t[this.rows[n].value]));return e},n.prototype.createMatrixRow=function(e,t,n){return new u(e,t,this,n)},n}(r.QuestionMatrixDropdownModelBase);i.JsonObject.metaData.addClass("matrixdropdown",[{name:"rows:itemvalues",onGetValue:function(e){return o.ItemValue.getData(e.rows)},onSetValue:function(e,t){e.rows=t}}],function(){return new a("")},"matrixdropdownbase"),s.QuestionFactory.Instance.registerQuestion("matrixdropdown",function(e){var t=new a(e);return t.choices=[1,2,3,4,5],t.rows=["Row 1","Row 2"],t.addColumn("Column 1"),t.addColumn("Column 2"),t.addColumn("Column 3"),t})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionMatrixDynamicModel=t.MatrixDynamicRowModel=void 0;var r=n(14),i=n(9),o=n(19),s=n(8),u=n(7),a=t.MatrixDynamicRowModel=function(t){function n(e,n,r){t.call(this,n,r),this.index=e}return e(n,t),Object.defineProperty(n.prototype,"rowName",{get:function(){return"row"+this.index},enumerable:!0,configurable:!0}),n}(r.MatrixDropdownRowModelBase),l=t.QuestionMatrixDynamicModel=function(t){function n(e){t.call(this,e),this.name=e,this.rowCounter=0,this.rowCountValue=2,this.addRowTextValue=null,this.removeRowTextValue=null,this.minRowCount=0}return e(n,t),n.prototype.getType=function(){return"matrixdynamic"},Object.defineProperty(n.prototype,"rowCount",{get:function(){return this.rowCountValue},set:function(e){if(!(e<0||e>n.MaxRowCount)){if(this.rowCountValue=e,this.value&&this.value.length>e){var t=this.value;t.splice(e),this.value=t}this.fireCallback(this.rowCountChangedCallback)}},enumerable:!0,configurable:!0}),n.prototype.addRow=function(){this.generatedVisibleRows&&this.generatedVisibleRows.push(this.createMatrixRow(null)),this.rowCount++},n.prototype.removeRow=function(e){if(!(e<0||e>=this.rowCount)){if(this.generatedVisibleRows&&e<this.generatedVisibleRows.length&&this.generatedVisibleRows.splice(e,1),this.value){var t=this.createNewValue(this.value);t.splice(e,1),t=this.deleteRowValue(t,null),this.value=t}this.rowCount--}},Object.defineProperty(n.prototype,"addRowText",{get:function(){return this.addRowTextValue?this.addRowTextValue:s.surveyLocalization.getString("addRow")},set:function(e){this.addRowTextValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"removeRowText",{get:function(){return this.removeRowTextValue?this.removeRowTextValue:s.surveyLocalization.getString("removeRow")},set:function(e){this.removeRowTextValue=e},enumerable:!0,configurable:!0}),n.prototype.supportGoNextPageAutomatic=function(){return!1},Object.defineProperty(n.prototype,"cachedVisibleRows",{get:function(){return this.generatedVisibleRows&&this.generatedVisibleRows.length==this.rowCount?this.generatedVisibleRows:this.visibleRows},enumerable:!0,configurable:!0}),n.prototype.onCheckForErrors=function(e){t.prototype.onCheckForErrors.call(this,e),this.hasErrorInRows()&&e.push(new u.CustomError(s.surveyLocalization.getString("minRowCountError").format(this.minRowCount)))},n.prototype.hasErrorInRows=function(){if(this.minRowCount<=0||!this.generatedVisibleRows)return!1;for(var e=0,t=0;t<this.generatedVisibleRows.length;t++){var n=this.generatedVisibleRows[t];n.isEmpty||e++}return e<this.minRowCount},n.prototype.generateRows=function(){var e=new Array;if(0===this.rowCount)return e;for(var t=this.createNewValue(this.value),n=0;n<this.rowCount;n++)e.push(this.createMatrixRow(this.getRowValueByIndex(t,n)));return e},n.prototype.createMatrixRow=function(e){return new a((this.rowCounter++),this,e)},n.prototype.onBeforeValueChanged=function(e){var t=e&&Array.isArray(e)?e.length:0;t<=this.rowCount||(this.rowCountValue=t,this.generatedVisibleRows&&(this.generatedVisibleRows=this.visibleRows))},n.prototype.createNewValue=function(e){var t=e;t||(t=[]);t.length>this.rowCount&&t.splice(this.rowCount-1);for(var n=t.length;n<this.rowCount;n++)t.push({});return t},n.prototype.deleteRowValue=function(e,t){for(var n=!0,r=0;r<e.length;r++)if(Object.keys(e[r]).length>0){n=!1;break}return n?null:e},n.prototype.getRowValueByIndex=function(e,t){return t>=0&&t<e.length?e[t]:null},n.prototype.getRowValue=function(e,t,n){return void 0===n&&(n=!1),this.getRowValueByIndex(t,this.generatedVisibleRows.indexOf(e))},n.MaxRowCount=100,n}(r.QuestionMatrixDropdownModelBase);i.JsonObject.metaData.addClass("matrixdynamic",[{name:"rowCount:number","default":2},{name:"minRowCount:number","default":0},{name:"addRowText",onGetValue:function(e){return e.addRowTextValue}},{name:"removeRowText",onGetValue:function(e){return e.removeRowTextValue}}],function(){return new l("")},"matrixdropdownbase"),o.QuestionFactory.Instance.registerQuestion("matrixdynamic",function(e){var t=new l(e);return t.choices=[1,2,3,4,5],t.addColumn("Column 1"),t.addColumn("Column 2"),t.addColumn("Column 3"),t})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionMatrixModel=t.MatrixRowModel=void 0;var r=n(6),i=n(15),o=n(9),s=n(8),u=n(7),a=n(19),l=t.MatrixRowModel=function(t){function n(e,n,r,i,o){t.call(this),this.name=e,this.text=n,this.fullName=r,this.data=i,this.rowValue=o}return e(n,t),Object.defineProperty(n.prototype,"value",{get:function(){return this.rowValue},set:function(e){this.rowValue=e,this.data&&this.data.onMatrixRowChanged(this),this.onValueChanged()},enumerable:!0,configurable:!0}),n.prototype.onValueChanged=function(){},n}(r.Base),c=t.QuestionMatrixModel=function(t){function n(e){t.call(this,e),this.name=e,this.columnsValue=[],this.rowsValue=[],this.isRowChanging=!1,this.isAllRowRequired=!1}return e(n,t),n.prototype.getType=function(){return"matrix"},Object.defineProperty(n.prototype,"hasRows",{get:function(){return this.rowsValue.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"columns",{get:function(){return this.columnsValue},set:function(e){r.ItemValue.setData(this.columnsValue,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){return this.rowsValue},set:function(e){r.ItemValue.setData(this.rowsValue,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleRows",{get:function(){var e=new Array,t=this.value;t||(t={});for(var n=0;n<this.rows.length;n++)this.rows[n].value&&e.push(this.createMatrixRow(this.rows[n].value,this.rows[n].text,this.name+"_"+this.rows[n].value.toString(),t[this.rows[n].value]));return 0==e.length&&e.push(this.createMatrixRow(null,"",this.name,t)),this.generatedVisibleRows=e,e},enumerable:!0,configurable:!0}),n.prototype.supportGoNextPageAutomatic=function(){return this.hasValuesInAllRows()},n.prototype.onCheckForErrors=function(e){t.prototype.onCheckForErrors.call(this,e),this.hasErrorInRows()&&this.errors.push(new u.CustomError(s.surveyLocalization.getString("requiredInAllRowsError")))},n.prototype.hasErrorInRows=function(){return!!this.isAllRowRequired&&!this.hasValuesInAllRows()},n.prototype.hasValuesInAllRows=function(){var e=this.generatedVisibleRows;if(e||(e=this.visibleRows),!e)return!0;for(var t=0;t<e.length;t++){var n=e[t].value;if(!n)return!1}return!0},n.prototype.createMatrixRow=function(e,t,n,r){return new l(e,t,n,this,r)},n.prototype.onValueChanged=function(){if(!this.isRowChanging&&this.generatedVisibleRows&&0!=this.generatedVisibleRows.length){this.isRowChanging=!0;var e=this.value;if(e||(e={}),0==this.rows.length)this.generatedVisibleRows[0].value=e;else for(var t=0;t<this.generatedVisibleRows.length;t++){var n=this.generatedVisibleRows[t],r=e[n.name]?e[n.name]:null;this.generatedVisibleRows[t].value=r}this.isRowChanging=!1}},n.prototype.onMatrixRowChanged=function(e){if(!this.isRowChanging){if(this.isRowChanging=!0,this.hasRows){var t=this.value;t||(t={}),t[e.name]=e.value,this.setNewValue(t)}else this.setNewValue(e.value);this.isRowChanging=!1}},n}(i.Question);o.JsonObject.metaData.addClass("matrix",[{name:"columns:itemvalues",onGetValue:function(e){return r.ItemValue.getData(e.columns)},onSetValue:function(e,t){e.columns=t}},{name:"rows:itemvalues",onGetValue:function(e){return r.ItemValue.getData(e.rows)},onSetValue:function(e,t){e.rows=t}},"isAllRowRequired:boolean"],function(){return new c("")},"question"),a.QuestionFactory.Instance.registerQuestion("matrix",function(e){var t=new c(e);return t.rows=["Row 1","Row 2"],t.columns=["Column 1","Column 2","Column 3"],t})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionMultipleTextModel=t.MultipleTextItemModel=void 0;var r=n(6),i=n(4),o=n(15),s=n(9),u=n(19),a=t.MultipleTextItemModel=function(t){function n(e,n){void 0===e&&(e=null),void 0===n&&(n=null),t.call(this),this.name=e,this.validators=new Array,this.title=n}return e(n,t),n.prototype.getType=function(){return"multipletextitem"},n.prototype.setData=function(e){this.data=e},Object.defineProperty(n.prototype,"title",{get:function(){return this.titleValue?this.titleValue:this.name},set:function(e){this.titleValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.data?this.data.getMultipleTextValue(this.name):null},set:function(e){null!=this.data&&this.data.setMultipleTextValue(this.name,e)},enumerable:!0,configurable:!0}),n.prototype.onValueChanged=function(e){},n.prototype.getValidatorTitle=function(){return this.title},n}(r.Base),l=t.QuestionMultipleTextModel=function(t){function n(e){t.call(this,e),this.name=e,this.colCountValue=1,this.itemSize=25,this.itemsValues=new Array,this.isMultipleItemValueChanging=!1;var n=this;this.items.push=function(e){e.setData(n);var t=Array.prototype.push.call(this,e);return n.fireCallback(n.colCountChangedCallback),t}}return e(n,t),n.prototype.getType=function(){return"multipletext"},Object.defineProperty(n.prototype,"items",{get:function(){return this.itemsValues},set:function(e){this.itemsValues=e,this.fireCallback(this.colCountChangedCallback)},enumerable:!0,configurable:!0}),n.prototype.addItem=function(e,t){void 0===t&&(t=null);var n=this.createTextItem(e,t);return this.items.push(n),n},n.prototype.AddItem=function(e,t){return void 0===t&&(t=null),this.addItem(e,t)},n.prototype.supportGoNextPageAutomatic=function(){for(var e=0;e<this.items.length;e++)if(!this.items[e].value)return!1;return!0},Object.defineProperty(n.prototype,"colCount",{get:function(){return this.colCountValue},set:function(e){e<1||e>4||(this.colCountValue=e,this.fireCallback(this.colCountChangedCallback))},enumerable:!0,configurable:!0}),n.prototype.getRows=function(){for(var e=this.colCount,t=this.items,n=[],r=0,i=0;i<t.length;i++)0==r&&n.push([]),n[n.length-1].push(t[i]),r++,r>=e&&(r=0);return n},n.prototype.onValueChanged=function(){t.prototype.onValueChanged.call(this),this.onItemValueChanged()},n.prototype.createTextItem=function(e,t){return new a(e,t)},n.prototype.onItemValueChanged=function(){if(!this.isMultipleItemValueChanging)for(var e=0;e<this.items.length;e++){var t=null;this.value&&this.items[e].name in this.value&&(t=this.value[this.items[e].name]),this.items[e].onValueChanged(t)}},n.prototype.runValidators=function(){var e=t.prototype.runValidators.call(this);if(null!=e)return e;for(var n=0;n<this.items.length;n++)if(e=(new i.ValidatorRunner).run(this.items[n]),null!=e)return e;return null},n.prototype.getMultipleTextValue=function(e){return this.value?this.value[e]:null},n.prototype.setMultipleTextValue=function(e,t){this.isMultipleItemValueChanging=!0;var n=this.value;n||(n={}),n[e]=t,this.setNewValue(n),this.isMultipleItemValueChanging=!1},n}(o.Question);s.JsonObject.metaData.addClass("multipletextitem",["name","placeHolder",{name:"title",onGetValue:function(e){return e.titleValue}},{name:"validators:validators",baseClassName:"surveyvalidator",classNamePart:"validator"}],function(){return new a("")}),s.JsonObject.metaData.addClass("multipletext",[{name:"!items:textitems",className:"multipletextitem"},{name:"itemSize:number","default":25},{name:"colCount:number","default":1,choices:[1,2,3,4]}],function(){return new l("")},"question"),u.QuestionFactory.Instance.registerQuestion("multipletext",function(e){var t=new l(e);return t.addItem("text1"),t.addItem("text2"),t})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageModel=t.QuestionRowModel=void 0;var r=n(9),i=n(6),o=n(11),s=n(19),u=t.QuestionRowModel=function(){function e(e,t){this.page=e,this.question=t,this.visibleValue=!1,this.questions=[];var n=this;this.question.rowVisibilityChangedCallback=function(){n.onRowVisibilityChanged()}}return Object.defineProperty(e.prototype,"visible",{get:function(){return this.visibleValue},set:function(e){e!=this.visible&&(this.visibleValue=e,this.onVisibleChanged())},enumerable:!0,configurable:!0}),e.prototype.updateVisible=function(){this.visible=this.calcVisible(),this.setWidth()},e.prototype.addQuestion=function(e){this.questions.push(e),this.updateVisible()},e.prototype.onVisibleChanged=function(){this.visibilityChangedCallback&&this.visibilityChangedCallback()},e.prototype.setWidth=function(){var e=this.getVisibleCount();if(0!=e)for(var t=0,n=0;n<this.questions.length;n++)this.isQuestionVisible(this.questions[n])&&(this.questions[n].renderWidth=this.question.width?this.question.width:Math.floor(100/e)+"%",this.questions[n].rightIndent=t<e-1?1:0,t++)},e.prototype.onRowVisibilityChanged=function(){this.page.onRowVisibilityChanged(this)},e.prototype.getVisibleCount=function(){for(var e=0,t=0;t<this.questions.length;t++)this.isQuestionVisible(this.questions[t])&&e++;return e},e.prototype.isQuestionVisible=function(e){return this.page.isQuestionVisible(e)},e.prototype.calcVisible=function(){return this.getVisibleCount()>0},e}(),a=t.PageModel=function(t){function n(e){void 0===e&&(e=""),t.call(this),this.name=e,this.rowValues=null,this.conditionRunner=null,this.questions=new Array,this.data=null,this.visibleIf="",this.navigationButtonsVisibility="inherit",this.title="",this.visibleIndex=-1,this.numValue=-1,this.visibleValue=!0,this.idValue=n.getPageId();var r=this;this.questions.push=function(e){return null!=r.data&&e.setData(r.data),Array.prototype.push.call(this,e)}}return e(n,t),n.getPageId=function(){return"sp_"+n.pageCounter++},Object.defineProperty(n.prototype,"id",{get:function(){return this.idValue},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){return this.rowValues=this.buildRows(),this.rowValues},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isActive",{get:function(){return!this.data||this.data.currentPage==this},enumerable:!0,configurable:!0}),n.prototype.isQuestionVisible=function(e){return e.visible||this.isDesignMode},n.prototype.createRow=function(e){return new u(this,e)},Object.defineProperty(n.prototype,"isDesignMode",{get:function(){return this.data&&this.data.isDesignMode},enumerable:!0,configurable:!0}),n.prototype.buildRows=function(){for(var e=new Array,t=-1,n=0;n<this.questions.length;n++){var r=this.questions[n];e.push(this.createRow(r)),r.startWithNewLine?(t=n,e[n].addQuestion(r)):(t<0&&(t=n),e[t].addQuestion(r))}for(var n=0;n<e.length;n++)e[n].setWidth();return e},n.prototype.onRowVisibilityChanged=function(e){if(this.isActive&&this.rowValues)for(var t=this.rowValues.indexOf(e),n=t;n>=0;n--)if(this.rowValues[n].questions.indexOf(e.question)>-1){this.rowValues[n].updateVisible();break}},Object.defineProperty(n.prototype,"processedTitle",{get:function(){return null!=this.data?this.data.processText(this.title):this.title},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"num",{get:function(){return this.numValue},set:function(e){this.numValue!=e&&(this.numValue=e,this.onNumChanged(e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visible",{get:function(){return this.visibleValue},set:function(e){e!==this.visible&&(this.visibleValue=e,null!=this.data&&this.data.pageVisibilityChanged(this,this.visible))},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"page"},Object.defineProperty(n.prototype,"isVisible",{get:function(){return this.getIsPageVisible(null)},enumerable:!0,configurable:!0}),n.prototype.getIsPageVisible=function(e){if(!this.visible)return!1;for(var t=0;t<this.questions.length;t++)if(this.questions[t]!=e&&this.questions[t].visible)return!0;return!1},n.prototype.addQuestion=function(e,t){void 0===t&&(t=-1),null!=e&&(t<0||t>=this.questions.length?this.questions.push(e):this.questions.splice(t,0,e),null!=this.data&&(e.setData(this.data),this.data.questionAdded(e,t)))},n.prototype.addNewQuestion=function(e,t){var n=s.QuestionFactory.Instance.createQuestion(e,t);return this.addQuestion(n),n},n.prototype.removeQuestion=function(e){var t=this.questions.indexOf(e);t<0||(this.questions.splice(t,1),null!=this.data&&this.data.questionRemoved(e))},n.prototype.focusFirstQuestion=function(){for(var e=0;e<this.questions.length;e++){var t=this.questions[e];if(t.visible&&t.hasInput){this.questions[e].focus();break}}},n.prototype.focusFirstErrorQuestion=function(){for(var e=0;e<this.questions.length;e++)if(this.questions[e].visible&&0!=this.questions[e].currentErrorCount){this.questions[e].focus(!0);break}},n.prototype.scrollToTop=function(){i.SurveyElement.ScrollElementToTop(i.SurveyPageId)},n.prototype.hasErrors=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1);for(var n=!1,r=null,i=0;i<this.questions.length;i++)this.questions[i].visible&&this.questions[i].hasErrors(e)&&(t&&null==r&&(r=this.questions[i]),n=!0);return r&&r.focus(!0),n},n.prototype.addQuestionsToList=function(e,t){if(void 0===t&&(t=!1),!t||this.visible)for(var n=0;n<this.questions.length;n++)t&&!this.questions[n].visible||e.push(this.questions[n])},n.prototype.runCondition=function(e){this.visibleIf&&(this.conditionRunner||(this.conditionRunner=new o.ConditionRunner(this.visibleIf)),this.conditionRunner.expression=this.visibleIf,this.visible=this.conditionRunner.run(e))},n.prototype.onNumChanged=function(e){},n.pageCounter=100,n}(i.Base);r.JsonObject.metaData.addClass("page",["name",{name:"navigationButtonsVisibility","default":"inherit",choices:["iherit","show","hide"]},{name:"questions",baseClassName:"question"},{name:"visible:boolean","default":!0},"visibleIf","title"],function(){return new a})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionCheckboxModel=void 0;var r=n(9),i=n(19),o=n(18),s=t.QuestionCheckboxModel=function(t){function n(e){t.call(this,e),this.name=e}return e(n,t),n.prototype.getHasOther=function(e){return!(!e||!Array.isArray(e))&&e.indexOf(this.otherItem.value)>=0},n.prototype.valueFromDataCore=function(e){if(!e||!Array.isArray(e))return e;for(var t=0;t<e.length;t++){if(e[t]==this.otherItem.value)return e;if(this.hasUnknownValue(e[t])){this.comment=e[t];var n=e.slice();return n[t]=this.otherItem.value,n}}return e},n.prototype.valueToDataCore=function(e){if(!e||!e.length)return e;for(var t=0;t<e.length;t++)if(e[t]==this.otherItem.value&&this.getComment()){var n=e.slice();return n[t]=this.getComment(),n}return e},n.prototype.getType=function(){return"checkbox"},n}(o.QuestionCheckboxBase);r.JsonObject.metaData.addClass("checkbox",[],function(){return new s("")},"checkboxbase"),i.QuestionFactory.Instance.registerQuestion("checkbox",function(e){var t=new s(e);return t.choices=i.QuestionFactory.DefaultChoices,t})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionCommentModel=void 0;var r=n(15),i=n(9),o=n(19),s=t.QuestionCommentModel=function(t){function n(e){t.call(this,e),this.name=e,this.rows=4,this.cols=50}return e(n,t),n.prototype.getType=function(){return"comment"},n.prototype.isEmpty=function(){return t.prototype.isEmpty.call(this)||""==this.value},n}(r.Question);i.JsonObject.metaData.addClass("comment",[{name:"cols:number","default":50},{name:"rows:number","default":4},"placeHolder"],function(){return new s("")},"question"),o.QuestionFactory.Instance.registerQuestion("comment",function(e){return new s(e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionDropdownModel=void 0;var r=n(9),i=n(19),o=n(18),s=n(8),u=t.QuestionDropdownModel=function(t){function n(e){t.call(this,e),this.name=e}return e(n,t),Object.defineProperty(n.prototype,"optionsCaption",{get:function(){return this.optionsCaptionValue?this.optionsCaptionValue:s.surveyLocalization.getString("optionsCaption");
},set:function(e){this.optionsCaptionValue=e},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"dropdown"},n.prototype.supportGoNextPageAutomatic=function(){return!0},n}(o.QuestionSelectBase);r.JsonObject.metaData.addClass("dropdown",[{name:"optionsCaption",onGetValue:function(e){return e.optionsCaptionValue}}],function(){return new u("")},"selectbase"),i.QuestionFactory.Instance.registerQuestion("dropdown",function(e){var t=new u(e);return t.choices=i.QuestionFactory.DefaultChoices,t})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionFileModel=void 0;var r=n(15),i=n(9),o=n(19),s=n(7),u=n(8),a=t.QuestionFileModel=function(t){function n(e){t.call(this,e),this.name=e,this.showPreviewValue=!1,this.isUploading=!1}return e(n,t),n.prototype.getType=function(){return"file"},Object.defineProperty(n.prototype,"showPreview",{get:function(){return this.showPreviewValue},set:function(e){this.showPreviewValue=e},enumerable:!0,configurable:!0}),n.prototype.loadFile=function(e){var t=this;this.survey&&!this.survey.uploadFile(this.name,e,this.storeDataAsText,function(e){t.isUploading="uploading"==e})||this.setFileValue(e)},n.prototype.setFileValue=function(e){if(FileReader&&(this.showPreview||this.storeDataAsText)&&!this.checkFileForErrors(e)){var t=new FileReader,n=this;t.onload=function(r){n.showPreview&&(n.previewValue=n.isFileImage(e)?t.result:null,n.fireCallback(n.previewValueLoadedCallback)),n.storeDataAsText&&(n.value=t.result)},t.readAsDataURL(e)}},n.prototype.onCheckForErrors=function(e){t.prototype.onCheckForErrors.call(this,e),this.isUploading&&this.errors.push(new s.CustomError(u.surveyLocalization.getString("uploadingFile")))},n.prototype.checkFileForErrors=function(e){var t=this.errors?this.errors.length:0;return this.errors=[],this.maxSize>0&&e.size>this.maxSize&&this.errors.push(new s.ExceedSizeError(this.maxSize)),(t!=this.errors.length||this.errors.length>0)&&this.fireCallback(this.errorsChangedCallback),this.errors.length>0},n.prototype.isFileImage=function(e){if(e&&e.type){var t=e.type.toLowerCase();return 0==t.indexOf("image")}},n}(r.Question);i.JsonObject.metaData.addClass("file",["showPreview:boolean","imageHeight","imageWidth","storeDataAsText:boolean","maxSize:number"],function(){return new a("")},"question"),o.QuestionFactory.Instance.registerQuestion("file",function(e){return new a(e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionHtmlModel=void 0;var r=n(16),i=n(9),o=n(19),s=t.QuestionHtmlModel=function(t){function n(e){t.call(this,e),this.name=e}return e(n,t),n.prototype.getType=function(){return"html"},Object.defineProperty(n.prototype,"html",{get:function(){return this.htmlValue},set:function(e){this.htmlValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"processedHtml",{get:function(){return this.survey?this.survey.processHtml(this.html):this.html},enumerable:!0,configurable:!0}),n}(r.QuestionBase);i.JsonObject.metaData.addClass("html",["html:html"],function(){return new s("")},"questionbase"),o.QuestionFactory.Instance.registerQuestion("html",function(e){return new s(e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionRadiogroupModel=void 0;var r=n(9),i=n(19),o=n(18),s=t.QuestionRadiogroupModel=function(t){function n(e){t.call(this,e),this.name=e}return e(n,t),n.prototype.getType=function(){return"radiogroup"},n.prototype.supportGoNextPageAutomatic=function(){return!0},n}(o.QuestionCheckboxBase);r.JsonObject.metaData.addClass("radiogroup",[],function(){return new s("")},"checkboxbase"),i.QuestionFactory.Instance.registerQuestion("radiogroup",function(e){var t=new s(e);return t.choices=i.QuestionFactory.DefaultChoices,t})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionRatingModel=void 0;var r=n(6),i=n(15),o=n(9),s=n(19),u=t.QuestionRatingModel=function(t){function n(e){t.call(this,e),this.name=e,this.rates=[],this.mininumRateDescription=null,this.maximumRateDescription=null}return e(n,t),Object.defineProperty(n.prototype,"rateValues",{get:function(){return this.rates},set:function(e){r.ItemValue.setData(this.rates,e),this.fireCallback(this.rateValuesChangedCallback)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleRateValues",{get:function(){return this.rateValues.length>0?this.rateValues:n.defaultRateValues},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"rating"},n.prototype.supportComment=function(){return!0},n.prototype.supportOther=function(){return!0},n.prototype.supportGoNextPageAutomatic=function(){return!0},n.defaultRateValues=[],n}(i.Question);r.ItemValue.setData(u.defaultRateValues,[1,2,3,4,5]),o.JsonObject.metaData.addClass("rating",["hasComment:boolean",{name:"rateValues:itemvalues",onGetValue:function(e){return r.ItemValue.getData(e.rateValues)},onSetValue:function(e,t){e.rateValues=t}},"mininumRateDescription","maximumRateDescription"],function(){return new u("")},"question"),s.QuestionFactory.Instance.registerQuestion("rating",function(e){return new u(e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionTextModel=void 0;var r=n(19),i=n(9),o=n(15),s=t.QuestionTextModel=function(t){function n(e){t.call(this,e),this.name=e,this.size=25,this.inputType="text"}return e(n,t),n.prototype.getType=function(){return"text"},n.prototype.isEmpty=function(){return t.prototype.isEmpty.call(this)||""==this.value},n.prototype.supportGoNextPageAutomatic=function(){return!0},n.prototype.setNewValue=function(e){e=this.correctValueType(e),t.prototype.setNewValue.call(this,e)},n.prototype.correctValueType=function(e){return e&&("number"==this.inputType||"range"==this.inputType)?this.isNumber(e)?parseFloat(e):"":e},n.prototype.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},n}(o.Question);i.JsonObject.metaData.addClass("text",[{name:"inputType","default":"text",choices:["color","date","datetime","datetime-local","email","month","number","password","range","tel","text","time","url","week"]},{name:"size:number","default":25},"placeHolder"],function(){return new s("")},"question"),r.QuestionFactory.Instance.registerQuestion("text",function(e){return new s(e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyModel=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(9),o=n(6),s=n(24),u=n(17),a=n(13),l=n(34),c=n(8),h=n(7);t.SurveyModel=function(t){function n(e){void 0===e&&(e=null),t.call(this),this.surveyId=null,this.surveyPostId=null,this.clientId=null,this.cookieName=null,this.sendResultOnPageNext=!1,this.commentPrefix="-Comment",this.title="",this.focusFirstQuestionAutomatic=!0,this.showNavigationButtons=!0,this.showTitle=!0,this.showPageTitles=!0,this.completedHtml="",this.requiredText="*",this.questionStartIndex="",this.questionTitleTemplate="",this.showProgressBar="off",this.storeOthersAsComment=!0,this.goNextPageAutomatic=!1,this.pages=new Array,this.triggers=new Array,this.clearInvisibleValues=!1,this.currentPageValue=null,this.valuesHash={},this.variablesHash={},this.showPageNumbersValue=!1,this.showQuestionNumbersValue="on",this.questionTitleLocationValue="top",this.localeValue="",this.isCompleted=!1,this.isLoading=!1,this.processedTextValues={},this.isValidatingOnServerValue=!1,this.modeValue="edit",this.isDesignModeValue=!1,this.onComplete=new o.Event,this.onPartialSend=new o.Event,this.onCurrentPageChanged=new o.Event,this.onValueChanged=new o.Event,this.onVisibleChanged=new o.Event,this.onPageVisibleChanged=new o.Event,this.onQuestionAdded=new o.Event,this.onQuestionRemoved=new o.Event,this.onValidateQuestion=new o.Event,this.onProcessHtml=new o.Event,this.onSendResult=new o.Event,this.onGetResult=new o.Event,this.onUploadFile=new o.Event,this.jsonErrors=null;var n=this;this.textPreProcessor=new u.TextPreProcessor,this.textPreProcessor.onHasValue=function(e){return n.hasProcessedTextValue(e)},this.textPreProcessor.onProcess=function(e){return n.getProcessedTextValue(e)},this.pages.push=function(e){return e.data=n,Array.prototype.push.call(this,e)},this.triggers.push=function(e){return e.setOwner(n),Array.prototype.push.call(this,e)},this.updateProcessedTextValues(),this.onBeforeCreating(),e&&(this.setJsonObject(e),this.surveyId&&this.loadSurveyFromService(this.surveyId)),this.onCreating()}return e(n,t),n.prototype.getType=function(){return"survey"},Object.defineProperty(n.prototype,"locale",{get:function(){return this.localeValue},set:function(e){this.localeValue=e,c.surveyLocalization.currentLocale=e},enumerable:!0,configurable:!0}),n.prototype.getLocString=function(e){return c.surveyLocalization.getString(e)},Object.defineProperty(n.prototype,"emptySurveyText",{get:function(){return this.getLocString("emptySurvey")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pagePrevText",{get:function(){return this.pagePrevTextValue?this.pagePrevTextValue:this.getLocString("pagePrevText")},set:function(e){this.pagePrevTextValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageNextText",{get:function(){return this.pageNextTextValue?this.pageNextTextValue:this.getLocString("pageNextText")},set:function(e){this.pageNextTextValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"completeText",{get:function(){return this.completeTextValue?this.completeTextValue:this.getLocString("completeText")},set:function(e){this.completeTextValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showPageNumbers",{get:function(){return this.showPageNumbersValue},set:function(e){e!==this.showPageNumbers&&(this.showPageNumbersValue=e,this.updateVisibleIndexes())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showQuestionNumbers",{get:function(){return this.showQuestionNumbersValue},set:function(e){e!==this.showQuestionNumbers&&(this.showQuestionNumbersValue=e,this.updateVisibleIndexes())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"processedTitle",{get:function(){return this.processText(this.title)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"questionTitleLocation",{get:function(){return this.questionTitleLocationValue},set:function(e){e!==this.questionTitleLocationValue&&(this.questionTitleLocationValue=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mode",{get:function(){return this.modeValue},set:function(e){e!=this.mode&&("edit"!=e&&"display"!=e||(this.modeValue=e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){var e={};for(var t in this.valuesHash)e[t]=this.valuesHash[t];return e},set:function(e){if(this.valuesHash={},e)for(var t in e)this.valuesHash[t]=e[t],this.checkTriggers(t,e[t],!1);this.notifyAllQuestionsOnValueChanged(),this.runConditions()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"comments",{get:function(){var e={};for(var t in this.valuesHash)t.indexOf(this.commentPrefix)>0&&(e[t]=this.valuesHash[t]);return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visiblePages",{get:function(){if(this.isDesignMode)return this.pages;for(var e=new Array,t=0;t<this.pages.length;t++)this.pages[t].isVisible&&e.push(this.pages[t]);return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEmpty",{get:function(){return 0==this.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"PageCount",{get:function(){return this.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visiblePageCount",{get:function(){return this.visiblePages.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPage",{get:function(){var e=this.visiblePages;return null!=this.currentPageValue&&e.indexOf(this.currentPageValue)<0&&(this.currentPage=null),null==this.currentPageValue&&e.length>0&&(this.currentPage=e[0]),this.currentPageValue},set:function(e){var t=this.visiblePages;if(!(null!=e&&t.indexOf(e)<0)&&e!=this.currentPageValue){var n=this.currentPageValue;this.currentPageValue=e,this.currentPageChanged(e,n)}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPageNo",{get:function(){return this.visiblePages.indexOf(this.currentPage)},set:function(e){this.visiblePages;e<0||e>=this.visiblePages.length||(this.currentPage=this.visiblePages[e])},enumerable:!0,configurable:!0}),n.prototype.focusFirstQuestion=function(){this.currentPageValue&&(this.currentPageValue.scrollToTop(),this.currentPageValue.focusFirstQuestion())},Object.defineProperty(n.prototype,"state",{get:function(){return this.isLoading?"loading":this.isCompleted?"completed":this.currentPage?"running":"empty"},enumerable:!0,configurable:!0}),n.prototype.clear=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),e&&(this.data=null,this.variablesHash={}),this.isCompleted=!1,t&&this.visiblePageCount>0&&(this.currentPage=this.visiblePages[0])},n.prototype.mergeValues=function(e,t){if(t&&e)for(var n in e){var i=e[n];i&&"object"===("undefined"==typeof i?"undefined":r(i))?(t[n]||(t[n]={}),this.mergeValues(i,t[n])):t[n]=i}},n.prototype.currentPageChanged=function(e,t){this.onCurrentPageChanged.fire(this,{oldCurrentPage:t,newCurrentPage:e})},n.prototype.getProgress=function(){if(null==this.currentPage)return 0;var e=this.visiblePages.indexOf(this.currentPage)+1;return Math.ceil(100*e/this.visiblePageCount)},Object.defineProperty(n.prototype,"isNavigationButtonsShowing",{get:function(){if(this.isDesignMode)return!1;var e=this.currentPage;return!!e&&("show"==e.navigationButtonsVisibility||"hide"!=e.navigationButtonsVisibility&&this.showNavigationButtons)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEditMode",{get:function(){return"edit"==this.mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDisplayMode",{get:function(){return"display"==this.mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDesignMode",{get:function(){return this.isDesignModeValue},enumerable:!0,configurable:!0}),n.prototype.setDesignMode=function(e){this.isDesignModeValue=e},Object.defineProperty(n.prototype,"hasCookie",{get:function(){if(!this.cookieName)return!1;var e=document.cookie;return e&&e.indexOf(this.cookieName+"=true")>-1},enumerable:!0,configurable:!0}),n.prototype.setCookie=function(){this.cookieName&&(document.cookie=this.cookieName+"=true; expires=Fri, 31 Dec 9999 0:0:0 GMT")},n.prototype.deleteCookie=function(){this.cookieName&&(document.cookie=this.cookieName+"=;")},n.prototype.nextPage=function(){return!this.isLastPage&&((!this.isEditMode||!this.isCurrentPageHasErrors)&&(!this.doServerValidation()&&(this.doNextPage(),!0)))},Object.defineProperty(n.prototype,"isCurrentPageHasErrors",{get:function(){return null==this.currentPage||this.currentPage.hasErrors(!0,!0)},enumerable:!0,configurable:!0}),n.prototype.prevPage=function(){if(this.isFirstPage)return!1;var e=this.visiblePages,t=e.indexOf(this.currentPage);this.currentPage=e[t-1]},n.prototype.completeLastPage=function(){return(!this.isEditMode||!this.isCurrentPageHasErrors)&&(!this.doServerValidation()&&(this.doComplete(),!0))},Object.defineProperty(n.prototype,"isFirstPage",{get:function(){return null==this.currentPage||0==this.visiblePages.indexOf(this.currentPage)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLastPage",{get:function(){if(null==this.currentPage)return!0;var e=this.visiblePages;return e.indexOf(this.currentPage)==e.length-1},enumerable:!0,configurable:!0}),n.prototype.doComplete=function(){this.clearInvisibleValues&&this.clearInvisibleQuestionValues(),this.setCookie(),this.setCompleted(),this.onComplete.fire(this,null),this.surveyPostId&&this.sendResult()},Object.defineProperty(n.prototype,"isValidatingOnServer",{get:function(){return this.isValidatingOnServerValue},enumerable:!0,configurable:!0}),n.prototype.setIsValidatingOnServer=function(e){e!=this.isValidatingOnServer&&(this.isValidatingOnServerValue=e,this.onIsValidatingOnServerChanged())},n.prototype.onIsValidatingOnServerChanged=function(){},n.prototype.doServerValidation=function(){if(!this.onServerValidateQuestions)return!1;for(var e=this,t={data:{},errors:{},survey:this,complete:function(){e.completeServerValidation(t)}},n=0;n<this.currentPage.questions.length;n++){var r=this.currentPage.questions[n];if(r.visible){var i=this.getValue(r.name);i&&(t.data[r.name]=i)}}return this.setIsValidatingOnServer(!0),this.onServerValidateQuestions(this,t),!0},n.prototype.completeServerValidation=function(e){if(this.setIsValidatingOnServer(!1),e||e.survey){var t=e.survey,n=!1;if(e.errors)for(var r in e.errors){var i=t.getQuestionByName(r);i&&i.errors&&(n=!0,i.addError(new h.CustomError(e.errors[r])))}n||(t.isLastPage?t.doComplete():t.doNextPage())}},n.prototype.doNextPage=function(){this.checkOnPageTriggers(),this.sendResultOnPageNext&&this.sendResult(this.surveyPostId,this.clientId,!0);var e=this.visiblePages,t=e.indexOf(this.currentPage);this.currentPage=e[t+1]},n.prototype.setCompleted=function(){this.isCompleted=!0},Object.defineProperty(n.prototype,"processedCompletedHtml",{get:function(){return this.completedHtml?this.processHtml(this.completedHtml):"<h3>"+this.getLocString("completingSurvey")+"</h3>"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"processedLoadingHtml",{get:function(){return"<h3>"+this.getLocString("loadingSurvey")+"</h3>"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"progressText",{get:function(){if(null==this.currentPage)return"";var e=this.visiblePages,t=e.indexOf(this.currentPage)+1;return this.getLocString("progressText").format(t,e.length)},enumerable:!0,configurable:!0}),n.prototype.uploadFile=function(e,t,n,r){var i=!0;return this.onUploadFile.fire(this,{name:e,file:t,accept:i}),!!i&&(!n&&this.surveyPostId&&this.uploadFileCore(e,t,r),!0)},n.prototype.uploadFileCore=function(e,t,n){var r=this;n&&n("uploading"),(new l.dxSurveyService).sendFile(this.surveyPostId,t,function(t,i){n&&n(t?"success":"error"),t&&r.setValue(e,i)})},n.prototype.getPage=function(e){return this.pages[e]},n.prototype.addPage=function(e){null!=e&&(this.pages.push(e),this.updateVisibleIndexes())},n.prototype.addNewPage=function(e){var t=this.createNewPage(e);return this.addPage(t),t},n.prototype.removePage=function(e){var t=this.pages.indexOf(e);t<0||(this.pages.splice(t,1),this.currentPageValue==e&&(this.currentPage=this.pages.length>0?this.pages[0]:null),this.updateVisibleIndexes())},n.prototype.getQuestionByName=function(e,t){void 0===t&&(t=!1);var n=this.getAllQuestions();t&&(e=e.toLowerCase());for(var r=0;r<n.length;r++){var i=n[r].name;if(t&&(i=i.toLowerCase()),i==e)return n[r]}return null},n.prototype.getQuestionsByNames=function(e,t){void 0===t&&(t=!1);var n=[];if(!e)return n;for(var r=0;r<e.length;r++)if(e[r]){var i=this.getQuestionByName(e[r],t);i&&n.push(i)}return n},n.prototype.getPageByQuestion=function(e){for(var t=0;t<this.pages.length;t++){var n=this.pages[t];if(n.questions.indexOf(e)>-1)return n}return null},n.prototype.getPageByName=function(e){for(var t=0;t<this.pages.length;t++)if(this.pages[t].name==e)return this.pages[t];return null},n.prototype.getPagesByNames=function(e){var t=[];if(!e)return t;for(var n=0;n<e.length;n++)if(e[n]){var r=this.getPageByName(e[n]);r&&t.push(r)}return t},n.prototype.getAllQuestions=function(e){void 0===e&&(e=!1);for(var t=new Array,n=0;n<this.pages.length;n++)this.pages[n].addQuestionsToList(t,e);return t},n.prototype.createNewPage=function(e){return new s.PageModel(e)},n.prototype.notifyQuestionOnValueChanged=function(e,t){for(var n=this.getAllQuestions(),r=null,i=0;i<n.length;i++)n[i].name==e&&(r=n[i],this.doSurveyValueChanged(r,t));this.onValueChanged.fire(this,{name:e,question:r,value:t})},n.prototype.notifyAllQuestionsOnValueChanged=function(){for(var e=this.getAllQuestions(),t=0;t<e.length;t++)this.doSurveyValueChanged(e[t],this.getValue(e[t].name))},n.prototype.doSurveyValueChanged=function(e,t){e.onSurveyValueChanged(t)},n.prototype.checkOnPageTriggers=function(){for(var e=this.getCurrentPageQuestions(),t=0;t<e.length;t++){var n=e[t],r=this.getValue(n.name);this.checkTriggers(n.name,r,!0)}},n.prototype.getCurrentPageQuestions=function(){var e=[],t=this.currentPage;if(!t)return e;for(var n=0;n<t.questions.length;n++){var r=t.questions[n];r.visible&&r.name&&e.push(r)}return e},n.prototype.checkTriggers=function(e,t,n){for(var r=0;r<this.triggers.length;r++){var i=this.triggers[r];i.name==e&&i.isOnNextPage==n&&i.check(t)}},n.prototype.doQuestionsOnLoad=function(){for(var e=this.getAllQuestions(!1),t=0;t<e.length;t++)e[t].onSurveyLoad()},n.prototype.runConditions=function(){this.runConditionsForList(this.getAllQuestions(!1)),this.runConditionsForList(this.pages)},n.prototype.runConditionsForList=function(e){for(var t=0;t<e.length;t++)e[t].runCondition(this.valuesHash)},n.prototype.sendResult=function(e,t,n){if(void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=!1),this.isEditMode&&(n&&this.onPartialSend&&this.onPartialSend.fire(this,null),!this.surveyPostId&&e&&(this.surveyPostId=e),this.surveyPostId&&(t&&(this.clientId=t),!n||this.clientId))){var r=this;(new l.dxSurveyService).sendResult(this.surveyPostId,this.data,function(e,t){r.onSendResult.fire(r,{success:e,response:t})},this.clientId,n)}},n.prototype.getResult=function(e,t){var n=this;(new l.dxSurveyService).getResult(e,t,function(e,t,r,i){n.onGetResult.fire(n,{success:e,data:t,dataList:r,response:i})})},n.prototype.loadSurveyFromService=function(e){void 0===e&&(e=null),e&&(this.surveyId=e);var t=this;this.isLoading=!0,this.onLoadingSurveyFromService(),(new l.dxSurveyService).loadSurvey(this.surveyId,function(e,n,r){t.isLoading=!1,e&&n&&(t.setJsonObject(n),t.notifyAllQuestionsOnValueChanged(),t.onLoadSurveyFromService())})},n.prototype.onLoadingSurveyFromService=function(){},n.prototype.onLoadSurveyFromService=function(){},n.prototype.checkPageVisibility=function(e,t){var n=this.getPageByQuestion(e);if(n){var r=n.isVisible;(r!=n.getIsPageVisible(e)||t)&&this.pageVisibilityChanged(n,r)}},n.prototype.updateVisibleIndexes=function(){if(this.updatePageVisibleIndexes(this.showPageNumbers),"onPage"==this.showQuestionNumbers)for(var e=this.visiblePages,t=0;t<e.length;t++)this.updateQuestionVisibleIndexes(e[t].questions,!0);else this.updateQuestionVisibleIndexes(this.getAllQuestions(!1),"on"==this.showQuestionNumbers)},n.prototype.updatePageVisibleIndexes=function(e){for(var t=0,n=0;n<this.pages.length;n++)this.pages[n].visibleIndex=this.pages[n].visible?t++:-1,this.pages[n].num=e&&this.pages[n].visible?this.pages[n].visibleIndex+1:-1},n.prototype.updateQuestionVisibleIndexes=function(e,t){for(var n=0,r=0;r<e.length;r++)e[r].setVisibleIndex(t&&e[r].visible&&e[r].hasTitle?n++:-1)},n.prototype.setJsonObject=function(e){if(e){this.jsonErrors=null;var t=new i.JsonObject;t.toObject(e,this),t.errors.length>0&&(this.jsonErrors=t.errors),this.updateProcessedTextValues(),this.hasCookie&&this.doComplete(),this.doQuestionsOnLoad(),this.runConditions(),this.updateVisibleIndexes()}},n.prototype.onBeforeCreating=function(){},n.prototype.onCreating=function(){},n.prototype.updateProcessedTextValues=function(){this.processedTextValues={};var e=this;this.processedTextValues.pageno=function(t){return null!=e.currentPage?e.visiblePages.indexOf(e.currentPage)+1:0},this.processedTextValues.pagecount=function(t){return e.visiblePageCount};for(var t=this.getAllQuestions(),n=0;n<t.length;n++)this.addQuestionToProcessedTextValues(t[n])},n.prototype.addQuestionToProcessedTextValues=function(e){this.processedTextValues[e.name.toLowerCase()]="question"},n.prototype.hasProcessedTextValue=function(e){var t=(new a.ProcessValue).getFirstName(e);return this.processedTextValues[t.toLowerCase()]},n.prototype.getProcessedTextValue=function(e){var t=(new a.ProcessValue).getFirstName(e),n=this.processedTextValues[t.toLowerCase()];if(!n)return null;if("variable"==n)return this.getVariable(e.toLowerCase());if("question"==n){var r=this.getQuestionByName(t,!0);return r?(e=r.name+e.substr(t.length),(new a.ProcessValue).getValue(e,this.valuesHash)):null}return"value"==n?(new a.ProcessValue).getValue(e,this.valuesHash):n(e)},n.prototype.clearInvisibleQuestionValues=function(){for(var e=this.getAllQuestions(),t=0;t<e.length;t++)e[t].visible||this.setValue(e[t].name,null)},n.prototype.getVariable=function(e){return e?this.variablesHash[e]:null},n.prototype.setVariable=function(e,t){e&&(this.variablesHash[e]=t,this.processedTextValues[e.toLowerCase()]="variable")},n.prototype.getUnbindValue=function(e){return e&&e instanceof Object?JSON.parse(JSON.stringify(e)):e},n.prototype.getValue=function(e){if(!e||0==e.length)return null;var t=this.valuesHash[e];return this.getUnbindValue(t)},n.prototype.setValue=function(e,t){this.isValueEqual(e,t)||(""==t||null==t?delete this.valuesHash[e]:(t=this.getUnbindValue(t),this.valuesHash[e]=t,this.processedTextValues[e.toLowerCase()]="value"),this.notifyQuestionOnValueChanged(e,t),this.checkTriggers(e,t,!1),this.runConditions(),this.tryGoNextPageAutomatic(e))},n.prototype.isValueEqual=function(e,t){""==t&&(t=null);var n=this.getValue(e);return null===t||null===n?t===n:this.isTwoValueEquals(t,n)},n.prototype.isTwoValueEquals=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n))return!1;if(e[n]!==t[n]){if("object"!==r(e[n]))return!1;if(!this.isTwoValueEquals(e[n],t[n]))return!1}}for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0},n.prototype.tryGoNextPageAutomatic=function(e){if(this.goNextPageAutomatic&&this.currentPage){var t=this.getQuestionByName(e);if(!t||t.supportGoNextPageAutomatic()){for(var n=this.getCurrentPageQuestions(),r=0;r<n.length;r++)if(n[r].hasInput&&!this.getValue(n[r].name))return;this.currentPage.hasErrors(!0,!1)||(this.isLastPage?this.doComplete():this.nextPage())}}},n.prototype.getComment=function(e){var t=this.data[e+this.commentPrefix];return null==t&&(t=""),t},n.prototype.setComment=function(e,t){e+=this.commentPrefix,""==t||null==t?delete this.valuesHash[e]:(this.valuesHash[e]=t,this.tryGoNextPageAutomatic(e))},n.prototype.questionVisibilityChanged=function(e,t){this.updateVisibleIndexes(),this.onVisibleChanged.fire(this,{question:e,name:e.name,visible:t}),this.checkPageVisibility(e,!t)},n.prototype.pageVisibilityChanged=function(e,t){this.updateVisibleIndexes(),this.onPageVisibleChanged.fire(this,{page:e,visible:t})},n.prototype.questionAdded=function(e,t){this.updateVisibleIndexes(),this.addQuestionToProcessedTextValues(e),this.onQuestionAdded.fire(this,{question:e,name:e.name,index:t})},n.prototype.questionRemoved=function(e){this.updateVisibleIndexes(),this.onQuestionRemoved.fire(this,{question:e,name:e.name})},n.prototype.validateQuestion=function(e){if(this.onValidateQuestion.isEmpty)return null;var t={name:e,value:this.getValue(e),error:null};return this.onValidateQuestion.fire(this,t),t.error?new h.CustomError(t.error):null},n.prototype.processHtml=function(e){var t={html:e};return this.onProcessHtml.fire(this,t),this.processText(t.html)},n.prototype.processText=function(e){return this.textPreProcessor.process(e)},n.prototype.getObjects=function(e,t){var n=[];return Array.prototype.push.apply(n,this.getPagesByNames(e)),Array.prototype.push.apply(n,this.getQuestionsByNames(t)),n},n.prototype.setTriggerValue=function(e,t,n){e&&(n?this.setVariable(e,t):this.setValue(e,t))},n}(o.Base);i.JsonObject.metaData.addClass("survey",[{name:"locale",choices:function(){return c.surveyLocalization.getLocales()}},"title",{name:"focusFirstQuestionAutomatic:boolean","default":!0},"completedHtml:html",{name:"pages",className:"page"},{name:"questions",baseClassName:"question",onGetValue:function(e){return null},onSetValue:function(e,t,n){var r=e.addNewPage("");n.toObject({questions:t},r)}},{name:"triggers:triggers",baseClassName:"surveytrigger",classNamePart:"trigger"},"surveyId","surveyPostId","cookieName","sendResultOnPageNext:boolean",{name:"showNavigationButtons:boolean","default":!0},{name:"showTitle:boolean","default":!0},{name:"showPageTitles:boolean","default":!0},"showPageNumbers:boolean",{name:"showQuestionNumbers","default":"on",choices:["on","onPage","off"]},{name:"questionTitleLocation","default":"top",choices:["top","bottom"]},{name:"showProgressBar","default":"off",choices:["off","top","bottom"]},{name:"mode","default":"edit",choices:["edit","display"]},{name:"storeOthersAsComment:boolean","default":!0},"goNextPageAutomatic:boolean","clearInvisibleValues:boolean",{name:"pagePrevText",onGetValue:function(e){return e.pagePrevTextValue}},{name:"pageNextText",onGetValue:function(e){return e.pageNextTextValue}},{name:"completeText",onGetValue:function(e){return e.completeTextValue}},{name:"requiredText","default":"*"},"questionStartIndex","questionTitleTemplate"])}).call(t,n(5))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dxSurveyService=function(){function e(){}return e.prototype.loadSurvey=function(t,n){var r=new XMLHttpRequest;r.open("GET",e.serviceUrl+"/getSurvey?surveyId="+t),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.onload=function(){var e=JSON.parse(r.response);n(200==r.status,e,r.response)},r.send()},e.prototype.sendResult=function(t,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=!1);var s=new XMLHttpRequest;s.open("POST",e.serviceUrl+"/post/"),s.setRequestHeader("Content-Type","application/json; charset=utf-8");var u={postId:t,surveyResult:JSON.stringify(n)};i&&(u.clientId=i),o&&(u.isPartialCompleted=!0);var a=JSON.stringify(u);s.onload=s.onerror=function(){r&&r(200==s.status,s.response)},s.send(a)},e.prototype.sendFile=function(t,n,r){var i=new XMLHttpRequest;i.onload=i.onerror=function(){r&&r(200==i.status,JSON.parse(i.response))},i.open("POST",e.serviceUrl+"/upload/",!0);var o=new FormData;o.append("file",n),o.append("postId",t),i.send(o)},e.prototype.getResult=function(t,n,r){var i=new XMLHttpRequest,o="resultId="+t+"&name="+n;i.open("GET",e.serviceUrl+"/getResult?"+o),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");i.onload=function(){var e=null,t=null;if(200==i.status){e=JSON.parse(i.response),t=[];for(var n in e.QuestionResult){var o={name:n,value:e.QuestionResult[n]};t.push(o)}}r(200==i.status,e,t,i.response)},i.send()},e.prototype.isCompleted=function(t,n,r){var i=new XMLHttpRequest,o="resultId="+t+"&clientId="+n;i.open("GET",e.serviceUrl+"/isCompleted?"+o),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");i.onload=function(){var e=null;200==i.status&&(e=JSON.parse(i.response)),r(200==i.status,e,i.response)},i.send()},e.serviceUrl="https://dxsurveyapi.azurewebsites.net/api/Survey",e}()},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyTriggerSetValue=t.SurveyTriggerComplete=t.SurveyTriggerVisible=t.SurveyTrigger=t.Trigger=void 0;var r=n(6),i=n(9),o=t.Trigger=function(t){function n(){t.call(this),this.opValue="equal"}return e(n,t),Object.defineProperty(n,"operators",{get:function(){return null!=n.operatorsValue?n.operatorsValue:(n.operatorsValue={empty:function(e,t){return!e},notempty:function(e,t){return!!e},equal:function(e,t){return e==t},notequal:function(e,t){return e!=t},contains:function(e,t){return e&&e.indexOf&&e.indexOf(t)>-1},notcontains:function(e,t){return!e||!e.indexOf||e.indexOf(t)==-1},greater:function(e,t){return e>t},less:function(e,t){return e<t},greaterorequal:function(e,t){
return e>=t},lessorequal:function(e,t){return e<=t}},n.operatorsValue)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"operator",{get:function(){return this.opValue},set:function(e){e&&(e=e.toLowerCase(),n.operators[e]&&(this.opValue=e))},enumerable:!0,configurable:!0}),n.prototype.check=function(e){n.operators[this.operator](e,this.value)?this.onSuccess():this.onFailure()},n.prototype.onSuccess=function(){},n.prototype.onFailure=function(){},n.operatorsValue=null,n}(r.Base),s=t.SurveyTrigger=function(t){function n(){t.call(this),this.owner=null}return e(n,t),n.prototype.setOwner=function(e){this.owner=e},Object.defineProperty(n.prototype,"isOnNextPage",{get:function(){return!1},enumerable:!0,configurable:!0}),n}(o),u=t.SurveyTriggerVisible=function(t){function n(){t.call(this),this.pages=[],this.questions=[]}return e(n,t),n.prototype.getType=function(){return"visibletrigger"},n.prototype.onSuccess=function(){this.onTrigger(this.onItemSuccess)},n.prototype.onFailure=function(){this.onTrigger(this.onItemFailure)},n.prototype.onTrigger=function(e){if(this.owner)for(var t=this.owner.getObjects(this.pages,this.questions),n=0;n<t.length;n++)e(t[n])},n.prototype.onItemSuccess=function(e){e.visible=!0},n.prototype.onItemFailure=function(e){e.visible=!1},n}(s),a=t.SurveyTriggerComplete=function(t){function n(){t.call(this)}return e(n,t),n.prototype.getType=function(){return"completetrigger"},Object.defineProperty(n.prototype,"isOnNextPage",{get:function(){return!0},enumerable:!0,configurable:!0}),n.prototype.onSuccess=function(){this.owner&&this.owner.doComplete()},n}(s),l=t.SurveyTriggerSetValue=function(t){function n(){t.call(this)}return e(n,t),n.prototype.getType=function(){return"setvaluetrigger"},n.prototype.onSuccess=function(){this.setToName&&this.owner&&this.owner.setTriggerValue(this.setToName,this.setValue,this.isVariable)},n}(s);i.JsonObject.metaData.addClass("trigger",["operator","!value"]),i.JsonObject.metaData.addClass("surveytrigger",["!name"],null,"trigger"),i.JsonObject.metaData.addClass("visibletrigger",["pages","questions"],function(){return new u},"surveytrigger"),i.JsonObject.metaData.addClass("completetrigger",[],function(){return new a},"surveytrigger"),i.JsonObject.metaData.addClass("setvaluetrigger",["!setToName","setValue","isVariable:boolean"],function(){return new l},"surveytrigger")}).call(t,n(5))},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyWindowModel=void 0;var r=n(6),i=n(33);t.SurveyWindowModel=function(t){function n(e){t.call(this),this.surveyValue=this.createSurvey(e),this.surveyValue.showTitle=!1,this.windowElement=document.createElement("div")}return e(n,t),n.prototype.getType=function(){return"window"},Object.defineProperty(n.prototype,"survey",{get:function(){return this.surveyValue},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isShowing",{get:function(){return this.isShowingValue},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isExpanded",{get:function(){return this.isExpandedValue},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this.titleValue?this.titleValue:this.survey.title},set:function(e){this.titleValue=e},enumerable:!0,configurable:!0}),n.prototype.expand=function(){this.expandcollapse(!0)},n.prototype.collapse=function(){this.expandcollapse(!1)},n.prototype.createSurvey=function(e){return new i.SurveyModel(e)},n.prototype.expandcollapse=function(e){this.isExpandedValue=e},n.surveyElementName="windowSurveyJS",n}(r.Base)}).call(t,n(5))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.surveyCss={currentType:"",getCss:function(){var e=this.currentType?this[this.currentType]:r;return e||(e=r),e}},r=t.defaultStandardCss={root:"sv_main",header:"",body:"sv_body",footer:"sv_nav",navigationButton:"",navigation:{complete:"",prev:"",next:""},progress:"sv_progress",progressBar:"",pageTitle:"sv_p_title",row:"sv_row",question:{root:"sv_q",title:"sv_q_title",comment:"",indent:20},error:{root:"sv_q_erbox",icon:"",item:""},checkbox:{root:"sv_qcbc",item:"sv_q_checkbox",other:"sv_q_other"},comment:"",dropdown:"",matrix:{root:"sv_q_matrix"},matrixdropdown:{root:"sv_q_matrix"},matrixdynamic:{root:"table",button:""},multipletext:{root:"",itemTitle:"",itemValue:""},radiogroup:{root:"sv_qcbc",item:"sv_q_radiogroup",other:"sv_q_other"},rating:{root:"sv_q_rating",item:"sv_q_rating_item"},text:"",window:{root:"sv_window",body:"sv_window_content",header:{root:"sv_window_title",title:"",button:"",buttonExpanded:"glyphicon-chevron-up",buttonCollapsed:"glyphicon-chevron-down"}}};n.standard=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultBootstrapCss=void 0;var r=n(37),i=t.defaultBootstrapCss={root:"",header:"panel-heading",body:"panel-body",footer:"panel-footer",navigationButton:"",navigation:{complete:"",prev:"",next:""},progress:"progress center-block",progressBar:"progress-bar",pageTitle:"",row:"",question:{root:"",title:"",comment:"form-control",indent:20},error:{root:"alert alert-danger",icon:"glyphicon glyphicon-exclamation-sign",item:""},checkbox:{root:"form-inline",item:"checkbox",other:""},comment:"form-control",dropdown:"form-control",matrix:{root:"table"},matrixdropdown:{root:"table"},matrixdynamic:{root:"table",button:"button"},multipletext:{root:"table",itemTitle:"",itemValue:"form-control"},radiogroup:{root:"form-inline",item:"radio",other:""},rating:{root:"btn-group",item:"btn btn-default"},text:"form-control",window:{root:"modal-content",body:"modal-body",header:{root:"modal-header panel-title",title:"pull-left",button:"glyphicon pull-right",buttonExpanded:"glyphicon pull-right glyphicon-chevron-up",buttonCollapsed:"glyphicon pull-right glyphicon-chevron-down"}}};r.surveyCss.bootstrap=i},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Survey=void 0;var i=n(40),o=r(i),s=n(44),u=n(45),a=n(50),l=n(49),c=n(37),h=n(52),p=n(6);t.Survey=function(t){function n(e){t.call(this,e),this.isCurrentPageChanged=!1,this.updateSurvey(e)}return e(n,t),Object.defineProperty(n,"cssType",{get:function(){return c.surveyCss.currentType},set:function(e){c.surveyCss.currentType=e},enumerable:!0,configurable:!0}),n.prototype.componentWillReceiveProps=function(e){this.updateSurvey(e)},n.prototype.componentDidUpdate=function(){this.isCurrentPageChanged&&(this.isCurrentPageChanged=!1,this.survey.focusFirstQuestionAutomatic&&this.survey.focusFirstQuestion())},n.prototype.render=function(){return"completed"==this.survey.state?this.renderCompleted():"loading"==this.survey.state?this.renderLoading():this.renderSurvey()},Object.defineProperty(n.prototype,"css",{get:function(){return c.surveyCss.getCss()},set:function(e){this.survey.mergeCss(e,this.css)},enumerable:!0,configurable:!0}),n.prototype.renderCompleted=function(){var e={__html:this.survey.processedCompletedHtml};return o.createElement("div",{dangerouslySetInnerHTML:e})},n.prototype.renderLoading=function(){var e={__html:this.survey.processedLoadingHtml};return o.createElement("div",{dangerouslySetInnerHTML:e})},n.prototype.renderSurvey=function(){var e=this.survey.title&&this.survey.showTitle?this.renderTitle():null,t=this.survey.currentPage?this.renderPage():null,n="top"==this.survey.showProgressBar?this.renderProgress(!0):null,r="bottom"==this.survey.showProgressBar?this.renderProgress(!1):null,i=t&&this.survey.showNavigationButtons?this.renderNavigation():null;return t||(t=this.renderEmptySurvey()),o.createElement("div",{className:this.css.root},e,o.createElement("div",{id:p.SurveyPageId,className:this.css.body},n,t,r),i)},n.prototype.renderTitle=function(){return o.createElement("div",{className:this.css.header},o.createElement("h3",null,this.survey.processedTitle))},n.prototype.renderPage=function(){return o.createElement(u.SurveyPage,{survey:this.survey,page:this.survey.currentPage,css:this.css,creator:this})},n.prototype.renderProgress=function(e){return o.createElement(h.SurveyProgress,{survey:this.survey,css:this.css,isTop:e})},n.prototype.renderNavigation=function(){return o.createElement(a.SurveyNavigation,{survey:this.survey,css:this.css})},n.prototype.renderEmptySurvey=function(){return o.createElement("span",null,this.survey.emptySurveyText)},n.prototype.updateSurvey=function(e){e?e.model?this.survey=e.model:e.json&&(this.survey=new s.ReactSurveyModel(e.json)):this.survey=new s.ReactSurveyModel,e&&(e.clientId&&(this.survey.clientId=e.clientId),e.data&&(this.survey.data=e.data),e.css&&this.survey.mergeCss(e.css,this.css));this.survey.currentPage;this.state={pageIndexChange:0,isCompleted:!1,modelChanged:0},this.setSurveyEvents(e)},n.prototype.setSurveyEvents=function(e){var t=this;this.survey.renderCallback=function(){t.state.modelChanged=t.state.modelChanged+1,t.setState(t.state)},this.survey.onComplete.add(function(e){t.state.isCompleted=!0,t.setState(t.state)}),this.survey.onPartialSend.add(function(e){t.setState(t.state)}),this.survey.onCurrentPageChanged.add(function(n,r){t.isCurrentPageChanged=!0,t.state.pageIndexChange=t.state.pageIndexChange+1,t.setState(t.state),e&&e.onCurrentPageChanged&&e.onCurrentPageChanged(n,r)}),this.survey.onVisibleChanged.add(function(e,t){if(t.question&&t.question.react){var n=t.question.react.state;n.visible=t.question.visible,t.question.react.setState(n)}}),this.survey.onValueChanged.add(function(e,t){if(t.question&&t.question.react){var n=t.question.react.state;n.value=t.value,t.question.react.setState(n)}}),e&&(this.survey.onValueChanged.add(function(t,n){e.data&&(e.data[n.name]=n.value),e.onValueChanged&&e.onValueChanged(t,n)}),e.onComplete&&this.survey.onComplete.add(function(t){e.onComplete(t)}),e.onPartialSend&&this.survey.onPartialSend.add(function(t){e.onPartialSend(t)}),this.survey.onPageVisibleChanged.add(function(t,n){e.onPageVisibleChanged&&e.onPageVisibleChanged(t,n)}),e.onQuestionAdded&&this.survey.onQuestionAdded.add(function(t,n){e.onQuestionAdded(t,n)}),e.onQuestionRemoved&&this.survey.onQuestionRemoved.add(function(t,n){e.onQuestionRemoved(t,n)}),e.onValidateQuestion&&this.survey.onValidateQuestion.add(function(t,n){e.onValidateQuestion(t,n)}),e.onServerValidateQuestions&&(this.survey.onServerValidateQuestions=e.onServerValidateQuestions),e.onSendResult&&this.survey.onSendResult.add(function(t,n){e.onSendResult(t,n)}),e.onGetResult&&this.survey.onGetResult.add(function(t,n){e.onGetResult(t,n)}),e.onProcessHtml&&this.survey.onProcessHtml.add(function(t,n){e.onProcessHtml(t,n)}))},n.prototype.createQuestionElement=function(e){var t=this.css[e.getType()];return l.ReactQuestionFactory.Instance.createQuestion(e.getType(),{question:e,css:t,rootCss:this.css,isDisplayMode:this.survey.isDisplayMode,creator:this})},n.prototype.renderError=function(e,t){return o.createElement("div",{key:e,className:this.css.error.item},t)},n.prototype.questionTitleLocation=function(){return this.survey.questionTitleLocation},n}(o.Component)}).call(t,n(5))},function(e,t,n){(function(t){!function(t,r){e.exports=r(n(42),n(43))}(this,function(e,n){function r(e){var t=e.nodeName,n=e.attributes;e.attributes={},t.defaultProps&&C(e.attributes,t.defaultProps),n&&C(e.attributes,n),n=e.attributes,e.children&&!e.children.length&&(e.children=void 0),e.children&&(n.children=e.children)}function i(e,t){var n,r,i;if(t){for(i in t)if(n=B.test(i))break;if(n){r=e.attributes={};for(i in t)t.hasOwnProperty(i)&&(r[B.test(i)?i.replace(/([A-Z0-9])/,"-$1").toLowerCase():i]=t[i])}}}function o(e,t,r){var i=t&&t._preactCompatRendered;i&&i.parentNode!==t&&(i=null),i||(i=t.children[0]);for(var o=t.childNodes.length;o--;)t.childNodes[o]!==i&&t.removeChild(t.childNodes[o]);var s=n.render(e,t,i);return t&&(t._preactCompatRendered=s),"function"==typeof r&&r(),s&&s._component||s.base}function s(e,t,r,i){var s=n.h(J,{context:e.context},t),u=o(s,r);return i&&i(u),u}function u(e){var t=e._preactCompatRendered;return!(!t||t.parentNode!==e)&&(n.render(n.h(L),e,t),!0)}function a(e){return d.bind(null,e)}function l(e,t){for(var n=t||0;n<e.length;n++){var r=e[n];Array.isArray(r)?l(r):r&&"object"==typeof r&&!m(r)&&(r.props&&r.type||r.attributes&&r.nodeName||r.children)&&(e[n]=d(r.type||r.nodeName,r.props||r.attributes,r.children))}}function c(e){return"function"==typeof e&&!(e.prototype&&e.prototype.render)}function h(e){return P({displayName:e.displayName||e.name,render:function(t,n,r){return e(t,r)}})}function p(e){var t=e[Z];return t?t===!0?e:t:(t=h(e),Object.defineProperty(t,Z,{configurable:!0,value:!0}),t.displayName=e.displayName,t.propTypes=e.propTypes,t.defaultProps=e.defaultProps,Object.defineProperty(e,Z,{configurable:!0,value:t}),t)}function d(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return l(e,2),f(n.h.apply(void 0,e))}function f(e){e.preactCompatNormalized=!0,b(e),c(e.nodeName)&&(e.nodeName=p(e.nodeName));var t=e.attributes.ref,n=t&&typeof t;return!U||"string"!==n&&"number"!==n||(e.attributes.ref=v(t,U)),g(e),e}function y(e,t){for(var r=[],i=arguments.length-2;i-- >0;)r[i]=arguments[i+2];if(!m(e))return e;var o=e.attributes||e.props,s=n.h(e.nodeName||e.type,o,e.children||o&&o.children);return f(n.cloneElement.apply(void 0,[s,t].concat(r)))}function m(e){return e&&(e instanceof z||e.$$typeof===_)}function v(e,t){return t._refProxies[e]||(t._refProxies[e]=function(n){t&&t.refs&&(t.refs[e]=n,null===n&&(delete t._refProxies[e],t=null))})}function g(e){var t=e.nodeName,n=e.attributes;if(n&&"string"==typeof t){var r={};for(var i in n)r[i.toLowerCase()]=i;if(r.onchange){t=t.toLowerCase();var o="input"===t&&"checkbox"===String(n.type).toLowerCase()?"onclick":"oninput",s=r[o]||o;n[s]||(n[s]=q([n[r[o]],n[r.onchange]]))}}}function b(e){var t=e.attributes;if(t){var n=t.className||t["class"];n&&(t.className=n)}}function C(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function w(e,t){for(var n in e)if(!(n in t))return!0;for(var r in t)if(e[r]!==t[r])return!0;return!1}function x(){}function P(e){function t(t,r){C(this,e),n&&S(this,n),O(this),N.call(this,t,r,A),T.call(this,t,r)}var n=e.mixins&&V(e.mixins);return e.statics&&C(t,e.statics),e.propTypes&&(t.propTypes=e.propTypes),e.defaultProps&&(t.defaultProps=e.defaultProps),e.getDefaultProps&&(t.defaultProps=e.getDefaultProps()),x.prototype=N.prototype,t.prototype=new x,t.prototype.constructor=t,t.displayName=e.displayName||"Component",t}function V(e){for(var t={},n=0;n<e.length;n++){var r=e[n];for(var i in r)r.hasOwnProperty(i)&&"function"==typeof r[i]&&(t[i]||(t[i]=[])).push(r[i])}return t}function S(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=q(t[n].concat(e[n]||n)))}function O(e){for(var t in e){var n=e[t];"function"!=typeof n||n.__bound||D.hasOwnProperty(t)||((e[t]=n.bind(e)).__bound=!0)}}function E(e,t,n){if("string"==typeof t&&(t=e.constructor.prototype[t]),"function"==typeof t)return t.apply(e,n)}function q(e){return function(){for(var t,n=arguments,r=this,i=0;i<e.length;i++){var o=E(r,e[i],n);"undefined"!=typeof o&&(t=o)}return t}}function T(e,t){j.call(this,e,t),this.componentWillReceiveProps=q([j,this.componentWillReceiveProps||"componentWillReceiveProps"]),this.render=q([j,M,this.render||"render",R])}function j(e,t){var n=this;if(e){var r=e.children;if(r&&Array.isArray(r)&&1===r.length&&(e.children=r[0],e.children&&"object"==typeof e.children&&(e.children.length=1,e.children[0]=e.children)),F){var i="function"==typeof this?this:this.constructor,o=this.propTypes||i.propTypes;if(o)for(var s in o)if(o.hasOwnProperty(s)&&"function"==typeof o[s]){var u=n.displayName||i.name,a=o[s](e,s,u,"prop");a&&console.error(new Error(a.message||a))}}}}function M(e){U=this}function R(){U===this&&(U=null)}function N(e,t,r){n.Component.call(this,e,t),this.getInitialState&&(this.state=this.getInitialState()),this.refs={},this._refProxies={},r!==A&&T.call(this,e,t)}function Q(e,t){N.call(this,e,t)}e="default"in e?e["default"]:e;var k="15.1.0",I="a abbr address area article aside audio b base bdi bdo big blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr circle clipPath defs ellipse g image line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan".split(" "),_="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103,D={constructor:1,render:1,shouldComponentUpdate:1,componentWillReceiveProps:1,componentWillUpdate:1,componentDidUpdate:1,componentWillMount:1,componentDidMount:1,componentWillUnmount:1,componentDidUnmount:1},B=/^(?:accent|alignment|arabic|baseline|cap|clip|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vert|word|writing|x)[A-Z]/,A={},F="undefined"==typeof t||!t.env||"production"!==t.env.NODE_ENV,L=function(){return null},z=n.h("").constructor;z.prototype.$$typeof=_,z.prototype.preactCompatUpgraded=!1,z.prototype.preactCompatNormalized=!1,Object.defineProperty(z.prototype,"type",{get:function(){return this.nodeName},set:function(e){this.nodeName=e},configurable:!0}),Object.defineProperty(z.prototype,"props",{get:function(){return this.attributes},set:function(e){this.attributes=e},configurable:!0});var W=n.options.event;n.options.event=function(e){return e.persist=Object,W&&(e=W(e)),e};var H=n.options.vnode;n.options.vnode=function(e){if(!e.preactCompatUpgraded){e.preactCompatUpgraded=!0;var t=e.nodeName,n=e.attributes;n||(n=e.attributes={}),"function"==typeof t?(t[Z]===!0||t.prototype&&"isReactComponent"in t.prototype)&&(e.preactCompatNormalized||f(e),r(e)):n&&i(e,n)}H&&H(e)};var J=function(){};J.prototype.getChildContext=function(){return this.props.context},J.prototype.render=function(e){return e.children[0]};for(var U,G=[],X={map:function(e,t,n){return e=X.toArray(e),n&&n!==e&&(t=t.bind(n)),e.map(t)},forEach:function(e,t,n){e=X.toArray(e),n&&n!==e&&(t=t.bind(n)),e.forEach(t)},count:function(e){return e=X.toArray(e),e.length},only:function(e){if(e=X.toArray(e),1!==e.length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:function(e){return Array.isArray&&Array.isArray(e)?e:G.concat(e)}},$={},K=I.length;K--;)$[I[K]]=a(I[K]);var Z="undefined"!=typeof Symbol?Symbol["for"]("__preactCompatWrapper"):"__preactCompatWrapper",Y=function(e){return e&&e.base||e};N.prototype=new n.Component,C(N.prototype,{constructor:N,isReactComponent:{},replaceState:function(e,t){var n=this;this.setState(e,t);for(var r in this.state)r in e||delete n.state[r]},getDOMNode:function(){return this.base},isMounted:function(){return!!this.base}}),Q.prototype=new N({},{},A),Q.prototype.shouldComponentUpdate=function(e,t){return w(this.props,e)||w(this.state,t)};var ee={version:k,DOM:$,PropTypes:e,Children:X,render:o,createClass:P,createFactory:a,createElement:d,cloneElement:y,isValidElement:m,findDOMNode:Y,unmountComponentAtNode:u,Component:N,PureComponent:Q,unstable_renderSubtreeIntoContainer:s};return ee})}).call(t,n(41))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){y&&d&&(y=!1,d.length?f=d.concat(f):m=-1,f.length&&u())}function u(){if(!y){var e=i(s);y=!0;for(var t=f.length;t;){for(d=f,f=[];++m<t;)d&&d[m].run();m=-1,t=f.length}d=null,y=!1,o(e)}}function a(e,t){this.fun=e,this.array=t}function l(){}var c,h,p=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(e){h=r}}();var d,f=[],y=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new a(e,t)),1!==f.length||y||i(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,n){var r,i,o;!function(n,s){i=[t,e],r=s,o="function"==typeof r?r.apply(t,i):r,!(void 0!==o&&(e.exports=o))}(this,function(e,t){"use strict";function n(e){var t=e&&(x&&e[x]||e[P]);if("function"==typeof t)return t}function r(e){function t(t,n,r,i,o,s){if(i=i||V,s=s||r,null==n[r]){var u=C[o];return t?new Error("Required "+u+" `"+s+"` was not specified in "+("`"+i+"`.")):null}return e(n,r,i,o,s)}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function i(e){function t(t,n,r,i,o){var s=t[n],u=y(s);if(u!==e){var a=C[i],l=m(s);return new Error("Invalid "+a+" `"+o+"` of type "+("`"+l+"` supplied to `"+r+"`, expected ")+("`"+e+"`."))}return null}return r(t)}function o(){return r(w.thatReturns(null))}function s(e){function t(t,n,r,i,o){var s=t[n];if(!Array.isArray(s)){var u=C[i],a=y(s);return new Error("Invalid "+u+" `"+o+"` of type "+("`"+a+"` supplied to `"+r+"`, expected an array."))}for(var l=0;l<s.length;l++){var c=e(s,l,r,i,o+"["+l+"]");if(c instanceof Error)return c}return null}return r(t)}function u(){function e(e,t,n,r,i){if(!b.isValidElement(e[t])){var o=C[r];return new Error("Invalid "+o+" `"+i+"` supplied to "+("`"+n+"`, expected a single ReactElement."))}return null}return r(e)}function a(e){function t(t,n,r,i,o){if(!(t[n]instanceof e)){var s=C[i],u=e.name||V,a=v(t[n]);return new Error("Invalid "+s+" `"+o+"` of type "+("`"+a+"` supplied to `"+r+"`, expected ")+("instance of `"+u+"`."))}return null}return r(t)}function l(e){function t(t,n,r,i,o){for(var s=t[n],u=0;u<e.length;u++)if(s===e[u])return null;var a=C[i],l=JSON.stringify(e);return new Error("Invalid "+a+" `"+o+"` of value `"+s+"` "+("supplied to `"+r+"`, expected one of "+l+"."))}return r(Array.isArray(e)?t:function(){return new Error("Invalid argument supplied to oneOf, expected an instance of array.")})}function c(e){function t(t,n,r,i,o){var s=t[n],u=y(s);if("object"!==u){var a=C[i];return new Error("Invalid "+a+" `"+o+"` of type "+("`"+u+"` supplied to `"+r+"`, expected an object."))}for(var l in s)if(s.hasOwnProperty(l)){var c=e(s,l,r,i,o+"."+l);if(c instanceof Error)return c}return null}return r(t)}function h(e){function t(t,n,r,i,o){for(var s=0;s<e.length;s++){var u=e[s];if(null==u(t,n,r,i,o))return null}var a=C[i];return new Error("Invalid "+a+" `"+o+"` supplied to "+("`"+r+"`."))}return r(Array.isArray(e)?t:function(){return new Error("Invalid argument supplied to oneOfType, expected an instance of array.")})}function p(){function e(e,t,n,r,i){if(!f(e[t])){var o=C[r];return new Error("Invalid "+o+" `"+i+"` supplied to "+("`"+n+"`, expected a ReactNode."))}return null}return r(e)}function d(e){function t(t,n,r,i,o){var s=t[n],u=y(s);if("object"!==u){var a=C[i];return new Error("Invalid "+a+" `"+o+"` of type `"+u+"` "+("supplied to `"+r+"`, expected `object`."))}for(var l in e){var c=e[l];if(c){var h=c(s,l,r,i,o+"."+l);if(h)return h}}return null}return r(t)}function f(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(f);if(null===e||b.isValidElement(e))return!0;var t=n(e);if(!t)return!1;var r,i=t.call(e);if(t!==e.entries){for(;!(r=i.next()).done;)if(!f(r.value))return!1}else for(;!(r=i.next()).done;){var o=r.value;if(o&&!f(o[1]))return!1}return!0;default:return!1}}function y(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":t}function m(e){var t=y(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function v(e){return e.constructor&&e.constructor.name?e.constructor.name:V}var g="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103,b={};b.isValidElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===g};var C={prop:"prop",context:"context",childContext:"child context"},w={thatReturns:function(e){return function(){return e}}},x="function"==typeof Symbol&&Symbol.iterator,P="@@iterator",V="<<anonymous>>",S={array:i("array"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),any:o(),arrayOf:s,element:u(),instanceOf:a,node:p(),objectOf:c,oneOf:l,oneOfType:h,shape:d};t.exports=S})},function(e,t,n){!function(e,n){n(t)}(this,function(e){function t(e,t,n){this.nodeName=e,this.attributes=t,this.children=n,this.key=t&&t.key}function n(e,n){var r,i,o,s,u=[];for(s=arguments.length;s-- >2;)B.push(arguments[s]);for(n&&n.children&&(B.length||B.push(n.children),delete n.children);B.length;)if((i=B.pop())instanceof Array)for(s=i.length;s--;)B.push(i[s]);else null!=i&&i!==!1&&("number"!=typeof i&&i!==!0||(i=String(i)),o="string"==typeof i,o&&r?u[u.length-1]+=i:(u.push(i),r=o));var a=new t(e,n||void 0,u);return D.vnode&&D.vnode(a),a}function r(e,t){if(t)for(var n in t)e[n]=t[n];return e}function i(e){return r({},e)}function o(e,t){for(var n=t.split("."),r=0;r<n.length&&e;r++)e=e[n[r]];return e}function s(e){return"function"==typeof e}function u(e){return"string"==typeof e}function a(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}function l(e,t){return n(e.nodeName,r(i(e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}function c(e,t,n){var r=t.split(".");return function(t){for(var i=t&&t.target||this,s={},a=s,l=u(n)?o(t,n):i.nodeName?i.type.match(/^che|rad/)?i.checked:i.value:t,c=0;c<r.length-1;c++)a=a[r[c]]||(a[r[c]]=!c&&e.state[r[c]]||{});a[r[c]]=l,e.setState(s)}}function h(e){!e._dirty&&(e._dirty=!0)&&1==G.push(e)&&(D.debounceRendering||z)(p)}function p(){var e,t=G;for(G=[];e=t.pop();)e._dirty&&N(e)}function d(e){var t=e&&e.nodeName;return t&&s(t)&&!(t.prototype&&t.prototype.render)}function f(e,t){return e.nodeName(v(e),t||W)}function y(e,t){return u(t)?e instanceof Text:u(t.nodeName)?!e._componentConstructor&&m(e,t.nodeName):s(t.nodeName)?!e._componentConstructor||e._componentConstructor===t.nodeName||d(t):void 0}function m(e,t){return e.normalizedNodeName===t||F(e.nodeName)===F(t)}function v(e){var t=i(e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function g(e){var t=e.parentNode;t&&t.removeChild(e)}function b(e,t,n,r,i){if("className"===t&&(t="class"),"class"===t&&r&&"object"==typeof r&&(r=a(r)),"key"===t);else if("class"!==t||i)if("style"===t){if((!r||u(r)||u(n))&&(e.style.cssText=r||""),r&&"object"==typeof r){if(!u(n))for(var o in n)o in r||(e.style[o]="");for(var o in r)e.style[o]="number"!=typeof r[o]||J[o]?r[o]:r[o]+"px"}}else if("dangerouslySetInnerHTML"===t)e.innerHTML=r&&r.__html||"";else if("o"==t[0]&&"n"==t[1]){var l=e._listeners||(e._listeners={});t=F(t.substring(2)),r?l[t]||e.addEventListener(t,w,!!U[t]):l[t]&&e.removeEventListener(t,w,!!U[t]),l[t]=r}else if("list"!==t&&"type"!==t&&!i&&t in e)C(e,t,null==r?"":r),null!=r&&r!==!1||e.removeAttribute(t);else{var c=i&&t.match(/^xlink\:?(.+)/);null==r||r===!1?c?e.removeAttributeNS("http://www.w3.org/1999/xlink",F(c[1])):e.removeAttribute(t):"object"==typeof r||s(r)||(c?e.setAttributeNS("http://www.w3.org/1999/xlink",F(c[1]),r):e.setAttribute(t,r))}else e.className=r||""}function C(e,t,n){try{e[t]=n}catch(r){}}function w(e){return this._listeners[e.type](D.event&&D.event(e)||e)}function x(e){if(g(e),e instanceof Element){e._component=e._componentConstructor=null;var t=e.normalizedNodeName||F(e.nodeName);(X[t]||(X[t]=[])).push(e)}}function P(e,t){var n=F(e),r=X[n]&&X[n].pop()||(t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e));return r.normalizedNodeName=n,r}function V(){for(var e;e=$.pop();)D.afterMount&&D.afterMount(e),e.componentDidMount&&e.componentDidMount()}function S(e,t,n,r,i,o){K++||(Z=i instanceof SVGElement,Y=e&&!(H in e));var s=O(e,t,n,r);return i&&s.parentNode!==i&&i.appendChild(s),--K||(Y=!1,o||V()),s}function O(e,t,n,r){for(var i=t&&t.attributes;d(t);)t=f(t,n);if(null==t&&(t=""),u(t))return e&&e instanceof Text?e.nodeValue!=t&&(e.nodeValue=t):(e&&q(e),e=document.createTextNode(t)),e[H]=!0,e;if(s(t.nodeName))return Q(e,t,n,r);var o=e,a=String(t.nodeName),l=Z,c=t.children;if(Z="svg"===a||"foreignObject"!==a&&Z,e){if(!m(e,a)){for(o=P(a,Z);e.firstChild;)o.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(o,e),q(e)}}else o=P(a,Z);var h=o.firstChild,p=o[H];if(!p){o[H]=p={};for(var y=o.attributes,v=y.length;v--;)p[y[v].name]=y[v].value}return T(o,t.attributes,p),!Y&&c&&1===c.length&&"string"==typeof c[0]&&h&&h instanceof Text&&!h.nextSibling?h.nodeValue!=c[0]&&(h.nodeValue=c[0]):(c&&c.length||h)&&E(o,c,n,r),i&&"function"==typeof i.ref&&(p.ref=i.ref)(o),Z=l,o}function E(e,t,n,r){var i,o,s,u,a=e.childNodes,l=[],c={},h=0,p=0,d=a.length,f=0,m=t&&t.length;if(d)for(var v=0;v<d;v++){var b=a[v],C=b[H],w=m?(o=b._component)?o.__key:C?C.key:null:null;null!=w?(h++,c[w]=b):(Y||C)&&(l[f++]=b)}if(m)for(var v=0;v<m;v++){s=t[v],u=null;var w=s.key;if(null!=w)h&&w in c&&(u=c[w],c[w]=void 0,h--);else if(!u&&p<f)for(i=p;i<f;i++)if(o=l[i],o&&y(o,s)){u=o,l[i]=void 0,i===f-1&&f--,i===p&&p++;break}u=O(u,s,n,r),u&&u!==e&&(v>=d?e.appendChild(u):u!==a[v]&&(u===a[v+1]&&g(a[v]),e.insertBefore(u,a[v]||null)))}if(h)for(var v in c)c[v]&&q(c[v]);for(;p<=f;)u=l[f--],u&&q(u)}function q(e,t){var n=e._component;if(n)k(n,!t);else{e[H]&&e[H].ref&&e[H].ref(null),t||x(e);for(var r;r=e.lastChild;)q(r,t)}}function T(e,t,n){for(var r in n)t&&r in t||null==n[r]||b(e,r,n[r],n[r]=void 0,Z);if(t)for(var i in t)"children"===i||"innerHTML"===i||i in n&&t[i]===("value"===i||"checked"===i?e[i]:n[i])||b(e,i,n[i],n[i]=t[i],Z)}function j(e){var t=e.constructor.name,n=ee[t];n?n.push(e):ee[t]=[e]}function M(e,t,n){var r=new e(t,n),i=ee[e.name];if(I.call(r,t,n),i)for(var o=i.length;o--;)if(i[o].constructor===e){r.nextBase=i[o].nextBase,i.splice(o,1);break}return r}function R(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&D.syncComponentUpdates===!1&&e.base?h(e):N(e,1,i)),e.__ref&&e.__ref(e))}function N(e,t,n,o){if(!e._disable){var u,a,l,c,h=e.props,p=e.state,y=e.context,m=e.prevProps||h,g=e.prevState||p,b=e.prevContext||y,C=e.base,w=e.nextBase,x=C||w,P=e._component;if(C&&(e.props=m,e.state=g,e.context=b,2!==t&&e.shouldComponentUpdate&&e.shouldComponentUpdate(h,p,y)===!1?u=!0:e.componentWillUpdate&&e.componentWillUpdate(h,p,y),e.props=h,e.state=p,e.context=y),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!u){for(e.render&&(a=e.render(h,p,y)),e.getChildContext&&(y=r(i(y),e.getChildContext()));d(a);)a=f(a,y);var O,E,T=a&&a.nodeName;if(s(T)){var j=v(a);l=P,l&&l.constructor===T&&j.key==l.__key?R(l,j,1,y):(O=l,l=M(T,j,y),l.nextBase=l.nextBase||w,
l._parentComponent=e,e._component=l,R(l,j,0,y),N(l,1,n,!0)),E=l.base}else c=x,O=P,O&&(c=e._component=null),(x||1===t)&&(c&&(c._component=null),E=S(c,a,y,n||!C,x&&x.parentNode,!0));if(x&&E!==x&&l!==P){var Q=x.parentNode;Q&&E!==Q&&(Q.replaceChild(E,x),O||(x._component=null,q(x)))}if(O&&k(O,E!==x),e.base=E,E&&!o){for(var I=e,_=e;_=_._parentComponent;)(I=_).base=E;E._component=I,E._componentConstructor=I.constructor}}!C||n?$.unshift(e):u||(e.componentDidUpdate&&e.componentDidUpdate(m,g,b),D.afterUpdate&&D.afterUpdate(e));var B,A=e._renderCallbacks;if(A)for(;B=A.pop();)B.call(e);K||o||V()}}function Q(e,t,n,r){for(var i=e&&e._component,o=e,s=i&&e._componentConstructor===t.nodeName,u=s,a=v(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(R(i,a,3,n,r),e=i.base):(i&&!s&&(k(i,!0),e=o=null),i=M(t.nodeName,a,n),e&&!i.nextBase&&(i.nextBase=e,o=null),R(i,a,1,n,r),e=i.base,o&&e!==o&&(o._component=null,q(o))),e}function k(e,t){D.beforeUnmount&&D.beforeUnmount(e);var n=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var r=e._component;if(r)k(r,t);else if(n){n[H]&&n[H].ref&&n[H].ref(null),e.nextBase=n,t&&(g(n),j(e));for(var i;i=n.lastChild;)q(i,!t)}e.__ref&&e.__ref(null),e.componentDidUnmount&&e.componentDidUnmount()}function I(e,t){this._dirty=!0,this.context=t,this.props=e,this.state||(this.state={})}function _(e,t,n){return S(n,e,{},!1,t)}var D={},B=[],A={},F=function(e){return A[e]||(A[e]=e.toLowerCase())},L="undefined"!=typeof Promise&&Promise.resolve(),z=L?function(e){L.then(e)}:setTimeout,W={},H="undefined"!=typeof Symbol?Symbol["for"]("preactattr"):"__preactattr_",J={boxFlex:1,boxFlexGroup:1,columnCount:1,fillOpacity:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,strokeOpacity:1,widows:1,zIndex:1,zoom:1},U={blur:1,error:1,focus:1,load:1,resize:1,scroll:1},G=[],X={},$=[],K=0,Z=!1,Y=!1,ee={};r(I.prototype,{linkState:function(e,t){var n=this._linkedStates||(this._linkedStates={});return n[e+t]||(n[e+t]=c(this,e,t))},setState:function(e,t){var n=this.state;this.prevState||(this.prevState=i(n)),r(n,s(e)?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),h(this)},forceUpdate:function(){N(this,2)},render:function(){}}),e.h=n,e.cloneElement=l,e.Component=I,e.render=_,e.rerender=p,e.options=D})},function(e,t,n){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactSurveyModel=void 0;var r=n(33);t.ReactSurveyModel=function(t){function n(e){void 0===e&&(e=null),t.call(this,e)}return e(n,t),n.prototype.render=function(){this.renderCallback&&this.renderCallback()},n.prototype.mergeCss=function(e,t){this.mergeValues(e,t)},n.prototype.onLoadSurveyFromService=function(){this.render()},n.prototype.onLoadingSurveyFromService=function(){this.render()},n}(r.SurveyModel)}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyRow=t.SurveyPage=void 0;var i=n(40),o=r(i),s=n(46),u=(t.SurveyPage=function(t){function n(e){t.call(this,e),this.page=e.page,this.survey=e.survey,this.creator=e.creator,this.css=e.css}return e(n,t),n.prototype.componentWillReceiveProps=function(e){this.page=e.page,this.survey=e.survey,this.creator=e.creator,this.css=e.css},n.prototype.render=function(){if(null==this.page||null==this.survey||null==this.creator)return null;for(var e=this.renderTitle(),t=[],n=this.page.rows,r=0;r<n.length;r++)t.push(this.createRow(n[r],r));return o.createElement("div",null,e,t)},n.prototype.createRow=function(e,t){var n="row"+(t+1);return o.createElement(u,{key:n,row:e,survey:this.survey,creator:this.creator,css:this.css})},n.prototype.renderTitle=function(){if(!this.page.title||!this.survey.showPageTitles)return null;var e=this.page.processedTitle;return this.page.num>0&&(e=this.page.num+". "+e),o.createElement("h4",{className:this.css.pageTitle},e)},n}(o.Component),t.SurveyRow=function(t){function n(e){t.call(this,e),this.setProperties(e)}return e(n,t),n.prototype.componentWillReceiveProps=function(e){this.setProperties(e)},n.prototype.setProperties=function(e){if(this.row=e.row,this.row){var t=this;this.row.visibilityChangedCallback=function(){t.setState({visible:t.row.visible})}}this.survey=e.survey,this.creator=e.creator,this.css=e.css},n.prototype.render=function(){if(null==this.row||null==this.survey||null==this.creator)return null;if(!this.row.visible)return null;for(var e=[],t=0;t<this.row.questions.length;t++){var n=this.row.questions[t];e.push(this.createQuestion(n))}return o.createElement("div",{className:this.css.row},e)},n.prototype.createQuestion=function(e){return o.createElement(s.SurveyQuestion,{key:e.name,question:e,creator:this.creator,css:this.css})},n}(o.Component))}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionErrors=t.SurveyQuestion=void 0;var i=n(40),o=r(i),s=n(15),u=n(47),a=(t.SurveyQuestion=function(t){function n(e){t.call(this,e),this.setQuestion(e.question),this.creator=e.creator,this.css=e.css}return e(n,t),n.prototype.componentWillReceiveProps=function(e){this.creator=e.creator,this.css=e.css,this.setQuestion(e.question)},n.prototype.setQuestion=function(e){this.questionBase=e,this.question=e instanceof s.Question?e:null;var t=this.question?this.question.value:null;this.state={visible:this.questionBase.visible,value:t,error:0,renderWidth:0,visibleIndexValue:-1}},n.prototype.componentDidMount=function(){if(this.questionBase){var e=this;this.questionBase.react=e,this.questionBase.renderWidthChangedCallback=function(){e.state.renderWidth=e.state.renderWidth+1,e.setState(e.state)},this.questionBase.visibleIndexChangedCallback=function(){e.state.visibleIndexValue=e.questionBase.visibleIndex,e.setState(e.state)}}},n.prototype.componentWillUnmount=function(){this.questionBase&&(this.questionBase.react=null,this.questionBase.renderWidthChangedCallback=null,this.questionBase.visibleIndexChangedCallback=null)},n.prototype.render=function(){if(!this.questionBase||!this.creator)return null;if(!this.questionBase.visible)return null;var e=this.creator.createQuestionElement(this.questionBase),t=this.questionBase.hasTitle?this.renderTitle():null,n="top"==this.creator.questionTitleLocation()?t:null,r="bottom"==this.creator.questionTitleLocation()?t:null,i=this.question&&this.question.hasComment?this.renderComment():null,s=this.renderErrors(),u=this.questionBase.indent>0?this.questionBase.indent*this.css.question.indent+"px":null,a=this.questionBase.rightIndent>0?this.questionBase.rightIndent*this.css.question.indent+"px":null,l={display:"inline-block",verticalAlign:"top"};return this.questionBase.renderWidth&&(l.width=this.questionBase.renderWidth),u&&(l.marginLeft=u),a&&(l.paddingRight=a),o.createElement("div",{id:this.questionBase.id,className:this.css.question.root,style:l},n,s,e,i,r)},n.prototype.renderTitle=function(){var e=this.question.fullTitle;return o.createElement("h5",{className:this.css.question.title},e)},n.prototype.renderComment=function(){return o.createElement("div",null,o.createElement("div",null,this.question.commentText),o.createElement("div",{className:this.css.question.comment},o.createElement(u.SurveyQuestionCommentItem,{question:this.question})))},n.prototype.renderErrors=function(){return o.createElement(a,{question:this.question,css:this.css,creator:this.creator})},n}(o.Component),t.SurveyQuestionErrors=function(t){function n(e){t.call(this,e),this.setQuestion(e.question),this.creator=e.creator,this.css=e.css}return e(n,t),n.prototype.componentWillReceiveProps=function(e){this.setQuestion(e.question),this.creator=e.creator,this.css=e.css},n.prototype.setQuestion=function(e){if(this.question=e instanceof s.Question?e:null,this.question){var t=this;this.question.errorsChangedCallback=function(){t.state.error=t.state.error+1,t.setState(t.state)}}this.state={error:0}},n.prototype.render=function(){if(!this.question||0==this.question.errors.length)return null;for(var e=[],t=0;t<this.question.errors.length;t++){var n=this.question.errors[t].getText(),r="error"+t;e.push(this.creator.renderError(r,n))}return o.createElement("div",{className:this.css.error.root},e)},n}(o.Component))}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionCommentItem=t.SurveyQuestionComment=void 0;var i=n(40),o=r(i),s=n(48),u=n(49),a=t.SurveyQuestionComment=function(t){function n(e){t.call(this,e),this.state={value:this.question.value||""},this.handleOnChange=this.handleOnChange.bind(this),this.handleOnBlur=this.handleOnBlur.bind(this)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.handleOnChange=function(e){this.setState({value:e.target.value})},n.prototype.handleOnBlur=function(e){this.question.value=e.target.value,this.setState({value:this.question.value||""})},n.prototype.render=function(){return this.question?this.isDisplayMode?o.createElement("div",{id:this.question.inputId,className:this.css},this.question.value):o.createElement("textarea",{id:this.question.inputId,className:this.css,type:"text",value:this.state.value,placeholder:this.question.placeHolder,onBlur:this.handleOnBlur,onChange:this.handleOnChange,cols:this.question.cols,rows:this.question.rows}):null},n}(s.SurveyQuestionElementBase);t.SurveyQuestionCommentItem=function(t){function n(e){t.call(this,e),this.question=e.question,this.comment=this.question.comment,this.state={value:this.comment},this.handleOnChange=this.handleOnChange.bind(this),this.handleOnBlur=this.handleOnBlur.bind(this)}return e(n,t),n.prototype.handleOnChange=function(e){this.comment=e.target.value,this.setState({value:this.comment})},n.prototype.handleOnBlur=function(e){this.question.comment=this.comment},n.prototype.componentWillReceiveProps=function(e){this.question=e.question},n.prototype.render=function(){return this.question?this.isDisplayMode?o.createElement("div",{className:this.css.question.comment},this.comment):o.createElement("input",{type:"text",className:this.css.question.comment,value:this.state.value,onChange:this.handleOnChange,onBlur:this.handleOnBlur}):null},n}(s.SurveyElementBase);u.ReactQuestionFactory.Instance.registerQuestion("comment",function(e){return o.createElement(a,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionElementBase=t.SurveyElementBase=void 0;var i=n(40),o=r(i),s=t.SurveyElementBase=function(t){function n(e){t.call(this,e),this.css=e.css,this.rootCss=e.rootCss,this.isDisplayMode=e.isDisplayMode||!1}return e(n,t),n.prototype.componentWillReceiveProps=function(e){this.css=e.css,this.rootCss=e.rootCss,this.isDisplayMode=e.isDisplayMode||!1},n}(o.Component);t.SurveyQuestionElementBase=function(t){function n(e){t.call(this,e),this.questionBase=e.question,this.creator=e.creator}return e(n,t),n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.questionBase=e.question,this.creator=e.creator},n}(s)}).call(t,n(5))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReactQuestionFactory=function(){function e(){this.creatorHash={}}return e.prototype.registerQuestion=function(e,t){this.creatorHash[e]=t},e.prototype.getAllTypes=function(){var e=new Array;for(var t in this.creatorHash)e.push(t);return e.sort()},e.prototype.createQuestion=function(e,t){var n=this.creatorHash[e];return null==n?null:n(t)},e.Instance=new e,e.DefaultChoices=["one","two|second value","three|third value"],e}()},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyNavigation=void 0;var i=n(40),o=r(i),s=n(51);t.SurveyNavigation=function(t){function n(e){t.call(this,e),this.handlePrevClick=this.handlePrevClick.bind(this),this.handleNextClick=this.handleNextClick.bind(this),this.handleCompleteClick=this.handleCompleteClick.bind(this)}return e(n,t),n.prototype.handlePrevClick=function(e){this.survey.prevPage()},n.prototype.handleNextClick=function(e){this.survey.nextPage()},n.prototype.handleCompleteClick=function(e){this.survey.completeLastPage()},n.prototype.render=function(){if(!this.survey||!this.survey.isNavigationButtonsShowing)return null;var e=this.survey.isFirstPage?null:this.renderButton(this.handlePrevClick,this.survey.pagePrevText,this.css.navigation.prev),t=this.survey.isLastPage?null:this.renderButton(this.handleNextClick,this.survey.pageNextText,this.css.navigation.next),n=this.survey.isLastPage?this.renderButton(this.handleCompleteClick,this.survey.completeText,this.css.navigation.complete):null;return o.createElement("div",{className:this.css.footer},e,t,n)},n.prototype.renderButton=function(e,t,n){var r={marginRight:"5px"},i=this.css.navigationButton+(n?" "+n:"");return o.createElement("input",{className:i,style:r,type:"button",onClick:e,value:t})},n}(s.SurveyNavigationBase)}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyNavigationBase=void 0;var i=n(40),o=r(i);t.SurveyNavigationBase=function(t){function n(e){t.call(this,e),this.updateStateFunction=null,this.survey=e.survey,this.css=e.css,this.state={update:0}}return e(n,t),n.prototype.componentWillReceiveProps=function(e){this.survey=e.survey,this.css=e.css},n.prototype.componentDidMount=function(){if(this.survey){var e=this;this.updateStateFunction=function(){e.state.update=e.state.update+1,e.setState(e.state)},this.survey.onPageVisibleChanged.add(this.updateStateFunction)}},n.prototype.componentWillUnmount=function(){this.survey&&this.updateStateFunction&&(this.survey.onPageVisibleChanged.remove(this.updateStateFunction),this.updateStateFunction=null)},n}(o.Component)}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyProgress=void 0;var i=n(40),o=r(i),s=n(51);t.SurveyProgress=function(t){function n(e){t.call(this,e),this.isTop=e.isTop}return e(n,t),n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.isTop=e.isTop},Object.defineProperty(n.prototype,"progress",{get:function(){return this.survey.getProgress()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"progressText",{get:function(){return this.survey.progressText},enumerable:!0,configurable:!0}),n.prototype.render=function(){var e=this.isTop?{width:"60%"}:{width:"60%",marginTop:"10px"},t={width:this.progress+"%"};return o.createElement("div",{className:this.css.progress,style:e},o.createElement("div",{style:t,className:this.css.progressBar,role:"progressbar","aria-valuemin":"0","aria-valuemax":"100"},o.createElement("span",null,this.progressText)))},n}(s.SurveyNavigationBase)}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionCheckboxItem=t.SurveyQuestionCheckbox=void 0;var i=n(40),o=r(i),s=n(48),u=n(47),a=n(49),l=t.SurveyQuestionCheckbox=function(t){function n(e){t.call(this,e),this.state={choicesChanged:0};var n=this;this.question.choicesChangedCallback=function(){n.state.choicesChanged=n.state.choicesChanged+1,n.setState(n.state)}}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.render=function(){return this.question?o.createElement("form",{className:this.css.root},this.getItems()):null},n.prototype.getItems=function(){for(var e=[],t=0;t<this.question.visibleChoices.length;t++){var n=this.question.visibleChoices[t],r="item"+t;e.push(this.renderItem(r,n,0==t))}return e},Object.defineProperty(n.prototype,"textStyle",{get:function(){return null},enumerable:!0,configurable:!0}),n.prototype.renderItem=function(e,t,n){return o.createElement(c,{key:e,question:this.question,css:this.css,rootCss:this.rootCss,isDisplayMode:this.isDisplayMode,item:t,textStyle:this.textStyle,isFirst:n})},n}(s.SurveyQuestionElementBase),c=t.SurveyQuestionCheckboxItem=function(t){function n(e){t.call(this,e),this.item=e.item,this.question=e.question,this.textStyle=e.textStyle,this.isFirst=e.isFirst,this.handleOnChange=this.handleOnChange.bind(this)}return e(n,t),n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.item=e.item,this.textStyle=e.textStyle,this.question=e.question,this.isFirst=e.isFirst},n.prototype.handleOnChange=function(e){var t=this.question.value;t||(t=[]);var n=t.indexOf(this.item.value);e.target.checked?n<0&&t.push(this.item.value):n>-1&&t.splice(n,1),this.question.value=t,this.setState({value:this.question.value})},n.prototype.render=function(){if(!this.item||!this.question)return null;var e=this.question.colCount>0?100/this.question.colCount+"%":"",t=0==this.question.colCount?"5px":"0px",n={marginRight:t};e&&(n.width=e);var r=this.question.value&&this.question.value.indexOf(this.item.value)>-1||!1,i=this.item.value===this.question.otherItem.value&&r?this.renderOther():null;return this.renderCheckbox(r,n,i)},Object.defineProperty(n.prototype,"inputStyle",{get:function(){return{marginRight:"3px"}},enumerable:!0,configurable:!0}),n.prototype.renderCheckbox=function(e,t,n){var r=this.isFirst?this.question.inputId:null;return o.createElement("div",{className:this.css.item,style:t},o.createElement("label",{className:this.css.item},o.createElement("input",{type:"checkbox",id:r,style:this.inputStyle,disabled:this.isDisplayMode,checked:e,onChange:this.handleOnChange}),o.createElement("span",null,this.item.text)),n)},n.prototype.renderOther=function(){return o.createElement("div",{className:this.css.other},o.createElement(u.SurveyQuestionCommentItem,{question:this.question,css:this.rootCss,isDisplayMode:this.isDisplayMode}))},n}(s.SurveyElementBase);a.ReactQuestionFactory.Instance.registerQuestion("checkbox",function(e){return o.createElement(l,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionDropdown=void 0;var i=n(40),o=r(i),s=n(48),u=n(47),a=n(49),l=t.SurveyQuestionDropdown=function(t){function n(e){t.call(this,e),this.state={value:this.question.value,choicesChanged:0};var n=this;this.question.choicesChangedCallback=function(){n.state.choicesChanged=n.state.choicesChanged+1,n.setState(n.state)},this.handleOnChange=this.handleOnChange.bind(this)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.handleOnChange=function(e){this.question.value=e.target.value,this.setState({value:this.question.value})},n.prototype.render=function(){if(!this.question)return null;var e=this.question.value===this.question.otherItem.value?this.renderOther():null,t=this.renderSelect();return o.createElement("div",null,t,e)},n.prototype.renderSelect=function(){if(this.isDisplayMode)return o.createElement("div",{id:this.question.inputId,className:this.css},this.question.value);for(var e=[],t=0;t<this.question.visibleChoices.length;t++){var n=this.question.visibleChoices[t],r="item"+t,i=o.createElement("option",{key:r,value:n.value},n.text);e.push(i)}return o.createElement("select",{id:this.question.inputId,className:this.css,value:this.state.value,onChange:this.handleOnChange},o.createElement("option",{value:""},this.question.optionsCaption),e)},n.prototype.renderOther=function(){var e={marginTop:"3px"};return o.createElement("div",{style:e},o.createElement(u.SurveyQuestionCommentItem,{question:this.question,css:this.rootCss,isDisplayMode:this.isDisplayMode}))},n}(s.SurveyQuestionElementBase);a.ReactQuestionFactory.Instance.registerQuestion("dropdown",function(e){return o.createElement(l,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionMatrixDropdownRow=t.SurveyQuestionMatrixDropdown=void 0;var i=n(40),o=r(i),s=n(48),u=n(46),a=n(49),l=t.SurveyQuestionMatrixDropdown=function(t){function n(e){t.call(this,e)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.render=function(){if(!this.question)return null;for(var e=[],t=0;t<this.question.columns.length;t++){var n=this.question.columns[t],r="column"+t,i=this.question.getColumnWidth(n),s=i?{minWidth:i}:{};e.push(o.createElement("th",{key:r,style:s},this.question.getColumnTitle(n)))}for(var u=[],a=this.question.visibleRows,t=0;t<a.length;t++){var l=a[t];u.push(o.createElement(c,{key:l.id,row:l,css:this.css,rootCss:this.rootCss,isDisplayMode:this.isDisplayMode,creator:this.creator}))}var h=this.question.horizontalScroll?{overflowX:"scroll"}:{};return o.createElement("div",{style:h},o.createElement("table",{className:this.css.root},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null),e)),o.createElement("tbody",null,u)))},n}(s.SurveyQuestionElementBase),c=t.SurveyQuestionMatrixDropdownRow=function(t){function n(e){t.call(this,e),this.setProperties(e)}return e(n,t),n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.setProperties(e)},n.prototype.setProperties=function(e){this.row=e.row,this.creator=e.creator},n.prototype.render=function(){if(!this.row)return null;for(var e=[],t=0;t<this.row.cells.length;t++){var n=this.row.cells[t],r=o.createElement(u.SurveyQuestionErrors,{question:n.question,css:this.rootCss,creator:this.creator}),i=this.renderSelect(n);e.push(o.createElement("td",{key:"row"+t},r,i))}return o.createElement("tr",null,o.createElement("td",null,this.row.text),e)},n.prototype.renderSelect=function(e){return this.creator.createQuestionElement(e.question)},n}(s.SurveyElementBase);a.ReactQuestionFactory.Instance.registerQuestion("matrixdropdown",function(e){return o.createElement(l,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionMatrixRow=t.SurveyQuestionMatrix=void 0;var i=n(40),o=r(i),s=n(48),u=n(49),a=t.SurveyQuestionMatrix=function(t){function n(e){t.call(this,e)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.render=function(){if(!this.question)return null;for(var e=this.question.hasRows?o.createElement("th",null):null,t=[],n=0;n<this.question.columns.length;n++){var r=this.question.columns[n],i="column"+n;t.push(o.createElement("th",{key:i},r.text))}for(var s=[],u=this.question.visibleRows,n=0;n<u.length;n++){var a=u[n],i="row"+n;s.push(o.createElement(l,{key:i,question:this.question,css:this.css,rootCss:this.rootCss,isDisplayMode:this.isDisplayMode,row:a,isFirst:0==n}))}return o.createElement("table",{className:this.css.root},o.createElement("thead",null,o.createElement("tr",null,e,t)),o.createElement("tbody",null,s))},n}(s.SurveyQuestionElementBase),l=t.SurveyQuestionMatrixRow=function(t){function n(e){t.call(this,e),this.question=e.question,this.row=e.row,this.isFirst=e.isFirst,this.handleOnChange=this.handleOnChange.bind(this)}return e(n,t),n.prototype.handleOnChange=function(e){this.row.value=e.target.value,this.setState({value:this.row.value})},n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.question=e.question,this.row=e.row,this.isFirst=e.isFirst},n.prototype.render=function(){if(!this.row)return null;for(var e=this.question.hasRows?o.createElement("td",null,this.row.text):null,t=[],n=0;n<this.question.columns.length;n++){var r=this.question.columns[n],i="value"+n,s=this.row.value==r.value,u=this.isFirst&&0==n?this.question.inputId:null,a=o.createElement("td",{key:i},o.createElement("input",{id:u,type:"radio",name:this.row.fullName,value:r.value,disabled:this.isDisplayMode,checked:s,onChange:this.handleOnChange}));t.push(a)}return o.createElement("tr",null,e,t)},n}(s.SurveyElementBase);u.ReactQuestionFactory.Instance.registerQuestion("matrix",function(e){return o.createElement(a,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionHtml=void 0;var i=n(40),o=r(i),s=n(48),u=n(49),a=t.SurveyQuestionHtml=function(t){function n(e){t.call(this,e)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.render=function(){if(!this.question||!this.question.html)return null;var e={__html:this.question.processedHtml};return o.createElement("div",{dangerouslySetInnerHTML:e})},n}(s.SurveyQuestionElementBase);u.ReactQuestionFactory.Instance.registerQuestion("html",function(e){return o.createElement(a,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionFile=void 0;var i=n(40),o=r(i),s=n(48),u=n(49),a=t.SurveyQuestionFile=function(t){function n(e){t.call(this,e),this.state={fileLoaded:0},this.handleOnChange=this.handleOnChange.bind(this)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.handleOnChange=function(e){var t=e.target||e.srcElement;window.FileReader&&(!t||!t.files||t.files.length<1||(this.question.loadFile(t.files[0]),this.setState({fileLoaded:this.state.fileLoaded+1})))},n.prototype.render=function(){if(!this.question)return null;var e=this.renderImage(),t=null;return this.isDisplayMode||(t=o.createElement("input",{id:this.question.inputId,type:"file",onChange:this.handleOnChange})),o.createElement("div",null,t,e)},n.prototype.renderImage=function(){return this.question.previewValue?o.createElement("div",null,"  ",o.createElement("img",{src:this.question.previewValue,height:this.question.imageHeight,width:this.question.imageWidth})):null},n}(s.SurveyQuestionElementBase);u.ReactQuestionFactory.Instance.registerQuestion("file",function(e){return o.createElement(a,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionMultipleTextItem=t.SurveyQuestionMultipleText=void 0;var i=n(40),o=r(i),s=n(48),u=n(49),a=t.SurveyQuestionMultipleText=function(t){function n(e){t.call(this,e)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.render=function(){if(!this.question)return null;for(var e=this.question.getRows(),t=[],n=0;n<e.length;n++)t.push(this.renderRow("item"+n,e[n]));return o.createElement("table",{className:this.css.root},o.createElement("tbody",null,t))},n.prototype.renderRow=function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r];n.push(o.createElement("td",{key:"label"+r},o.createElement("span",{className:this.css.itemTitle},i.title))),n.push(o.createElement("td",{key:"value"+r},this.renderItem(i,0==r)))}return o.createElement("tr",{key:e},n)},n.prototype.renderItem=function(e,t){var n=t?this.question.inputId:null;return o.createElement(l,{item:e,css:this.css,isDisplayMode:this.isDisplayMode,inputId:n})},n}(s.SurveyQuestionElementBase),l=t.SurveyQuestionMultipleTextItem=function(t){function n(e){t.call(this,e),this.item=e.item,this.inputId=e.inputId,this.state={value:this.item.value||""},this.handleOnChange=this.handleOnChange.bind(this),this.handleOnBlur=this.handleOnBlur.bind(this)}return e(n,t),n.prototype.handleOnChange=function(e){this.setState({value:e.target.value})},n.prototype.handleOnBlur=function(e){this.item.value=e.target.value,this.setState({value:this.item.value})},n.prototype.componentWillReceiveProps=function(e){this.item=e.item,this.css=e.css},n.prototype.render=function(){if(!this.item)return null;var e={"float":"left"};return this.isDisplayMode?o.createElement("div",{id:this.inputId,className:this.css.itemValue,style:e},this.item.value):o.createElement("input",{id:this.inputId,className:this.css.itemValue,style:e,type:"text",value:this.state.value,placeholder:this.item.placeHolder,onBlur:this.handleOnBlur,onChange:this.handleOnChange})},Object.defineProperty(n.prototype,"mainClassName",{get:function(){return""},enumerable:!0,configurable:!0}),n}(s.SurveyElementBase);u.ReactQuestionFactory.Instance.registerQuestion("multipletext",function(e){return o.createElement(a,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionRadiogroup=void 0;var i=n(40),o=r(i),s=n(48),u=n(47),a=n(49),l=t.SurveyQuestionRadiogroup=function(t){function n(e){t.call(this,e),this.state={choicesChanged:0};var n=this;this.question.choicesChangedCallback=function(){n.state.choicesChanged=n.state.choicesChanged+1,n.setState(n.state)},this.handleOnChange=this.handleOnChange.bind(this)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.handleOnChange=this.handleOnChange.bind(this)},n.prototype.handleOnChange=function(e){this.question.value=e.target.value,this.setState({value:this.question.value})},n.prototype.render=function(){return this.question?o.createElement("form",{className:this.css.root},this.getItems()):null},n.prototype.getItems=function(){for(var e=[],t=0;t<this.question.visibleChoices.length;t++){var n=this.question.visibleChoices[t],r="item"+t;e.push(this.renderItem(r,n,0==t))}return e},Object.defineProperty(n.prototype,"textStyle",{
get:function(){return{marginLeft:"3px"}},enumerable:!0,configurable:!0}),n.prototype.renderItem=function(e,t,n){var r=this.question.colCount>0?100/this.question.colCount+"%":"",i=0==this.question.colCount?"5px":"0px",o={marginRight:i};r&&(o.width=r);var s=this.question.value==t.value,u=s&&t.value===this.question.otherItem.value?this.renderOther():null;return this.renderRadio(e,t,s,o,u,n)},n.prototype.renderRadio=function(e,t,n,r,i,s){var u=s?this.question.inputId:null;return o.createElement("div",{key:e,className:this.css.item,style:r},o.createElement("label",{className:this.css.item},o.createElement("input",{id:u,type:"radio",checked:n,value:t.value,disabled:this.isDisplayMode,onChange:this.handleOnChange}),o.createElement("span",{style:this.textStyle},t.text)),i)},n.prototype.renderOther=function(){return o.createElement("div",{className:this.css.other},o.createElement(u.SurveyQuestionCommentItem,{question:this.question,css:this.rootCss,isDisplayMode:this.isDisplayMode}))},n}(s.SurveyQuestionElementBase);a.ReactQuestionFactory.Instance.registerQuestion("radiogroup",function(e){return o.createElement(l,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionText=void 0;var i=n(40),o=r(i),s=n(48),u=n(49),a=t.SurveyQuestionText=function(t){function n(e){t.call(this,e),this.state={value:this.question.value||""},this.handleOnChange=this.handleOnChange.bind(this),this.handleOnBlur=this.handleOnBlur.bind(this)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.handleOnChange=function(e){this.setState({value:e.target.value})},n.prototype.handleOnBlur=function(e){this.question.value=e.target.value,this.setState({value:this.question.value||""})},n.prototype.render=function(){return this.question?this.isDisplayMode?o.createElement("div",{id:this.question.inputId,className:this.css},this.question.value):o.createElement("input",{id:this.question.inputId,className:this.css,type:this.question.inputType,value:this.state.value,size:this.question.size,placeholder:this.question.placeHolder,onBlur:this.handleOnBlur,onChange:this.handleOnChange}):null},n}(s.SurveyQuestionElementBase);u.ReactQuestionFactory.Instance.registerQuestion("text",function(e){return o.createElement(a,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionMatrixDynamicRow=t.SurveyQuestionMatrixDynamic=void 0;var i=n(40),o=r(i),s=n(48),u=n(46),a=n(49),l=t.SurveyQuestionMatrixDynamic=function(t){function n(e){t.call(this,e),this.setProperties(e)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.setProperties(e)},n.prototype.setProperties=function(e){var t=this;this.state={rowCounter:0},this.question.rowCountChangedCallback=function(){t.state.rowCounter=t.state.rowCounter+1,t.setState(t.state)},this.handleOnRowAddClick=this.handleOnRowAddClick.bind(this)},n.prototype.handleOnRowAddClick=function(e){this.question.addRow()},n.prototype.render=function(){if(!this.question)return null;for(var e=[],t=0;t<this.question.columns.length;t++){var n=this.question.columns[t],r="column"+t,i=this.question.getColumnWidth(n),s=i?{minWidth:i}:{};e.push(o.createElement("th",{key:r,style:s},this.question.getColumnTitle(n)))}for(var u=[],a=this.question.visibleRows,t=0;t<a.length;t++){var l=a[t];u.push(o.createElement(c,{key:l.id,row:l,question:this.question,index:t,css:this.css,rootCss:this.rootCss,isDisplayMode:this.isDisplayMode,creator:this.creator}))}var h=this.question.horizontalScroll?{overflowX:"scroll"}:{},p=this.isDisplayMode?null:o.createElement("th",null);return o.createElement("div",null,o.createElement("div",{style:h},o.createElement("table",{className:this.css.root},o.createElement("thead",null,o.createElement("tr",null,e,p)),o.createElement("tbody",null,u))),this.renderAddRowButton())},n.prototype.renderAddRowButton=function(){return this.isDisplayMode?null:o.createElement("input",{className:this.css.button,type:"button",onClick:this.handleOnRowAddClick,value:this.question.addRowText})},n}(s.SurveyQuestionElementBase),c=t.SurveyQuestionMatrixDynamicRow=function(t){function n(e){t.call(this,e),this.setProperties(e)}return e(n,t),n.prototype.componentWillReceiveProps=function(e){t.prototype.componentWillReceiveProps.call(this,e),this.setProperties(e)},n.prototype.setProperties=function(e){this.row=e.row,this.question=e.question,this.index=e.index,this.creator=e.creator,this.handleOnRowRemoveClick=this.handleOnRowRemoveClick.bind(this)},n.prototype.handleOnRowRemoveClick=function(e){this.question.removeRow(this.index)},n.prototype.render=function(){if(!this.row)return null;for(var e=[],t=0;t<this.row.cells.length;t++){var n=this.row.cells[t],r=o.createElement(u.SurveyQuestionErrors,{question:n.question,css:this.rootCss,creator:this.creator}),i=this.renderQuestion(n);e.push(o.createElement("td",{key:"row"+t},r,i))}if(!this.isDisplayMode){var s=this.renderButton();e.push(o.createElement("td",{key:"row"+this.row.cells.length+1},s))}return o.createElement("tr",null,e)},n.prototype.renderQuestion=function(e){return this.creator.createQuestionElement(e.question)},n.prototype.renderButton=function(){return o.createElement("input",{className:this.css.button,type:"button",onClick:this.handleOnRowRemoveClick,value:this.question.removeRowText})},n}(s.SurveyElementBase);a.ReactQuestionFactory.Instance.registerQuestion("matrixdynamic",function(e){return o.createElement(l,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyQuestionRating=void 0;var i=n(40),o=r(i),s=n(48),u=n(47),a=n(49),l=t.SurveyQuestionRating=function(t){function n(e){t.call(this,e),this.handleOnChange=this.handleOnChange.bind(this)}return e(n,t),Object.defineProperty(n.prototype,"question",{get:function(){return this.questionBase},enumerable:!0,configurable:!0}),n.prototype.handleOnChange=function(e){this.question.value=e.target.value,this.setState({value:this.question.value})},n.prototype.render=function(){if(!this.question)return null;for(var e=[],t=0;t<this.question.visibleRateValues.length;t++){var n=0==t?this.question.mininumRateDescription+" ":null,r=t==this.question.visibleRateValues.length-1?" "+this.question.maximumRateDescription:null;e.push(this.renderItem("value"+t,this.question.visibleRateValues[t],n,r))}var i=this.question.hasOther?this.renderOther():null;return o.createElement("div",{className:this.css.root},e,i)},n.prototype.renderItem=function(e,t,n,r){var i=this.question.value==t.value,s=this.css.item;i&&(s+=" active");var u=n?o.createElement("span",null,n):null,a=r?o.createElement("span",null,r):null;return o.createElement("label",{key:e,className:s},o.createElement("input",{type:"radio",style:{display:"none"},name:this.question.name,value:t.value,disabled:this.isDisplayMode,checked:this.question.value==t.value,onChange:this.handleOnChange}),u,o.createElement("span",null,t.text),a)},n.prototype.renderOther=function(){return o.createElement("div",{className:this.css.other},o.createElement(u.SurveyQuestionCommentItem,{question:this.question,css:this.rootCss,isDisplayMode:this.isDisplayMode}))},n}(s.SurveyQuestionElementBase);a.ReactQuestionFactory.Instance.registerQuestion("rating",function(e){return o.createElement(l,e)})}).call(t,n(5))},function(e,t,n){(function(e){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyWindow=void 0;var i=n(40),o=r(i),s=n(39);t.SurveyWindow=function(t){function n(e){t.call(this,e),this.handleOnExpanded=this.handleOnExpanded.bind(this)}return e(n,t),n.prototype.handleOnExpanded=function(e){this.state.expanded=!this.state.expanded,this.setState(this.state)},n.prototype.render=function(){if(this.state.hidden)return null;var e=this.renderHeader(),t=this.state.expanded?this.renderBody():null,n={position:"fixed",bottom:"3px",right:"10px"};return o.createElement("div",{className:this.css.window.root,style:n},e,t)},n.prototype.renderHeader=function(){var e={width:"100%"},t={paddingRight:"10px"},n=this.state.expanded?this.css.window.header.buttonCollapsed:this.css.window.header.buttonExpanded;return n="glyphicon pull-right "+n,o.createElement("div",{className:this.css.window.header.root},o.createElement("a",{href:"#",onClick:this.handleOnExpanded,style:e},o.createElement("span",{className:this.css.window.header.title,style:t},this.title),o.createElement("span",{className:n,"aria-hidden":"true"})))},n.prototype.renderBody=function(){return o.createElement("div",{"class":this.css.window.body},this.renderSurvey())},n.prototype.updateSurvey=function(e){t.prototype.updateSurvey.call(this,e),this.title=e.title?e.title:this.survey.title;var n=!!e.expanded&&e.expanded;this.state={expanded:n,hidden:!1};var r=this;this.survey.onComplete.add(function(e){r.state.hidden=!0,r.setState(r.state)})},n}(s.Survey)}).call(t,n(5))},function(e,t,n){"use strict";n(66),n(67),n(68),n(69),n(70),n(71),n(72),n(73),n(74)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.danishSurveyStrings=void 0;var r=n(8),i=t.danishSurveyStrings={pagePrevText:"Tilbage",pageNextText:"Videre",completeText:"Frdig",progressText:"Side {0} af {1}",emptySurvey:"Der er ingen synlige sprgsml.",completingSurvey:"Mange tak for din besvarelse!",loadingSurvey:"Sprgeskemaet hentes fra serveren...",otherItemText:"Valgfrit svar...",optionsCaption:"Vlg...",requiredError:"Besvar venligst sprgsmlet.",numericError:"Angiv et tal.",textMinLength:"Angiv mindst {0} tegn.",minSelectError:"Vlg venligst mindst  {0} svarmulighed(er).",maxSelectError:"Vlg venligst frre {0} svarmuligheder(er).",numericMinMax:"'{0}' skal vre lig med eller strre end {1} og lig med eller mindre end {2}",numericMin:"'{0}' skal vre lig med eller strre end {1}",numericMax:"'{0}' skal vre lig med eller mindre end {1}",invalidEmail:"Angiv venligst en gyldig e-mail adresse.",exceedMaxSize:"Filstrrelsen m ikke overstige {0}.",otherRequiredError:"Angiv en vrdi for dit valgfrie svar."};r.surveyLocalization.locales.da=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dutchSurveyStrings=void 0;var r=n(8),i=t.dutchSurveyStrings={pagePrevText:"Vorige",pageNextText:"Volgende",completeText:"Afsluiten",otherItemText:"Andere",progressText:"Pagina {0} van {1}",emptySurvey:"Er is geen zichtbare pagina of vraag in deze vragenlijst",completingSurvey:"Bedankt om deze vragenlijst in te vullen",loadingSurvey:"De vragenlijst is aan het laden...",optionsCaption:"Kies...",requiredError:"Gelieve een antwoord in te vullen",numericError:"Het antwoord moet een getal zijn",textMinLength:"Gelieve minsten {0} karakters in te vullen.",minSelectError:"Gelieve minimum {0} antwoorden te selecteren.",maxSelectError:"Gelieve niet meer dan {0} antwoorden te selecteren.",numericMinMax:"Uw antwoord '{0}' moet groter of gelijk zijn aan {1} en kleiner of gelijk aan {2}",numericMin:"Uw antwoord '{0}' moet groter of gelijk zijn aan {1}",numericMax:"Uw antwoord '{0}' moet groter of gelijk zijn aan {1}",invalidEmail:"Gelieve een geldig e-mailadres in te vullen.",exceedMaxSize:"De grootte van het bestand mag niet groter zijn dan {0}.",otherRequiredError:"Gelieve het veld 'Andere' in te vullen"};r.surveyLocalization.locales.nl=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.finnishSurveyStrings=void 0;var r=n(8),i=t.finnishSurveyStrings={pagePrevText:"Edellinen",pageNextText:"Seuraava",completeText:"Valmis",otherItemText:"Muu (kuvaile)",progressText:"Sivu {0}/{1}",emptySurvey:"Tss kyselyss ei ole yhtkn nkyvill olevaa sivua tai kysymyst.",completingSurvey:"Kiitos kyselyyn vastaamisesta!",loadingSurvey:"Kysely ladataan palvelimelta...",optionsCaption:"Valitse...",requiredError:"Vastaa kysymykseen, kiitos.",numericError:"Arvon tulee olla numeerinen.",textMinLength:"Ole hyv ja syt vhintn {0} merkki.",minSelectError:"Ole hyv ja valitse vhintn {0} vaihtoehtoa.",maxSelectError:"Ole hyv ja valitse enintn {0} vaihtoehtoa.",numericMinMax:"'{0}' tytyy olla enemmn tai yht suuri kuin {1} ja vhemmn tai yht suuri kuin {2}",numericMin:"'{0}' tytyy olla enemmn tai yht suuri kuin {1}",numericMax:"'{0}' tytyy olla vhemmn tai yht suuri kuin {1}",invalidEmail:"Syt validi shkpostiosoite.",otherRequiredError:'Ole hyv ja syt "Muu (kuvaile)"'};r.surveyLocalization.locales.fi=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.frenchSurveyStrings=void 0;var r=n(8),i=t.frenchSurveyStrings={pagePrevText:"Prcdent",pageNextText:"Suivant",completeText:"Terminer",otherItemText:"Autre (prciser)",progressText:"Page {0} sur {1}",emptySurvey:"Il n'y a ni page visible ni question visible dans ce questionnaire",completingSurvey:"Merci d'avoir rpondu au questionnaire!",loadingSurvey:"Le questionnaire est en cours de chargement...",optionsCaption:"Choisissez...",requiredError:"La rponse  cette question est obligatoire.",numericError:"La rponse doit tre un nombre.",textMinLength:"Merci d'entrer au moins {0} symboles.",minSelectError:"Merci de slectionner au moins {0}rponses.",maxSelectError:"Merci de slectionner au plus {0}rponses.",numericMinMax:"Votre rponse '{0}' doit tresuprieure ou gale  {1} et infrieure ougale  {2}",numericMin:"Votre rponse '{0}' doit tresuprieure ou gale  {1}",numericMax:"Votre rponse '{0}' doit treinfrieure ou gale  {1}",invalidEmail:"Merci d'entrer une adresse mail valide.",exceedMaxSize:"La taille du fichier ne doit pas excder {0}.",otherRequiredError:"Merci de prciser le champ 'Autre'."};r.surveyLocalization.locales.fr=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.germanSurveyStrings=void 0;var r=n(8),i=t.germanSurveyStrings={pagePrevText:"Zurck",pageNextText:"Weiter",completeText:"Fertig",progressText:"Seite {0} von {1}",emptySurvey:"Es gibt keine sichtbare Frage.",completingSurvey:"Vielen Dank fr das Ausfllen des Fragebogens!",loadingSurvey:"Der Fragebogen wird vom Server geladen...",otherItemText:"Benutzerdefinierte Antwort...",optionsCaption:"Whlen...",requiredError:"Bitte antworten Sie auf die Frage.",numericError:"Der Wert sollte eine Zahl sein.",textMinLength:"Bitte geben Sie mindestens {0} Symbole.",minSelectError:"Bitte whlen Sie mindestens {0} Varianten.",maxSelectError:"Bitte whlen Sie nicht mehr als {0} Varianten.",numericMinMax:"'{0}' solte gleich oder grer sein als {1} und gleich oder kleiner als {2}",numericMin:"'{0}' solte gleich oder grer sein als {1}",numericMax:"'{0}' solte gleich oder kleiner als {1}",invalidEmail:"Bitte geben Sie eine gltige Email-Adresse ein.",exceedMaxSize:"Die Dateigre soll nicht mehr als {0}.",otherRequiredError:"Bitte geben Sie einen Wert fr Ihre benutzerdefinierte Antwort ein."};r.surveyLocalization.locales.de=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.greekSurveyStrings=void 0;var r=n(8),i=t.greekSurveyStrings={pagePrevText:"",pageNextText:"",completeText:"",otherItemText:" ( )",progressText:" {0}  {1}",emptySurvey:"           .",completingSurvey:"      !",loadingSurvey:"     ...",optionsCaption:"...",requiredError:"   .",requiredInAllRowsError:"       .",numericError:"     .",textMinLength:"   {0} .",minRowCountError:"   {0} .",minSelectError:"   {0} .",maxSelectError:"     {0} .",numericMinMax:" '{0}'          {1}       {2}",numericMin:" '{0}'         {1}",numericMax:" '{0}'         {1}",invalidEmail:"     e-mail.",urlRequestError:"    '{0}'. {1}",urlGetChoicesError:"        '/path'  ",exceedMaxSize:"       {0}.",otherRequiredError:"       ''.",uploadingFile:"   .       .",addRow:" ",removeRow:""};r.surveyLocalization.locales.gr=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.polishSurveyStrings=void 0;var r=n(8),i=t.polishSurveyStrings={pagePrevText:"Wstecz",pageNextText:"Dalej",completeText:"Gotowe",progressText:"Strona {0} z {1}",emptySurvey:"Nie ma widocznych pyta.",completingSurvey:"Dzikujemy za wypenienie ankiety!",loadingSurvey:"Trwa wczytywanie ankiety...",otherItemText:"Inna odpowied...",optionsCaption:"Wybierz...",requiredError:"Prosz odpowiedzie na to pytanie.",numericError:"W tym polu mona wpisa tylko liczby.",textMinLength:"Prosz wpisa co najmniej {0} znakw.",minSelectError:"Prosz wybra co najmniej {0} pozycji.",maxSelectError:"Prosz wybra nie wicej ni {0} pozycji.",numericMinMax:"Odpowied '{0}' powinna by wiksza lub rwna {1} oraz mniejsza lub rwna {2}",numericMin:"Odpowied '{0}' powinna by wiksza lub rwna {1}",numericMax:"Odpowied '{0}' powinna by mniejsza lub rwna {1}",invalidEmail:"Prosz poda prawidowy adres email.",exceedMaxSize:"Rozmiar przesanego pliku nie moe przekracza {0}.",otherRequiredError:"Prosz poda inn odpowied."};r.surveyLocalization.locales.pl=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.russianSurveyStrings=void 0;var r=n(8),i=t.russianSurveyStrings={pagePrevText:"",pageNextText:"",completeText:"",progressText:" {0}  {1}",emptySurvey:"   .",completingSurvey:"    !",loadingSurvey:"  ...",otherItemText:" (, )",optionsCaption:"...",requiredError:",   .",numericError:"   .",textMinLength:",    {0} .",minSelectError:",    {0} .",maxSelectError:",    {0} .",numericMinMax:"'{0}'     ,  {1},    ,  {2}",numericMin:"'{0}'     ,  {1}",numericMax:"'{0}'     ,  {1}",invalidEmail:",     .",otherRequiredError:',     ""'};r.surveyLocalization.locales.ru=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.turkishSurveyStrings=void 0;var r=n(8),i=t.turkishSurveyStrings={pagePrevText:"Geri",pageNextText:"leri",completeText:"Anketi Tamamla",otherItemText:"Dier (aklaynz)",progressText:"Sayfa {0} / {1}",emptySurvey:"Ankette grntlenecek sayfa ya da soru mevcut deil.",completingSurvey:"Anketimizi tamamladnz iin teekkr ederiz.",loadingSurvey:"Anket sunucudan ykleniyor ...",optionsCaption:"Seiniz ...",requiredError:"Ltfen soruya cevap veriniz",numericError:"Girilen deer numerik olmaldr",textMinLength:"En az {0} sembol giriniz.",minRowCountError:"Ltfen en az {0} satr doldurun.",minSelectError:"Ltfen en az {0} seenei seiniz.",maxSelectError:"Ltfen {0} adetten fazla semeyiniz.",numericMinMax:"The '{0}' should be equal or more than {1} and equal or less than {2}",numericMin:"'{0}' deeri {1} deerine eit veya byk olmaldr",numericMax:"'{0}' deeri {1} deerine eit ya da kk olmaldr.",invalidEmail:"Ltfen geerli bir eposta adresi giriniz.",urlRequestError:"Talebi u hatay dnd '{0}'. {1}",urlGetChoicesError:"Talep herhangi bir veri dnmedi ya da 'path' zellii hatal.",exceedMaxSize:"Dosya boyutu {0} deerini geemez.",otherRequiredError:"Ltfen dier deerleri giriniz.",uploadingFile:"Dosyanz ykleniyor. Ltfen birka saniye bekleyin ve tekrar deneyin.",addRow:"Satr Ekle",removeRow:"Kaldr"};r.surveyLocalization.locales.tr=i},function(t,n){t.exports=e}])});
ACC.csvimport = {
    TEXT_CSV_CONTENT_TYPE: 'text/csv',
    APP_EXCEL_CONTENT_TYPE: 'application/vnd.ms-excel',

    _autoload: [
        ["changeFileUploadAppearance", $(".js-file-upload").length != 0],
        ["bindImportCSVActions", $(".js-import-csv").length != 0]
    ],

    changeFileUploadAppearance: function() {
        $('.js-file-upload__input').on('change',function () {
            var files = (this.files);
            var fileNames = "";

            for (var i = 0; i < files.length; i++) {
                fileNames += (files[i].name) + '<br/>';

            }

            $('.js-file-upload__file-name').unbind('mouseenter mouseleave');

            if (files.length > 1) {
                $('.js-file-upload__file-name').html(files.length + " files");
                $('.js-file-upload__file-name').hover(

                    function mouseIn() {
                        $(this).html(fileNames.toLowerCase());
                    }, function mouseOut() {

                        $(this).html(files.length + " files");
                    }
                );
            } else {
                $('.js-file-upload__file-name').html(fileNames.toLowerCase());
            }

            if($('.js-file-upload').parents('#cboxLoadedContent').length > 0){
                ACC.colorbox.resize();
            }
        })
    },

    bindImportCSVActions: function() {
        $('#chooseFileButton').on('click', function (event) {
            ACC.csvimport.clearGlobalAlerts();
        });

        $('#importButton').on('click', function (event) {
            event.preventDefault();
            ACC.csvimport.clearGlobalAlerts();

            if (!($('.js-file-upload__input').val().trim().length > 0)) {
                ACC.csvimport.displayGlobalAlert({type: 'error', messageId: 'import-csv-no-file-chosen-error-message'});
                return;
            }

            var selectedFile = document.getElementById('csvFile').files[0];
            if (!ACC.csvimport.isSelectedFileValid(selectedFile)) {
                return;
            }

            var form = document.getElementById('importCSVSavedCartForm');
            var formData = new window.FormData(form);
            formData.append("csvFile", selectedFile);

            ACC.csvimport.displayGlobalAlert({type: 'warning', messageId: 'import-csv-upload-message'});
            ACC.csvimport.enableDisableActionButtons(false);

            $.ajax({
                url: form.action,
                type: 'POST',
                data: formData,
                contentType: false,
                processData: false,
                success: function() {
                    ACC.csvimport.displayGlobalAlert({type: 'info', message: ''});
                    $('#import-csv-alerts .alert-info').append($('#import-csv-success-message').html());

                    ACC.csvimport.clearChosenFile();
                },
                error: function(jqXHR) {
                    if (jqXHR.status == 400) {
                        if (jqXHR.responseJSON) {
                            ACC.csvimport.displayGlobalAlert({type: 'error', message: jqXHR.responseJSON});
                            return;
                        }
                    }

                    ACC.csvimport.displayGlobalAlert({type: 'error', messageId: 'import-csv-generic-error-message'});
                },
                complete: function() {
                    ACC.csvimport.enableDisableActionButtons(true);
                }
            });
        });
    },

    isSelectedFileValid: function(selectedFile) {
        if (window.File && window.Blob) {
            if (selectedFile) {
                if (!(selectedFile.type == ACC.csvimport.TEXT_CSV_CONTENT_TYPE ||
                    selectedFile.type == ACC.csvimport.APP_EXCEL_CONTENT_TYPE)) {
                    ACC.csvimport.displayGlobalAlert({type: 'error', messageId: 'import-csv-file-csv-required'});
                    return false;
                }

                var fileName = selectedFile.name;
                if (!fileName || !(/\.csv$/i).test(fileName)) {
                    ACC.csvimport.displayGlobalAlert({type: 'error', messageId: 'import-csv-file-csv-required'});
                    return false;
                }
            }

            var fileMaxSize = $('.js-file-upload__input').data('file-max-size');
            if ($.isNumeric(fileMaxSize) && selectedFile) {
                if (selectedFile.size > parseFloat(fileMaxSize)) {
                    ACC.csvimport.displayGlobalAlert({type: 'error', messageId: 'import-csv-file-max-size-exceeded-error-message'});
                    return false;
                }
            }
        }

        return true;
    },

    displayGlobalAlert: function(options) {
        ACC.csvimport.clearGlobalAlerts();
        var alertTemplateSelector;

        switch (options.type) {
            case 'error':
                alertTemplateSelector = '#global-alert-danger-template';
                break;
            case 'warning':
                alertTemplateSelector = '#global-alert-warning-template';
                break;
            default:
                alertTemplateSelector = '#global-alert-info-template';
        }

        if (typeof options.message != 'undefined') {
            $('#import-csv-alerts').append($(alertTemplateSelector).tmpl({message: options.message}));
        }

        if (typeof options.messageId != 'undefined')
        {
            $('#import-csv-alerts').append($(alertTemplateSelector).tmpl({message: $('#' + options.messageId).text()}));
        }
    },

    clearGlobalAlerts: function() {
        $('#import-csv-alerts').empty();
    },

    clearChosenFile: function() {
        document.getElementById('csvFile').value = '';
        $('.js-file-upload__file-name').text('');
    },

    enableDisableActionButtons: function(enable) {
        $('#chooseFileButton').attr('disabled', !enable);
        $('#importButton').prop('disabled', !enable);
    }
}
//################################################################
//#### Autoload
//################################################################
// 
// ACC.sample={
// 	_autoload: [
// 		"samplefunction",
// 		["somefunction", "some expression to test"]
// 		["somefunction","some expression to test","elsefunction"]
// 	],

// 	samplefunction:function(){
// 		//... do some suff here, executed every time ...
// 	},

// 	somefunction:function(){
// 		//... do some suff here. if expression match ...
// 	},

// 	elsefunction:function(){
// 		//... do some suff here. if expression NOT match ...
// 	}

// }

//  // sample expression: $(".js-storefinder-map").length != 0


function _autoload(){
	$.each(ACC,function(section,obj){
		if($.isArray(obj._autoload)){
			$.each(obj._autoload,function(key,value){
				if($.isArray(value)){
					if(value[1]){
						ACC[section][value[0]]();
					}else{
						if(value[2]){
							ACC[section][value[2]]()
						}
					}
				}else{
					if(ACC[section][value]) 	ACC[section][value]();
				}
			})
		}
	})
}

$(function(){
	_autoload();
});
ACC.addtocartaction = {

}

$(document).ready(function ()
{
	with (ACC.addtocartaction)
	{

	}
});



ACC.listaddtocartaction = {

}

$(document).ready(function ()
{
	with (ACC.listaddtocartaction)
	{

	}
});



ACC.listorderformaction = {

}

$(document).ready(function ()
{
	with (ACC.listorderformaction)
	{

	}
});



ACC.listpickupinstoreaction = {

}

$(document).ready(function ()
{
	with (ACC.listpickupinstoreaction)
	{

	}
});



ACC.pickupinstoreaction = {

}

$(document).ready(function ()
{
	with (ACC.pickupinstoreaction)
	{

	}
});



ACC.shareonsocialnetworkaction = {

}

$(document).ready(function ()
{
	with (ACC.shareonsocialnetworkaction)
	{

	}
});



ACC.viewstoreaction = {

}

$(document).ready(function ()
{
    with (ACC.viewstoreaction)
    {

    }
});
